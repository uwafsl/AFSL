var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var i;for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}}function eachReverse(e,t){if(e){var i;for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,n){return t&&eachProp(t,function(t,s){(i||!hasProp(e,s))&&(n&&"string"!=typeof t?(e[s]||(e[s]={}),mixin(e[s],t,i,n)):e[s]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,n){var s=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return s.requireType=e,s.requireModules=n,i&&(s.originalError=i),s}function newContext(e){function t(e){var t,i;for(t=0;e[t];t+=1)if(i=e[t],"."===i)e.splice(t,1),t-=1;else if(".."===i){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function i(e,i,n){var s,o,a,r,l,h,d,c,u,p,f,g=i&&i.split("/"),m=g,v=x.map,b=v&&v["*"];if(e&&"."===e.charAt(0)&&(i?(m=getOwn(x.pkgs,i)?g=[i]:g.slice(0,g.length-1),e=m.concat(e.split("/")),t(e),o=getOwn(x.pkgs,s=e[0]),e=e.join("/"),o&&e===s+"/"+o.main&&(e=s)):0===e.indexOf("./")&&(e=e.substring(2))),n&&v&&(g||b)){for(r=e.split("/"),l=r.length;l>0;l-=1){if(d=r.slice(0,l).join("/"),g)for(h=g.length;h>0;h-=1)if(a=getOwn(v,g.slice(0,h).join("/")),a&&(a=getOwn(a,d))){c=a,u=l;break}if(c)break;!p&&b&&getOwn(b,d)&&(p=getOwn(b,d),f=l)}!c&&p&&(c=p,u=f),c&&(r.splice(0,u,c),e=r.join("/"))}return e}function n(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function s(e){var t=getOwn(x.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function o(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function a(e,t,n,s){var a,r,l,h,d=null,c=t?t.name:null,u=e,p=!0,f="";return e||(p=!1,e="_@r"+(D+=1)),h=o(e),d=h[0],e=h[1],d&&(d=i(d,c,s),r=getOwn($,d)),e&&(d?f=r&&r.normalize?r.normalize(e,function(e){return i(e,c,s)}):i(e,c,s):(f=i(e,c,s),h=o(f),d=h[0],f=h[1],n=!0,a=w.nameToUrl(f))),l=!d||r||n?"":"_unnormalized"+(I+=1),{prefix:d,name:f,parentMap:t,unnormalized:!!l,url:a,originalName:u,isDefine:p,id:(d?d+"!"+f:f)+l}}function r(e){var t=e.id,i=getOwn(S,t);return i||(i=S[t]=new w.Module(e)),i}function l(e,t,i){var n=e.id,s=getOwn(S,n);!hasProp($,n)||s&&!s.defineEmitComplete?(s=r(e),s.error&&"error"===t?i(s.error):s.on(t,i)):"defined"===t&&i($[n])}function h(e,t){var i=e.requireModules,n=!1;t?t(e):(each(i,function(t){var i=getOwn(S,t);i&&(i.error=e,i.events.error&&(n=!0,i.emit("error",e)))}),n||req.onError(e))}function d(){globalDefQueue.length&&(apsp.apply(k,[k.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function c(e){delete S[e],delete T[e]}function u(e,t,i){var n=e.map.id;e.error?e.emit("error",e.error):(t[n]=!0,each(e.depMaps,function(n,s){var o=n.id,a=getOwn(S,o);!a||e.depMatched[s]||i[o]||(getOwn(t,o)?(e.defineDep(s,$[o]),e.check()):u(a,t,i))}),i[n]=!0)}function p(){var e,t,i,o,a=1e3*x.waitSeconds,r=a&&w.startTime+a<(new Date).getTime(),l=[],d=[],c=!1,f=!0;if(!b){if(b=!0,eachProp(T,function(i){if(e=i.map,t=e.id,i.enabled&&(e.isDefine||d.push(i),!i.error))if(!i.inited&&r)s(t)?(o=!0,c=!0):(l.push(t),n(t));else if(!i.inited&&i.fetched&&e.isDefine&&(c=!0,!e.prefix))return f=!1}),r&&l.length)return i=makeError("timeout","Load timeout for modules: "+l,null,l),i.contextName=w.contextName,h(i);f&&each(d,function(e){u(e,{},{})}),r&&!o||!c||!isBrowser&&!isWebWorker||C||(C=setTimeout(function(){C=0,p()},50)),b=!1}}function f(e){hasProp($,e[0])||r(a(e[0],null,!0)).init(e[1],e[2])}function g(e,t,i,n){e.detachEvent&&!isOpera?n&&e.detachEvent(n,t):e.removeEventListener(i,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,w.onScriptLoad,"load","onreadystatechange"),g(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function v(){var e;for(d();k.length;){if(e=k.shift(),null===e[0])return h(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}}var b,y,w,_,C,x={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},S={},T={},A={},k=[],$={},P={},D=1,I=1;return _={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=$[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,i=getOwn(x.pkgs,e.map.id);return t=i?getOwn(x.config,e.map.id+"/"+i.main):getOwn(x.config,e.map.id),t||{}},exports:$[e.map.id]}}},y=function(e){this.events=getOwn(A,e.id)||{},this.map=e,this.shim=getOwn(x.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(e,t,i,n){n=n||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;P[e]||(P[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,n=this.depExports,s=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{s=w.execCb(i,o,n,s)}catch(a){e=a}else s=w.execCb(i,o,n,s);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?s=t.exports:void 0===s&&this.usingExports&&(s=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",h(this.error=e)}else s=o;this.exports=s,this.map.isDefine&&!this.ignore&&($[i]=s,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,n=a(e.prefix);this.depMaps.push(n),l(n,"defined",bind(this,function(n){var s,o,d,u=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,f=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(u=n.normalize(u,function(e){return i(e,p,!0)})||""),o=a(e.prefix+"!"+u,this.map.parentMap),l(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),d=getOwn(S,o.id),void(d&&(this.depMaps.push(o),this.events.error&&d.on("error",bind(this,function(e){this.emit("error",e)})),d.enable()))):(s=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),s.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(S,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&c(e.map.id)}),h(e)}),s.fromText=bind(this,function(i,n){var o=e.name,l=a(o),d=useInteractive;n&&(i=n),d&&(useInteractive=!1),r(l),hasProp(x.config,t)&&(x.config[o]=x.config[t]);try{req.exec(i)}catch(c){return h(makeError("fromtexteval","fromText eval for "+t+" failed: "+c,c,[t]))}d&&(useInteractive=!0),this.depMaps.push(l),w.completeLoad(o),f([o],s)}),void n.load(e.name,f,s,x))})),w.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){T[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,n,s;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,s=getOwn(_,e.id))return void(this.depExports[t]=s(this));this.depCount+=1,l(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&l(e,"error",bind(this,this.errback))}i=e.id,n=S[i],hasProp(_,i)||!n||n.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(S,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:x,contextName:e,registry:S,defined:$,urlFetched:P,defQueue:k,Module:y,makeModuleMap:a,nextTick:req.nextTick,onError:h,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=x.pkgs,i=x.shim,n={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?"map"===t?(x.map||(x.map={}),mixin(x[t],e,!0,!0)):mixin(x[t],e,!0):x[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),i[t]=e}),x.shim=i),e.packages&&(each(e.packages,function(e){var i;e="string"==typeof e?{name:e}:e,i=e.location,t[e.name]={name:e.name,location:i||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),x.pkgs=t),eachProp(S,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,s){function o(i,n,l){var d,c,u;return s.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof i?isFunction(n)?h(makeError("requireargs","Invalid require call"),l):t&&hasProp(_,i)?_[i](S[t.id]):req.get?req.get(w,i,t,o):(c=a(i,t,!1,!0),d=c.id,hasProp($,d)?$[d]:h(makeError("notloaded",'Module name "'+d+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(v(),w.nextTick(function(){v(),u=r(a(null,t)),u.skipMap=s.skipMap,u.init(i,n,l,{enabled:!0}),p()}),o)}return s=s||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var n,s=e.lastIndexOf("."),o=e.split("/")[0],a="."===o||".."===o;return-1!==s&&(!a||s>1)&&(n=e.substring(s,e.length),e=e.substring(0,s)),w.nameToUrl(i(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp($,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp($,e)||hasProp(S,e)}}),t||(o.undef=function(e){d();var i=a(e,t,!0),s=getOwn(S,e);n(e),delete $[e],delete P[i.url],delete A[e],s&&(s.events.defined&&(A[e]=s.events),c(e))}),o},enable:function(e){var t=getOwn(S,e.id);t&&r(e).enable()},completeLoad:function(e){var t,i,n,o=getOwn(x.shim,e)||{},a=o.exports;for(d();k.length;){if(i=k.shift(),null===i[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);f(i)}if(n=getOwn(S,e),!t&&!hasProp($,e)&&n&&!n.inited){if(!(!x.enforceDefine||a&&getGlobal(a)))return s(e)?void 0:h(makeError("nodefine","No define call for "+e,null,[e]));f([e,o.deps||[],o.exportsFn])}p()},nameToUrl:function(e,t,i){var n,s,o,a,r,l,h,d,c;if(req.jsExtRegExp.test(e))d=e+(t||"");else{for(n=x.paths,s=x.pkgs,r=e.split("/"),l=r.length;l>0;l-=1){if(h=r.slice(0,l).join("/"),o=getOwn(s,h),c=getOwn(n,h)){isArray(c)&&(c=c[0]),r.splice(0,l,c);break}if(o){a=e===o.name?o.location+"/"+o.main:o.location,r.splice(0,l,a);break}}d=r.join("/"),d+=t||(/^data\:|\?/.test(d)||i?"":".js"),d=("/"===d.charAt(0)||d.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+d}return x.urlArgs?d+((-1===d.indexOf("?")?"?":"&")+x.urlArgs):d},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,i,n){return t.apply(n,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);return s(t.id)?void 0:h(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,n){var s,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=i,i=n):e=[]),o&&o.context&&(a=o.context),s=getOwn(contexts,a),s||(s=contexts[a]=req.s.newContext(a)),o&&s.configure(o),s.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},req.load=function(e,t,i){var n,s=e&&e.config||{};if(isBrowser)return n=req.createNode(s,t,i),n.setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",t),!n.attachEvent||n.attachEvent.toString&&n.attachEvent.toString().indexOf("[native code")<0||isOpera?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=i,currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{importScripts(i),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,o,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,i){var n,s;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript(),n&&(e||(e=n.getAttribute("data-requiremodule")),s=contexts[n.getAttribute("data-requirecontext")])),(s?s.defQueue:globalDefQueue).push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("libs/require/require",function(){}),define("main.min",function(){}),function(){if(!window.console||!window.console.log){var e={};e.log=e.error=e.info=e.debug=e.warn=e.trace=e.dir=e.dirxml=e.time=e.timeEnd=e.assert=e.profile=function(){},window.console=e}window.console.group&&window.console.groupCollapsed&&window.console.groupEnd||(window.console.groupCollapsed=window.console.group=function(e){window.console.log(e)},window.console.groupEnd=function(){})}(),define("console.setup",function(){}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t="length"in e&&e.length,i=Q.type(e);return"function"===i||Q.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function n(e,t,i){if(Q.isFunction(t))return Q.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return Q.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(rt.test(t))return Q.filter(t,e,i);t=Q.filter(t,e)}return Q.grep(e,function(e){return V.call(t,e)>=0!==i})}function s(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t=ft[e]={};return Q.each(e.match(pt)||[],function(e,i){t[i]=!0}),t}function a(){J.removeEventListener("DOMContentLoaded",a,!1),e.removeEventListener("load",a,!1),Q.ready()}function r(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Q.expando+r.uid++}function l(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(wt,"-$1").toLowerCase(),i=e.getAttribute(n),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:yt.test(i)?Q.parseJSON(i):i}catch(s){}bt.set(e,t,i)}else i=void 0;return i}function h(){return!0}function d(){return!1}function c(){try{return J.activeElement}catch(e){}}function u(e,t){return Q.nodeName(e,"table")&&Q.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Nt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var i=0,n=e.length;n>i;i++)vt.set(e[i],"globalEval",!t||vt.get(t[i],"globalEval"))}function m(e,t){var i,n,s,o,a,r,l,h;if(1===t.nodeType){if(vt.hasData(e)&&(o=vt.access(e),a=vt.set(t,o),h=o.events)){delete a.handle,a.events={};for(s in h)for(i=0,n=h[s].length;n>i;i++)Q.event.add(t,s,h[s][i])}bt.hasData(e)&&(r=bt.access(e),l=Q.extend({},r),bt.set(t,l))}}function v(e,t){var i=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Q.nodeName(e,t)?Q.merge([e],i):i}function b(e,t){var i=t.nodeName.toLowerCase();"input"===i&&St.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function y(t,i){var n,s=Q(i.createElement(t)).appendTo(i.body),o=e.getDefaultComputedStyle&&(n=e.getDefaultComputedStyle(s[0]))?n.display:Q.css(s[0],"display");return s.detach(),o}function w(e){var t=J,i=zt[e];return i||(i=y(e,t),"none"!==i&&i||(Ot=(Ot||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Ot[0].contentDocument,t.write(),t.close(),i=y(e,t),Ot.detach()),zt[e]=i),i}function _(e,t,i){var n,s,o,a,r=e.style;return i=i||Ut(e),i&&(a=i.getPropertyValue(t)||i[t]),i&&(""!==a||Q.contains(e.ownerDocument,e)||(a=Q.style(e,t)),Ht.test(a)&&jt.test(t)&&(n=r.width,s=r.minWidth,o=r.maxWidth,r.minWidth=r.maxWidth=r.width=a,a=i.width,r.width=n,r.minWidth=s,r.maxWidth=o)),void 0!==a?a+"":a}function C(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function x(e,t){if(t in e)return t;for(var i=t[0].toUpperCase()+t.slice(1),n=t,s=Xt.length;s--;)if(t=Xt[s]+i,t in e)return t;return n}function S(e,t,i){var n=qt.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function T(e,t,i,n,s){for(var o=i===(n?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=Q.css(e,i+Ct[o],!0,s)),n?("content"===i&&(a-=Q.css(e,"padding"+Ct[o],!0,s)),"margin"!==i&&(a-=Q.css(e,"border"+Ct[o]+"Width",!0,s))):(a+=Q.css(e,"padding"+Ct[o],!0,s),"padding"!==i&&(a+=Q.css(e,"border"+Ct[o]+"Width",!0,s)));return a}function A(e,t,i){var n=!0,s="width"===t?e.offsetWidth:e.offsetHeight,o=Ut(e),a="border-box"===Q.css(e,"boxSizing",!1,o);if(0>=s||null==s){if(s=_(e,t,o),(0>s||null==s)&&(s=e.style[t]),Ht.test(s))return s;n=a&&(Z.boxSizingReliable()||s===e.style[t]),s=parseFloat(s)||0}return s+T(e,t,i||(a?"border":"content"),n,o)+"px"}function k(e,t){for(var i,n,s,o=[],a=0,r=e.length;r>a;a++)n=e[a],n.style&&(o[a]=vt.get(n,"olddisplay"),i=n.style.display,t?(o[a]||"none"!==i||(n.style.display=""),""===n.style.display&&xt(n)&&(o[a]=vt.access(n,"olddisplay",w(n.nodeName)))):(s=xt(n),"none"===i&&s||vt.set(n,"olddisplay",s?i:Q.css(n,"display"))));for(a=0;r>a;a++)n=e[a],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[a]||"":"none"));return e}function $(e,t,i,n,s){return new $.prototype.init(e,t,i,n,s)}function P(){return setTimeout(function(){Zt=void 0}),Zt=Q.now()}function D(e,t){var i,n=0,s={height:e};for(t=t?1:0;4>n;n+=2-t)i=Ct[n],s["margin"+i]=s["padding"+i]=e;return t&&(s.opacity=s.width=e),s}function I(e,t,i){for(var n,s=(ii[t]||[]).concat(ii["*"]),o=0,a=s.length;a>o;o++)if(n=s[o].call(i,t,e))return n}function L(e,t,i){var n,s,o,a,r,l,h,d,c=this,u={},p=e.style,f=e.nodeType&&xt(e),g=vt.get(e,"fxshow");i.queue||(r=Q._queueHooks(e,"fx"),null==r.unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,c.always(function(){c.always(function(){r.unqueued--,Q.queue(e,"fx").length||r.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],h=Q.css(e,"display"),d="none"===h?vt.get(e,"olddisplay")||w(e.nodeName):h,"inline"===d&&"none"===Q.css(e,"float")&&(p.display="inline-block")),i.overflow&&(p.overflow="hidden",c.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in t)if(s=t[n],Kt.exec(s)){if(delete t[n],o=o||"toggle"===s,s===(f?"hide":"show")){if("show"!==s||!g||void 0===g[n])continue;f=!0}u[n]=g&&g[n]||Q.style(e,n)}else h=void 0;if(Q.isEmptyObject(u))"inline"===("none"===h?w(e.nodeName):h)&&(p.display=h);else{g?"hidden"in g&&(f=g.hidden):g=vt.access(e,"fxshow",{}),o&&(g.hidden=!f),f?Q(e).show():c.done(function(){Q(e).hide()}),c.done(function(){var t;vt.remove(e,"fxshow");for(t in u)Q.style(e,t,u[t])});for(n in u)a=I(f?g[n]:0,n,c),n in g||(g[n]=a.start,f&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}}function E(e,t){var i,n,s,o,a;for(i in e)if(n=Q.camelCase(i),s=t[n],o=e[i],Q.isArray(o)&&(s=o[1],o=e[i]=o[0]),i!==n&&(e[n]=o,delete e[i]),a=Q.cssHooks[n],a&&"expand"in a){o=a.expand(o),delete e[n];for(i in o)i in e||(e[i]=o[i],t[i]=s)}else t[n]=s}function M(e,t,i){var n,s,o=0,a=ti.length,r=Q.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var t=Zt||P(),i=Math.max(0,h.startTime+h.duration-t),n=i/h.duration||0,o=1-n,a=0,l=h.tweens.length;l>a;a++)h.tweens[a].run(o);return r.notifyWith(e,[h,o,i]),1>o&&l?i:(r.resolveWith(e,[h]),!1)},h=r.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Zt||P(),duration:i.duration,tweens:[],createTween:function(t,i){var n=Q.Tween(e,h.opts,t,i,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(n),n},stop:function(t){var i=0,n=t?h.tweens.length:0;if(s)return this;for(s=!0;n>i;i++)h.tweens[i].run(1);return t?r.resolveWith(e,[h,t]):r.rejectWith(e,[h,t]),this}}),d=h.props;for(E(d,h.opts.specialEasing);a>o;o++)if(n=ti[o].call(h,e,d,h.opts))return n;return Q.map(d,I,h),Q.isFunction(h.opts.start)&&h.opts.start.call(e,h),Q.fx.timer(Q.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function R(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,s=0,o=t.toLowerCase().match(pt)||[];if(Q.isFunction(i))for(;n=o[s++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function N(e,t,i,n){function s(r){var l;return o[r]=!0,Q.each(e[r]||[],function(e,r){var h=r(t,i,n);return"string"!=typeof h||a||o[h]?a?!(l=h):void 0:(t.dataTypes.unshift(h),s(h),!1)}),l}var o={},a=e===yi;return s(t.dataTypes[0])||!o["*"]&&s("*")}function F(e,t){var i,n,s=Q.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((s[i]?e:n||(n={}))[i]=t[i]);return n&&Q.extend(!0,e,n),e}function B(e,t,i){for(var n,s,o,a,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(s in r)if(r[s]&&r[s].test(n)){l.unshift(s);break}if(l[0]in i)o=l[0];else{for(s in i){if(!l[0]||e.converters[s+" "+l[0]]){o=s;break}a||(a=s)}o=o||a}return o?(o!==l[0]&&l.unshift(o),i[o]):void 0}function O(e,t,i,n){var s,o,a,r,l,h={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)h[a.toLowerCase()]=e.converters[a];for(o=d.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=d.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=h[l+" "+o]||h["* "+o],!a)for(s in h)if(r=s.split(" "),r[1]===o&&(a=h[l+" "+r[0]]||h["* "+r[0]])){a===!0?a=h[s]:h[s]!==!0&&(o=r[0],d.unshift(r[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(c){return{state:"parsererror",error:a?c:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function z(e,t,i,n){var s;if(Q.isArray(t))Q.each(t,function(t,s){i||Si.test(e)?n(e,s):z(e+"["+("object"==typeof s?t:"")+"]",s,i,n)});else if(i||"object"!==Q.type(t))n(e,t);else for(s in t)z(e+"["+s+"]",t[s],i,n)}function j(e){return Q.isWindow(e)?e:9===e.nodeType&&e.defaultView}var H=[],U=H.slice,W=H.concat,q=H.push,V=H.indexOf,G={},Y=G.toString,X=G.hasOwnProperty,Z={},J=e.document,K="2.1.4",Q=function(e,t){return new Q.fn.init(e,t)},et=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,tt=/^-ms-/,it=/-([\da-z])/gi,nt=function(e,t){return t.toUpperCase()};Q.fn=Q.prototype={jquery:K,constructor:Q,selector:"",length:0,toArray:function(){return U.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:U.call(this)},pushStack:function(e){var t=Q.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Q.each(this,e,t)},map:function(e){return this.pushStack(Q.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(U.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:q,sort:H.sort,splice:H.splice},Q.extend=Q.fn.extend=function(){var e,t,i,n,s,o,a=arguments[0]||{},r=1,l=arguments.length,h=!1;for("boolean"==typeof a&&(h=a,a=arguments[r]||{},r++),"object"==typeof a||Q.isFunction(a)||(a={}),r===l&&(a=this,r--);l>r;r++)if(null!=(e=arguments[r]))for(t in e)i=a[t],n=e[t],a!==n&&(h&&n&&(Q.isPlainObject(n)||(s=Q.isArray(n)))?(s?(s=!1,o=i&&Q.isArray(i)?i:[]):o=i&&Q.isPlainObject(i)?i:{},a[t]=Q.extend(h,o,n)):void 0!==n&&(a[t]=n));return a},Q.extend({expando:"jQuery"+(K+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Q.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==Q.type(e)||e.nodeType||Q.isWindow(e)?!1:e.constructor&&!X.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?G[Y.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=Q.trim(e),e&&(1===e.indexOf("use strict")?(t=J.createElement("script"),t.text=e,J.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(tt,"ms-").replace(it,nt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var s,o=0,a=e.length,r=i(e);if(n){if(r)for(;a>o&&(s=t.apply(e[o],n),s!==!1);o++);else for(o in e)if(s=t.apply(e[o],n),s===!1)break}else if(r)for(;a>o&&(s=t.call(e[o],o,e[o]),s!==!1);o++);else for(o in e)if(s=t.call(e[o],o,e[o]),s===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(et,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?Q.merge(n,"string"==typeof e?[e]:e):q.call(n,e)),n},inArray:function(e,t,i){return null==t?-1:V.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,s=e.length;i>n;n++)e[s++]=t[n];return e.length=s,e},grep:function(e,t,i){for(var n,s=[],o=0,a=e.length,r=!i;a>o;o++)n=!t(e[o],o),n!==r&&s.push(e[o]);return s},map:function(e,t,n){var s,o=0,a=e.length,r=i(e),l=[];if(r)for(;a>o;o++)s=t(e[o],o,n),null!=s&&l.push(s);else for(o in e)s=t(e[o],o,n),null!=s&&l.push(s);return W.apply([],l)},guid:1,proxy:function(e,t){var i,n,s;return"string"==typeof t&&(i=e[t],t=e,e=i),Q.isFunction(e)?(n=U.call(arguments,2),s=function(){return e.apply(t||this,n.concat(U.call(arguments)))},s.guid=e.guid=e.guid||Q.guid++,s):void 0},now:Date.now,support:Z}),Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){G["[object "+t+"]"]=t.toLowerCase()});var st=function(e){function t(e,t,i,n){var s,o,a,r,l,h,c,p,f,g;if((t?t.ownerDocument||t:z)!==L&&I(t),t=t||L,i=i||[],r=t.nodeType,"string"!=typeof e||!e||1!==r&&9!==r&&11!==r)return i;if(!n&&M){if(11!==r&&(s=bt.exec(e)))if(a=s[1]){if(9===r){if(o=t.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&B(t,o)&&o.id===a)return i.push(o),i}else{if(s[2])return K.apply(i,t.getElementsByTagName(e)),i;if((a=s[3])&&_.getElementsByClassName)return K.apply(i,t.getElementsByClassName(a)),i}if(_.qsa&&(!R||!R.test(e))){if(p=c=O,f=t,g=1!==r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(h=T(e),(c=t.getAttribute("id"))?p=c.replace(wt,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=h.length;l--;)h[l]=p+u(h[l]);f=yt.test(e)&&d(t.parentNode)||t,g=h.join(",")}if(g)try{return K.apply(i,f.querySelectorAll(g)),i}catch(m){}finally{c||t.removeAttribute("id")}}}return k(e.replace(lt,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>C.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[O]=!0,e}function s(e){var t=L.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var i=e.split("|"),n=e.length;n--;)C.attrHandle[i[n]]=t}function a(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function r(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function l(e){return function(t){var i=t.nodeName.toLowerCase();
return("input"===i||"button"===i)&&t.type===e}}function h(e){return n(function(t){return t=+t,n(function(i,n){for(var s,o=e([],i.length,t),a=o.length;a--;)i[s=o[a]]&&(i[s]=!(n[s]=i[s]))})})}function d(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function c(){}function u(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function p(e,t,i){var n=t.dir,s=i&&"parentNode"===n,o=H++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,o)}:function(t,i,a){var r,l,h=[j,o];if(a){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,a))return!0}else for(;t=t[n];)if(1===t.nodeType||s){if(l=t[O]||(t[O]={}),(r=l[n])&&r[0]===j&&r[1]===o)return h[2]=r[2];if(l[n]=h,h[2]=e(t,i,a))return!0}}}function f(e){return e.length>1?function(t,i,n){for(var s=e.length;s--;)if(!e[s](t,i,n))return!1;return!0}:e[0]}function g(e,i,n){for(var s=0,o=i.length;o>s;s++)t(e,i[s],n);return n}function m(e,t,i,n,s){for(var o,a=[],r=0,l=e.length,h=null!=t;l>r;r++)(o=e[r])&&(!i||i(o,n,s))&&(a.push(o),h&&t.push(r));return a}function v(e,t,i,s,o,a){return s&&!s[O]&&(s=v(s)),o&&!o[O]&&(o=v(o,a)),n(function(n,a,r,l){var h,d,c,u=[],p=[],f=a.length,v=n||g(t||"*",r.nodeType?[r]:r,[]),b=!e||!n&&t?v:m(v,u,e,r,l),y=i?o||(n?e:f||s)?[]:a:b;if(i&&i(b,y,r,l),s)for(h=m(y,p),s(h,[],r,l),d=h.length;d--;)(c=h[d])&&(y[p[d]]=!(b[p[d]]=c));if(n){if(o||e){if(o){for(h=[],d=y.length;d--;)(c=y[d])&&h.push(b[d]=c);o(null,y=[],h,l)}for(d=y.length;d--;)(c=y[d])&&(h=o?et(n,c):u[d])>-1&&(n[h]=!(a[h]=c))}}else y=m(y===a?y.splice(f,y.length):y),o?o(null,a,y,l):K.apply(a,y)})}function b(e){for(var t,i,n,s=e.length,o=C.relative[e[0].type],a=o||C.relative[" "],r=o?1:0,l=p(function(e){return e===t},a,!0),h=p(function(e){return et(t,e)>-1},a,!0),d=[function(e,i,n){var s=!o&&(n||i!==$)||((t=i).nodeType?l(e,i,n):h(e,i,n));return t=null,s}];s>r;r++)if(i=C.relative[e[r].type])d=[p(f(d),i)];else{if(i=C.filter[e[r].type].apply(null,e[r].matches),i[O]){for(n=++r;s>n&&!C.relative[e[n].type];n++);return v(r>1&&f(d),r>1&&u(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(lt,"$1"),i,n>r&&b(e.slice(r,n)),s>n&&b(e=e.slice(n)),s>n&&u(e))}d.push(i)}return f(d)}function y(e,i){var s=i.length>0,o=e.length>0,a=function(n,a,r,l,h){var d,c,u,p=0,f="0",g=n&&[],v=[],b=$,y=n||o&&C.find.TAG("*",h),w=j+=null==b?1:Math.random()||.1,_=y.length;for(h&&($=a!==L&&a);f!==_&&null!=(d=y[f]);f++){if(o&&d){for(c=0;u=e[c++];)if(u(d,a,r)){l.push(d);break}h&&(j=w)}s&&((d=!u&&d)&&p--,n&&g.push(d))}if(p+=f,s&&f!==p){for(c=0;u=i[c++];)u(g,v,a,r);if(n){if(p>0)for(;f--;)g[f]||v[f]||(v[f]=Z.call(l));v=m(v)}K.apply(l,v),h&&!n&&v.length>0&&p+i.length>1&&t.uniqueSort(l)}return h&&(j=w,$=b),g};return s?n(a):a}var w,_,C,x,S,T,A,k,$,P,D,I,L,E,M,R,N,F,B,O="sizzle"+1*new Date,z=e.document,j=0,H=0,U=i(),W=i(),q=i(),V=function(e,t){return e===t&&(D=!0),0},G=1<<31,Y={}.hasOwnProperty,X=[],Z=X.pop,J=X.push,K=X.push,Q=X.slice,et=function(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",nt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",st=nt.replace("w","w#"),ot="\\["+it+"*("+nt+")(?:"+it+"*([*^$|!~]?=)"+it+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+st+"))|)"+it+"*\\]",at=":("+nt+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ot+")*)|.*)\\)|)",rt=new RegExp(it+"+","g"),lt=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),ht=new RegExp("^"+it+"*,"+it+"*"),dt=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),ct=new RegExp("="+it+"*([^\\]'\"]*?)"+it+"*\\]","g"),ut=new RegExp(at),pt=new RegExp("^"+st+"$"),ft={ID:new RegExp("^#("+nt+")"),CLASS:new RegExp("^\\.("+nt+")"),TAG:new RegExp("^("+nt.replace("w","w*")+")"),ATTR:new RegExp("^"+ot),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+tt+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},gt=/^(?:input|select|textarea|button)$/i,mt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,wt=/'|\\/g,_t=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),Ct=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},xt=function(){I()};try{K.apply(X=Q.call(z.childNodes),z.childNodes),X[z.childNodes.length].nodeType}catch(St){K={apply:X.length?function(e,t){J.apply(e,Q.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}_=t.support={},S=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},I=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:z;return n!==L&&9===n.nodeType&&n.documentElement?(L=n,E=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",xt,!1):i.attachEvent&&i.attachEvent("onunload",xt)),M=!S(n),_.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=s(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=vt.test(n.getElementsByClassName),_.getById=s(function(e){return E.appendChild(e).id=O,!n.getElementsByName||!n.getElementsByName(O).length}),_.getById?(C.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&M){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},C.filter.ID=function(e){var t=e.replace(_t,Ct);return function(e){return e.getAttribute("id")===t}}):(delete C.find.ID,C.filter.ID=function(e){var t=e.replace(_t,Ct);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),C.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],s=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[s++];)1===i.nodeType&&n.push(i);return n}return o},C.find.CLASS=_.getElementsByClassName&&function(e,t){return M?t.getElementsByClassName(e):void 0},N=[],R=[],(_.qsa=vt.test(n.querySelectorAll))&&(s(function(e){E.appendChild(e).innerHTML="<a id='"+O+"'></a><select id='"+O+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&R.push("[*^$]="+it+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||R.push("\\["+it+"*(?:value|"+tt+")"),e.querySelectorAll("[id~="+O+"-]").length||R.push("~="),e.querySelectorAll(":checked").length||R.push(":checked"),e.querySelectorAll("a#"+O+"+*").length||R.push(".#.+[+~]")}),s(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&R.push("name"+it+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||R.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),R.push(",.*:")})),(_.matchesSelector=vt.test(F=E.matches||E.webkitMatchesSelector||E.mozMatchesSelector||E.oMatchesSelector||E.msMatchesSelector))&&s(function(e){_.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),N.push("!=",at)}),R=R.length&&new RegExp(R.join("|")),N=N.length&&new RegExp(N.join("|")),t=vt.test(E.compareDocumentPosition),B=t||vt.test(E.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return D=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!_.sortDetached&&t.compareDocumentPosition(e)===i?e===n||e.ownerDocument===z&&B(z,e)?-1:t===n||t.ownerDocument===z&&B(z,t)?1:P?et(P,e)-et(P,t):0:4&i?-1:1)}:function(e,t){if(e===t)return D=!0,0;var i,s=0,o=e.parentNode,r=t.parentNode,l=[e],h=[t];if(!o||!r)return e===n?-1:t===n?1:o?-1:r?1:P?et(P,e)-et(P,t):0;if(o===r)return a(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)h.unshift(i);for(;l[s]===h[s];)s++;return s?a(l[s],h[s]):l[s]===z?-1:h[s]===z?1:0},n):L},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==L&&I(e),i=i.replace(ct,"='$1']"),!(!_.matchesSelector||!M||N&&N.test(i)||R&&R.test(i)))try{var n=F.call(e,i);if(n||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(s){}return t(i,L,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==L&&I(e),B(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==L&&I(e);var i=C.attrHandle[t.toLowerCase()],n=i&&Y.call(C.attrHandle,t.toLowerCase())?i(e,t,!M):void 0;return void 0!==n?n:_.attributes||!M?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,s=0;if(D=!_.detectDuplicates,P=!_.sortStable&&e.slice(0),e.sort(V),D){for(;t=e[s++];)t===e[s]&&(n=i.push(s));for(;n--;)e.splice(i[n],1)}return P=null,e},x=t.getText=function(e){var t,i="",n=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=x(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[n++];)i+=x(t);return i},C=t.selectors={cacheLength:50,createPseudo:n,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_t,Ct),e[3]=(e[3]||e[4]||e[5]||"").replace(_t,Ct),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return ft.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&ut.test(i)&&(t=T(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_t,Ct).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=U[e+" "];return t||(t=new RegExp("(^|"+it+")"+e+"("+it+"|$)"))&&U(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(s){var o=t.attr(s,e);return null==o?"!="===i:i?(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(rt," ")+" ").indexOf(n)>-1:"|="===i?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,i,n,s){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),r="of-type"===t;return 1===n&&0===s?function(e){return!!e.parentNode}:function(t,i,l){var h,d,c,u,p,f,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=r&&t.nodeName.toLowerCase(),b=!l&&!r;if(m){if(o){for(;g;){for(c=t;c=c[g];)if(r?c.nodeName.toLowerCase()===v:1===c.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?m.firstChild:m.lastChild],a&&b){for(d=m[O]||(m[O]={}),h=d[e]||[],p=h[0]===j&&h[1],u=h[0]===j&&h[2],c=p&&m.childNodes[p];c=++p&&c&&c[g]||(u=p=0)||f.pop();)if(1===c.nodeType&&++u&&c===t){d[e]=[j,p,u];break}}else if(b&&(h=(t[O]||(t[O]={}))[e])&&h[0]===j)u=h[1];else for(;(c=++p&&c&&c[g]||(u=p=0)||f.pop())&&((r?c.nodeName.toLowerCase()!==v:1!==c.nodeType)||!++u||(b&&((c[O]||(c[O]={}))[e]=[j,u]),c!==t)););return u-=s,u===n||u%n===0&&u/n>=0}}},PSEUDO:function(e,i){var s,o=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[O]?o(i):o.length>1?(s=[e,e,"",i],C.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,s=o(e,i),a=s.length;a--;)n=et(e,s[a]),e[n]=!(t[n]=s[a])}):function(e){return o(e,0,s)}):o}},pseudos:{not:n(function(e){var t=[],i=[],s=A(e.replace(lt,"$1"));return s[O]?n(function(e,t,i,n){for(var o,a=s(e,null,n,[]),r=e.length;r--;)(o=a[r])&&(e[r]=!(t[r]=o))}):function(e,n,o){return t[0]=e,s(t,null,o,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(_t,Ct),function(t){return(t.textContent||t.innerText||x(t)).indexOf(e)>-1}}),lang:n(function(e){return pt.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_t,Ct).toLowerCase(),function(t){var i;do if(i=M?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===E},focus:function(e){return e===L.activeElement&&(!L.hasFocus||L.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return mt.test(e.nodeName)},input:function(e){return gt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:h(function(){return[0]}),last:h(function(e,t){return[t-1]}),eq:h(function(e,t,i){return[0>i?i+t:i]}),even:h(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:h(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:h(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:h(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}},C.pseudos.nth=C.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[w]=r(w);for(w in{submit:!0,reset:!0})C.pseudos[w]=l(w);return c.prototype=C.filters=C.pseudos,C.setFilters=new c,T=t.tokenize=function(e,i){var n,s,o,a,r,l,h,d=W[e+" "];if(d)return i?0:d.slice(0);for(r=e,l=[],h=C.preFilter;r;){(!n||(s=ht.exec(r)))&&(s&&(r=r.slice(s[0].length)||r),l.push(o=[])),n=!1,(s=dt.exec(r))&&(n=s.shift(),o.push({value:n,type:s[0].replace(lt," ")}),r=r.slice(n.length));for(a in C.filter)!(s=ft[a].exec(r))||h[a]&&!(s=h[a](s))||(n=s.shift(),o.push({value:n,type:a,matches:s}),r=r.slice(n.length));if(!n)break}return i?r.length:r?t.error(e):W(e,l).slice(0)},A=t.compile=function(e,t){var i,n=[],s=[],o=q[e+" "];if(!o){for(t||(t=T(e)),i=t.length;i--;)o=b(t[i]),o[O]?n.push(o):s.push(o);o=q(e,y(s,n)),o.selector=e}return o},k=t.select=function(e,t,i,n){var s,o,a,r,l,h="function"==typeof e&&e,c=!n&&T(e=h.selector||e);if(i=i||[],1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&_.getById&&9===t.nodeType&&M&&C.relative[o[1].type]){if(t=(C.find.ID(a.matches[0].replace(_t,Ct),t)||[])[0],!t)return i;h&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(s=ft.needsContext.test(e)?0:o.length;s--&&(a=o[s],!C.relative[r=a.type]);)if((l=C.find[r])&&(n=l(a.matches[0].replace(_t,Ct),yt.test(o[0].type)&&d(t.parentNode)||t))){if(o.splice(s,1),e=n.length&&u(o),!e)return K.apply(i,n),i;break}}return(h||A(e,c))(n,t,!M,i,yt.test(e)&&d(t.parentNode)||t),i},_.sortStable=O.split("").sort(V).join("")===O,_.detectDuplicates=!!D,I(),_.sortDetached=s(function(e){return 1&e.compareDocumentPosition(L.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||o(tt,function(e,t,i){var n;return i?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);Q.find=st,Q.expr=st.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=st.uniqueSort,Q.text=st.getText,Q.isXMLDoc=st.isXML,Q.contains=st.contains;var ot=Q.expr.match.needsContext,at=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rt=/^.[^:#\[\.,]*$/;Q.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?Q.find.matchesSelector(n,e)?[n]:[]:Q.find.matches(e,Q.grep(t,function(e){return 1===e.nodeType}))},Q.fn.extend({find:function(e){var t,i=this.length,n=[],s=this;if("string"!=typeof e)return this.pushStack(Q(e).filter(function(){for(t=0;i>t;t++)if(Q.contains(s[t],this))return!0}));for(t=0;i>t;t++)Q.find(e,s[t],n);return n=this.pushStack(i>1?Q.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&ot.test(e)?Q(e):e||[],!1).length}});var lt,ht=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,dt=Q.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ht.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||lt).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof Q?t[0]:t,Q.merge(this,Q.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:J,!0)),at.test(i[1])&&Q.isPlainObject(t))for(i in t)Q.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return n=J.getElementById(i[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=J,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Q.isFunction(e)?"undefined"!=typeof lt.ready?lt.ready(e):e(Q):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Q.makeArray(e,this))};dt.prototype=Q.fn,lt=Q(J);var ct=/^(?:parents|prev(?:Until|All))/,ut={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(e,t,i){for(var n=[],s=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(s&&Q(e).is(i))break;n.push(e)}return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),Q.fn.extend({has:function(e){var t=Q(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(Q.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,n=0,s=this.length,o=[],a=ot.test(e)||"string"!=typeof e?Q(e,t||this.context):0;s>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&Q.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?Q.unique(o):o)},index:function(e){return e?"string"==typeof e?V.call(Q(e),this[0]):V.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Q.unique(Q.merge(this.get(),Q(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,i){return Q.dir(e,"parentNode",i)},next:function(e){return s(e,"nextSibling")},prev:function(e){return s(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,i){return Q.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return Q.dir(e,"previousSibling",i)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(i,n){var s=Q.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=Q.filter(n,s)),this.length>1&&(ut[e]||Q.unique(s),ct.test(e)&&s.reverse()),this.pushStack(s)}});var pt=/\S+/g,ft={};Q.Callbacks=function(e){e="string"==typeof e?ft[e]||o(e):Q.extend({},e);var t,i,n,s,a,r,l=[],h=!e.once&&[],d=function(o){for(t=e.memory&&o,i=!0,r=s||0,s=0,a=l.length,n=!0;l&&a>r;r++)if(l[r].apply(o[0],o[1])===!1&&e.stopOnFalse){t=!1;break}n=!1,l&&(h?h.length&&d(h.shift()):t?l=[]:c.disable())},c={add:function(){if(l){var i=l.length;!function o(t){Q.each(t,function(t,i){var n=Q.type(i);"function"===n?e.unique&&c.has(i)||l.push(i):i&&i.length&&"string"!==n&&o(i)})}(arguments),n?a=l.length:t&&(s=i,d(t))}return this},remove:function(){return l&&Q.each(arguments,function(e,t){for(var i;(i=Q.inArray(t,l,i))>-1;)l.splice(i,1),n&&(a>=i&&a--,r>=i&&r--)}),this},has:function(e){return e?Q.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=h=t=void 0,this},disabled:function(){return!l},lock:function(){return h=void 0,t||c.disable(),this},locked:function(){return!h},fireWith:function(e,t){return!l||i&&!h||(t=t||[],t=[e,t.slice?t.slice():t],n?h.push(t):d(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Q.Deferred(function(i){Q.each(t,function(t,o){var a=Q.isFunction(e[t])&&e[t];s[o[1]](function(){var e=a&&a.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===n?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Q.extend(e,n):n}},s={};return n.pipe=n.then,Q.each(t,function(e,o){var a=o[2],r=o[3];n[o[1]]=a.add,r&&a.add(function(){i=r},t[1^e][2].disable,t[2][2].lock),s[o[0]]=function(){return s[o[0]+"With"](this===s?n:this,arguments),this},s[o[0]+"With"]=a.fireWith}),n.promise(s),e&&e.call(s,s),s},when:function(e){var t,i,n,s=0,o=U.call(arguments),a=o.length,r=1!==a||e&&Q.isFunction(e.promise)?a:0,l=1===r?e:Q.Deferred(),h=function(e,i,n){return function(s){i[e]=this,n[e]=arguments.length>1?U.call(arguments):s,n===t?l.notifyWith(i,n):--r||l.resolveWith(i,n)}};if(a>1)for(t=new Array(a),i=new Array(a),n=new Array(a);a>s;s++)o[s]&&Q.isFunction(o[s].promise)?o[s].promise().done(h(s,n,o)).fail(l.reject).progress(h(s,i,t)):--r;return r||l.resolveWith(n,o),l.promise()}});var gt;Q.fn.ready=function(e){return Q.ready.promise().done(e),this},Q.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){(e===!0?--Q.readyWait:Q.isReady)||(Q.isReady=!0,e!==!0&&--Q.readyWait>0||(gt.resolveWith(J,[Q]),Q.fn.triggerHandler&&(Q(J).triggerHandler("ready"),Q(J).off("ready"))))}}),Q.ready.promise=function(t){return gt||(gt=Q.Deferred(),"complete"===J.readyState?setTimeout(Q.ready):(J.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1))),gt.promise(t)},Q.ready.promise();var mt=Q.access=function(e,t,i,n,s,o,a){var r=0,l=e.length,h=null==i;if("object"===Q.type(i)){s=!0;for(r in i)Q.access(e,t,r,i[r],!0,o,a)}else if(void 0!==n&&(s=!0,Q.isFunction(n)||(a=!0),h&&(a?(t.call(e,n),t=null):(h=t,t=function(e,t,i){return h.call(Q(e),i)})),t))for(;l>r;r++)t(e[r],i,a?n:n.call(e[r],r,t(e[r],i)));return s?e:h?t.call(e):l?t(e[0],i):o};Q.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},r.uid=1,r.accepts=Q.acceptData,r.prototype={key:function(e){if(!r.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=r.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(n){t[this.expando]=i,Q.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var n,s=this.key(e),o=this.cache[s];if("string"==typeof t)o[t]=i;else if(Q.isEmptyObject(o))Q.extend(this.cache[s],t);else for(n in t)o[n]=t[n];return o},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,t,i){var n;return void 0===t||t&&"string"==typeof t&&void 0===i?(n=this.get(e,t),void 0!==n?n:this.get(e,Q.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n,s,o=this.key(e),a=this.cache[o];if(void 0===t)this.cache[o]={};else{Q.isArray(t)?n=t.concat(t.map(Q.camelCase)):(s=Q.camelCase(t),t in a?n=[t,s]:(n=s,n=n in a?[n]:n.match(pt)||[])),i=n.length;for(;i--;)delete a[n[i]]}},hasData:function(e){return!Q.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var vt=new r,bt=new r,yt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,wt=/([A-Z])/g;Q.extend({hasData:function(e){return bt.hasData(e)||vt.hasData(e)},data:function(e,t,i){return bt.access(e,t,i)},removeData:function(e,t){bt.remove(e,t)},_data:function(e,t,i){return vt.access(e,t,i)},_removeData:function(e,t){vt.remove(e,t)}}),Q.fn.extend({data:function(e,t){var i,n,s,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(s=bt.get(o),1===o.nodeType&&!vt.get(o,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&(n=a[i].name,0===n.indexOf("data-")&&(n=Q.camelCase(n.slice(5)),l(o,n,s[n])));vt.set(o,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){bt.set(this,e)}):mt(this,function(t){var i,n=Q.camelCase(e);if(o&&void 0===t){if(i=bt.get(o,e),void 0!==i)return i;if(i=bt.get(o,n),void 0!==i)return i;if(i=l(o,n,void 0),void 0!==i)return i}else this.each(function(){var i=bt.get(this,n);bt.set(this,n,t),-1!==e.indexOf("-")&&void 0!==i&&bt.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){bt.remove(this,e)})}}),Q.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=vt.get(e,t),i&&(!n||Q.isArray(i)?n=vt.access(e,t,Q.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=Q.queue(e,t),n=i.length,s=i.shift(),o=Q._queueHooks(e,t),a=function(){Q.dequeue(e,t)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===t&&i.unshift("inprogress"),delete o.stop,s.call(e,a,o)),!n&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return vt.get(e,i)||vt.access(e,i,{empty:Q.Callbacks("once memory").add(function(){vt.remove(e,[t+"queue",i])})})}}),Q.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?Q.queue(this[0],e):void 0===t?this:this.each(function(){var i=Q.queue(this,e,t);Q._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,s=Q.Deferred(),o=this,a=this.length,r=function(){--n||s.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)i=vt.get(o[a],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(r));return r(),s.promise(t)}});var _t=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ct=["Top","Right","Bottom","Left"],xt=function(e,t){return e=t||e,"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)},St=/^(?:checkbox|radio)$/i;!function(){var e=J.createDocumentFragment(),t=e.appendChild(J.createElement("div")),i=J.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),Z.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Z.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Tt="undefined";Z.focusinBubbles="onfocusin"in e;var At=/^key/,kt=/^(?:mouse|pointer|contextmenu)|click/,$t=/^(?:focusinfocus|focusoutblur)$/,Pt=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(e,t,i,n,s){var o,a,r,l,h,d,c,u,p,f,g,m=vt.get(e);if(m)for(i.handler&&(o=i,i=o.handler,s=o.selector),i.guid||(i.guid=Q.guid++),(l=m.events)||(l=m.events={}),(a=m.handle)||(a=m.handle=function(t){return typeof Q!==Tt&&Q.event.triggered!==t.type?Q.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(pt)||[""],h=t.length;h--;)r=Pt.exec(t[h])||[],p=g=r[1],f=(r[2]||"").split(".").sort(),p&&(c=Q.event.special[p]||{},p=(s?c.delegateType:c.bindType)||p,c=Q.event.special[p]||{},d=Q.extend({type:p,origType:g,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&Q.expr.match.needsContext.test(s),namespace:f.join(".")},o),(u=l[p])||(u=l[p]=[],u.delegateCount=0,c.setup&&c.setup.call(e,n,f,a)!==!1||e.addEventListener&&e.addEventListener(p,a,!1)),c.add&&(c.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),s?u.splice(u.delegateCount++,0,d):u.push(d),Q.event.global[p]=!0)},remove:function(e,t,i,n,s){var o,a,r,l,h,d,c,u,p,f,g,m=vt.hasData(e)&&vt.get(e);if(m&&(l=m.events)){for(t=(t||"").match(pt)||[""],h=t.length;h--;)if(r=Pt.exec(t[h])||[],p=g=r[1],f=(r[2]||"").split(".").sort(),p){for(c=Q.event.special[p]||{},p=(n?c.delegateType:c.bindType)||p,u=l[p]||[],r=r[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=u.length;o--;)d=u[o],!s&&g!==d.origType||i&&i.guid!==d.guid||r&&!r.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(u.splice(o,1),d.selector&&u.delegateCount--,c.remove&&c.remove.call(e,d));a&&!u.length&&(c.teardown&&c.teardown.call(e,f,m.handle)!==!1||Q.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)Q.event.remove(e,p+t[h],i,n,!0);Q.isEmptyObject(l)&&(delete m.handle,vt.remove(e,"events"))}},trigger:function(t,i,n,s){var o,a,r,l,h,d,c,u=[n||J],p=X.call(t,"type")?t.type:t,f=X.call(t,"namespace")?t.namespace.split("."):[];if(a=r=n=n||J,3!==n.nodeType&&8!==n.nodeType&&!$t.test(p+Q.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),h=p.indexOf(":")<0&&"on"+p,t=t[Q.expando]?t:new Q.Event(p,"object"==typeof t&&t),t.isTrigger=s?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:Q.makeArray(i,[t]),c=Q.event.special[p]||{},s||!c.trigger||c.trigger.apply(n,i)!==!1)){if(!s&&!c.noBubble&&!Q.isWindow(n)){for(l=c.delegateType||p,$t.test(l+p)||(a=a.parentNode);a;a=a.parentNode)u.push(a),r=a;r===(n.ownerDocument||J)&&u.push(r.defaultView||r.parentWindow||e)}for(o=0;(a=u[o++])&&!t.isPropagationStopped();)t.type=o>1?l:c.bindType||p,d=(vt.get(a,"events")||{})[t.type]&&vt.get(a,"handle"),d&&d.apply(a,i),d=h&&a[h],d&&d.apply&&Q.acceptData(a)&&(t.result=d.apply(a,i),t.result===!1&&t.preventDefault());return t.type=p,s||t.isDefaultPrevented()||c._default&&c._default.apply(u.pop(),i)!==!1||!Q.acceptData(n)||h&&Q.isFunction(n[p])&&!Q.isWindow(n)&&(r=n[h],r&&(n[h]=null),Q.event.triggered=p,n[p](),Q.event.triggered=void 0,r&&(n[h]=r)),t.result}},dispatch:function(e){e=Q.event.fix(e);var t,i,n,s,o,a=[],r=U.call(arguments),l=(vt.get(this,"events")||{})[e.type]||[],h=Q.event.special[e.type]||{};if(r[0]=e,e.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,e)!==!1){for(a=Q.event.handlers.call(this,e,l),t=0;(s=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,i=0;(o=s.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,n=((Q.event.special[o.origType]||{}).handle||o.handler).apply(s.elem,r),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,s,o,a=[],r=t.delegateCount,l=e.target;if(r&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(n=[],i=0;r>i;i++)o=t[i],s=o.selector+" ",void 0===n[s]&&(n[s]=o.needsContext?Q(s,this).index(l)>=0:Q.find(s,this,null,[l]).length),n[s]&&n.push(o);
n.length&&a.push({elem:l,handlers:n})}return r<t.length&&a.push({elem:this,handlers:t.slice(r)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,s,o=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||J,n=i.documentElement,s=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||s&&s.scrollLeft||0)-(n&&n.clientLeft||s&&s.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||s&&s.scrollTop||0)-(n&&n.clientTop||s&&s.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Q.expando])return e;var t,i,n,s=e.type,o=e,a=this.fixHooks[s];for(a||(this.fixHooks[s]=a=kt.test(s)?this.mouseHooks:At.test(s)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,e=new Q.Event(o),t=n.length;t--;)i=n[t],e[i]=o[i];return e.target||(e.target=J),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==c()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===c()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Q.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Q.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var s=Q.extend(new Q.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?Q.event.trigger(s,null,t):Q.event.dispatch.call(t,s),s.isDefaultPrevented()&&i.preventDefault()}},Q.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},Q.Event=function(e,t){return this instanceof Q.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?h:d):this.type=e,t&&Q.extend(this,t),this.timeStamp=e&&e.timeStamp||Q.now(),void(this[Q.expando]=!0)):new Q.Event(e,t)},Q.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=h,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=h,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=h,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,s=e.relatedTarget,o=e.handleObj;return(!s||s!==n&&!Q.contains(n,s))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),Z.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){var n=this.ownerDocument||this,s=vt.access(n,t);s||n.addEventListener(e,i,!0),vt.access(n,t,(s||0)+1)},teardown:function(){var n=this.ownerDocument||this,s=vt.access(n,t)-1;s?vt.access(n,t,s):(n.removeEventListener(e,i,!0),vt.remove(n,t))}}}),Q.fn.extend({on:function(e,t,i,n,s){var o,a;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(a in e)this.on(a,t,i,e[a],s);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),n===!1)n=d;else if(!n)return this;return 1===s&&(o=n,n=function(e){return Q().off(e),o.apply(this,arguments)},n.guid=o.guid||(o.guid=Q.guid++)),this.each(function(){Q.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,s;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,Q(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=d),this.each(function(){Q.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?Q.event.trigger(e,t,i,!0):void 0}});var Dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,It=/<([\w:]+)/,Lt=/<|&#?\w+;/,Et=/<(?:script|style|link)/i,Mt=/checked\s*(?:[^=]|=\s*.checked.)/i,Rt=/^$|\/(?:java|ecma)script/i,Nt=/^true\/(.*)/,Ft=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Bt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Bt.optgroup=Bt.option,Bt.tbody=Bt.tfoot=Bt.colgroup=Bt.caption=Bt.thead,Bt.th=Bt.td,Q.extend({clone:function(e,t,i){var n,s,o,a,r=e.cloneNode(!0),l=Q.contains(e.ownerDocument,e);if(!(Z.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Q.isXMLDoc(e)))for(a=v(r),o=v(e),n=0,s=o.length;s>n;n++)b(o[n],a[n]);if(t)if(i)for(o=o||v(e),a=a||v(r),n=0,s=o.length;s>n;n++)m(o[n],a[n]);else m(e,r);return a=v(r,"script"),a.length>0&&g(a,!l&&v(e,"script")),r},buildFragment:function(e,t,i,n){for(var s,o,a,r,l,h,d=t.createDocumentFragment(),c=[],u=0,p=e.length;p>u;u++)if(s=e[u],s||0===s)if("object"===Q.type(s))Q.merge(c,s.nodeType?[s]:s);else if(Lt.test(s)){for(o=o||d.appendChild(t.createElement("div")),a=(It.exec(s)||["",""])[1].toLowerCase(),r=Bt[a]||Bt._default,o.innerHTML=r[1]+s.replace(Dt,"<$1></$2>")+r[2],h=r[0];h--;)o=o.lastChild;Q.merge(c,o.childNodes),o=d.firstChild,o.textContent=""}else c.push(t.createTextNode(s));for(d.textContent="",u=0;s=c[u++];)if((!n||-1===Q.inArray(s,n))&&(l=Q.contains(s.ownerDocument,s),o=v(d.appendChild(s),"script"),l&&g(o),i))for(h=0;s=o[h++];)Rt.test(s.type||"")&&i.push(s);return d},cleanData:function(e){for(var t,i,n,s,o=Q.event.special,a=0;void 0!==(i=e[a]);a++){if(Q.acceptData(i)&&(s=i[vt.expando],s&&(t=vt.cache[s]))){if(t.events)for(n in t.events)o[n]?Q.event.remove(i,n):Q.removeEvent(i,n,t.handle);vt.cache[s]&&delete vt.cache[s]}delete bt.cache[i[bt.expando]]}}}),Q.fn.extend({text:function(e){return mt(this,function(e){return void 0===e?Q.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?Q.filter(e,this):this,s=0;null!=(i=n[s]);s++)t||1!==i.nodeType||Q.cleanData(v(i)),i.parentNode&&(t&&Q.contains(i.ownerDocument,i)&&g(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Q.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Q.clone(this,e,t)})},html:function(e){return mt(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Et.test(e)&&!Bt[(It.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Dt,"<$1></$2>");try{for(;n>i;i++)t=this[i]||{},1===t.nodeType&&(Q.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(s){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Q.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=W.apply([],e);var i,n,s,o,a,r,l=0,h=this.length,d=this,c=h-1,u=e[0],g=Q.isFunction(u);if(g||h>1&&"string"==typeof u&&!Z.checkClone&&Mt.test(u))return this.each(function(i){var n=d.eq(i);g&&(e[0]=u.call(this,i,n.html())),n.domManip(e,t)});if(h&&(i=Q.buildFragment(e,this[0].ownerDocument,!1,this),n=i.firstChild,1===i.childNodes.length&&(i=n),n)){for(s=Q.map(v(i,"script"),p),o=s.length;h>l;l++)a=i,l!==c&&(a=Q.clone(a,!0,!0),o&&Q.merge(s,v(a,"script"))),t.call(this[l],a,l);if(o)for(r=s[s.length-1].ownerDocument,Q.map(s,f),l=0;o>l;l++)a=s[l],Rt.test(a.type||"")&&!vt.access(a,"globalEval")&&Q.contains(r,a)&&(a.src?Q._evalUrl&&Q._evalUrl(a.src):Q.globalEval(a.textContent.replace(Ft,"")))}return this}}),Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(e){for(var i,n=[],s=Q(e),o=s.length-1,a=0;o>=a;a++)i=a===o?this:this.clone(!0),Q(s[a])[t](i),q.apply(n,i.get());return this.pushStack(n)}});var Ot,zt={},jt=/^margin/,Ht=new RegExp("^("+_t+")(?!px)[a-z%]+$","i"),Ut=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",s.appendChild(o);var t=e.getComputedStyle(a,null);i="1%"!==t.top,n="4px"===t.width,s.removeChild(o)}var i,n,s=J.documentElement,o=J.createElement("div"),a=J.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===a.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(a),e.getComputedStyle&&Q.extend(Z,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return null==n&&t(),n},reliableMarginRight:function(){var t,i=a.appendChild(J.createElement("div"));return i.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",a.style.width="1px",s.appendChild(o),t=!parseFloat(e.getComputedStyle(i,null).marginRight),s.removeChild(o),a.removeChild(i),t}}))}(),Q.swap=function(e,t,i,n){var s,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];s=i.apply(e,n||[]);for(o in t)e.style[o]=a[o];return s};var Wt=/^(none|table(?!-c[ea]).+)/,qt=new RegExp("^("+_t+")(.*)$","i"),Vt=new RegExp("^([+-])=("+_t+")","i"),Gt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=_(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,a,r=Q.camelCase(t),l=e.style;return t=Q.cssProps[r]||(Q.cssProps[r]=x(l,r)),a=Q.cssHooks[t]||Q.cssHooks[r],void 0===i?a&&"get"in a&&void 0!==(s=a.get(e,!1,n))?s:l[t]:(o=typeof i,"string"===o&&(s=Vt.exec(i))&&(i=(s[1]+1)*s[2]+parseFloat(Q.css(e,t)),o="number"),null!=i&&i===i&&("number"!==o||Q.cssNumber[r]||(i+="px"),Z.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(i=a.set(e,i,n))||(l[t]=i)),void 0)}},css:function(e,t,i,n){var s,o,a,r=Q.camelCase(t);return t=Q.cssProps[r]||(Q.cssProps[r]=x(e.style,r)),a=Q.cssHooks[t]||Q.cssHooks[r],a&&"get"in a&&(s=a.get(e,!0,i)),void 0===s&&(s=_(e,t,n)),"normal"===s&&t in Yt&&(s=Yt[t]),""===i||i?(o=parseFloat(s),i===!0||Q.isNumeric(o)?o||0:s):s}}),Q.each(["height","width"],function(e,t){Q.cssHooks[t]={get:function(e,i,n){return i?Wt.test(Q.css(e,"display"))&&0===e.offsetWidth?Q.swap(e,Gt,function(){return A(e,t,n)}):A(e,t,n):void 0},set:function(e,i,n){var s=n&&Ut(e);return S(e,i,n?T(e,t,n,"border-box"===Q.css(e,"boxSizing",!1,s),s):0)}}}),Q.cssHooks.marginRight=C(Z.reliableMarginRight,function(e,t){return t?Q.swap(e,{display:"inline-block"},_,[e,"marginRight"]):void 0}),Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(i){for(var n=0,s={},o="string"==typeof i?i.split(" "):[i];4>n;n++)s[e+Ct[n]+t]=o[n]||o[n-2]||o[0];return s}},jt.test(e)||(Q.cssHooks[e+t].set=S)}),Q.fn.extend({css:function(e,t){return mt(this,function(e,t,i){var n,s,o={},a=0;if(Q.isArray(t)){for(n=Ut(e),s=t.length;s>a;a++)o[t[a]]=Q.css(e,t[a],!1,n);return o}return void 0!==i?Q.style(e,t,i):Q.css(e,t)},e,t,arguments.length>1)},show:function(){return k(this,!0)},hide:function(){return k(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){xt(this)?Q(this).show():Q(this).hide()})}}),Q.Tween=$,$.prototype={constructor:$,init:function(e,t,i,n,s,o){this.elem=e,this.prop=i,this.easing=s||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=o||(Q.cssNumber[i]?"":"px")},cur:function(){var e=$.propHooks[this.prop];return e&&e.get?e.get(this):$.propHooks._default.get(this)},run:function(e){var t,i=$.propHooks[this.prop];return this.pos=t=this.options.duration?Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):$.propHooks._default.set(this),this}},$.prototype.init.prototype=$.prototype,$.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Q.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},$.propHooks.scrollTop=$.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Q.fx=$.prototype.init,Q.fx.step={};var Zt,Jt,Kt=/^(?:toggle|show|hide)$/,Qt=new RegExp("^(?:([+-])=|)("+_t+")([a-z%]*)$","i"),ei=/queueHooks$/,ti=[L],ii={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),s=Qt.exec(t),o=s&&s[3]||(Q.cssNumber[e]?"":"px"),a=(Q.cssNumber[e]||"px"!==o&&+n)&&Qt.exec(Q.css(i.elem,e)),r=1,l=20;if(a&&a[3]!==o){o=o||a[3],s=s||[],a=+n||1;do r=r||".5",a/=r,Q.style(i.elem,e,a+o);while(r!==(r=i.cur()/n)&&1!==r&&--l)}return s&&(a=i.start=+a||+n||0,i.unit=o,i.end=s[1]?a+(s[1]+1)*s[2]:+s[2]),i}]};Q.Animation=Q.extend(M,{tweener:function(e,t){Q.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,s=e.length;s>n;n++)i=e[n],ii[i]=ii[i]||[],ii[i].unshift(t)},prefilter:function(e,t){t?ti.unshift(e):ti.push(e)}}),Q.speed=function(e,t,i){var n=e&&"object"==typeof e?Q.extend({},e):{complete:i||!i&&t||Q.isFunction(e)&&e,duration:e,easing:i&&t||t&&!Q.isFunction(t)&&t};return n.duration=Q.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in Q.fx.speeds?Q.fx.speeds[n.duration]:Q.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){Q.isFunction(n.old)&&n.old.call(this),n.queue&&Q.dequeue(this,n.queue)},n},Q.fn.extend({fadeTo:function(e,t,i,n){return this.filter(xt).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var s=Q.isEmptyObject(e),o=Q.speed(t,i,n),a=function(){var t=M(this,Q.extend({},e),o);(s||vt.get(this,"finish"))&&t.stop(!0)};return a.finish=a,s||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,s=null!=e&&e+"queueHooks",o=Q.timers,a=vt.get(this);if(s)a[s]&&a[s].stop&&n(a[s]);else for(s in a)a[s]&&a[s].stop&&ei.test(s)&&n(a[s]);for(s=o.length;s--;)o[s].elem!==this||null!=e&&o[s].queue!==e||(o[s].anim.stop(i),t=!1,o.splice(s,1));(t||!i)&&Q.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=vt.get(this),n=i[e+"queue"],s=i[e+"queueHooks"],o=Q.timers,a=n?n.length:0;for(i.finish=!0,Q.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),Q.each(["toggle","show","hide"],function(e,t){var i=Q.fn[t];Q.fn[t]=function(e,n,s){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(D(t,!0),e,n,s)}}),Q.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),Q.timers=[],Q.fx.tick=function(){var e,t=0,i=Q.timers;for(Zt=Q.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||Q.fx.stop(),Zt=void 0},Q.fx.timer=function(e){Q.timers.push(e),e()?Q.fx.start():Q.timers.pop()},Q.fx.interval=13,Q.fx.start=function(){Jt||(Jt=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.stop=function(){clearInterval(Jt),Jt=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fn.delay=function(e,t){return e=Q.fx?Q.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},function(){var e=J.createElement("input"),t=J.createElement("select"),i=t.appendChild(J.createElement("option"));e.type="checkbox",Z.checkOn=""!==e.value,Z.optSelected=i.selected,t.disabled=!0,Z.optDisabled=!i.disabled,e=J.createElement("input"),e.value="t",e.type="radio",Z.radioValue="t"===e.value}();var ni,si,oi=Q.expr.attrHandle;Q.fn.extend({attr:function(e,t){return mt(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})}}),Q.extend({attr:function(e,t,i){var n,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===Tt?Q.prop(e,t,i):(1===o&&Q.isXMLDoc(e)||(t=t.toLowerCase(),n=Q.attrHooks[t]||(Q.expr.match.bool.test(t)?si:ni)),void 0===i?n&&"get"in n&&null!==(s=n.get(e,t))?s:(s=Q.find.attr(e,t),null==s?void 0:s):null!==i?n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:(e.setAttribute(t,i+""),i):void Q.removeAttr(e,t))},removeAttr:function(e,t){var i,n,s=0,o=t&&t.match(pt);if(o&&1===e.nodeType)for(;i=o[s++];)n=Q.propFix[i]||i,Q.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!Z.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),si={set:function(e,t,i){return t===!1?Q.removeAttr(e,i):e.setAttribute(i,i),i}},Q.each(Q.expr.match.bool.source.match(/\w+/g),function(e,t){var i=oi[t]||Q.find.attr;oi[t]=function(e,t,n){var s,o;return n||(o=oi[t],oi[t]=s,s=null!=i(e,t,n)?t.toLowerCase():null,oi[t]=o),s}});var ai=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(e,t){return mt(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Q.propFix[e]||e]})}}),Q.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var n,s,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return o=1!==a||!Q.isXMLDoc(e),o&&(t=Q.propFix[t]||t,s=Q.propHooks[t]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:e[t]=i:s&&"get"in s&&null!==(n=s.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||ai.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Z.optSelected||(Q.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Q.propFix[this.toLowerCase()]=this});var ri=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(e){var t,i,n,s,o,a,r="string"==typeof e&&e,l=0,h=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(r)for(t=(e||"").match(pt)||[];h>l;l++)if(i=this[l],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ri," "):" ")){for(o=0;s=t[o++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");a=Q.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(e){var t,i,n,s,o,a,r=0===arguments.length||"string"==typeof e&&e,l=0,h=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(r)for(t=(e||"").match(pt)||[];h>l;l++)if(i=this[l],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ri," "):"")){for(o=0;s=t[o++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");a=e?Q.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):this.each(Q.isFunction(e)?function(i){Q(this).toggleClass(e.call(this,i,this.className,t),t)}:function(){if("string"===i)for(var t,n=0,s=Q(this),o=e.match(pt)||[];t=o[n++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else(i===Tt||"boolean"===i)&&(this.className&&vt.set(this,"__className__",this.className),this.className=this.className||e===!1?"":vt.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(ri," ").indexOf(t)>=0)return!0;return!1}});var li=/\r/g;Q.fn.extend({val:function(e){var t,i,n,s=this[0];{if(arguments.length)return n=Q.isFunction(e),this.each(function(i){var s;1===this.nodeType&&(s=n?e.call(this,i,Q(this).val()):e,null==s?s="":"number"==typeof s?s+="":Q.isArray(s)&&(s=Q.map(s,function(e){return null==e?"":e+""})),t=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))});if(s)return t=Q.valHooks[s.type]||Q.valHooks[s.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(s,"value"))?i:(i=s.value,"string"==typeof i?i.replace(li,""):null==i?"":i)}}}),Q.extend({valHooks:{option:{get:function(e){var t=Q.find.attr(e,"value");return null!=t?t:Q.trim(Q.text(e))}},select:{get:function(e){for(var t,i,n=e.options,s=e.selectedIndex,o="select-one"===e.type||0>s,a=o?null:[],r=o?s+1:n.length,l=0>s?r:o?s:0;r>l;l++)if(i=n[l],!(!i.selected&&l!==s||(Z.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&Q.nodeName(i.parentNode,"optgroup"))){if(t=Q(i).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var i,n,s=e.options,o=Q.makeArray(t),a=s.length;a--;)n=s[a],(n.selected=Q.inArray(n.value,o)>=0)&&(i=!0);return i||(e.selectedIndex=-1),o}}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]={set:function(e,t){return Q.isArray(t)?e.checked=Q.inArray(Q(e).val(),t)>=0:void 0}},Z.checkOn||(Q.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),Q.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var hi=Q.now(),di=/\?/;Q.parseJSON=function(e){return JSON.parse(e+"")},Q.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,t=i.parseFromString(e,"text/xml")}catch(n){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Q.error("Invalid XML: "+e),t};var ci=/#.*$/,ui=/([?&])_=[^&]*/,pi=/^(.*?):[ \t]*([^\r\n]*)$/gm,fi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,gi=/^(?:GET|HEAD)$/,mi=/^\/\//,vi=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,bi={},yi={},wi="*/".concat("*"),_i=e.location.href,Ci=vi.exec(_i.toLowerCase())||[];Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_i,type:"GET",isLocal:fi.test(Ci[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?F(F(e,Q.ajaxSettings),t):F(Q.ajaxSettings,e)},ajaxPrefilter:R(bi),ajaxTransport:R(yi),ajax:function(e,t){function i(e,t,i,a){var l,d,v,b,w,C=t;2!==y&&(y=2,r&&clearTimeout(r),n=void 0,o=a||"",_.readyState=e>0?4:0,l=e>=200&&300>e||304===e,i&&(b=B(c,_,i)),b=O(c,b,_,l),l?(c.ifModified&&(w=_.getResponseHeader("Last-Modified"),w&&(Q.lastModified[s]=w),w=_.getResponseHeader("etag"),w&&(Q.etag[s]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,d=b.data,v=b.error,l=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),_.status=e,_.statusText=(t||C)+"",l?f.resolveWith(u,[d,C,_]):f.rejectWith(u,[_,C,v]),_.statusCode(m),m=void 0,h&&p.trigger(l?"ajaxSuccess":"ajaxError",[_,c,l?d:v]),g.fireWith(u,[_,C]),h&&(p.trigger("ajaxComplete",[_,c]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,s,o,a,r,l,h,d,c=Q.ajaxSetup({},t),u=c.context||c,p=c.context&&(u.nodeType||u.jquery)?Q(u):Q.event,f=Q.Deferred(),g=Q.Callbacks("once memory"),m=c.statusCode||{},v={},b={},y=0,w="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!a)for(a={};t=pi.exec(o);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?o:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return y||(e=b[i]=b[i]||e,v[e]=t),this},overrideMimeType:function(e){return y||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)m[t]=[m[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||w;return n&&n.abort(t),i(0,t),this}};if(f.promise(_).complete=g.add,_.success=_.done,_.error=_.fail,c.url=((e||c.url||_i)+"").replace(ci,"").replace(mi,Ci[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=Q.trim(c.dataType||"*").toLowerCase().match(pt)||[""],null==c.crossDomain&&(l=vi.exec(c.url.toLowerCase()),c.crossDomain=!(!l||l[1]===Ci[1]&&l[2]===Ci[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(Ci[3]||("http:"===Ci[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=Q.param(c.data,c.traditional)),N(bi,c,t,_),2===y)return _;h=Q.event&&c.global,h&&0===Q.active++&&Q.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!gi.test(c.type),s=c.url,c.hasContent||(c.data&&(s=c.url+=(di.test(s)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=ui.test(s)?s.replace(ui,"$1_="+hi++):s+(di.test(s)?"&":"?")+"_="+hi++)),c.ifModified&&(Q.lastModified[s]&&_.setRequestHeader("If-Modified-Since",Q.lastModified[s]),Q.etag[s]&&_.setRequestHeader("If-None-Match",Q.etag[s])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&_.setRequestHeader("Content-Type",c.contentType),_.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+wi+"; q=0.01":""):c.accepts["*"]);for(d in c.headers)_.setRequestHeader(d,c.headers[d]);if(c.beforeSend&&(c.beforeSend.call(u,_,c)===!1||2===y))return _.abort();w="abort";for(d in{success:1,error:1,complete:1})_[d](c[d]);if(n=N(yi,c,t,_)){_.readyState=1,h&&p.trigger("ajaxSend",[_,c]),c.async&&c.timeout>0&&(r=setTimeout(function(){_.abort("timeout")},c.timeout));try{y=1,n.send(v,i)}catch(C){if(!(2>y))throw C;i(-1,C)}}else i(-1,"No Transport");return _},getJSON:function(e,t,i){return Q.get(e,t,i,"json")},getScript:function(e,t){return Q.get(e,void 0,t,"script")}}),Q.each(["get","post"],function(e,t){Q[t]=function(e,i,n,s){return Q.isFunction(i)&&(s=s||n,n=i,i=void 0),Q.ajax({url:e,type:t,dataType:s,data:i,success:n})}}),Q._evalUrl=function(e){return Q.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Q.fn.extend({wrapAll:function(e){var t;return Q.isFunction(e)?this.each(function(t){Q(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Q(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(Q.isFunction(e)?function(t){Q(this).wrapInner(e.call(this,t))}:function(){var t=Q(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(i){Q(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()}}),Q.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)};var xi=/%20/g,Si=/\[\]$/,Ti=/\r?\n/g,Ai=/^(?:submit|button|image|reset|file)$/i,ki=/^(?:input|select|textarea|keygen)/i;Q.param=function(e,t){var i,n=[],s=function(e,t){t=Q.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(e)||e.jquery&&!Q.isPlainObject(e))Q.each(e,function(){s(this.name,this.value)});else for(i in e)z(i,e[i],t,s);return n.join("&").replace(xi,"+")},Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Q.prop(this,"elements");return e?Q.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Q(this).is(":disabled")&&ki.test(this.nodeName)&&!Ai.test(e)&&(this.checked||!St.test(e))}).map(function(e,t){var i=Q(this).val();return null==i?null:Q.isArray(i)?Q.map(i,function(e){return{name:t.name,value:e.replace(Ti,"\r\n")}}):{name:t.name,value:i.replace(Ti,"\r\n")}}).get()}}),Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var $i=0,Pi={},Di={0:200,1223:204},Ii=Q.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Pi)Pi[e]()}),Z.cors=!!Ii&&"withCredentials"in Ii,Z.ajax=Ii=!!Ii,Q.ajaxTransport(function(e){var t;return Z.cors||Ii&&!e.crossDomain?{send:function(i,n){var s,o=e.xhr(),a=++$i;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)o[s]=e.xhrFields[s];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)o.setRequestHeader(s,i[s]);t=function(e){return function(){t&&(delete Pi[a],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?n(o.status,o.statusText):n(Di[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=Pi[a]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(r){if(t)throw r
}},abort:function(){t&&t()}}:void 0}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Q.globalEval(e),e}}}),Q.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Q.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,s){t=Q("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&s("error"===e.type?404:200,e.type)}),J.head.appendChild(t[0])},abort:function(){i&&i()}}}});var Li=[],Ei=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Li.pop()||Q.expando+"_"+hi++;return this[e]=!0,e}}),Q.ajaxPrefilter("json jsonp",function(t,i,n){var s,o,a,r=t.jsonp!==!1&&(Ei.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ei.test(t.data)&&"data");return r||"jsonp"===t.dataTypes[0]?(s=t.jsonpCallback=Q.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(Ei,"$1"+s):t.jsonp!==!1&&(t.url+=(di.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return a||Q.error(s+" was not called"),a[0]},t.dataTypes[0]="json",o=e[s],e[s]=function(){a=arguments},n.always(function(){e[s]=o,t[s]&&(t.jsonpCallback=i.jsonpCallback,Li.push(s)),a&&Q.isFunction(o)&&o(a[0]),a=o=void 0}),"script"):void 0}),Q.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||J;var n=at.exec(e),s=!i&&[];return n?[t.createElement(n[1])]:(n=Q.buildFragment([e],t,s),s&&s.length&&Q(s).remove(),Q.merge([],n.childNodes))};var Mi=Q.fn.load;Q.fn.load=function(e,t,i){if("string"!=typeof e&&Mi)return Mi.apply(this,arguments);var n,s,o,a=this,r=e.indexOf(" ");return r>=0&&(n=Q.trim(e.slice(r)),e=e.slice(0,r)),Q.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(s="POST"),a.length>0&&Q.ajax({url:e,type:s,dataType:"html",data:t}).done(function(e){o=arguments,a.html(n?Q("<div>").append(Q.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){a.each(i,o||[e.responseText,t,e])}),this},Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Q.fn[t]=function(e){return this.on(t,e)}}),Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length};var Ri=e.document.documentElement;Q.offset={setOffset:function(e,t,i){var n,s,o,a,r,l,h,d=Q.css(e,"position"),c=Q(e),u={};"static"===d&&(e.style.position="relative"),r=c.offset(),o=Q.css(e,"top"),l=Q.css(e,"left"),h=("absolute"===d||"fixed"===d)&&(o+l).indexOf("auto")>-1,h?(n=c.position(),a=n.top,s=n.left):(a=parseFloat(o)||0,s=parseFloat(l)||0),Q.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(u.top=t.top-r.top+a),null!=t.left&&(u.left=t.left-r.left+s),"using"in t?t.using.call(e,u):c.css(u)}},Q.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var t,i,n=this[0],s={top:0,left:0},o=n&&n.ownerDocument;if(o)return t=o.documentElement,Q.contains(t,n)?(typeof n.getBoundingClientRect!==Tt&&(s=n.getBoundingClientRect()),i=j(o),{top:s.top+i.pageYOffset-t.clientTop,left:s.left+i.pageXOffset-t.clientLeft}):s},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===Q.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Q.nodeName(e[0],"html")||(n=e.offset()),n.top+=Q.css(e[0],"borderTopWidth",!0),n.left+=Q.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-Q.css(i,"marginTop",!0),left:t.left-n.left-Q.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Ri;e&&!Q.nodeName(e,"html")&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||Ri})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n="pageYOffset"===i;Q.fn[t]=function(s){return mt(this,function(t,s,o){var a=j(t);return void 0===o?a?a[i]:t[s]:void(a?a.scrollTo(n?e.pageXOffset:o,n?o:e.pageYOffset):t[s]=o)},t,s,arguments.length,null)}}),Q.each(["top","left"],function(e,t){Q.cssHooks[t]=C(Z.pixelPosition,function(e,i){return i?(i=_(e,t),Ht.test(i)?Q(e).position()[t]+"px":i):void 0})}),Q.each({Height:"height",Width:"width"},function(e,t){Q.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){Q.fn[n]=function(n,s){var o=arguments.length&&(i||"boolean"!=typeof n),a=i||(n===!0||s===!0?"margin":"border");return mt(this,function(t,i,n){var s;return Q.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===n?Q.css(t,i,a):Q.style(t,i,n,a)},t,o?n:void 0,o,null)}})}),Q.fn.size=function(){return this.length},Q.fn.andSelf=Q.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Q});var Ni=e.jQuery,Fi=e.$;return Q.noConflict=function(t){return e.$===Q&&(e.$=Fi),t&&e.jQuery===Q&&(e.jQuery=Ni),Q},typeof t===Tt&&(e.jQuery=e.$=Q),Q}),define("jquery_modern",function(){}),function(){var e=this,t=e._,i={},n=Array.prototype,s=Object.prototype,o=Function.prototype,a=n.push,r=n.slice,l=n.concat,h=s.toString,d=s.hasOwnProperty,c=n.forEach,u=n.map,p=n.reduce,f=n.reduceRight,g=n.filter,m=n.every,v=n.some,b=n.indexOf,y=n.lastIndexOf,w=Array.isArray,_=Object.keys,C=o.bind,x=function(e){return e instanceof x?e:this instanceof x?void(this._wrapped=e):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var S=x.each=x.forEach=function(e,t,n){if(null!=e)if(c&&e.forEach===c)e.forEach(t,n);else if(e.length===+e.length){for(var s=0,o=e.length;o>s;s++)if(t.call(n,e[s],s,e)===i)return}else for(var a in e)if(x.has(e,a)&&t.call(n,e[a],a,e)===i)return};x.map=x.collect=function(e,t,i){var n=[];return null==e?n:u&&e.map===u?e.map(t,i):(S(e,function(e,s,o){n[n.length]=t.call(i,e,s,o)}),n)};var T="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=x.bind(t,n)),s?e.reduce(t,i):e.reduce(t);if(S(e,function(e,o,a){s?i=t.call(n,i,e,o,a):(i=e,s=!0)}),!s)throw new TypeError(T);return i},x.reduceRight=x.foldr=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=x.bind(t,n)),s?e.reduceRight(t,i):e.reduceRight(t);var o=e.length;if(o!==+o){var a=x.keys(e);o=a.length}if(S(e,function(r,l,h){l=a?a[--o]:--o,s?i=t.call(n,i,e[l],l,h):(i=e[l],s=!0)}),!s)throw new TypeError(T);return i},x.find=x.detect=function(e,t,i){var n;return A(e,function(e,s,o){return t.call(i,e,s,o)?(n=e,!0):void 0}),n},x.filter=x.select=function(e,t,i){var n=[];return null==e?n:g&&e.filter===g?e.filter(t,i):(S(e,function(e,s,o){t.call(i,e,s,o)&&(n[n.length]=e)}),n)},x.reject=function(e,t,i){return x.filter(e,function(e,n,s){return!t.call(i,e,n,s)},i)},x.every=x.all=function(e,t,n){t||(t=x.identity);var s=!0;return null==e?s:m&&e.every===m?e.every(t,n):(S(e,function(e,o,a){return(s=s&&t.call(n,e,o,a))?void 0:i}),!!s)};var A=x.some=x.any=function(e,t,n){t||(t=x.identity);var s=!1;return null==e?s:v&&e.some===v?e.some(t,n):(S(e,function(e,o,a){return s||(s=t.call(n,e,o,a))?i:void 0}),!!s)};x.contains=x.include=function(e,t){return null==e?!1:b&&e.indexOf===b?-1!=e.indexOf(t):A(e,function(e){return e===t})},x.invoke=function(e,t){var i=r.call(arguments,2),n=x.isFunction(t);return x.map(e,function(e){return(n?t:e[t]).apply(e,i)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,i){return x.isEmpty(t)?i?null:[]:x[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var n={computed:-1/0,value:-1/0};return S(e,function(e,s,o){var a=t?t.call(i,e,s,o):e;a>=n.computed&&(n={value:e,computed:a})}),n.value},x.min=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return S(e,function(e,s,o){var a=t?t.call(i,e,s,o):e;a<n.computed&&(n={value:e,computed:a})}),n.value},x.shuffle=function(e){var t,i=0,n=[];return S(e,function(e){t=x.random(i++),n[i-1]=n[t],n[t]=e}),n};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,i){var n=k(t);return x.pluck(x.map(e,function(e,t,s){return{value:e,index:t,criteria:n.call(i,e,t,s)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index<t.index?-1:1}),"value")};var $=function(e,t,i,n){var s={},o=k(t||x.identity);return S(e,function(t,a){var r=o.call(i,t,a,e);n(s,r,t)}),s};x.groupBy=function(e,t,i){return $(e,t,i,function(e,t,i){(x.has(e,t)?e[t]:e[t]=[]).push(i)})},x.countBy=function(e,t,i){return $(e,t,i,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,i,n){i=null==i?x.identity:k(i);for(var s=i.call(n,t),o=0,a=e.length;a>o;){var r=o+a>>>1;i.call(n,e[r])<s?o=r+1:a=r}return o},x.toArray=function(e){return e?x.isArray(e)?r.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:r.call(e,0,t)},x.initial=function(e,t,i){return r.call(e,0,e.length-(null==t||i?1:t))},x.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:r.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,i){return r.call(e,null==t||i?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var P=function(e,t,i){return S(e,function(e){x.isArray(e)?t?a.apply(i,e):P(e,t,i):i.push(e)}),i};x.flatten=function(e,t){return P(e,t,[])},x.without=function(e){return x.difference(e,r.call(arguments,1))},x.uniq=x.unique=function(e,t,i,n){x.isFunction(t)&&(n=i,i=t,t=!1);var s=i?x.map(e,i,n):e,o=[],a=[];return S(s,function(i,n){(t?n&&a[a.length-1]===i:x.contains(a,i))||(a.push(i),o.push(e[n]))}),o},x.union=function(){return x.uniq(l.apply(n,arguments))},x.intersection=function(e){var t=r.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=l.apply(n,r.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=r.call(arguments),t=x.max(x.pluck(e,"length")),i=new Array(t),n=0;t>n;n++)i[n]=x.pluck(e,""+n);return i},x.object=function(e,t){if(null==e)return{};for(var i={},n=0,s=e.length;s>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},x.indexOf=function(e,t,i){if(null==e)return-1;var n=0,s=e.length;if(i){if("number"!=typeof i)return n=x.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,s+i):i}if(b&&e.indexOf===b)return e.indexOf(t,i);for(;s>n;n++)if(e[n]===t)return n;return-1},x.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(y&&e.lastIndexOf===y)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var s=n?i:e.length;s--;)if(e[s]===t)return s;return-1},x.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),s=0,o=new Array(n);n>s;)o[s++]=e,e+=i;return o},x.bind=function(e,t){if(e.bind===C&&C)return C.apply(e,r.call(arguments,1));var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}},x.partial=function(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}},x.bindAll=function(e){var t=r.call(arguments,1);return 0===t.length&&(t=x.functions(e)),S(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var i={};return t||(t=x.identity),function(){var n=t.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},x.delay=function(e,t){var i=r.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(r.call(arguments,1)))},x.throttle=function(e,t){var i,n,s,o,a=0,r=function(){a=new Date,s=null,o=e.apply(i,n)};return function(){var l=new Date,h=t-(l-a);return i=this,n=arguments,0>=h?(clearTimeout(s),s=null,a=l,o=e.apply(i,n)):s||(s=setTimeout(r,h)),o}},x.debounce=function(e,t,i){var n,s;return function(){var o=this,a=arguments,r=function(){n=null,i||(s=e.apply(o,a))},l=i&&!n;return clearTimeout(n),n=setTimeout(r,t),l&&(s=e.apply(o,a)),s}},x.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var i=[e];return a.apply(i,arguments),t.apply(this,i)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)x.has(e,i)&&(t[t.length]=i);return t},x.values=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push(e[i]);return t},x.pairs=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push([i,e[i]]);return t},x.invert=function(e){var t={};for(var i in e)x.has(e,i)&&(t[e[i]]=i);return t},x.functions=x.methods=function(e){var t=[];for(var i in e)x.isFunction(e[i])&&t.push(i);return t.sort()},x.extend=function(e){return S(r.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},x.pick=function(e){var t={},i=l.apply(n,r.call(arguments,1));return S(i,function(i){i in e&&(t[i]=e[i])}),t},x.omit=function(e){var t={},i=l.apply(n,r.call(arguments,1));for(var s in e)x.contains(i,s)||(t[s]=e[s]);return t},x.defaults=function(e){return S(r.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var D=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var s=h.call(e);if(s!=h.call(t))return!1;switch(s){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=i.length;o--;)if(i[o]==e)return n[o]==t;i.push(e),n.push(t);var a=0,r=!0;if("[object Array]"==s){if(a=e.length,r=a==t.length)for(;a--&&(r=D(e[a],t[a],i,n)););}else{var l=e.constructor,d=t.constructor;if(l!==d&&!(x.isFunction(l)&&l instanceof l&&x.isFunction(d)&&d instanceof d))return!1;for(var c in e)if(x.has(e,c)&&(a++,!(r=x.has(t,c)&&D(e[c],t[c],i,n))))break;if(r){for(c in t)if(x.has(t,c)&&!a--)break;r=!a}}return i.pop(),n.pop(),r};x.isEqual=function(e,t){return D(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!(!e||1!==e.nodeType)},x.isArray=w||function(e){return"[object Array]"==h.call(e)},x.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return h.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!(!e||!x.has(e,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==h.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return d.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,i){for(var n=Array(e),s=0;e>s;s++)n[s]=t.call(i,s);return n},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=x.invert(I.escape);var L={escape:new RegExp("["+x.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(I.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(L[e],function(t){return I[e][t]})}}),x.result=function(e,t){if(null==e)return null;var i=e[t];return x.isFunction(i)?i.call(e):i},x.mixin=function(e){S(x.functions(e),function(t){var i=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),F.call(this,i.apply(x,e))}})};var E=0;x.uniqueId=function(e){var t=++E+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,R={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,i){var n;i=x.defaults({},i,x.templateSettings);var s=new RegExp([(i.escape||M).source,(i.interpolate||M).source,(i.evaluate||M).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(s,function(t,i,n,s,r){return a+=e.slice(o,r).replace(N,function(e){return"\\"+R[e]}),i&&(a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(a+="';\n"+s+"\n__p+='"),o=r+t.length,t}),a+="';\n",i.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(i.variable||"obj","_",a)}catch(r){throw r.source=a,r}if(t)return n(t,x);var l=function(e){return n.call(this,e,x)};return l.source="function("+(i.variable||"obj")+"){\n"+a+"}",l},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];x.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],F.call(this,i)}}),S(["concat","join","slice"],function(e){var t=n[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(e,t){"undefined"!=typeof exports?t(e,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(i,n,s){e.Backbone=t(e,s,i,n)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender)}(this,function(e,t,i,n){var s=e.Backbone,o=[],a=o.push,r=o.slice,l=o.splice;t.VERSION="1.0.0",t.$=n,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var h=t.Events={on:function(e,t,i){if(!c(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,n){if(!c(this,"once",e,[t,n])||!t)return this;var s=this,o=i.once(function(){s.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,n)},off:function(e,t,n){var s,o,a,r,l,h,d,u;if(!this._events||!c(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(r=e?[e]:i.keys(this._events),l=0,h=r.length;h>l;l++)if(e=r[l],a=this._events[e]){if(this._events[e]=s=[],t||n)for(d=0,u=a.length;u>d;d++)o=a[d],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&s.push(o);s.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&u(i,t),n&&u(n,arguments),this},stopListening:function(e,t,i){var n=this._listeners;if(!n)return this;var s=!t&&!i;"object"==typeof t&&(i=this),e&&((n={})[e._listenerId]=e);for(var o in n)n[o].off(t,i,this),s&&delete this._listeners[o];return this}},d=/\s+/,c=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)e[t].apply(e,[s,i[s]].concat(n));return!1}if(d.test(i)){for(var o=i.split(d),a=0,r=o.length;r>a;a++)e[t].apply(e,[o[a]].concat(n));return!1}return!0},u=function(e,t){var i,n=-1,s=e.length,o=t[0],a=t[1],r=t[2];switch(t.length){case 0:for(;++n<s;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o);return;case 2:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o,a);return;case 3:for(;++n<s;)(i=e[n]).callback.call(i.ctx,o,a,r);return;default:for(;++n<s;)(i=e[n]).callback.apply(i.ctx,t)}},p={listenTo:"on",listenToOnce:"once"};i.each(p,function(e,t){h[t]=function(t,n,s){var o=this._listeners||(this._listeners={}),a=t._listenerId||(t._listenerId=i.uniqueId("l"));return o[a]=t,"object"==typeof n&&(s=this),t[e](n,s,this),this}}),h.bind=h.on,h.unbind=h.off,i.extend(t,h);var f=t.Model=function(e,t){var n,s=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(s=this.parse(s,t)||{}),(n=i.result(this,"defaults"))&&(s=i.defaults({},s,n)),this.set(s,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(f.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var s,o,a,r,l,h,d,c;if(null==e)return this;if("object"==typeof e?(o=e,n=t):(o={})[e]=t,n||(n={}),!this._validate(o,n))return!1;a=n.unset,l=n.silent,r=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=i.clone(this.attributes),this.changed={}),c=this.attributes,d=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(s in o)t=o[s],i.isEqual(c[s],t)||r.push(s),i.isEqual(d[s],t)?delete this.changed[s]:this.changed[s]=t,a?delete c[s]:c[s]=t;if(!l){r.length&&(this._pending=!0);for(var u=0,p=r.length;p>u;u++)this.trigger("change:"+r[u],this,c[r[u]],n)}if(h)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,n=!1,s=this._changing?this._previousAttributes:this.attributes;for(var o in e)i.isEqual(s[o],t=e[o])||((n||(n={}))[o]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(n&&n(t,i,e),void t.trigger("sync",t,i,e)):!1},k(this,e),this.sync("read",this,e)},save:function(e,t,n){var s,o,a,r=this.attributes;if(null==e||"object"==typeof e?(s=e,n=t):(s={})[e]=t,n=i.extend({validate:!0},n),s&&!n.wait){if(!this.set(s,n))return!1}else if(!this._validate(s,n))return!1;s&&n.wait&&(this.attributes=i.extend({},r,s)),void 0===n.parse&&(n.parse=!0);var l=this,h=n.success;return n.success=function(e){l.attributes=r;var t=l.parse(e,n);return n.wait&&(t=i.extend(s||{},t)),i.isObject(t)&&!l.set(t,n)?!1:(h&&h(l,e,n),void l.trigger("sync",l,e,n))},k(this,n),o=this.isNew()?"create":n.patch?"patch":"update","patch"===o&&(n.attrs=s),a=this.sync(o,this,n),s&&n.wait&&(this.attributes=r),a},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,s=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&s(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;k(this,e);var o=this.sync("delete",this,e);return e.wait||s(),o},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||A();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,i.extend(t||{},{validationError:n})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];i.each(g,function(e){f.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},b={add:!0,merge:!1,remove:!1};i.extend(m.prototype,h,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.defaults(t||{},b))},remove:function(e,t){e=i.isArray(e)?e.slice():[e],t||(t={});var n,s,o,a;for(n=0,s=e.length;s>n;n++)a=this.get(e[n]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,t.silent||(t.index=o,a.trigger("remove",a,this,t)),this._removeReference(a));return this},set:function(e,t){t=i.defaults(t||{},v),t.parse&&(e=this.parse(e,t)),i.isArray(e)||(e=e?[e]:[]);var n,s,o,r,h,d=t.at,c=this.comparator&&null==d&&t.sort!==!1,u=i.isString(this.comparator)?this.comparator:null,p=[],f=[],g={};for(n=0,s=e.length;s>n;n++)(o=this._prepareModel(e[n],t))&&((r=this.get(o))?(t.remove&&(g[r.cid]=!0),t.merge&&(r.set(o.attributes,t),c&&!h&&r.hasChanged(u)&&(h=!0))):t.add&&(p.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(t.remove){for(n=0,s=this.length;s>n;++n)g[(o=this.models[n]).cid]||f.push(o);f.length&&this.remove(f,t)}if(p.length&&(c&&(h=!0),this.length+=p.length,null!=d?l.apply(this.models,[d,0].concat(p)):a.apply(this.models,p)),h&&this.sort({silent:!0}),t.silent)return this;for(n=0,s=p.length;s>n;n++)(o=p[n]).trigger("add",o,this,t);return h&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,s=this.models.length;s>n;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,i.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,i.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return r.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var s=i.isFunction(t)?t:function(e){return e.get(t)};return i.sortedIndex(this.models,e,s,n)},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var s=e.reset?"reset":"set";n[s](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},k(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,s=t.success;return t.success=function(i){t.wait&&n.add(e,t),s&&s(e,i,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof f)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var i=new this.model(e,t);return i._validate(e,t)?i:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];i.each(y,function(e){m.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var w=["groupBy","countBy","sortBy"];i.each(w,function(e){m.prototype[e]=function(t,n){var s=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,s,n)}});var _=t.View=function(e){this.cid=i.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},C=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,h,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var s=t.match(C),o=s[1],a=s[2];n=i.bind(n,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,n):this.$el.on(o,a,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=i.extend({},i.result(this,"options"),e)),i.extend(this,i.pick(e,x)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,s){var o=S[e];i.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:o,dataType:"json"};if(s.url||(a.url=i.result(n,"url")||A()),null!=s.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(s.attrs||n.toJSON(s))),s.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),s.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",s.emulateJSON&&(a.data._method=o);
var r=s.beforeSend;s.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),r?r.apply(this,arguments):void 0}}"GET"===a.type||s.emulateJSON||(a.processData=!1),"PATCH"!==a.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=s.xhr=t.ajax(i.extend(a,s));return n.trigger("request",n,l,s),l};var S={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var T=function(e,t){var n,s=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,t);var o=function(){this.constructor=n};return o.prototype=s.prototype,n.prototype=new o,e&&i.extend(n.prototype,e),n.__super__=s.prototype,n};f.extend=m.extend=_.extend=T;var A=function(){throw new Error('A "url" property or function must be specified')},k=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t}),define("pubsub",["underscore","backbone"],function(e,t){"use strict";var i=e.extend({},t.Events);i.attach=function(t,i){e.each(t,e.bind(function(e,t){this.on(t,e,i)},this))},i.unattach=function(t,i){e.each(t,e.bind(function(e,t){this.off(t,e,i)},this))};var n=i.trigger;return i.trigger=function(e){try{n.apply(i,arguments)}catch(t){console.error('PubSub trigger "'+e+'" threw exception: ',t.stack||t.stacktrace||t.message)}return i},i}),define("managers/trafficcop",["jquery","underscore"],function(e,t){var i=function(){this.DEBUG=!0,this.defaultTimeout=2e3,this.minTimeout=500,this.activeRequests=[],this.activeAnimations=[],this.animationCompletion=null};return i.prototype={addRequest:function(i){var n={ajaxPromise:i,gate:e.Deferred(),result:null};this.activeRequests.push(n),i.always(t.bind(function(e){this.activeAnimations.length?n.result=e:("resolved"===i.state()?n.gate.resolve(e):n.gate.reject(e),this._cleanup())},this));var s=n.gate.promise();return s.original=i,s.abort=i.abort,s},addAnimation:function(i,n,s,o,a){if(!i||"pending"!==i.state())return i;this.animationCompletion||(this.animationCompletion=e.Deferred());var r=Math.max(2*a,this.minTimeout)||this.defaultTimeout,l=setTimeout(t.bind(function(){console.warn("ANIMATION did NOT resolve within "+r+" ms, releasing barrier "+this._getAnimationPropertyDescription(s,o),n),this._resolveAnimation(i)},this),r);return this.activeAnimations.push(i),i.always(t.bind(function(){clearTimeout(l),this._resolveAnimation(i)||console.warn("animation finished after being released "+this._getAnimationPropertyDescription(s,o),n)},this)),this.animationCompletion.promise()},getAnimationCompletion:function(){return this.animationCompletion?this.animationCompletion.promise():e.Deferred().resolve()},_getAnimationPropertyDescription:function(e,t){return e?"on property "+e+":"+t:"on unregistered element"},_resolveAnimation:function(t){var i=e.inArray(t,this.activeAnimations);return-1!==i?(this.activeAnimations.splice(i,1),0===this.activeAnimations.length&&this._openGate(),!0):!1},_openGate:function(){var e=this.animationCompletion;this.animationCompletion=null,t.each(this.activeRequests,function(e){var t=e.ajaxPromise.state();"resolved"===t?e.gate.resolve(e.result):"rejected"===t&&e.gate.reject(e.result)}),this._cleanup(),e.resolve()},_cleanup:function(){this.activeRequests=t.reject(this.activeRequests,function(e){return"pending"!==e.gate.state()})}},new i}),function(e){"use strict";"function"==typeof define&&define.amd?define("libs/css-transition-lib/css-transition-lib",["jquery"],function(t){return window.CSSAnimate=e(t),window.CSSAnimate}):window.CSSAnimate=e(window.jQuery||window.Zepto||window.$)}(function(e){"use strict";function t(e){var t,i=document.createElement("p").style,n=["ms","O","Moz","Webkit"];if(""===i[e])return e;for(e=e.charAt(0).toUpperCase()+e.slice(1),t=n.length;t--;)if(""===i[n[t]+e])return n[t]+e}function i(e){var t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};return t[e]}var n=function(e){this.transitionCssName=e,this.transitionEndName=i(e)};return n.prototype={animate:function(t,i,n,s,o,a){var r=this;return t=e(t),0===t.length?(console.error("tried animating null or empty jquery object"),e.Deferred().reject()):e.when.apply(e,e.map(t,function(t){return r.transitionCssName?r.cssTransition(e(t),i,n,s,o,a):r.jQuery(e(t),i,n,s,o,a)}))},cssTransition:function(t,i,n,s,o,a){var r;return"opacity"===i&&"none"===t.css("display")&&(s=0),this._isDocumentHidden()?(t.css(i,n),e.Deferred().resolve()):(0!==s&&40>s&&(s=40),o=this._normalizeEasing(o,this._easingMap),r=e.camelCase(i),n=this._getCssNumber(r,n),a=a?" "+a+"ms":"",this._transition(t,i,r,n,s,o,a))},jQuery:function(t,i,n,s,o,a){if(this._isDocumentHidden())return t.css(i,n),e.Deferred().resolve();var r={};return o=this._normalizeEasing(o,this._invert(this._easingMap)),r[i]=n,e.Deferred(function(e){var l="proganimate"+i;t.stop(l,!0),0===s?(t.css(i,n),setTimeout(function(){e.resolve()},1)):t.delay(a||0,l).animate(r,{duration:s,easing:o,queue:l,done:function(){t.css(i,n),e.resolve()},fail:function(){e.reject()}}).dequeue(l)}).promise()},stop:function(t,i){var n=e.camelCase(i),s=window.getComputedStyle(t[0]).getPropertyValue(i);return t.stop("proganimate"+i,!0),this._failPreviousTransition(t,n)&&(t[0].style[n]=s),s},_easingMap:{easeInQuad:"ease-in",easeInSine:"ease-in",easeInCubic:"ease-in",easeInQuart:"ease-in",easeInQuint:"ease-in",easeInExpo:"ease-in",easeInCirc:"ease-in",easeInBack:"ease-in",easeInElastic:"ease-in",easeInBounce:"ease-in",easeOutQuad:"ease-out",easeOutSine:"ease-out",easeOutCubic:"ease-out",easeOutQuart:"ease-out",easeOutQuint:"ease-out",easeOutExpo:"ease-out",easeOutCirc:"ease-out",easeOutBack:"ease-out",easeOutElastic:"ease-out",easeOutBounce:"ease-out",easeInOutQuad:"ease-in-out",easeInOutSine:"ease-in-out",easeInOutCubic:"ease-in-out",easeInOutQuart:"ease-in-out",easeInOutQuint:"ease-in-out",easeInOutExpo:"ease-in-out",easeInOutCirc:"ease-in-out",easeInOutBack:"ease-in-out",easeInOutElastic:"ease-in-out",easeInOutBounce:"ease-in-out",swing:"ease-in-out"},_normalizeEasing:function(e,t){var i;return e=e||"linear",i=t[e],i?e=i:-1===e.indexOf("cubic-bezier")||t.swing?this._invert(t)[e]||(e="linear"):e="swing",e},_transition:function(t,i,n,s,o,a,r){var l,h=e.Deferred(),d=this._getCurrentValue(t,n,i);return this._shouldDoTransition(t,n,i,d,s,o)?(l=i+" "+o+"ms "+a+" "+r,h=this._doTransition(t,n,i,s,l)):setTimeout(function(){h.resolve()},1),h.promise()},_doTransition:function(t,i,n,s,o){var a=t[0].style,r=this;return this._getAnimationDeferred(t,i,n,"2d",function(e){r._triggerTransition(e,t,i,n,s,o)}).then(function(){return s.replace(/[ ]+/g,"")===a[i].replace(/[ ]+/g,"")?e.Deferred().resolve():e.Deferred().reject()})},_getAnimationDeferred:function(t,i,n,s,o){var a=this;return e.Deferred(function(e){var r=a._failPreviousTransition(t,i,!0);setTimeout(function(){r&&r.cleanup(),"pending"===e.state()&&o(e)},20),t.data("transition-animate-"+i+"-defer",{promise:e,animationType:s,cleanup:function(){a._removeTransition(t[0].style,n)}})}).always(function(e){t.removeData("transition-animate-"+i+"-defer"),e||a._removeTransition(t[0].style,n)})},_removeTransition:function(t,i){var n=t[this.transitionCssName];n=n||"",n=n.replace(new RegExp(i+" \\w+ [\\w-]+(\\s*\\([^\\)]*\\))?"),""),t[this.transitionCssName]=e.trim(n.replace(/^[ ,]+/,"").replace(/[ ,]+$/,"").replace(/,[ ]+,/,""))},_triggerTransition:function(e,t,i,n,s,o){var a=t[0].style;this._registerTransitionEndListener(t,e,n),this._setupTransition(a,n,o),a[i]=s},_failPreviousTransition:function(e,t,i){var n=e.data("transition-animate-"+t+"-defer");return n?(n.promise.reject(i),n):void 0},_setupTransition:function(e,t,i){var n=e[this.transitionCssName];n?n+=","+i:n=i,e[this.transitionCssName]=n},_getCurrentValue:function(e,t,i){var n=e[0].style,s=n[t]||e.css(i);return"auto"!==s&&s||(n[t]=this._getCssNumber(t,0),s="0"),s},_shouldDoTransition:function(e,t,i,n,s,o){var a=e[0].style;return 0===o?(this._failPreviousTransition(e,t),a[t]=s,!1):this._canAnimate(n,s)?n:(this._failPreviousTransition(e,t),!1)},_canAnimate:function(e,t){return"0"===e.replace(/[ a-z%]+/g,"")&&"0"===t.replace(/[ a-z%]+/g,"")?!1:e.replace(/[ ]/g,"")!==t.replace(/[ ]/g,"")},_getCssNumber:function(t,i){return e.cssNumber[t]||!this._isNumber(i)&&i.match(/[a-z%]/)?i+"":i+"px"},_registerTransitionEndListener:function(t,i,n){if(this.transitionEndName){var s=t[0],o=this.transitionEndName,a=function(e){e.target!==s||n&&e.propertyName!==n||(this.removeEventListener(o,a),i.resolve(),a=null)};return s.addEventListener(o,a),i.promise()}return e.Deferred.reject()},_invert:function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t},_isNumber:function(e){return"[object Number]"===Object.prototype.toString.call(e)},_isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden}},new n(t("transition"))}),define("easing",["jquery"],function(e){e.easing.jswing=e.easing.swing,e.extend(e.easing,{def:"easeOutQuad",swing:function(t,i,n,s,o){return e.easing[e.easing.def](t,i,n,s,o)},easeInQuad:function(e,t,i,n,s){return n*(t/=s)*t+i},easeOutQuad:function(e,t,i,n,s){return-n*(t/=s)*(t-2)+i},easeInOutQuad:function(e,t,i,n,s){return(t/=s/2)<1?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,n,s){return n*(t/=s)*t*t+i},easeOutCubic:function(e,t,i,n,s){return n*((t=t/s-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,n,s){return(t/=s/2)<1?n/2*t*t*t+i:n/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,n,s){return n*(t/=s)*t*t*t+i},easeOutQuart:function(e,t,i,n,s){return-n*((t=t/s-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,n,s){return(t/=s/2)<1?n/2*t*t*t*t+i:-n/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,n,s){return n*(t/=s)*t*t*t*t+i},easeOutQuint:function(e,t,i,n,s){return n*((t=t/s-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,n,s){return(t/=s/2)<1?n/2*t*t*t*t*t+i:n/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,n,s){return-n*Math.cos(t/s*(Math.PI/2))+n+i},easeOutSine:function(e,t,i,n,s){return n*Math.sin(t/s*(Math.PI/2))+i},easeInOutSine:function(e,t,i,n,s){return-n/2*(Math.cos(Math.PI*t/s)-1)+i},easeInExpo:function(e,t,i,n,s){return 0==t?i:n*Math.pow(2,10*(t/s-1))+i},easeOutExpo:function(e,t,i,n,s){return t==s?i+n:n*(-Math.pow(2,-10*t/s)+1)+i},easeInOutExpo:function(e,t,i,n,s){return 0==t?i:t==s?i+n:(t/=s/2)<1?n/2*Math.pow(2,10*(t-1))+i:n/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(e,t,i,n,s){return-n*(Math.sqrt(1-(t/=s)*t)-1)+i},easeOutCirc:function(e,t,i,n,s){return n*Math.sqrt(1-(t=t/s-1)*t)+i},easeInOutCirc:function(e,t,i,n,s){return(t/=s/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+i:n/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,n,s){var o=1.70158,a=0,r=n;if(0==t)return i;if(1==(t/=s))return i+n;if(a||(a=.3*s),r<Math.abs(n)){r=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/r);return-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*s-o)*Math.PI/a))+i},easeOutElastic:function(e,t,i,n,s){var o=1.70158,a=0,r=n;if(0==t)return i;if(1==(t/=s))return i+n;if(a||(a=.3*s),r<Math.abs(n)){r=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/r);return r*Math.pow(2,-10*t)*Math.sin(2*(t*s-o)*Math.PI/a)+n+i},easeInOutElastic:function(e,t,i,n,s){var o=1.70158,a=0,r=n;if(0==t)return i;if(2==(t/=s/2))return i+n;if(a||(a=.3*s*1.5),r<Math.abs(n)){r=n;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(n/r);return 1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*s-o)*Math.PI/a)+i:r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*s-o)*Math.PI/a)*.5+n+i},easeInBack:function(e,t,i,n,s,o){return void 0==o&&(o=1.70158),n*(t/=s)*t*((o+1)*t-o)+i},easeOutBack:function(e,t,i,n,s,o){return void 0==o&&(o=1.70158),n*((t=t/s-1)*t*((o+1)*t+o)+1)+i},easeInOutBack:function(e,t,i,n,s,o){return void 0==o&&(o=1.70158),(t/=s/2)<1?n/2*t*t*(((o*=1.525)+1)*t-o)+i:n/2*((t-=2)*t*(((o*=1.525)+1)*t+o)+2)+i},easeInBounce:function(t,i,n,s,o){return s-e.easing.easeOutBounce(t,o-i,0,s,o)+n},easeOutBounce:function(e,t,i,n,s){return(t/=s)<1/2.75?7.5625*n*t*t+i:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+i:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+i:n*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(t,i,n,s,o){return o/2>i?.5*e.easing.easeInBounce(t,2*i,0,s,o)+n:.5*e.easing.easeOutBounce(t,2*i-o,0,s,o)+.5*s+n}})}),define("transformSupport",["jquery"],function(e){e.support.css=e.support.css||{},Modernizr.csstransitions&&(e.support.css.transition={cssName:Modernizr.prefixed("transition"),endEventNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}},e.support.css.transition.endName=e.support.css.transition.endEventNames[e.support.css.transition.cssName],e.support.css.transition.registerTransitionEndListener=function(t,i,n){i||(i=e.Deferred());var s=e.support.css.transition.endName,o=function(e){e.target!=t||n&&e.propertyName!==n||(this.removeEventListener(s,o),i.resolve(),o=null)};return t.addEventListener(s,o),i.promise()}),!Modernizr.csstransforms3d||navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/5")||(e.support.css.transform={cssName:Modernizr.prefixed("transform"),originCssName:Modernizr.prefixed("transformOrigin"),styleCssName:Modernizr.prefixed("transformStyle"),backfaceVisibilityCssName:Modernizr.prefixed("backfaceVisibility"),perspectiveCssName:Modernizr.prefixed("perspective"),perspectiveOriginCssName:Modernizr.prefixed("perspectiveOrigin")},e.support.css.transform.cssHyphenName=e.support.css.transform.cssName.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-"))}),define("baseview",["jquery","underscore","backbone","pubsub","managers/trafficcop","libs/css-transition-lib/css-transition-lib","easing","transformSupport"],function(e,t,i,n,s,o){"use strict";var a=i.View.extend({useCSSTransitions:!!e.support.css.transition,transitionCssName:e.support.css.transition&&e.support.css.transition.cssName,isSafari6:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/6"),isApple:navigator.userAgent.indexOf("iPhone")>-1||navigator.userAgent.indexOf("iPad")>-1,pubSub:null,options:{animations:{fadeIn:{duration:200,easing:"easeInQuad"},fadeOut:{duration:200,easing:"easeOutSine"},useCSSTransitions:!0}},initialize:function(t){this.options=e.extend(!0,{},a.prototype.options,t),this.useCSSTransitions=this.options.animations.useCSSTransitions&&this.useCSSTransitions,this.seenModules={},this.subviews=this.subviews||{},this.clear$$(),this.pubSub&&n.attach(this.pubSub,this)},$$:function(e){var t=this.cachedSelectors[e];return t||(t=this.$(e),this.cachedSelectors[e]=t),t},clear$$:function(e){e?delete this.cachedSelectors[e]:this.cachedSelectors={}},setElement:function(){this.clear$$(),i.View.prototype.setElement.apply(this,arguments)},destroy:function(e,t){this.destroyed=!0,this.destroyModules(e,t),this.clear$$(),this.pubSub&&n.unattach(this.pubSub,this),e&&this.$el.remove()},destroyModules:function(e,t){this._callCollection(this.subviews,"destroy",[e,t]),this.undelegateEvents(),this.subviews={}},triggerEvent:function(e,t){t=Array.prototype.slice.call(arguments,1),this._callCollection(this.subviews,e,t)},_callCollection:function(i,n,s){t.each(i,function(i){try{e.isArray(i)?t.each(i,function(t){e.isFunction(t[n])&&t[n].apply(t,s)}):i&&e.isFunction(i[n])&&i[n].apply(i,s)}catch(o){console.error("subview threw exception on destruction: ",o.stack||o.stacktrace||o.message)}})},registerAnimation:function(e,t,i,n,o){return s.addAnimation(e,t,i,n,o)},animate:function(i,n,a,r,l,h){return i&&0!==i.length?(this.isSafari6&&"opacity"===n&&(r=0),e.when.apply(e,t.map(i,t.bind(function(t){var i;return i=this.useCSSTransitions?o.cssTransition(e(t),n,a,r,l,h):o.jQuery(e(t),n,a,r,l,h),s.addAnimation(i,t,a,r),i},this)))):(console.error("tried animating null or empty jquery object"),e.Deferred().reject())},stopAnimate:function(i,n){t.each(i,function(t){o.stop(e(t),n)})},show:function(i,n){var s,o=this.options.animations.fadeIn;return i&&!this.isSafari6?(s=this.$el.fadeTo(o.duration,1,o.easing).promise(),this.registerAnimation(s,this.$el,"opacity",1)):(s=e.Deferred(),t.defer(function(){s.resolve()}),this.$el.css({display:"block",opacity:1})),s.done(function(){n&&n()}),s},hide:function(i,n){var s,o=this.options.animations.fadeOut;return i&&!this.isSafari6?(s=this.$el.fadeTo(o.duration,0,o.easing).promise(),s.done(t.bind(function(){this.$el.css({display:"none"})},this)),this.registerAnimation(s,this.$el,"opacity",0,o.duration)):(s=e.Deferred().resolve(),this.$el.css({display:"none",opacity:0})),s.done(function(){n&&n()}),s},setupSub:function(e,t,i,n){n=n||{};var s=this.subviews[e];s||(this.subviews[e]=s=[]),this.$(t).each(function(e,t){n.el=t,s.push(new i(n))})}});return a}),define("utils",["jquery","underscore"],function(e,t){"use strict";var i=function(){this.storage={},this.set("DEBUG",!0),this.set("document",e(document)),this.set("win",e(window)),this.set("body",e("body")),this.set("scrollEl",e("html,body")),this.set("doc",e(document))};return i.prototype={set:function(e,t){this.storage[e]=t},get:function(e){return this.storage[e]},getPageUrl:function(){return this.getOrigin()+window.location.pathname},getOrigin:function(){return window.location.protocol+"//"+window.location.host},getScrollPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},_loadedScripts:{},loadScript:function(e,t,i){return this._loadedScripts[t]=this._loadedScripts[t]||this._requireScript(e,t),this._loadedScripts[t].done(i)},_requireScript:function(t,i){return e.Deferred(function(e){require([t],function(){var n=window[i];n?e.resolve(n):e.reject("Missing symbol: "+i+" from script: "+t)},e.reject)}).fail(function(e){console.error(e)})},openPopup:function(e,t,i){t=t||600,i=i||400;var n=this.popupCoords(t,i);window.open(e,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height="+i+",width="+t+",top="+n.top+",left="+n.left)},isValidUrl:function(e){if(!e)return!1;if(-1!==e.indexOf("mailto:"))return!0;if(-1!==e.indexOf("javascript:"))return!1;if("#"===e[0]){if(1===e.length)return!1}else if(-1!==e.indexOf("../")||"/"!==e[0]&&-1===e.indexOf("://"))return console.error("Attempting to load a relative url, bad code monkey! ("+e+")"),!1;return!0},getNested:function(e,i){return e?(i=Array.prototype.slice.call(arguments,1),t.reduce(i,function(e,t){return e&&e[t]},e)):void 0},getSiteSections:function(){var e=this.getNested(window.site_vars,"sections")||"";return e?e.split("|"):[]},popupCoords:function(e,t){var i=window.screenLeft?window.screenLeft:window.screenX,n=window.screenTop?window.screenTop:window.screenY,s=window.outerWidth?window.outerWidth:document.documentElement.clientWidth,o=window.outerHeight?window.outerHeight:document.documentElement.clientHeight;return{left:i+s/2-e/2,top:n+o/2-t/2-25}},addCommas:function(e){e+="";for(var t=e.split("."),i=t[0],n=t.length>1?"."+t[1]:"",s=/(\d+)(\d{3})/;s.test(i);)i=i.replace(s,"$1,$2");return i+n},lazyLoadImage:function(i,n,s,o,a){var r=!1;return n=n||"data-src",i.each(t.bind(function(t,i){var l=e(i),h=l.attr(n),d=l.attr("src");h&&d!==h&&(this._attachHandler("error",l,o),a&&this._attachHandler("load",l,a),l.attr("src",h),s||l.removeAttr(n),r=!0)},this)),r},_attachHandler:function(e,t,i){var n=function(){t.off(e,n),"error"===e&&t.hide(),i&&i(t)};t.on(e,n)},getSectionPath:function(e){if(e&&(e=this._stripQueryParams(e)),e&&"/"!==e){"/"===e[0]&&(e=e.substring(1));var t=e.indexOf("/");return-1===t?e:e.substring(0,t)}return"home"},getSubSection:function(e){if(e){e=this._stripQueryParams(e),"/"!==e[e.length-1]&&(e+="/");var t=e.indexOf("/",1),i=e.indexOf("/",t+1);if(-1!==t&&-1!==i)return e.substring(t+1,i)}return""},_stripQueryParams:function(e){var t=e.indexOf("?");return-1!==t&&(e=e.substring(0,t)),e},lazyLoadError:function(t){e(this).hide(),t&&t(e(this))},requireSingleUseScript:function(i){return e.Deferred(function(e){require([i],function(t){e.resolveWith(this,[t])},function(t){console.error("failed loading scripts",t),e.reject(t)})}).always(t.bind(function(){this.removeRequireModule(i)},this)).promise()},removeRequireModule:function(t){require.undef(t),e('script[data-requiremodule="'+t+'"]').remove()},getUrlParam:function(e){var t=decodeURI((new RegExp(e+"=(.+?)(&|$)").exec(window.location.search)||[0,!1])[1]);return"false"===t?!1:"true"===t?!0:t},getSessionData:function(e,t){var i=sessionStorage[e];return i&&JSON.parse(i)||t},setSessionData:function(e,i){t.isString(i)||(i=JSON.stringify(i)),sessionStorage.setItem(e,i)},clearSessionData:function(e){sessionStorage.removeItem(e)},isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden},smartTruncate:function(e,t,i){if(e&&t){if(e.length<=t)return e;i=i||"&hellip;";var n=e.lastIndexOf(" ",t-1),s=n>0?n:t;return e.substr(0,s)+i}}},new i}),define("modules/global/alert",["jquery","underscore","pubsub"],function(e,t,i){var n=function(){};return n.prototype={render:function(){this.$alert||(this.$alert=e('<div class="ui-alert"><span class="text"></span><span class="close-btn">Close</span></div>').appendTo(e("body")),this.$alertText=this.$alert.find(".text"),this.$alert.on("click",".close-btn",t.bind(function(){this.hide()},this)))},show:function(e){this.render(),i.trigger("show:alert"),this.$alertText.html(e),this.$alert.addClass("active").removeClass("error")},hide:function(){i.trigger("hide:alert"),this.$alert.removeClass("active error")},showError:function(e){this.render(),i.trigger("show:error:alert"),this.$alertText.html(e),this.$alert.addClass("active error")}},new n}),define("managers/requestmanager",["jquery","underscore","managers/trafficcop","utils"],function(e,t,i,n){var s=function(){this.DEBUG=!0,this.xhrList=[],this.intervalList=[]};return e(document).ajaxSend(function(t,i,n){"post"===n.method&&i.setRequestHeader("X-CSRFToken",e.cookie("csrftoken"))}),s.prototype={timeout:3e4,fetchHtml:function(e,t,i,n){return this.fetchData(e,t,i,n,!0)},recurringFetchHtml:function(e,t,i,n,s){return this.recurringFetchData(e,t,i,n,s,!0)},recurringFetchData:function(e,i,n,s,o,a){var r=t.bind(function(){this.fetchData(e,i,!1,o,a).done(function(e){s(e)})},this);r();var l=setInterval(r,n);return this.intervalList.push(l),l},fetchData:function(i,n,s,o,a){n=this._setupRequest(i,n,o);var r=e.Deferred();this._startRequest(r,n,s,a);var l=r.promise();return l.abort=t.bind(function(){r.reject()},this),l},_setupRequest:function(t,i,n){var s={};return n&&(s["X-PJAX"]="true",s["X-PJAX-Container"]="#overlay"),t?0!==t.indexOf("/")&&0!==t.indexOf("http")&&(t="/"+t):t="/",i=e.extend({url:t,data:{ajax:!0},beforeSend:function(t){e.each(s,function(e,i){t.setRequestHeader(e,i)})},timeout:this.timeout},i)},_startRequest:function(t,n,s,o,a){var r=this._initializeFetchData(n.url,s);if(!r)return void t.reject();var l=e.ajax(n);this.DEBUG&&l.fail(function(e){e.statusText&&"abort"!==e.statusText&&console.log("fetchData Error: ",e.statusText,n)}),t.fail(function(){"pending"===l.state()&&l.abort()}),l=i.addRequest(l),this._registerNavRequests(l,t,n.url,s),s?this._resolveNavAjax(l,t,n,s,o,a):this._resolveAjax(l,t,o)},_refreshPage:function(){window.location=window.location},_resolveNavAjax:function(e,i,n,o,a,r){e.done(t.bind(function(){var t=e.original.getResponseHeader("X-Firefly-Session-Needed"),s=e.original.getResponseHeader("X-Gannett-Site-Version");t?this._handleFireflyAuth(t,i,n,o,a,r):s&&window.site_static_version!==s?this._refreshPage():this._resolveAjax(e,i,a)},this)).fail(function(){s.prototype._resolveAjax(e,i,a)})},_handleFireflyAuth:function(e,i,n,s,o,a){if(a)console.error("Auth failed, X-Firefly-Session-Needed appeared on refetch"),i.reject("NOT AUTHORIZED");else{console.log("Requesting FIREFLY Auth");var r=this._getFireflyAuth(e).done(t.bind(function(){console.log("FIREFLY Auth Successful, requesting original asset"),this._startRequest(i,n,s,o,!0)},this)).fail(function(e,t){i.reject(e,t)});i.fail(function(){r.reject()})}},_resolveAjax:function(e,t,i){e.done(function(n){i&&(n=s.prototype._toHtml(n)),t.resolveWith(e,[n])}).fail(function(i){t.rejectWith(e,[i])})},_toHtml:function(t){var i=document.createDocumentFragment(),n=document.createElement("div");return n.innerHTML=t,i.appendChild(n),e(i).children().children()},_getFireflyAuth:function(i){var s,o=Math.floor(1e3*Math.random()),a=this._createFireflyiFrame(i);return e.Deferred(t.bind(function(t){s=setTimeout(function(){console.error("Auth timeout occurred"),t.reject("NOT AUTHORIZED","Request Timed Out")},this.timeout),e(window).on("message.rqman"+o,function(e){if(e=e.originalEvent,e.origin===n.getOrigin())try{var i=JSON.parse(e.data);if("firefly-auth"!==i.type)return;if("success"===i.auth)return void t.resolve(i);t.reject("NOT AUTHORIZED",i)}catch(s){}})},this)).always(function(){clearTimeout(s),e(window).off(".rqman"+o),document.body.removeChild(a)})},_createFireflyiFrame:function(e){var i=document.createElement("iframe");return i.id=i.name=t.uniqueId("firefly_auth_"),i.className="hidden",i.src=e,document.body.appendChild(i),i},_registerNavRequests:function(e,i,n,s){var o={ajaxPromise:e,resultDeferred:i,url:n,isNav:s};this.xhrList.push(o),e.always(t.bind(function(){this.xhrList=t.without(this.xhrList,o)},this))},_initializeFetchData:function(e,t){var i=1==this.xhrList.length&&this.xhrList[0],n=i&&i.isNav;if(t){if(n&&i.url===e)return!1;this.abortAllRequests()}else if(n)return!1;return!0},abortAllRequests:function(){t.each(this.xhrList,function(e){e.ajaxPromise.abort(),e.resultDeferred.reject()}),t.each(this.intervalList,function(e){clearInterval(e)}),this.xhrList=[],this.intervalList=[]},done:function(){return e.when(this.xhrList)}},new s}),define("mergedSiteConfig",[],function(){return{require:{paths:{chosen:"libs/jquery/plugins/chosen.jquery.min",touchswipe:"libs/jquery/plugins/jquery.touchSwipe"},shim:{"libs/flot/jquery.flot.usat.pie":["libs/flot/jquery.flot"],"libs/flot/jquery.flot.multibars":["libs/flot/jquery.flot"],touchswipe:["jquery"],chosen:["jquery"],"libs/flot/jquery.flot.orderBars":["libs/flot/jquery.flot"],"libs/flot/jquery.flot.usat.style":["libs/flot/jquery.flot"],"libs/flot/jquery.flot":["jquery","libs/flot/excanvas"]}},global:{modules:["modules/global/header","analytics/settealium"],pubSub:{openFullScreenCarousel:["modules/carousel/carousel-fullscreen"]}},apps:{"contact-us-staff":{path:"apps/contact-us-staff",css:"apps/contact-us-staff"},Interactives:{path:"apps/interactives",selector:"#interactive"},"member-guide-apps":{path:"apps/member-guide-apps",css:"apps/member-guide"},Overlay:{path:"apps/simple-overlay",css:["story-article","story-grid","story-navbar","blog-story-article","stories/sponsored-series","stories/story-right-rail"],overlay:!0},"Overlay-with-footer":{path:"apps/simple-overlay",init_modules:[{name:"footer"}],overlay:!0},BaseApp:{path:"base-app"},Users:{path:"base-app",selector:".something"},"member-guide-social":{path:"apps/member-guide-social",css:"apps/member-guide"},MediaView:{path:"apps/media",css:"media-view",header:{fixed:!0,open:!1}},Search:{path:"apps/search",css:"modules/search",header:{fixed:!0,open:!0}},StaffCMS:{path:"base-app",init_modules:[{name:"staff-listing"}],css:["pages/staff-listing"]},BigPage:{path:"apps/bigpage",css:"bigpage",header:{fixed:!0,open:!1}},Error:{path:"apps/404",css:"404",overlay:!0},Cards:{path:"apps/cards/cards",init_modules:[{name:"footer"},{name:"sidebar"},{name:"taboola-recommendations"}],css:["cards","sidebar"]},"Overlay-with-arrows":{path:"apps/overlay/overlay",init_modules:[{name:"utility-bar"},{name:"recommended-flyout"}],overlay:!0},StaffBio:{path:"apps/stag-front",init_modules:[{name:"footer"},{name:"headline-grid"}],css:["pages/staff"]},"Interactive-Overlay":{path:"apps/overlay/overlay",selector:"#interactive",overlay:!0},Topics:{path:"apps/topics",init_modules:[{name:"footer"}],css:["stag","apps/topics/topics-page-automated"]},ElectionsCard:{path:"apps/cards/elections-card",init_modules:[{name:"footer"}],css:["cards","sidebar"]},longform:{path:"base-app",css:"longform/longform-article",header:{fixed:!0,open:!1}},"member-guide":{path:"apps/member-guide",css:"apps/member-guide"},"Overlay-with-utility-bar":{path:"apps/simple-overlay",init_modules:[{name:"utility-bar"}],css:["utility-bar"],overlay:!0}},version:2,pages:[{init_modules:[{name:"taboola-recommendations"}],name:"Video Asset",urls:["^videos/.*/$"],appName:"Overlay-with-arrows"},{path:"apps/overlay/pages/story-overlay",init_modules:[{name:"iframe-auto-height"},{name:"taboola-recommendations"},{name:"myCapture"}],name:"Story",urls:["^((story|article)/.*/)$"],appName:"Overlay-with-arrows"},{path:"modules/longform/longform",init_modules:[{name:"longform-navigation"},{name:"longform-share"},{name:"longform-nav-rail-bucket"},{name:"longform-arrow"},{name:"longform-poster-ad-bottom"},{name:"longform-fullsize-gallery"}],name:"Longform",urls:["^(wide-story/.*)$","^(longform/.*)$"],appName:"longform"},{path:"apps/overlay/pages/interactive-overlay",name:"Interactive Overlay",urls:["^interactive/.+/\\d{4}/\\d{2}/\\d{2}/([^/]*/)?(\\d{1,32})/$"],appName:"Interactive-Overlay"},{path:"apps/overlay/pages/interactive-overlay",name:"Interactive",urls:["^interactive/\\d{1,32}/(embed/)?$"],appName:"Interactives"},{name:"Default",urls:["^(search/.*)$"],appName:"Search"},{name:"Sports Employee Directory",urls:["^(staff/listing/.*)$","^(staff/record/.*)$"],appName:"StaffCMS"},{name:"Default",urls:["^(staff/.*)$"],appName:"StaffBio"},{name:"Default",urls:["^(topic/.*)$"],appName:"Topics"},{name:"Default",urls:["^(media/.*)$"],appName:"MediaView"},{name:"Default",urls:["^(big-page/.*)$"],appName:"BigPage"},{name:"Text Alerts",appName:"Overlay",urls:["^(textalerts/[a-zA-Z0-9%\\-/\\.]*)$"],path:"apps/overlay/pages/textalerts-overlay",init_modules:[{name:"footer"}],css:["textalerts"]},{name:"Closings",appName:"Overlay",urls:["^(closings/)$"],path:"apps/overlay/pages/closings-overlay",init_modules:[{name:"footer"}],css:["closings","closings-default"]},{name:"Closings Signup",appName:"Overlay",urls:["^(closings/signup/)$"],path:"apps/overlay/pages/closings-signup-overlay",init_modules:[{name:"footer"}],css:["closings","closings-text-alerts"]},{name:"Closings Edit",appName:"Overlay",urls:["^(closings/edit/)$"],path:"apps/overlay/pages/closings-edit-overlay",init_modules:[{name:"footer"}],css:["closings","closings-text-alerts"]},{name:"Weather Alerts",appName:"Overlay",urls:["^(weatheralerts/[a-zA-Z0-9%\\-/\\.]*)$"],path:"apps/overlay/pages/weatheralerts-overlay",init_modules:[{name:"footer"}],css:["weatheralerts"]},{name:"Weather Cameras",appName:"Overlay",urls:["^(weathercams/.*)$"],path:"apps/overlay/pages/weathercams-overlay",init_modules:[{name:"footer"}],css:["weathercams"]},{name:"Detailed Forecast",appName:"Overlay",urls:["^(weather/forecasts/[a-z_A-Z0-9%\\-/\\.]*)$"],path:"apps/overlay/pages/forecast-overlay",init_modules:[{name:"footer"}],css:["forecast"]},{name:"Detailed Health",appName:"Overlay",urls:["^(weather/health/[a-z_A-Z0-9%\\-/\\.]*)$"],path:"apps/overlay/pages/health-overlay",init_modules:[{name:"footer"}],css:["health"]},{path:"apps/cards/pages/weather-card",name:"Weather",urls:["^(weather/.*)$"],appName:"Cards"},{name:"Golf Leaderboard",appName:"Cards",urls:["^(sports/golf/leaderboard/.*)$"],path:"apps/cards/pages/sports-card",init_modules:[{name:"sports-jumptotop"}],css:["sports"]},{path:"modules/polldaddy-poll",urls:["^(polls/.*)$"],name:"Poll",css:["polldaddy"],appName:"Overlay-with-utility-bar"},{header:{fixed:!0,open:!1},urls:["^(memberguide/social/?)$"],name:"Member Guide Social",viewport:"width=device-width, initial-scale=1.0",appName:"member-guide-social"},{header:{fixed:!0,open:!1},urls:["^(memberguide/apps/?)$"],name:"Member Guide Apps",viewport:"width=device-width, initial-scale=1.0",appName:"member-guide-apps"},{header:{fixed:!0,open:!1},urls:["^(memberguide/.*)$"],name:"Member Guide",viewport:"width=device-width, initial-scale=1.0",appName:"member-guide"},{urls:["^(contact/staff/?)$"],name:"Contact Us Staff",viewport:"width=device-width, initial-scale=1.0",appName:"contact-us-staff"},{name:"CatchAll",urls:["^(errors/.*)$","^(404.html)$"],appName:"Error"},{init_modules:[{name:"taboola-recommendations"}],name:"Photo Asset",urls:["^((photos|picture-gallery)/.*/)$"],appName:"Overlay-with-arrows"},{css:["users"],name:"Profile Page",urls:["^(profile/[0-9]+/)$"],appName:"Users"},{css:["firefly"],name:"Not Authorized",urls:["^get-access/","^restricted/"],appName:"Overlay"},{name:"Generic Section",urls:["^({{sections}})$","^({{sections}})/.*$","^$","^index.html$","^section/[a-zA-Z0-9%_\\-/\\.]*$"],appName:"Cards"},{name:"Static Page",appName:"Overlay-with-utility-bar",header:{fixed:!0,open:!1},ajax:!1,urls:["^pages/.*$"],path:"pages/static_page"},{path:"apps/cards/pages/elections-card",urls:["^(elections/.*)$"],name:"Election",css:["elections"],appName:"ElectionsCard"},{path:"apps/overlay/pages/contact-us-overlay",init_modules:[{name:"static-story-expand-faq"},{name:"footer"}],name:"ContactUs",urls:["^(contactus.*)$"],appName:"Overlay"},{init_modules:[{name:"static-story-expand-faq"},{name:"footer"}],name:"StaticContent",urls:["^(conversation-guidelines.*|advertisewithus.*|rss.*|10News2.*|closedcaptioning.*|communityrules.*|connectwithus.*|contactus.*|faq.*|gasprices.*|intern.*|privacy.*|programming.*|publicfile.*|terms.*|requestemail.*|nbcplayer.*|legal.*|feedback.*|editorial-policy.*)$"],appName:"Overlay"},{init_modules:[{name:"realmen"},{name:"footer"}],name:"RealMen",urls:["^(realmen.*)$"],appName:"Overlay"}],siteModules:{"weather-headlines":{},"sponsor-story-topbar":{},"story-headline":{},"interactive-poll":{path:"modules/interactive-poll",selector:".interactive-poll"},"site-nav-firefly-module":{path:"modules/users/site-nav-firefly-module",selector:".site-nav-firefly-module"},"home-finder-ads":{path:"modules/home-finder/home-ads"},"leaderboard-ad":{path:"modules/partner/leaderboard-ad",selector:".leaderboard-ad"},quicklinks:{},"election-inline":{path:"modules/elections/election-inline",selector:".election-inline"},"topics-videos":{path:"modules/topics/topics-videos"},"right-now-weather":{path:"modules/right-now-weather/right-now-weather"},"sidebar-poster-ad":{path:"modules/fronts/sidebar-poster-ad",selector:".partner-sidebar-ad"},"blog-promo":{path:"modules/fronts/blog-promo"},"cxense-recommends":{path:"modules/cxense-recommends/cxense-recommends"},"rentals-apartments-ad":{path:"modules/rentals-apartments-ad"},"expandable-photo":{path:"modules/stories/expandable-photo"},"top-stories":{},"ggm-classifieds-search":{},"home-finder-featured":{path:"modules/home-finder/home-carousel"},"dynamic-video-playlist":{path:"modules/videos/video-gallery",selector:".video-gallery"},"headline-list":{},"longform-inline-share":{path:"modules/longform/longform-inline-share"},"weather-twentyfour-hour":{path:"modules/weather/weather-twentyfour-hour"},"wsi-defcon-map":{path:"modules/wsi-defcon-map/wsi-defcon-map"},"more-blogs":{},interactive_beforeandafter:{path:"modules/interactives/before-after",selector:".interactive.before-after"},"assigned-content-nav":{path:"modules/fronts/assigned-content-nav"},"section-header-blog":{},"weather-interactive-map":{path:"modules/weather/weather-interactive-map"},"longform-footer-copyright":{},"blogs-index-latest-hero":{},"utility-bar-module-firefly":{path:"modules/stories/utility-bar-module-firefly",selector:".util-bar-module-firefly"},"assigned-content":{path:"modules/stories/assigned-content"},"weather-search-bar":{},"rentalslite-search":{path:"modules/rentalslite-search"},"site-nav-weather-icon-module":{},"featured-content-with-datasphere":{path:"modules/datasphere-community/datasphere-community"},"weather-twitter":{path:"modules/weather/weather-twitter"},"ggm-jobs-search":{path:"modules/ggm-jobs-search/ggm-jobs-search"},"static-story-expand-faq":{path:"modules/stories/expand-faq",selector:".static-page-faq"},"section-header-nation-now":{},"broadcast-video-carousel-player":{path:"modules/broadcast-video-carousel-player/broadcast-video-carousel-player"},"sponsored-series-topbar":{path:"modules/stories/sponsored-series-topbar",selector:".sponsored-series-bar"},"topics-related-tags":{},"headline-list-blog":{path:"modules/fronts/headline-list-blog"},twitter:{path:"modules/twitter"},"weather-current":{path:"modules/weather/weather-current"},"inline-share-tools":{path:"modules/stories/inline-share-tools",selector:".inline-share-tools"},interactive_piechart:{path:"modules/interactives/pie-chart",selector:".interactive.pie-chart"},"most-popular-articles":{path:"modules/most-popular-articles/most-popular-articles"},"front-galleries":{path:"modules/fronts/front-galleries"},video:{path:"modules/videos/brightcove-video",selector:".ui-video"},"sub-section-navigation":{},"featured-content":{path:"modules/fronts/featured-content"},"featured-events":{path:"modules/featured-events/featured-events"},"ggm-jobs-latest":{},"rentals-local-rentals":{path:"modules/rentals-local-rentals"},sidebar:{path:"modules/sidebar",selector:"#card_full_width_main"},"related-topics-embed-stories":{},"longform-byline":{},"longform-series-bottom":{path:"modules/longform/longform-series-bottom",selector:".series-bucket-wrapper"},"section-header-elections-2016":{},"market-tool-links":{},"election-race-selection":{path:"modules/elections/election-race-selection"},taboola:{},"site-nav-social-module":{path:"modules/header/site-nav-social-module",selector:".site-nav-social-module"},"headline-text-grid":{},"longform-headline":{},"recommended-flyout":{path:"modules/stories/recommended-flyout",selector:".recommended-flyout-container"},"iframe-auto-height":{path:"modules/global/iframe-auto-height",selector:".iframe-auto"},hero:{path:"modules/fronts/hero",selector:".hero"},"poster-ad-asset2":{path:"modules/partner/poster-ad-asset2",selector:".partner-asset-right-ad-2"},"web-twitter":{},"share-facebook":{path:"modules/stories/share-facebook",selector:".util-bar-flyout-share"},"about-this-blog":{},"blog-list":{path:"blog/blog-list"},"longform-series-top":{path:"modules/longform/longform-featured-series",selector:".longform-top-series-bucket"},"headline-grid":{path:"modules/fronts/headline-grid"},"longform-nav-rail-bucket":{path:"modules/longform/longform-nav-rail-bucket",selector:".longform-series-flyout-bucket-wrapper"},"countdown-clock":{path:"modules/fronts/countdown-clock"},"topics-interactives":{},"topics-share-tools":{path:"modules/topics/topics-share-tools"},"site-nav-weather-module":{path:"modules/weather/site-nav-weather-module",selector:".site-nav-weather-module"},"section-header":{},"live-newscasts":{path:"modules/live-newscasts/live-newscasts"},"dynamic-video-playlist-module":{path:"modules/videos/dynamic-video-playlist-module",selector:".story-ribbon"},interactive_overview:{path:"modules/interactives/overview",selector:".interactive.overview"},"gravy-events":{},"election-front-results":{path:"modules/elections/election-front-results"},"trending-map":{path:"modules/trending-map/trending-map"},"topics-overview":{},oembed:{path:"modules/stories/oembed",selector:".js-oembed"},"hero-5-up":{path:"modules/fronts/hero",selector:".hero"},livefeed:{path:"modules/fronts/live-feed",selector:".livefeed-news-list"},"poster-ad-asset":{path:"modules/partner/poster-ad-asset",selector:".partner-asset-right-ad"},"weather-seven-day":{path:"modules/weather/weather-seven-day"},"datasphere-community":{path:"modules/datasphere-community/datasphere-community"},"brightcove-video":{path:"modules/videos/brightcove-video",selector:".ui-video:not('.gallery-video')"},"ggm-va-loan":{path:"modules/ggm-va-loan/ggm-va-loan"},"rentals-header":{},"broadcast-most-popular":{path:"modules/broadcast-most-popular/broadcast-most-popular"},header:{path:"modules/global/header",selector:".site-header"},"rentalslite-header":{},"video-carousel":{path:"modules/global/video-carousel"},"suspender-ad":{path:"modules/fronts/suspender-ad",selector:".suspender-ad"},"longform-share":{path:"modules/longform/longform-share",selector:".longform-share-wrapper"},"google-survey":{path:"modules/stories/google-survey"},gallery:{path:"modules/carousel/carousel",selector:".galleries"},myCapture:{path:"modules/myCapture/myCapture",selector:".mycapture-btn-wrap"},"top-stories-subsection":{path:"modules/fronts/most-popular"},"rentalslite-classified":{path:"modules/rentalslite-classified"},interactive_barchart:{path:"modules/interactives/bar-chart",selector:".interactive.bar-chart"},realmen:{path:"modules/real-men/real-men",selector:".realmen-wear-gowns"},"weather-saved-location":{},"video-playlist":{path:"modules/videos/video-gallery",selector:".video-gallery"},"countdown-clock-broadcast":{path:"modules/countdown-clock/countdown-clock"},"hero-4-up":{path:"modules/fronts/hero",selector:".hero"},"election-results":{path:"modules/fronts/election-results-module"},"longform-footer-logo":{},"polldaddy-poll":{path:"modules/polldaddy-poll"},"featured-content-with-advertising":{path:"modules/fronts/sidebar-poster-ad",selector:".poster-ad-primary"},"story-byline":{},"site-nav-user-module":{path:"modules/users/site-nav-user-module",selector:".site-nav-user-module"},"sponsor-story-more-stories":{},"rentals-listing-row":{path:"modules/rentals-listing-row"},"sports-pulse":{path:"modules/partner/sponsor-logo-ad",selector:".sponsor-logo"},"longform-sponsor-attribution":{},"ggm-mil-mall-promo":{},"hero-4-up-flex":{path:"modules/fronts/hero",selector:".hp4fm-primary-wrap"},"longform-poster-ad-bottom":{path:"modules/longform/longform-poster-ad-bottom",selector:".longform-poster-ad-bottom"},footer:{path:"modules/global/footer",selector:".footer"},elections:{path:"modules/fronts/elections-module"},"most-popular":{path:"modules/fronts/most-popular"},"utility-bar-module-share":{path:"modules/stories/utility-bar-module-share",selector:".util-bar-module-share"},"election-all-results":{path:"modules/elections/election-all-results"},"home-finder-search":{path:"modules/home-finder/home-search"},"utility-bar-module-comments":{path:"modules/stories/utility-bar-module-comments",selector:".util-bar-module-comments"},"asset-nav-bar":{},"story-transition-ad":{path:"modules/partner/story-transition-ad",selector:".partner-overlay"},"form-dropdown":{path:"ui/dropdown",selector:".ui-dropdown"},"social-media":{},"utility-bar":{path:"modules/stories/utility-bar",selector:".utility-bar-wrap"},videos:{path:"videos/jwplayer_splice",selector:".js-jwloader"},"longform-navigation":{path:"modules/longform/longform-navigation",selector:".longform-navigation-wrapper"},"weather-health":{},"sports-jumptotop":{path:"modules/sports/sports-jumptotop",selector:"#section_sports"},"blogs-index-grid":{},"taboola-recommendations":{path:"modules/stories/taboola-recommendations",selector:"#js-taboola-wrapper"},"topics-timeline":{path:"modules/topics/topics-timeline"},"newsletter-signup":{path:"modules/newsletter-signup/newsletter-signup"},"weather-station-location":{},"ggm-earlybird-signup":{},"longform-arrow":{path:"modules/longform/cover-photo-arrow",selector:".longform-arrow-container"},"broadcast-live-newscasts":{path:"modules/broadcast-live-newscasts/broadcast-live-newscasts"},"slider-ad":{path:"modules/partner/slider-ad",selector:".slider-ad"},"big-headline":{},"site-nav-more-module":{path:"modules/header/site-nav-more-module",selector:".site-nav-more-module"},"share-email":{path:"modules/stories/share-email",selector:".util-bar-flyout-share"},interactive_sequencer:{path:"modules/interactives/sequencer",selector:".interactive.sequencer"},"staff-listing":{path:"modules/tools/staff-listing",selector:"#section_staff"},"live-video-sidebar":{path:"modules/live-video-sidebar/live-video-sidebar"},"topics-photo-gallery":{path:"modules/topics/topics-photo-gallery"},"more-section-stories":{},livevideo:{path:"modules/videos/brightcove-video",selector:".ui-video"},"overlay-ad":{},map:{path:"modules/map/map",selector:".mapboxWrap"},"related-topics-photo-gallery-embed-stories":{},interactive_linechart:{path:"modules/interactives/line-chart",selector:".interactive.line-chart"},"cxense-top-stories":{path:"modules/stories/cxense-top-stories",selector:".story-ribbon"},interactive_timeline:{path:"modules/interactives/timeline",selector:".interactive.timeline"},"top-stories-asset":{},"rentalslite-ads":{path:"modules/rentalslite-ads"},"utility-bar-module-print":{path:"modules/stories/utility-bar-module-print",selector:".util-bar-module-print"},"hero-6-pack":{path:"modules/fronts/hero",selector:".hero"},"generic-iframe":{},"section-highlights":{path:"modules/section-highlights/section-highlights"},"longform-subheadline":{},"generic-front-header":{},dealchicken:{},blogs:{path:"modules/fronts/blogs"},"gannett-properties":{selector:".gannett-properties-wrapper"},"topics-scroller-ad":{},"asset-sponsorship":{},"longform-fullsize-gallery":{path:"modules/longform/longform-fullsize-gallery",selector:".js-lfa-full-gallery"},"live-vpc-suspender":{path:"modules/live-vpc-suspender/live-vpc-suspender"},"national-news-desk":{},"super-hero":{path:"modules/fronts/super-hero"}}}
}),define("managers/siteconfig",["jquery","underscore","mergedSiteConfig"],function(e,t,i){"use strict";var n={getSiteConfig:function(){return this.inited||(this.inited=!0,this.setupSiteConfig(i)),i},setupSiteConfig:function(e){!e.require||t.isEmpty(e.require.paths)&&t.isEmpty(e.require.shim)||require.config(e.require),n._replaceEnvVariables(e)},loadRoutes:function(){return e.Deferred(t.bind(function(e){var i=this.getSiteConfig(),n=t.pluck(i.apps,"path");require(n,t.bind(function(){var n=arguments,s=0;t.each(i.apps,function(e){e.AppClass=n[s++]}),this.urls=this._buildRoutes(i.pages,i.apps),e.resolve(this.urls)},this))},this))},_buildRoutes:function(e,i){return t.reduce(e,function(e,n){var s=i[n.appName],o=n.hosturls&&n.hosturls[location.hostname]||n.urls;return s||(n.appName&&(console.error("Invalid appName "+n.appName+" for Page "+n.name),n.appName="BaseApp"),s=i.BaseApp),n.modules=(n.init_modules||[]).concat(s.init_modules||[]),e.concat(t.map(o,function(e){var t=void 0===n.ajax&&void 0===s.ajax||void 0===n.ajax&&s.ajax===!0||n.ajax===!0;return{url:new RegExp(e),app:s,page:n,ajax:t}},this))},[])},getRouteInfo:function(i){return i&&(i=i.split("?")[0].split("#")[0],"/"===i[0]&&(i=i.substring(1)),i=e.trim(i)),null!==i&&t.find(this.urls,function(e){return e.url.test(i)})},_replaceEnvVariables:function(e){var i=t.templateSettings.interpolate;t.templateSettings.interpolate=/{{(.+?)}}/g,t.each(e.pages,function(e){if(e.urls){var i=[];t.each(e.urls,function(e){if(-1!=e.indexOf("{{")&&-1!=e.indexOf("}}"))try{e=t.template(e,window.site_vars||{})}catch(n){console.error("invalid url template: "+e),e=void 0}void 0!==e&&i.push(e)}),e.urls=i}}),t.templateSettings.interpolate=i}};return n}),define("managers/resourcemanager",["jquery","underscore","managers/siteconfig"],function(e,t,i){"use strict";var n=function(){this.initialize()};return n.prototype={initialize:function(n){n=e.extend({siteModules:i.getSiteConfig().siteModules},n),this.siteModules=n.siteModules||{},this.$stylesheets=e([]),this.stylesheets=[],this.staticUrl=window.site_static_url||"/static/",this.staticVersion=window.site_static_version||"off",e("link[data-identifier]").each(t.bind(function(t,i){var n=e(i).data("identifier");"main"!=n&&(this.stylesheets.push(e(i).data("identifier")),this.$stylesheets.push(i))},this))},fetchStyles:function(i,n,s){var o=t.difference(i,this.stylesheets),a=t.difference(this.stylesheets,i);s&&a.length&&console.log("removing styles from dom: ",a),s&&o.length&&console.log("adding styles to dom: ",o);var r=this._findStyleTags(a);this.stylesheets=i,this.$stylesheets=e(t.filter(this.$stylesheets,function(e){return!t.include(r,e)})),this._addStylesToHead(o),r.length&&n.done(function(){r.remove()})},fetchJavascript:function(i,n){return e.Deferred(t.bind(function(e){i?require([i],t.bind(function(t){this._resolveFetchJavascript(e,t,n)},this)):this._resolveFetchJavascript(e,null,n)},this)).promise()},_resolveFetchJavascript:function(e,t,i){this.fetchPageModules(i).done(function(i){e.resolve(t,i)})},fetchPageModules:function(i){return i=i||[],e.Deferred(t.bind(function(e){var n=i.length,s=[];return n?void t.each(i,function(i){s.push(i),this.getSiteModuleByName(i.name).done(function(e){i.selector=e.selector||"."+e.name+"-module",i.ModuleClass=e.ModuleClass}).fail(function(){s=t.reject(s,function(e){return e.name===i.name})}).always(function(){n--,0===n&&e.resolve(s)})},this):void e.resolve(s)},this)).promise()},getSiteModuleByName:function(i){return e.Deferred(t.bind(function(e){var t=this.siteModules[i];t?t.ModuleClass?e.resolve(t):t.path?require([t.path],function(n){t.ModuleClass=n,t.name=i,e.resolve(t)},function(i){console.error("Failed loading "+t.path+": "+i.message,i),e.reject(i)}):e.reject():e.reject("No Such Module Found")},this)).promise()},_findStyleTags:function(i){return e(t.filter(this.$stylesheets,function(n){var s=e(n).data("identifier");return t.find(i,function(e){return s===e})}))},_addStylesToHead:function(i){if(i&&i.length>0){var n=e([]);t.each(i,function(t){var i=e('<link rel="stylesheet" data-identifier="'+t+'" href="'+this.staticUrl+"css/bundles/"+t+(window.use_minified_css?".min":"")+".css?v="+this.staticVersion+'">')[0];n.push(i),this.$stylesheets.push(i)},this),e("head").append(n)}}},new n}),define("state",["jquery","underscore","pubsub","utils","modules/global/alert","managers/trafficcop","managers/requestmanager","managers/resourcemanager","managers/siteconfig"],function(e,t,i,n,s,o,a,r,l){"use strict";Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.constructor.prototype});var h=function(){this.scrollEl=n.get("scrollEl"),this.body=n.get("body"),this.initialize()};return h.prototype={DEBUG:!0,LAYER_OVERLAY:"overlay",LAYER_PRELOAD:"preload",LAYER_BASE:"base",REFRESH_FREQUENCY:60*(n.getNested(window.site_vars,"REFRESH_RATE")||0)*1e3,start:function(e){var t=l.getSiteConfig();this.started=!0,this.header=e,this.pubSub={"page:unload":this.updateActivityTimestamp,"page:load":this.updateActivityTimestamp,"video:load":this.updateActivityTimestamp,"slide:change":this.updateActivityTimestamp,heattrack:this.updateActivityTimestamp,vitrack:this.updateActivityTimestamp,uotrack:this.updateActivityTimestamp},i.attach(this.pubSub,this),this._setupGlobalPubSub(n.getNested(t,"global","pubSub")),this.startRefreshTimer()},stop:function(){this.started=!1,this._currentViewport="width=1070",i.unattach(this.pubSub,this),t.each(n.getNested(this.siteConfig,"global","pubSub"),function(e,t){i.off(t)})},_setupGlobalPubSub:function(e){t.each(e,function(e,n){e instanceof Array||(e=[e]),require(e,t.bind(function(){var e=arguments;this.started&&i.on(n,function(i){t.each(e,function(e){new e(i)})})},this))},this)},initialize:function(){this.$overlayFilm=e("#overlay-film"),this.activeAppInfo={url:null,css:[],layer:null,scrollTop:0,appConfig:null,pageConfig:null,app:null},this.lastUrl=null,this._clearPreloadedAppInfo(),this.fullscreenView=null},_clearPreloadedAppInfo:function(){this.preloadedAppInfo={url:null,css:[],scrollTop:0,appConfig:null,pageConfig:null,layer:this.LAYER_PRELOAD,app:null}},onRouteChange:function(e,t){return console.log("App: "+e.page.appName+"/"+e.page.name),this.activeAppInfo.app&&i.trigger("page:unload"),this._loadRoute(e,t)},_loadRoute:function(e,t,i){var n={preloadedUrl:e.page.preloadedUrl||e.app.preloadedUrl};return this._loadApp(e.app.AppClass,n,t,e.app,e.page,i)},_preloadRoute:function(e,t,i){return this._preloadApp(e.app.AppClass,{},t,e.app,e.page,i)},preloadPath:function(t){this.DEBUG&&console.log("Router: Preloading: ",t);var i=l.getRouteInfo(t);return!i||window.chromeless||this.activeAppInfo.layer&&this.activeAppInfo.layer!==this.LAYER_OVERLAY?e.Deferred().reject():this._preloadRoute(i,t)},_loadPath:function(t){var i=l.getRouteInfo(t);return i?this.onRouteChange(i,t):(console.error("StateManager: tried navigating to path, but no match found: "+t),e.Deferred().reject())},refreshActiveApp:function(){var e=this.activeAppInfo.url,t=l.getRouteInfo(e).page,n=r.fetchJavascript(t.path,t.modules),s=this._fetchPathHtml(e);return i.trigger("page:unload"),this._changePage(this.activeAppInfo,e,e,s,n)},setIntentUrl:function(e){this.activeAppInfo.intentUrl=e,this.activeAppInfo.app&&this.activeAppInfo.app.destroyModules()},getIntentUrl:function(){return this.activeAppInfo.intentUrl},getPreloadedUrl:function(){return this.preloadedAppInfo.url},registerFullScreenView:function(e){this._setFixedPosition(this.activeAppInfo,this.activeAppInfo.app,!0),this.fullscreenView=e,this.activeAppInfo.app.pause()},setActiveAppFixed:function(e){this._setFixedPosition(this.activeAppInfo,this.activeAppInfo.app,e)},clearFullScreenView:function(){return this._clearFixedPosition(this.activeAppInfo,this.activeAppInfo.app,!0),this.fullscreenView?(this.fullscreenView=null,this._loadPath(this.activeAppInfo.url)):void 0},clearActiveAppFixed:function(e){this._clearFixedPosition(this.activeAppInfo,this.activeAppInfo.app,e)},_loadApp:function(e,i,n,s,o,a){var l,h=s.overlay?this.LAYER_OVERLAY:this.LAYER_BASE,d=r.fetchJavascript(o.path,o.modules);return this._closeFullscreenView(),this.lastUrl=this.activeAppInfo.url,this.activeAppInfo.app&&(this.activeAppInfo.intentUrl&&this.activeAppInfo.intentUrl!==n&&(this.activeAppInfo.url=this.activeAppInfo.intentUrl),this.activeAppInfo.intentUrl=null),l=this._handleTransition(n,this.activeAppInfo,e,i,h,a,d),this.activeAppInfo.css=o.css||[],this.activeAppInfo.url=n,this.activeAppInfo.layer=h,this.activeAppInfo.pageConfig=o,this.activeAppInfo.appConfig=s,r.fetchStyles(t.union(this.preloadedAppInfo.css,this.activeAppInfo.css),l),l},_preloadApp:function(e,i,n,s,o,a){var l=this._handleTransition(n,this.preloadedAppInfo,e,i,this.LAYER_PRELOAD,a);return this.preloadedAppInfo.css=o.css||[],this.preloadedAppInfo.url=n,this.preloadedAppInfo.pageConfig=o,this.preloadedAppInfo.appConfig=s,r.fetchStyles(t.union(this.preloadedAppInfo.css,this.activeAppInfo.css),l),l},_closeFullscreenView:function(){if(this.fullscreenView){var e=this.fullscreenView;this.fullscreenView=null,e.close()}},_handleTransition:function(e,t,i,n,s,o,a){var r,l=t.url;return this._needsNewApp(i,t)?(r=new i(n),o=o||this._requestPageHtml(l,e,t===this.preloadedAppInfo),t.app?this._changeApps(t,s,r,l,e,o,a):this._revealApp(t,r,l,e,o,a)):t.layer===s?(o=this._requestPageHtml(l,e,t===this.preloadedAppInfo),this._changePage(t,l,e,o,a)):this._transitionFromOverlayToPreloadedApp(l,e,a)},_changeApps:function(i,n,s,o,a,r,l){return i.layer===n?i.app.removeApp(o,a).then(t.bind(function(){return this._revealApp(i,s,o,a,r,l)},this)):n===this.LAYER_OVERLAY?this._revealOverlay(s,o,a,r,l):e.when(this._removePreloadedApp(o,a),this._removeOverlay(i.app,o,a)).then(t.bind(function(){return this._revealApp(i,s,o,a,r,l)},this))},updateState:function(){var t=this.activeAppInfo;if(t.appConfig&&t.pageConfig){this.header&&this._setHeader(this.header,e.extend({},t.appConfig.header,t.pageConfig.header));var i=t.appConfig.viewport||t.pageConfig.viewport||"width=1070";this._currentViewport!==i&&(this._currentViewport=i,e("meta[name=viewport]").attr("content",i))}},_setHeader:function(e,i){t.isEmpty(i)?e.restoreDefaultState():i.fixed?i.open?e.setOpenFixed():e.setClosedFixed():e.setFixingScroller(!0)},_changePage:function(e,i,n,s,o){return e.app.changePage(i,n,s,o,e===this.preloadedAppInfo).then(null,t.bind(function(t,o){return"InvalidApp"===t&&o?this._invalidateApp(e,o,i,n,s):void 0},this))},_rerouteInitialPageLoad:function(i,n,s){return e.Deferred(function(e){t.defer(function(){i.app=null,i.url=null,e.resolve()})}).then(t.bind(function(){return this._loadRoute(s,n)},this))},_removePreloadedApp:function(e,t){var i=this.preloadedAppInfo.app;return i?(this._clearPreloadedAppInfo(),i.beforeOverlayRemove(t),i.removeApp(e,t)):void 0},_revealApp:function(e,i,n,s,o,a){return e.app=i,i.revealApp(n,s,o,a,e===this.preloadedAppInfo).then(null,t.bind(function(t,i){return"InvalidApp"===t&&i?this._invalidateApp(e,i,n,s,o):void 0},this))},_invalidateApp:function(e,t,i,n,s){try{e.app.destroy()}catch(o){console.error("View threw an exception on destroy: ",o.stack||o.stacktrace||o.message)}return console.log("Rerouting: "+t.page.appName+"/"+t.page.name),s?(e.url=i,e===this.activeAppInfo?this._loadRoute(t,n,s):this._preloadRoute(t,n,s)):this._rerouteInitialPageLoad(e,n,t)},_needsNewApp:function(e,t){return!(t.app&&t.app.isRevealed()&&(Object.getPrototypeOf(t.app)===e.prototype||this.preloadedAppInfo.app&&Object.getPrototypeOf(this.preloadedAppInfo.app)===e.prototype&&this.preloadedAppInfo.app.isRevealed()))},_requestPageHtml:function(e,t,i){if(null!==e||i){if(e!==t)return this._fetchPathHtml(t,i);i||a.abortAllRequests()}return null},_transitionFromOverlayToPreloadedApp:function(e,i,n){var s=this.preloadedAppInfo,o=this._requestPageHtml(s.url,i,!1),a=this.activeAppInfo.app;return this._movePreloadAppToActiveApp(this.LAYER_BASE),s.app.beforeOverlayRemove(i),this._removeOverlay(a,e,i).then(t.bind(function(){return this.updateState(),this._transitionFromOverlayScroll(s),this._changePage(s,e,i,o,n)},this))},_removeOverlay:function(t,i,n){return e.when(t.removeApp(i,n),this._fadeOutOverlayFilm(t))},_movePreloadAppToActiveApp:function(t){e.extend(this.activeAppInfo,this.preloadedAppInfo),this.activeAppInfo.layer=t,this._clearPreloadedAppInfo()},_deactivateActiveApp:function(){this.activeAppInfo.app.pause(),e.extend(this.preloadedAppInfo,this.activeAppInfo)},_revealOverlay:function(n,s,o,a,r){var l=this.activeAppInfo.app;l.isRevealed()?this._deactivateActiveApp():(l.removeApp(s,o),l=null),this.body.css("overflow-y","scroll"),this._transitionToOverlayScroll(this.preloadedAppInfo);var h=e.when(this._fadeInOverlayFilm(n),this._revealApp(this.activeAppInfo,n,s,o,a,r));return i.trigger("scrollTop",0),h.done(t.bind(function(){this.body.css("overflow-y",""),l&&!l.destroyed&&l.afterOverlayReveal(this.preloadedAppInfo.scrollTop)},this)),h},_fadeInOverlayFilm:function(t){var i=t.options.animations.fadeIn;return this.$overlayFilm.length||(this.$overlayFilm=e('<div class="ui-film"></div>'),this.body.append(this.$overlayFilm)),t.animate(this.$overlayFilm,"opacity",.7,i.duration,"ease-in")},_fadeOutOverlayFilm:function(t){var i=this.$overlayFilm,n=t.options.animations.fadeOut;return this.$overlayFilm=e([]),t.animate(i,"opacity",0,n.duration,"ease-out").done(function(){i.remove()})},_fetchPathHtml:function(e,i){var o=this.fetchHtml(e,null,!i);return i||o.fail(t.bind(function(e){if(e)if("NOT AUTHORIZED"===e)window.location.assign(n.getNested(window,"firefly_urls","samSubscribeURL")||"");else{var t=this.generateRequestError(e);t&&s.showError(t),(200!==e.status&&e.status||"timeout"===e.statusText)&&window.history.back()}},this)),o},generateRequestError:function(e){if(e){if(500===e.status)return"Connection Error... (INTERNAL SERVER ERROR)";if(404===e.status)return"Connection Error... (FILE NOT FOUND)";if(200!==e.status&&e.status)return"Connection Error... ("+(e.statusText||"Unknown Error")+")"}return null},_transitionFromOverlayScroll:function(e){var t=e.app;t&&(t.isApple?t.show():this._clearFixedPosition(e,t),t.$el.css("z-index",""))},_transitionToOverlayScroll:function(e){var t=e.app;t&&(t.isApple?t.hide():this._setFixedPosition(e,t),t.$el.css("z-index","0"))},_clearFixedPosition:function(e,t,n){t.clearFixedPosition(n),i.trigger("scrollTop",e.scrollTop||0)},_setFixedPosition:function(e,t,s){var o=t.getWindowOffset().top;e.scrollTop=n.getScrollPosition(),i.trigger("scrollTop",0),t.setFixedPosition(o,s)},updateActivityTimestamp:function(){this.lastActivityTimestamp=(new Date).getTime()},getActivePageInfo:function(){return this.activeAppInfo.app&&this.activeAppInfo.app.pageInfo||{}},getActiveAppClientInfo:function(){return this.activeAppInfo.app&&this.activeAppInfo.app.getClientInfo()||{}},getPreloadedPageInfo:function(){return this.preloadedAppInfo.app&&this.preloadedAppInfo.app.pageInfo||{}},getActiveApp:function(){return this.activeAppInfo.app},getPreloadedApp:function(){return this.preloadedAppInfo.app},getReferrer:function(){return null===this.lastUrl?document.referrer:n.getOrigin()+this.lastUrl},getCurrentUrl:function(){return n.getOrigin()+this.activeAppInfo.url},startRefreshTimer:function(){!this.refreshTimer&&this.REFRESH_FREQUENCY&&(this.lastActivityTimestamp=0,this.refreshTimer=setInterval(t.bind(function(){if(!this.fullscreenView&&this.activeAppInfo.layer!==this.LAYER_OVERLAY){var e=(new Date).getTime(),t=e-this.lastActivityTimestamp;t>this.REFRESH_FREQUENCY&&(i.trigger("site:refresh","refresh:"+(this.getActivePageInfo().ssts||"").replace(/[\/:].*/,"")),window.location=window.location)}},this),6e4))},stopRefreshTimer:function(){this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=null)},registerAnimation:function(e,t,i,n,s){return o.addAnimation(e,t,i,n,s)},fetchHtml:function(e,t,i,n){return a.fetchHtml(e,t,i,n,!0)},fetchData:function(e,t,i,n,s){return a.fetchData(e,t,i,n,s)},recurringFetchHtml:function(e,t,i,n,s){return a.recurringFetchHtml(e,t,i,n,s,!0)},recurringFetchData:function(e,t,i,n,s,o){return a.recurringFetchData(e,t,i,n,s,o)}},window.stateManager=new h,window.stateManager}),define("managers/routemanager",["jquery","underscore","state","managers/siteconfig","pubsub","utils"],function(e,t,i,n,s,o){"use strict";var a=function(){};return a.prototype={baseUrl:window.location.protocol+"//"+window.location.host,usatBetaDomain:"http://beta.usatoday.com",start:function(e){this.started=!0,n.loadRoutes().done(t.bind(function(){this.started&&(e&&o.get("win").on("popstate",t.bind(this._onStateChange,this)),this._onStateChange(),console.log("Site Loaded"))},this))},getLocalPath:function(e){if(!e||"#"===e)return null;if(e.indexOf(this.baseUrl))if(e.indexOf(this.usatBetaDomain)){if(-1!==e.indexOf("://"))return null}else e=e.substring(this.usatBetaDomain.length);else e=e.substring(this.baseUrl.length);return e},stop:function(){this.started=!1,o.get("win").off("popstate")},getInfo:function(t){var i=this.getLocalPath(t);return null!==i?n.getRouteInfo(e.trim(i)):null},isAjax:function(e){var t=this.getInfo(e);return t&&t.ajax},goTo:function(e,t,n){if(!o.isValidUrl(e)||!this._canNavigate())return!1;if(!i.getIntentUrl()&&this.isCurrentUrl(e))return console.warn("Tried navigating to the current url, skipping"),!1;s.trigger("track",{label:t,url:e,event:n});var a=this._goHashTag(e)||this._goInternal(e);return a||this._setLocation(this.attachChromeless(e)),!0},goToInterstitual:function(e){return e=this.getLocalPath(e),Modernizr.history&&o.isValidUrl(e)&&this._canNavigate()&&this.getInfo(e)?(i.setIntentUrl(e),this._pushState(this.attachChromeless(e)),!0):!1},isCurrentUrl:function(e){var t=this.getLocalPath(e);return t&&(t=t.split("#")[0]),t===this._getCurrentPath()},_getCurrentPath:function(){return window.location.pathname+location.search},_setLocation:function(e){window.location.assign(e)},_canNavigate:function(){var e=i.getActivePageInfo().navigationWarning;return e&&!window.confirm(e)?!1:!0},_goHashTag:function(t){if("#"===t[0]){t=t.substring(1);var i=e("a[name="+t+"]").offset();return i&&i.top&&s.trigger("scrollTop",i.top-40),window.location.hash=t,!0}},attachChromeless:function(e){return window.chromeless?e+(-1===e.indexOf("?")?"?":"&")+"chromeless=true":e},_goInternal:function(e){return Modernizr.history&&this.isAjax(e)&&this.isAjax(o.getPageUrl())?(this._pushState(this.attachChromeless(this.getLocalPath(e))),this._onStateChange(),!0):!1},_pushState:function(e){window.history.pushState({},document.title,e)},_onStateChange:function(){var e,t=window.location;t.pathname!==this._currentPathName&&(this._currentPathName=t.pathname+t.search,e=this.getInfo(t.pathname),e?i.onRouteChange(e,t.pathname+t.search+t.hash):console.error("Could not find any site-config matching "+t.pathname))}},new a}),define("managers/cachemanager",["jquery","underscore"],function(e,t){"use strict";var i=function(){t.bindAll(this,"_updateCache"),window.addEventListener?window.addEventListener("storage",this._updateCache,!1):window.attachEvent("onstorage",this._updateCache),this.reset(),this.getValue("cmgc",this.gc,10080)};return i.prototype={keyPrefix:"wf_",reset:function(){this._cache={}},gc:function(){var e=i.prototype;t.each(t.keys(window.localStorage),function(t){0===t.indexOf(e.keyPrefix)&&(e._getBrowserCache(window.localStorage,t)||window.localStorage.removeItem(t))})},_updateCache:function(i){var n;i||(i=window.event),i.key&&0===i.key.indexOf(this.keyPrefix)&&(i.newValue?(n=JSON.parse(i.newValue),t.isObject(n)&&"raw"!==n.type&&(n.data=e.Deferred().resolve(n.data)),this._setMemoryCache(i.key,n)):delete this._cache[i.key])},getValue:function(e,i,n){var s,o,a,r=this._getStorage(n);return e=this.keyPrefix+e,s=this._getMemoryCache(e),s||(s=this._getBrowserCache(r,e),s||(o=this._getValue(i),a=this._isPromise(o),s=this._buildCacheEntry(o,a,n),a?o.done(t.bind(function(t){var i=this._buildCacheEntry(t,!0,n);this._setBrowserCache(e,i,r)},this)):this._setBrowserCache(e,s,r)),this._setMemoryCache(e,s)),s.data},setValue:function(e,i,n){var s=this._isPromise(i),o=this._buildCacheEntry(i,s,n);e=this.keyPrefix+e,s?i.done(t.bind(function(t){var i=this._buildCacheEntry(t,!0,n);this._setBrowserCache(e,i,this._getStorage(n))},this)):this._setBrowserCache(e,o,this._getStorage(n)),this._setMemoryCache(e,o)},_isPromise:function(t){return e.isPlainObject(t)&&e.isFunction(t.promise)},_getStorage:function(e){var t=e?"localStorage":"sessionStorage";return window[t]},_setMemoryCache:function(e,t){this._cache[e]=t},_setBrowserCache:function(e,t,i){try{i.setItem(e,JSON.stringify(t))}catch(n){console.log("Storage Set Failed for key: "+e)}},_buildCacheEntry:function(e,t,i){var n,s={data:e,type:t?0:"raw"};return i&&(n=new Date,s.expires=n.setTime(n.getTime()+1e3*i*60)),s},clearValue:function(e){e=this.keyPrefix+e,sessionStorage.removeItem(e),localStorage.removeItem(e),delete this._cache[e]},_getMemoryCache:function(e){var t=this._cache[e];if(t){if("raw"!==t.type){if("pending"===t.data.state())return t;if("rejected"===t.data.state())return null}if(!t.expires)return t;if(new Date<new Date(t.expires))return t}},_getBrowserCache:function(i,n){var s=i.getItem(n);return s&&(s=JSON.parse(s),t.isObject(s)&&(!s.expires||new Date<new Date(s.expires)))?("raw"!==s.type&&(s.data=e.Deferred().resolve(s.data)),s):void 0},_getValue:function(t){return e.isFunction(t)?t():t}},new i}),define("user-manager",["jquery","underscore","pubsub","managers/cachemanager"],function(e,t,i,n){"use strict";var s=function(){this.initialize()};return s.prototype={PREFERRED_ACCOUNT_KEY:"userPreferredAccount",PREFERRED_ACCOUNT_TIMEOUT:525600,initialize:function(){this.resetManager(),this.preferredAccount&&(this.state="loggingIn",i.on("page:load",this.autoLogin,this)),i.on("user:statuschange",this._userStatusChange,this)},destroy:function(){this.resetManager(),i.off("user:statuschange",this._userStatusChange,this),i.off("page:load",this.autoLogin,this)},autoLogin:function(){this.state=null,this.loginUser(this.preferredAccount,!0).fail(t.bind(function(){this.logoutUser()},this)),i.off("page:load",this.autoLogin,this)},registerAccount:function(e){var t=e.getName();return this.accounts[t]?void console.error("duplicate account name given to registerAccount"):void(this.accounts[t]=e)},unRegisterAccount:function(e){var t=e.getName();this.accounts[t]?this.accounts[t]=null:console.error("unRegisterAccount called on name that isn't registered!"),e.logout(),this.preferredAccount===t&&this.setPreferredAccount(null)},loginUser:function(e,t){return this._askAccount("login",e,t)},_userStatusChange:function(e,t,i){"loggedIn"===t?this._onLoginSuccess(e,i):"loggedOut"===t&&this._onLogoutSuccess(e)},_onLoginSuccess:function(e,t){this.setPreferredAccount(e),i.trigger("user:login",t,e)},setPreferredAccount:function(e){var t=this.getPreferredAccountLookupKey();e?n.setValue(t,e,this.PREFERRED_ACCOUNT_TIMEOUT):n.clearValue(t),this.preferredAccount=e},getPreferredAccountLookupKey:function(){return this.PREFERRED_ACCOUNT_KEY},getPreferredAccount:function(){return this.preferredAccount||n.getValue(this.getPreferredAccountLookupKey(),null,this.PREFERRED_ACCOUNT_TIMEOUT)},getLoginStatus:function(e){var t,i=this.getAccount(e);return t=i?i.getLoginStatus():"loggedOut",this.state||t},logoutUser:function(e){return this._askAccount("logout",e)},logoutAll:function(){return e.when.apply(e,t.map(this.accounts,function(e){return e.logout()}))},_onLogoutSuccess:function(e){i.trigger("user:logout",e),e===this.getPreferredAccount()&&this.setPreferredAccount(null)},getAccount:function(e){return this.accounts[e||this.preferredAccount]},getUserInfo:function(e){return this._askAccount("getUserInfo",e)},getCoreUserInfo:function(e){return this._askAccount("getCoreUserInfo",e)},resetManager:function(){this.accounts={},this.preferredAccount=this.getPreferredAccount()},_askAccount:function(t,i){var n=this.getAccount(i);return n?n[t]?n[t].apply(n,Array.prototype.slice.call(arguments,2)):e.Deferred().reject("Account "+(i||this.preferredAccount)+" does not support method "+t):e.Deferred().reject("Invalid Account")}},new s}),define("adLogger",["underscore"],function(e){"use strict";var t=function(){this.initialize()};return t.prototype={initialize:function(){this.debug=window.isAdDebug,Function.prototype.bind&&window.console&&"object"==typeof window.console.log&&e.each(["log","info","warn","error"],function(e){window.console[e]=Function.prototype.call.bind(window.console[e],window.console)})},logGroup:function(e){this.debug&&window.console.groupCollapsed(e)},logGroupEnd:function(){this.debug&&window.console.groupEnd()},_log:function(e,t,i){var n="Ad "+t+": "+e;if(window.console&&window.console[t])if(i.length){window.console.groupCollapsed(n);for(var s=0,o=i.length;o>s;s++)window.console[t](i[s]);window.console.groupEnd()}else window.console[t](n)},logDebug:function(e){this.debug&&this._log(e,"log",Array.prototype.slice.call(arguments,1))},logError:function(e){this._log(e,"error",Array.prototype.slice.call(arguments,1))},logInfo:function(e){this.debug&&this._log(e,"info",Array.prototype.slice.call(arguments,1))},logWarn:function(e){this._log(e,"warn",Array.prototype.slice.call(arguments,1))}},new t}),define("partner/ad-slot",["jquery","underscore","baseview","state","utils","user-manager","pubsub","adLogger"],function(e,t,i,n,s,o,a,r){"use strict";var l=i.extend({className:"ad-slot",id:function(){return t.uniqueId("ad-slot-"+this.options.adUnit.replace(/\//g,"-")+"-")},events:{partnersetup:"onHighImpactAdLoad",partnerloading:"onPartnerLoading"},pageLoaded:!1,initialized:!1,queue:[],pageUnLoad:function(){l.prototype.pageLoaded=!1},pageLoad:function(){l.prototype.queue.length&&l.prototype._requestSlots(l.prototype.queue),l.prototype.queue=[],l.prototype.pageLoaded=!0},initialize:function(t){return t=e.extend({adUnit:null,targeting:{},sizes:[],type:"in",onSlotRequest:null,onSlotRender:null,onSlotEmpty:null,position:null},t),!l.prototype.initialized&&window.googletag&&(l.prototype.initialized=!0,googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",l.prototype._renderEnded)})),this.$el.length&&t.position&&t.position.length&&t.position.parents("body").length?(t.position.append(this.$el),this.gptSlot=null,this.slotId=this.$el.prop("id"),this.adDeliveryData=null,i.prototype.initialize.call(this,t),void this._buildGptSlot()):void r.logError("AdSlot("+this.options.adUnit+"): Unable to request ad because no valid dom element provided")},_buildGptSlot:function(){return n.getActivePageInfo().noadvertising?void r.logInfo("AdSlot("+this.options.adUnit+"): blocked because of noadvertising flag in pageinfo"):void("in"===this.options.type?this._registerSlotWithGoogle(this.options.adUnit,this.options.sizes,this.slotId):this._registerOutOfPageSlotWithGoogle(this.options.adUnit,this.slotId))},destroy:function(){this.gptSlot&&(this.gptSlot.__gannettSlot=null),this.destroyed=!0,this.gptSlot=null,i.prototype.destroy.call(this,!0)},refresh:function(){this.destroyed||(this.adLoading=!1,this.adData=null,this.$el.closest("body").length||this.options.position.append(this.$el),this.delegateEvents(),this.gptSlot?window.googletag&&!n.getActivePageInfo().noadvertising&&(this._refreshSlot(this.gptSlot),r.logInfo("AdSlot("+this.options.adUnit+"): Ad refreshed for slot",this.gptSlot)):this._buildGptSlot())},onPartnerLoading:function(){this.adLoading=!0},onHighImpactAdLoad:function(e,t){var i=null;if(t&&t.data)i=t.data;else{if(!e.originalEvent||!e.originalEvent.data)return void r.logError("AdSlot("+this.options.adUnit+"): Found a high impact ad, can't find the data object from the iFrame",arguments);i=e.originalEvent.data}if(!i||!i.adType)return void r.logError("AdSlot("+this.options.adUnit+"): high impact event received, but invalid data object was given",i);this.adData=i;var n=this._normalizeAdType(i.adType);this.options.onSlotRender(i,n)},_normalizeAdType:function(e){return e?e.toLowerCase().replace(/[^a-z]/,""):null},_registerOutOfPageSlotWithGoogle:function(e,i){window.googletag&&googletag.cmd.push(t.bind(function(){r.logInfo("AdSlot("+this.options.adUnit+"): registering out of page slot with google "+e),this.gptSlot=googletag.defineOutOfPageSlot(e,i).addService(googletag.pubads()),this.gptSlot.__gannettSlot=this,googletag.display(i),this._refreshSlot(this.gptSlot)},this))},_refreshSlot:function(e){this.setTargeting(this.options.targeting),this.pageLoaded?this._requestSlots([e]):this.queue.push(e)},_requestSlots:function(e){googletag.pubads().refresh(e),t.each(e,function(e){e.__gannettSlot.options.onSlotRequest()})},_registerSlotWithGoogle:function(e,i,n){window.googletag&&googletag.cmd.push(t.bind(function(){r.logGroup("AdSlot "+this.options.adUnit),r.logInfo("registering slot with google "+e+" sizes",i),this.gptSlot=googletag.defineSlot(e,i,n).addService(googletag.pubads()),this.gptSlot.__gannettSlot=this,googletag.display(n),this._refreshSlot(this.gptSlot),r.logGroupEnd()},this))},_renderEnded:function(e){e.slot.__gannettSlot&&t.defer(t.bind(function(){!this.gptSlot||this.adData||this.adLoading||(e.isEmpty||e.size[0]<10||e.size[1]<10?(r.logInfo("AdSlot("+this.options.adUnit+"): No Ad Delivered"),this.options.onSlotEmpty&&this.options.onSlotEmpty()):this.options.onSlotRender())},e.slot.__gannettSlot))},setTargeting:function(e){this.gptSlot&&(this.options.targeting=e,this._setTargeting(this.gptSlot,e))},_setTargeting:function(e,i){e.clearTargeting(),t.each(i,function(t,i){(t||0===t||t===!1)&&(e.setTargeting(i,t),r.logInfo("set targetting - key:"+i+" value:"+t))},this)}});return l}),define("modules/global/barrier",["jquery"],function(e){var t=function(t,i,n){e.extend(this,e.Deferred()),n&&(this.reject=this.resolve);var s=setTimeout(e.proxy(function(){this.reject()},this),i);t.then(e.proxy(function(){this.resolve.apply(this,arguments)},this),e.proxy(function(){this.reject.apply(this,arguments)},this)).always(function(){clearTimeout(s)})},i=function(){this.init()};return i.prototype={init:function(){this._processes=[],this._waiting=[]},add:function(e,i,n){return i?void this._addToQueue(this._processes,new t(e,i,n)):void console.error("Invalid Barrier, timeoutMS required")},cancel:function(t){e.each(this._waiting,function(e,t){t.reject()}),this._waiting=[],t&&(e.each(this._processes.slice(0),function(e,t){t.reject()}),this._processes=[])},wait:function(){var t=this._processes;return t.length?this._addToQueue(this._waiting,e.Deferred(function(i){e.when.apply(e,t).then(function(){i.resolve.apply(i,arguments)},function(){i.reject.apply(i,arguments)})})):e.Deferred().resolve()},_addToQueue:function(t,i){return t.push(i),i.always(e.proxy(function(){return this._removeFromQueue(t,i)},this))},_removeFromQueue:function(t,i){var n=e.inArray(i,t);return-1!==n?(t.splice(n,1),!0):!1}},i}),define("modules/global/memobarrier",["jquery","modules/global/barrier"],function(e,t){var i=function(){this.init()};return i.prototype=new t,i.prototype.constructor=i,i.prototype._addToQueue=function(e,t){return e.push(t),t},i}),function(e){"function"==typeof define&&define.amd?define("cookie",["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e){return r.raw?e:encodeURIComponent(e)}function i(e){return r.raw?e:decodeURIComponent(e)}function n(e){return t(r.json?JSON.stringify(e):String(e))}function s(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(a," ")),r.json?JSON.parse(e):e}catch(t){}}function o(t,i){var n=r.raw?t:s(t);return e.isFunction(i)?i(n):n}var a=/\+/g,r=e.cookie=function(s,a,l){if(arguments.length>1&&!e.isFunction(a)){if(l=e.extend({},r.defaults,l),"number"==typeof l.expires){var h=l.expires,d=l.expires=new Date;d.setTime(+d+864e5*h)}return document.cookie=[t(s),"=",n(a),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var c=s?void 0:{},u=document.cookie?document.cookie.split("; "):[],p=0,f=u.length;f>p;p++){var g=u[p].split("="),m=i(g.shift()),v=g.join("=");
if(s&&s===m){c=o(v,a);break}s||void 0===(v=o(v))||(c[m]=v)}return c};r.defaults={},e.removeCookie=function(t,i){return void 0===e.cookie(t)?!1:(e.cookie(t,"",e.extend({},i,{expires:-1})),!e.cookie(t))}}),define("admanager",["jquery","underscore","pubsub","state","utils","user-manager","partner/ad-slot","modules/global/memobarrier","adLogger","cookie"],function(e,t,i,n,s,o,a,r,l){"use strict";var h=function(){this.initialize()};return h.prototype={adSizes:{pushdown:[1200,615],gravity:[2560,1440],dual_pushdown:[1200,1230],skyline:[1080,450],elastic:[1080,810],outofpage:[1080,810],cinematicvideoskin:[2600,1400],heroflip:[720,524],coverviewfullpage:[1,1],bigpageflex:[1,1],mediumrectangle:[300,250],halfpage:[300,600],sponsor_logo_medium:[100,50],leaderboard:[728,90],generic:[1,2],filmstrip:[300,600],iabpushdown:[970,90],iabpushdown2:[970,66],billboard:[970,250],portrait:[300,1050],sponsor_logo:[100,30]},flexibleAds:["pushdown","gravity","dual_pushdown","elastic","outofpage","cinematicvideoskin","heroflip","coverviewfullpage","generic"],activeAdPlacements:{},globalTargetingKeys:[],getSharedAdSlot:function(e,i,n,s){var o=this._buildAdSizesFromPlacements(i),a=this.buildAdUnit(e),r=n&&n.$el||this.globalStaging;return s=s||n&&n.getSlotType()||"in",this._createAdSlot(a,{},o,s,r,function(e,t){if(!t&&n)n.render();else{var s=i[t];if(!s)return void l.logError("AdSlot("+a+"): ad delivered to unknown ad position/type: "+t);s.render(e,t)}},function(){t.each(i,function(e){e.noAd()})})},getAdSlot:function(e,t,i,n,s){var o=this.buildAdUnit(e),a=this._mapAdSizeNamesToActualSizes(i);return this._createAdSlot(o,t,a,s,n.$el,function(e,t){n.render(e,t)},function(){n.noAd()})},buildAdUnit:function(e){var t=s.getNested(window.site_vars,"ADS")||{},i=s.getNested(t,"DFP","ACCOUNTID"),n=s.getNested(t,"DFP","ACCOUNTNAME");return this.override&&(i=this.override.usatai,n=this.override.usatan),i+"/"+n+"/"+e},getSize:function(t){var i=this.adSizes[e.trim(t)];return i?i:(l.logWarn("Size not found for "+t),null)},isFlexibleAdSize:function(e){return-1!==t.indexOf(this.flexibleAds,e)},getVCESize:function(e){var t=this.getSize(e);return t?t.join("x"):"1x1"},initialize:function(){if(this._resetSlots(),!window.googletag||!window.googletag.pubads)return this.adLoadBarrier.resolve(),void(this.pageLoaded=!0);this.targetBarrier=new r,this._fetchTargeting(),l.logGroup("AdManager initialize"),this.pubSub={"page:load":this.onPageLoad,"page:unload":this.onPageUnload,"user:statuschange":this.onUserStatusChange},i.attach(this.pubSub,this);var t=s.getUrlParam("usatai"),n=s.getUrlParam("usatan"),o=s.getUrlParam("usatl");t&&n&&o&&(this.override={usatai:t,usatan:n,usatl:o}),this.globalStaging=e("#ad-staging"),this._initializeGoogletag(),window.adManager=this,this._initializeBaseTargeting(),l.logDebug("AdManager initialized"),l.logGroupEnd()},stop:function(){i.unattach(this.pubSub,this)},_beginA9:function(){var e=s.getNested(window.site_vars,"ADS","a9");e&&e.enabled&&this.targetBarrier.add(this._fetchA9(e),2e3,!0)},_fetchA9:function(t){return s.loadScript(t.url,"amznads").then(function(i){try{i.ads={},i.getAdsAsync(t.account)}catch(n){return console.error("failed amznads.getAdsAsync("+t.account+")",n),e.Deferred().reject()}return e.Deferred(function(e){i.tasks.push(function(){e.resolve({amznslots:i.getTokens()})})})})},_fetchTargeting:function(){this._beginA9(),this._beginCriteo(),this._beginPubMatic()},_beginCriteo:function(){var e=s.getNested(window.site_vars,"ADS","criteo");e&&e.enabled&&this.targetBarrier.add(this._fetchCriteo(e),2e3,!0)},_fetchCriteo:function(i){return window[i.varName]=e.cookie(i.cookie),e.ajax({url:i.url,data:{netId:i.account,cookieName:i.cookie,varName:i.varName},dataType:"script"}).then(t.bind(function(){var e=window[i.varName];return e?t.reduce(e.split(";"),function(e,t){if(t){var i=t.split("=");e[i[0]]=i[1]}return e},{}):{}},this))},_beginPubMatic:function(){var e=s.getNested(window.site_vars,"ADS","pubMatic");e&&e.enabled&&this.targetBarrier.add(this._fetchPubMatic(e),2e3,!0)},_fetchPubMatic:function(i){window.pm_pub_id=i.account,window.pm_optimize_adslots=i.slots;var n,s=i.site,o=i.group;switch(window.location.href.split("/")[3]){case"ros":n="10";break;case"life":n="20";break;case"money":n="30";break;case"news":n="40";break;case"sports":n="50";break;case"tech":n="60";break;case"travel":n="70";break;case"weather":n="80";break;case"entertainment":n="90";break;default:n="0"}return window.pmzoneid=t.compact([o,s,n]).join(","),window.kadpageurl=document.location.hostname,l.logGroup("PubMatic Initialization Info"),l.logInfo("PubMatic pmzoneid: "+window.pmzoneid),l.logInfo("PubMatic slots: "+window.pm_optimize_adslots),l.logGroupEnd(),e.Deferred(function(n){window.pm_async_callback_fn="pm_async_callback",window.pm_async_callback=function(){var e,i,s=window.PubMaticGrouped;if(s){try{e=s.getCombinedKeyValueGPT()}catch(o){l.logError("PubMatic.getCombinedKeyValueGPT() failed",o)}e&&(e=e.replace(/ATF@728x90/gi,"pm1").replace(/BTF@728x90/gi,"pm2").replace(/ATF@300x250/gi,"pm3").replace(/BTF@300x250/gi,"pm4").replace(/ATF@300x600/gi,"pm5").replace(/ROS@970x250/gi,"pm6-bid").replace(/ROS@300x1050/gi,"pm7-bid"),i=t.chain(e.split(";")).map(function(e){return e.split("=")}).filter(function(e){return e.length>1&&e[0].match("bid$")&&parseInt(e[1],10)>0}).object().value(),n.resolve(i))}else l.logError("PubMatic script failed to provide PubMaticGrouped");n.reject()},e.ajax({url:i.url,dataType:"script",cache:!0}).fail(function(){n.reject()})})},_createAdSlot:function(i,n,o,r,l,h,d){var c=e.Deferred();return c.done(t.bind(function(){this.activeSlotStatistics.unknown--},this)),this.activeSlotStatistics.unknown++,new a({adUnit:i,targeting:n,sizes:o,type:r||"out",position:l,onSlotRequest:t.bind(function(){this.slotsBarrier.add(c,2e3,!0)},this),onSlotEmpty:t.bind(function(){this.activeSlotStatistics.noad++,c.resolve(),d()},this),onSlotRender:t.bind(function(e,t){if(t){this.activeSlotStatistics.high_impact++;var i=s.getNested(e,"dfp","ecid");this.activeSlotStatistics.high_impact_info.push({adType:t,cap:e.maxDisplayed,capExp:parseInt(e.leaveBehindExp,10),ecid:i,state:"loading"})}else this.activeSlotStatistics.iab++;c.resolve(),h(e,t)},this)})},_resetSlots:function(){this.slotsBarrier?this.slotsBarrier.cancel(!0):this.slotsBarrier=new r,this.adLoadBarrier&&this.adLoadBarrier.reject(),this.adLoadBarrier=e.Deferred(),this.activeSlotStatistics={high_impact:0,high_impact_info:[],iab:0,noad:0,unknown:0}},getActiveSlotStatistics:function(){return this.adLoadBarrier.then(t.bind(function(){return this.slotsBarrier.wait()},this)).then(t.bind(function(){var i=this.activeSlotStatistics;return e.Deferred(function(e){t.defer(function(){e.resolve(i)})})},this))},updateActiveSlotStatistics:function(e,i){var n=t.findWhere(this.activeSlotStatistics.high_impact_info,{adType:e});n&&(n.state=i)},_initializeGoogletag:function(){googletag.cmd.push(function(){var e=googletag.pubads();l.logInfo("Collapses the empty divs. Used for the asset pages where the slot and placement are the same"),e.collapseEmptyDivs(),e.enableSingleRequest(),l.logInfo("Disabling initial load of slots"),e.disableInitialLoad(),l.logInfo("Enabled the ad calls"),googletag.enableServices()})},_initializeBaseTargeting:function(){var t=googletag.pubads(),i=this.override;googletag.cmd.push(function(){var n=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join();t.setTargeting("aam",n),t.setTargeting("u",e.cookie("aam_uuid")||""),i&&i.usatl&&t.setTargeting("adlabel",i.usatl);var o=s.getNested(window.site_vars,"ADS","DFP","ENV");l.logInfo("using env targeting: "+o),t.setTargeting("env",o)})},onPageLoad:function(i){this._buildSharedAdSlots(i.cst),this.pageLoaded=!0,this.targetBarrier?this.targetBarrier.wait().done(t.bind(function(){var t=[{},{ss:this.ssInfo}].concat([].slice.call(arguments)),n=e.extend.apply(e,t);l.logInfo("AdManager: requestAds()",i,n),this._setGlobalTargeting(i,n),a.prototype.pageLoad(),this.adLoadBarrier.resolve()},this)):this.adLoadBarrier.resolve()},_buildSharedAdSlots:function(e){t.each(this.activeAdPlacements,function(t){t&&(t.slotInfo=this.getSharedAdSlot(t.name+"/"+e,t.positionMap,t.defaultPosition))},this)},onPageUnload:function(){this.pageLoaded=!1,this._resetSlots(),a.prototype.pageUnLoad(),this._resetTargeting()},_resetTargeting:function(){this.targetBarrier.cancel(!0),this._clearGlobalTargeting(),this._fetchTargeting()},isPageLoaded:function(){return this.pageLoaded},_clearGlobalTargeting:function(){googletag.cmd.push(t.bind(function(){var e=googletag.pubads(),i=this.globalTargetingKeys;l.logInfo("clear pubads() targetting",i),t.each(i,function(t){e.clearTargeting(t)}),this.globalTargetingKeys=[]},this))},_setGlobalTargeting:function(i,s){var o=this,a=n.getActiveApp(),r=e.extend({},this.getPageAdTargeting(i),s,a&&a.getClientAdInfo());this.globalTargetingKeys=[],googletag.cmd.push(function(){var e=googletag.pubads();t.each(r,function(t,i){(t||0===t||t===!1)&&(o.globalTargetingKeys.push(i),e.setTargeting(i,String(t)),l.logInfo("set pubads() targetting - key:"+i+" value:"+t))})})},getPageAdTargeting:function(e){var t=s.getNested(window,"site_vars","aws_site_name")||"usat";return{pageType:e.basePageType,referrer:(n.getReferrer().match(/https?:\/\/[:\w\.-]+/)||[])[0],series:e.series,sitepage:t+"/"+e.ssts,contentid:e.assetid,topic:e.topic}},onUserStatusChange:function(e,i){if("firefly"===e)if("loggedIn"==i||"loggingIn"==i){var n=o.getCoreUserInfo();n=n.then(t.bind(function(e){this.ssInfo=e.UserLicenseType?t.map(e.UserLicenseType.split("_"),function(e){return e.substring(0,3)}).join("_"):null},this),t.bind(function(){this.ssInfo=null},this)),this.targetBarrier.add(n,2e3,!0)}else this.ssInfo=null},getAdActualSizes:function(e){return this._mapAdSizeNamesToActualSizes(e)},_mapAdSizeNamesToActualSizes:function(e){if(t.isString(e)){var i=e.split(",");return this._processAdSizeData(i.length>1?i:[e])}return t.isArray(e)?this._processAdSizeData(this._isAdSizeArray(e)?[e]:e):[]},_processAdSizeData:function(e){return t.reduce(e,function(e,i){var n;return t.isString(i)?n=this._getAdSizeFromString(i):t.isArray(i)&&this._isAdSizeArray(i)&&(n=i),n&&e.push(n),e},[],this)},_isAdSizeArray:function(t){return 2===t.length&&e.isNumeric(t[0])&&e.isNumeric(t[1])},_getAdSizeFromString:function(e){var t=this.getSize(e);if(!t){var i=e.toLowerCase().split("x");2===i.length&&(i=[parseInt(i[0],10),parseInt(i[1],10)],this._isAdSizeArray(i)&&(t=i))}return t},_buildAdSizesFromPlacements:function(i){var n=[];return t.each(i,function(t){var i=this._mapAdSizeNamesToActualSizes(t.getAdSizes());e.merge(n,i)},this),t.uniq(n)},refreshSharedAdPosition:function(e){var i=this.activeAdPlacements[e];return i?i.slotInfo?(t.each(i.positionMap,function(e){e.destroyAdPlacement()},this),void i.slotInfo.refresh()):void l.logError("AdManager: tried refreshing shared ad position that hasn't been requested yet"):void l.logError("AdManager: tried refreshing shared ad position that no longer exists")},registerSharedAdPosition:function(e){var i=e.getAdPlacement(),n=e.getAdType();if(this._checkPageChange(),n&&!t.isArray(n)&&(n=[n]),!i||!n||!n.length)return void l.logError("AdManager: invalid ad unit registered, adUnit and adType are required",e);var s=this._getAdPlacementInfo(i);this._addAdToPlacementInfo(s,e,n)},_getAdPlacementInfo:function(e){var t=this.activeAdPlacements[e];return t||(this.activeAdPlacements[e]=t={name:e,positionMap:{},defaultPosition:null,slotInfo:null,numPositions:0}),t},_addAdToPlacementInfo:function(e,i,n){t.each(n,function(t){return e.positionMap[t]?void l.logError("AdManager: invalid ad unit registered, duplicate adType registered",i):(l.logInfo("AdManager: registerSharedAdPosition for adPlacement: "+e.name+" and adType:"+t),void(e.positionMap[t]=i))}),e.numPositions++,i.isDefaultPosition()&&(e.defaultPosition?l.logWarn("AdManager: multiple ad placements declared themselves default for adUnit: "+e.name,i):e.defaultPosition=i)},_checkPageChange:function(){var e=window.location.pathname;e!==this.siteUrl&&(this.siteUrl=e,t.each(this.activeAdPlacements,function(e){e&&l.logError("Site Url changed, but ad placements were not released: ",e)}),this.activeAdPlacements={})},destroySharedAdPosition:function(e){var i=e.getAdPlacement(),n=e.getAdType(),s=this.activeAdPlacements[i];return s?(n&&!t.isArray(n)&&(n=[n]),t.each(n,function(t){var n=s.positionMap[t];return n?(l.logInfo("AdManager: destroySharedAdPosition for adPlacement: "+i+" and adType:"+t),void(s.positionMap[t]=null)):void l.logError("AdManager: destruction of unknown ad type",e)}),e.isDefaultPosition()&&(s.defaultPosition=null),s.numPositions--,void(s.numPositions||(s.slotInfo&&s.slotInfo.destroy(),this.activeAdPlacements[i]=null))):void l.logError("AdManager: destruction of unknown ad unit",e)},_createScript:function(e,t,i){l.logDebug("Creating script",e,t,i[0]);var n=document.createElement("script");n.id=e,n.src=t,n.type="text/javascript",n.defer=!1,i[0].appendChild(n)},logDebug:function(){l.logDebug.apply(l,arguments)},logError:function(){l.logError.apply(l,arguments)},logInfo:function(){l.logInfo.apply(l,arguments)},logWarn:function(){l.logWarn.apply(l,arguments)}},new h}),define("api/ads",["jquery","admanager"],function(e,t){return{registerAd:function(i,n,s,o){var a=e("string"==typeof i?"#"+i:i),r={$el:a,render:function(){},noAd:function(){}};t.getAdSlot(n,o,s,r,"in")}}}),define("managers/autoplay",["jquery","underscore","pubsub","admanager","utils"],function(e,t,i,n,s){"use strict";var o=function(){this.pubSub={"page:load":this._onPageLoad,"page:unload":this._onPageUnload}};return o.prototype={start:function(){this._pageIndex=0,this.reset(),this._autoPlayOrder=s.getNested(window.site_vars,"autoplay","default")||[],i.attach(this.pubSub,this)},reset:function(){this._currentModules={},this._playedModules=[]},stop:function(){i.unattach(this.pubSub,this)},register:function(e,i){t.isFunction(i)&&(this._currentModules[e]=i)},_onPageLoad:function(){n.getActiveSlotStatistics().done(t.bind(function(){this._go(0,this._pageIndex)},this))},_onPageUnload:function(){this._pageIndex++,this.reset()},_go:function(e,i){i===this._pageIndex&&this._triggerAutoPlay(e||0).then(t.bind(function(){this._go(e+1,i)},this))},_triggerAutoPlay:function(i){var n=this._getAutoPlayResult(i);return n&&t.isFunction(n.then)?n:e.Deferred(t.bind(function(e){n===!1?e.reject():n===!0?e.resolve():(console.error("AutoPlayManager: Invalid return value from "+this._autoPlayOrder[i]+".startAutoPlay()"),e.resolve())},this))},_getAutoPlayResult:function(e){var t=this._autoPlayOrder[e],i=this._playedModules,n=this._currentModules[t];return n?(this._playedModules=this._playedModules.concat(t),n(i)):e<this._autoPlayOrder.length}},new o}),define("managers/abtestmanager",["jquery","underscore","utils","state","pubsub","cookie"],function(e,t,i,n,s){"use strict";var o=function(){this.pubSub={"pageInfo:set":this._onPageInfoSet}};return o.prototype={start:function(){s.attach(this.pubSub,this),this.slotKey="ab_test_slot",this.cid=t.uniqueId("c"),this.userTestSlot=this._getUserTestSlot()},stop:function(){s.unattach(this.pubSub,this),this._clearUserTestSlot()},_onPageInfoSet:function(){},getAllTests:function(){return n.getActivePageInfo().abtests||[]},getAllCurrentTests:function(){return t.filter(this.getAllTests(),this._isTestCurrent)},getTestById:function(e){return t.find(this.getAllTests(),function(t){return t.id===e})},getVariantById:function(e,n){var s=this.getTestById(e),o=i.getNested(s,"variants");return o?t.find(o,function(e){return e.id===n}):void 0},getUserActiveTest:function(){return t.find(this.getAllTests(),function(e){if(this._isActiveUrlPattern(e.urlRegex)&&this._isTestCurrent(e)){var t=this.getUserActiveVariant(e.variants);if(t)return e.activeVariant=t,e.controlVariant=this.getControlVariant(e),!0}},this)},getUserActiveTestString:function(e){return e=e||this.getUserActiveTest(),e?i.getNested(e,"id")+"_"+i.getNested(e,"activeVariant","id"):void 0},getUserActiveTestId:function(e){return e=e||this.getUserActiveTest(),e?i.getNested(e,"id"):void 0},getUserActiveVariantId:function(e){return e=e||this.getUserActiveTest(),e?i.getNested(e,"activeVariant","id"):void 0},getUserActiveVariant:function(e){if(e)return t.find(e,function(e){return this.userTestSlot>=e.trafficRange.start&&this.userTestSlot<=e.trafficRange.end},this);var n=this.getUserActiveTest();return n?i.getNested(n,"activeVariant"):void 0},getUserActiveTestOptions:function(t){return t=t||this.getUserActiveTest(),t?e.extend(i.getNested(t,"defaultOptions"),i.getNested(t,"activeVariant","options")):void 0},getControlVariant:function(e){var i=e?e.variants:this.getUserActiveTest().variants;return t.find(i,function(e){return e.control===!0})},isUserInActiveCtrlCompareGrp:function(e){if(e=e||this.getUserActiveTest(),e&&!e.activeVariant.control){var t=i.getNested(e.activeVariant,"trafficRange"),n=i.getNested(e.controlVariant,"trafficRange"),s=n.end-n.start;return this.userTestSlot<=t.start+s}},_getUserTestSlot:function(){return this._readUserTestSlot()||this._setUserTestSlot()},_readUserTestSlot:function(){return JSON.parse(window.localStorage.getItem(this.slotKey))},_setUserTestSlot:function(){var e=Math.floor(100*Math.random())+1;try{window.localStorage.setItem(this.slotKey,JSON.stringify(e)),window.localStorage.removeItem("wfm_abtestgroup"),window.localStorage.removeItem("wf_ab_test_slot")}catch(t){console.error("Failed saving userTestSlot",t.stack||t.stacktrace||t.message)}return e},_clearUserTestSlot:function(){window.localStorage.removeItem(this.slotKey)},_setUserActiveTestCookie:function(){t.each(this.getAllCurrentTests(),function(t){var i=this.getUserActiveVariant(t.variants);i&&(i.trafficRange.start>0&&i.trafficRange.end<101?e.cookie("wf_ab_test",t.id+"_"+i.id,{expires:new Date(t.endTime)}):console.warn("The trafficRange for variant for A/B Test "+t.name+" variant "+i.id+" is outside of the allowed range (1-100).  No segmentation cookie is being set."))},this)},_isTestCurrent:function(e){var t=new Date;return e.endTime&&new Date(e.endTime)<t?!1:e.startTime&&new Date(e.startTime)>t?!1:!0},_isActiveUrlPattern:function(e){return new RegExp(e).test(window.location.pathname)},_registerEvents:function(e,n){t.each(e,function(e){e.selector&&i.get("body").on("click."+this.cid,e.selector,function(){s.trigger("abtesttrack",n)})},this)}},window.abTestManager=new o,window.abTestManager}),define("site-manager",["jquery","underscore","backbone","utils","pubsub","state","managers/routemanager","managers/autoplay","managers/abtestmanager"],function(e,t,i,n,s,o,a,r,l){var h=i.View.extend({el:"body",initialize:function(){window.appViewEventProxy=s,window.Utils=n,window.siteManager=this,this.DEBUG=n.get("DEBUG"),this.$win=n.get("win"),this.$top=n.get("scrollEl"),this.pubSub={scrollTop:this.scrollTop},s.attach(this.pubSub,this)},start:function(e,i){this.$win.on("resize."+this.cid,t.throttle(function(){s.trigger("resize:app")},50)).trigger("resize"),this.$el.on("click."+this.cid,"a,area",t.bind(this.triggerRoute,this)),this.$el.on("submit."+this.cid,"form.ui-ajax-form",t.bind(this.triggerForm,this)),e&&(window.header=this.header=new e),a.start(i||void 0===i),o.start(this.header),r.start(),l.start()},getHeader:function(){return this.header},scrollTop:function(e,t){return this.header?this.header.scrollTop(e,t):0},stop:function(){this.$el.off("."+this.cid),this.$win.off("."+this.cid),r.stop(),o.stop(),a.stop(),l.stop()},destroy:function(){this.undelegateEvents(),window.header&&delete window.header,delete window.appViewEventProxy,delete window.Utils,s.unattach(this.pubSub,this)},triggerRoute:function(t){var i=e(t.currentTarget),n=e.trim(i.attr("href"));t.isDefaultPrevented()||this._isMetaKey(t)?s.trigger("track",{event:t,url:n}):i.attr("target")?(s.trigger("track",{event:t,url:n}),this._goPopup(i,n)&&t.preventDefault()):n?(t.preventDefault(),a.goTo(n,i.data("trackLabel")||i.data("uotrack")||i.data("ht"),t)):(s.trigger("track",{event:t}),t.preventDefault())},_isMetaKey:function(e){return e.metaKey||e.ctrlKey||e.altKey||2==e.which},_goPopup:function(e,t){var i=e.attr("target");return"_popup"===i||"_blank"===i&&void 0!==e.data("popup")?(n.openPopup(t,e.data("popup-width"),e.data("popup-height")),!0):void 0},triggerForm:function(i){var n=e(i.currentTarget),s=n.data("mapping"),o={},r=n.attr("action");i.isDefaultPrevented()||(s&&(e.each(n.serializeArray(),function(e,t){o[t.name]=t.value}),r+=t.template(s,o)),i.preventDefault(),a.goTo(r,n.data("trackLabel")||n.data("uotrack")||n.data("ht"),i))}});return new h}),define("base-app",["jquery","underscore","baseview","state","managers/trafficcop","site-manager","utils","pubsub","managers/resourcemanager","managers/routemanager"],function(e,t,i,n,s,o,a,r,l,h){"use strict";var d=i.extend({currentPath:"",initialize:function(t){this._animId=0,this._fixedOffset=null,this.$top=a.get("scrollEl"),this.appRevealed=!1,this.pubSub=e.extend({"header:fixed":this._onHeaderFixed,"header:unfixed":this._onHeaderUnfixed},this.pubSub),i.prototype.initialize.call(this,t)},isRevealed:function(){return this.appRevealed},revealApp:function(e,t,i,n,s){var o=this._buildRequestInfo(e,t,n,s);return i?"rejected"===i.state()?i:this._handleAsyncReveal(i,o):this._handleInitialReveal(o)},_buildRequestInfo:function(t,i,n,s){return{fromUrl:t,toUrl:i,animId:++this._animId,resourcePromise:n||e.Deferred().resolve(),modulePromise:e.Deferred(),paused:s}},_handleInitialReveal:function(i){var n=e(".site-header").next();n.length||(n=a.get("body")),this.setElement(n);var s=this._setPageInfo(n,i);return this._isCorrectApp(s.jsUrl).then(t.bind(function(){return this._triggerAfterPageReveal(i)},this))},_handleAsyncReveal:function(i,n){var s;return"resolved"===i.state()?i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,n).then(t.bind(function(){return this._updateState(n),this._revealAppMarkup(e,n).then(t.bind(function(){return this._finishReveal(e,n)},this))},this))},this)):(s=this.getRevealAppLoader(n.toUrl),s instanceof e||(s=e(s)),this._revealAppMarkup(s,n).then(t.bind(function(){return i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,n).then(t.bind(function(){return this._updateState(n),this._handleRevealLoaderContentSwap(e,n).then(t.bind(function(){return this.setElement(e,!1),this._finishReveal(e,n)},this))},this))},this))},this)))},_updateState:function(e){e.paused||n.updateState()},_revealAppMarkup:function(t,i){this._insertAppMarkup(t,i.paused);var n=this._safeCall("animateRevealApp",i.fromUrl,i.toUrl,i.paused);return n?s.addAnimation(n):e.Deferred().resolve()},_handleRevealLoaderContentSwap:function(t,i){return i.animId!==this._animId?e.Deferred().reject():this.swapContent(this.$el,t,i.paused,this.getHash(i.toUrl))},_finishReveal:function(t,i){return i.animId!==this._animId?e.Deferred().reject():(i.paused&&this.setFixedPosition(this.$el.offset().top),this._triggerAfterPageReveal(i))},_fetchPageModules:function(e,t){t.paused?t.modulePromise.resolve():t.resourcePromise.done(function(){l.fetchPageModules(e.js_modules).done(t.modulePromise.resolve)})},_insertAppMarkup:function(t,i){var n=e(".site-header");t.hide(),this.setElement(t,!1),this.$el.insertAfter(n),i&&this.setFixedPosition(n.outerHeight())},changePage:function(e,t,i,n,s){var o=this._buildRequestInfo(e,t,n,s);return this.destroyModules(),i?this._handleChangePageRequest(i,o):this._handleChangePageNoRequest(o)},_handleChangePageNoRequest:function(e){return this._fetchPageModules(this.pageInfo,e),this._triggerAfterPageReveal(e)},_handleChangePageRequest:function(i,s){var o=this.animateChangePagePreData(s.fromUrl,s.toUrl);return o||this._triggerGenericLoader(i),i=i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,s).then(function(){return e})},this)),e.when(i,o).then(t.bind(function(e){return s.paused||n.updateState(),this._finishChangePage(e,s)},this))},_triggerGenericLoader:function(e){"pending"===e.state()&&(this.activateLoader(),e.always(t.bind(function(){this.deactivateLoader()},this)))},_finishChangePage:function(i,n){if(n.animId!==this._animId)return e.Deferred().reject();var s=this.animateChangePagePostData(n.fromUrl,n.toUrl,i,n.paused)||e.Deferred().resolve();return n.paused&&this.setFixedPosition(this.$el.offset().top),s.then(t.bind(function(){return this._triggerAfterPageReveal(n)},this))},swapContent:function(t,i,n,s){return this.isSafari5||this.isApple||n?(i.insertAfter(t),t.remove(),e.Deferred().resolve()):this._crossFade(t,i,s)},_crossFade:function(e,t,i){var n=parseInt(e.css("top"),10)||0;return n-=a.getScrollPosition(),t.css({"z-index":100}),e.css({position:"absolute","z-index":101,opacity:1,top:n}),t.insertAfter(e),i&&this._scrollToHashTag(t,i)||o.scrollTop(0),this.animate(e,"opacity",0,this.options.animations.fadeIn.duration).always(function(){t.css({"z-index":""}),e.remove()})},_scrollToHashTag:function(e,t){var i=this._getOffset(e,t);return i.top?(this.$top.scrollTop(i.top-this.$el.offset().top),!0):void 0},_getOffset:function(e,t){try{return e.find("a[name="+t+"]").offset()||{}}catch(i){console.warn("Invalid hashtag",t)}return{}},pause:function(){this.destroyModules(!1,!0)},getHash:function(e){var t=e.indexOf("#");return-1!==t?e.substring(t+1):null},_triggerAfterPageReveal:function(i){return e.when(i.resourcePromise,i.modulePromise).done(t.bind(function(e,t){i.animId===this._animId&&(i.paused||this._initPage(null!==i.fromUrl,e,t),this._safeCall("afterPageReveal",i.fromUrl,i.toUrl,i.paused,e&&e[0]),this.appRevealed=!0,this.currentPath=i.toUrl,i.paused||this.trackPageLoad(this.pageInfo))},this))},_safeCall:function(e){try{return this[e].apply(this,Array.prototype.slice.call(arguments,1))}catch(t){console.error("View threw an exception on "+e,t.stack||t.stacktrace||t.message)}},_initPage:function(e,t,i){e&&(this.delegateEvents(),this._updatePageTitle()),this._initModules(t&&t.length>1?t[1].concat(i||[]):i)},_triggerBeforePageReveal:function(e,t){this._safeCall("beforePageReveal",t.fromUrl,t.toUrl,e,t.paused);var i=this._setPageInfo(e,t);return this._isCorrectApp(i.jsUrl)},_isCorrectApp:function(t){var i=this;return e.Deferred(function(e){if(t){var n=h.getInfo(t);if(n&&n.app.AppClass.prototype!==Object.getPrototypeOf(i))return void e.reject("InvalidApp",n)}e.resolve()})},_setPageInfo:function(e,t){var i=this.pageInfo=this._safeCall("parsePageInfo",e)||{};return this._verifyPageInfo(i),this._fetchPageModules(i,t),r.trigger("pageInfo:set",i),i},_verifyPageInfo:function(e){e.templatetype=e.templatetype||"",e.ssts=e.ssts||"bugpages",e.cst=e.aws||e.cst||"undefined"},_updatePageTitle:function(){if("None"===(this.pageInfo.seotitle||"None")){var e=a.getNested(window.site_vars,"display_name");e&&(document.title=e)}else document.title=this.pageInfo.seotitle},removeApp:function(e,i){return this._animId++,this._safeCall("beforeAppRemove",e,i),this.destroyModules(!1),this._triggerAnimateRemoveApp(e,i).always(t.bind(function(){this._safeCall("afterAppRemove",e,i),this._safeDestroy()},this))},_triggerAnimateRemoveApp:function(t,i){var n=this._safeCall("animateRemoveApp",t,i);return n?s.addAnimation(n):e.Deferred().resolve()},_safeDestroy:function(){try{this.destroy(!0)}catch(e){console.error("View threw an exception on destroy: ",e.stack||e.stacktrace||e.message),this.$el.remove()}},getWindowOffset:function(){return this.el?this.el.getBoundingClientRect():{top:0,left:0}},animateRevealApp:function(t,i,n){return this.isApple&&n?e.Deferred().resolve():this.show(!0)},animateRemoveApp:function(){return this.hide(!0)},animateChangePagePreData:function(){return null},animateChangePagePostData:function(e,t,i,n){var s=this.swapContent(this.$el,i,n,this.getHash(t));return this.setElement(i,!1),s},setFixedPosition:function(e,t){t||!this.isSafari5&&!this.isApple?(this._header=o.getHeader(),this._header?this._header.isFixed()?(this._fixedOffset=this._header.isOpen()?e-this._header.getFixedThreshold():e,this.$el.css({position:"fixed",top:e})):(this._fixedOffset=e=this.$el.offset().top,this.$el.css({position:"absolute",top:e})):this._fixedOffset=e):this.$el.hide()},clearFixedPosition:function(e){this._fixedOffset=null,e||!this.isSafari5&&!this.isApple?this.$el.css({position:"",top:""}):this.$el.show()},_onHeaderFixed:function(){this._header&&null!==this._fixedOffset&&(this._fixedOffset-=this._header.getFixedThreshold(),this.$el.css({position:"fixed",top:this._fixedOffset}))},_onHeaderUnfixed:function(){this._header&&null!==this._fixedOffset&&(this._fixedOffset+=this._header.getFixedThreshold(),this.$el.css({position:"absolute",top:this._fixedOffset}))},activateLoader:function(){},deactivateLoader:function(){},beforeAppRemove:function(){},afterAppRemove:function(){},beforePageReveal:function(){},afterPageReveal:function(e,t,i,n){n&&(this.subviews.page=new n({el:this.$el}))},getRevealAppLoader:function(){return'<section class="ui-loading dark-medium ui-app-loader"></section>'},beforeOverlayRemove:function(){},afterOverlayReveal:function(){},getClientAdInfo:function(){return{}},parsePageInfo:function(e){return JSON.parse(e.find(".pageinfo").eq(0).html())||{}},getClientInfo:function(){return{}},trackPageLoad:function(e){t.defer(function(){s.getAnimationCompletion().done(function(){r.trigger("page:load",e)})})},buildModules:function(e){return l.fetchPageModules(e).done(t.bind(this._initModules,this))},_initModules:function(e){this.destroyed||t.each(e,this._initModule,this)},_initModule:function(i){var n=i.selector,s=this.seenModules[i.name]||0;i.position&&(n="#module-position-"+i.position+n+",#module-position-"+i.position+" "+n),this.$(n).each(t.bind(function(t,n){var o=e.extend(!0,{},i.options);o.el=n,o.layoutType=i.layoutType;try{this.subviews[i.name+s]=new i.ModuleClass(o)}catch(a){console.error("failed loading module "+i.name,a.stack||a.stacktrace||a.message)}s+=1},this)),this.seenModules[i.name]=s}});return d}),define("apps/contact-us-staff",["jquery","underscore","base-app","utils"],function(e,t,i,n){var s=i.extend({events:{"click .js-cufwa-jumper":"jumpToGroup"},beforePageReveal:function(){var e=n.get("body");e.hasClass("cufwa-body")||e.addClass("cufwa-body")},beforeAppRemove:function(){e("body").removeClass("cufwa-body")},jumpToGroup:function(t){t.preventDefault();var i=e(t.currentTarget).data("anchor"),n=this.$(".js-cufwa-jump[data-anchor='"+i+"']");e("html, body").animate({scrollTop:n.offset().top-60},500)}});return s}),define("apps/interactives",["jquery","underscore","base-app"],function(e,t,i){var n=i.extend({trackPageLoad:function(e){window.top===window&&i.prototype.trackPageLoad(e)}});return n}),define("apps/member-guide-apps",["jquery","base-app","site-manager"],function(e,t){var i=t.extend({events:{"click .js-mga-apps-icon-link":"showApp"},showApp:function(t){t.preventDefault();var i=e(t.currentTarget),n=i.data("app-number");this.$(".js-mga-apps-icon-link").removeClass("mga-icon-active"),this.$(".js-mga-panel[data-app-number]").removeClass("mga-active-app"),this.$(".js-mga-apps-icon-link[data-app-number="+n+"]").addClass("mga-icon-active"),0===n?this.$(".js-mga-panel[data-app-number]").addClass("mga-active-app"):this.$(".js-mga-panel[data-app-number="+n+"]").addClass("mga-active-app");var s=e(window).width();670>s&&e("html, body").animate({scrollTop:this.$(".mga-page-content").offset().top-60},500)},afterPageReveal:function(){e("body").addClass("mga-body").addClass("mga-body-subpage"),e(".js-mga-container").addClass("mga-body-subpage").addClass("mga-section-inline")},beforeAppRemove:function(){e("body").removeClass("mga-body")}});return i}),define("apps/simple-overlay",["jquery","underscore","backbone","base-app","state","utils","site-manager","managers/routemanager","pubsub","user-manager"],function(e,t,i,n,s,o,a,r,l,h){"use strict";var d=n.extend({el:"#overlay",events:{"click .transition-wrap":"close","click .close-overlay":"close"},initialize:function(i){i=e.extend(!0,{template:'<div id="overlay" class="no-transition"><div class="transition-wrap"><article class="asset clearfix story ui-loading light-medium"></article></div></div>'},i),t.bindAll(this,"resizeHandler"),this.win=o.get("win"),this.scrollEl=o.get("scrollEl"),this.header=a.getHeader(),this.pubSub={"header:fixed":this.onHeaderFixed,"header:unfixed":this.onHeaderUnfixed};
var s=t.throttle(this.resizeHandler,50);this.win.on("resize."+this.cid,s),this.resizeHandler(),n.prototype.initialize.call(this,i)},destroy:function(e){this.win.off("."+this.cid),n.prototype.destroy.call(this,e)},resizeHandler:function(){this.winSize={width:this.win.width(),height:this.win.height()},this.header&&(this.winSize.height-=this.header.getCollapsedHeight()),this.setArticleMinHeight(this.$(".transition-wrap:first .asset"))},setArticleMinHeight:function(e){e.length&&e.outerHeight()<this.winSize.height&&e.css("min-height",this.winSize.height)},onHeaderFixed:function(){this.positionCloseButton("fixed"),this._onHeaderFixed()},onHeaderUnfixed:function(){this.positionCloseButton("absolute"),this._onHeaderUnfixed()},beforeAppRemove:function(){this.win.off("."+this.cid),this.positionCloseButton("absolute",o.getScrollPosition())},animateRemoveApp:function(e,t){return this.isSafari5?this.hide():(this.header&&this.header.updateNavigation(t),this.$el.css({position:"relative",opacity:1}),this.animate(this.$el,"opacity",0,250))},beforePageReveal:function(e,t,i){i.find(".asset").css("min-height",this.winSize.height)},animateRevealApp:function(){var i=this.$(".transition-wrap"),n=this.winSize.height;if(this.isSafari5||!e.support.css.transform)return i.css("height",n),this.show();i.css({height:n,overflow:"hidden",opacity:0}),i[0].style[e.support.css.transform.cssName]="scale(0.4)",i[0].style[e.support.css.transform.originCssName]="50% "+.25*n+"px",i[0].style[this.transitionCssName]=e.support.css.transform.cssHyphenName+" 300ms linear, opacity 300ms linear",this.$el.show().css({opacity:1,display:"block"}),t.delay(t.bind(function(){i[0].style[e.support.css.transform.cssName]="scale(1.0)",i[0].style.opacity=1},this));var s=e.support.css.transition.registerTransitionEndListener(i[0]);return s.done(t.bind(function(){i[0].style[e.support.css.transform.cssName]="",i[0].style[this.transitionCssName]="",i[0].style[e.support.css.transform.originCssName]=""},this)),s.promise()},getRevealAppLoader:function(){return this.options.template},animateChangePagePreData:function(){var t=this.winSize.height,i=o.getScrollPosition(),n=this.$(".transition-wrap:first");this.prepareContentForTransition(n,i,t);var s=e(this.options.template),r=s.find(".transition-wrap");return this.prepareContentForTransition(r,0,t),this.$el.prepend(r),a.scrollTop(0),this.positionCloseButton("absolute",i,n),this.swapContent(n,r)},prepareContentForTransition:function(e,t,i){e.css({height:i}),e.children().css({top:-1*t})},animateChangePagePostData:function(e,i,n){var s=n.find(".transition-wrap");return s.css("height",this.winSize.height),this.setArticleMinHeight(s.find(".asset")),this.swapContent(this.$(".transition-wrap:first"),s,this.getHash(i)).done(t.bind(function(){s.css("height","")},this))},afterPageReveal:function(e,t,i,n){var s=this.$(".transition-wrap:first");s.css({height:"",overflow:"visible"}),this.currentSection=this.getSectionName(),this.preloadedUrl=this.options.preloadedUrl||this.currentSection||"/",this.header&&this.header.updateNavigation((this.pageInfo||{}).ssts),null===e&&this.preloadPath(),n&&(this.subviews.view=new n({el:s,path:t})),this.header&&this.header.isFixed()&&this.positionCloseButton("fixed")},parsePageInfo:function(){var e=h.getAccount("firefly"),t=n.prototype.parsePageInfo.apply(this,arguments),i="nothitpaywall";if(e){var s=e.getViewsCookie().viewsRemaining;s>=0&&(i=0===s?"nofreearticlesremaining":s)}return t.numPageViewsLeft=i,t},preloadPath:function(){s.preloadPath(this.preloadedUrl)},positionCloseButton:function(e,t,i){var n=i?i.find(".close-wrap"):this.$(".close-wrap");n.css("absolute"===e?{position:e,"margin-top":"",top:t||0}:{position:e,"margin-top":-80,top:""})},getSectionName:function(){var e,i="",n=this.pageInfo||{};if(n&&(n.ss||n.ssts)){if(e=n.ss,!e){e=n.ssts;var s=e.indexOf("/");s>0&&(e=e.substring(0,s)),-1===t.indexOf(o.getSiteSections(),e)&&(e="")}i=e,e.indexOf("/")>0&&(i=e.substring(0,e.indexOf("/"))),i="home"===i?"/":"/"+i+"/"}return i},close:function(t){if(!t||t.target===t.currentTarget){var i=e(t.currentTarget).attr("data-ht")||"modalclose";return l.trigger("heattrack",i),r.goTo(s.getPreloadedUrl()||"/"),t?!1:void 0}}});return d}),define("modules/global/footer",["jquery","underscore","baseview","easing","pubsub","utils"],function(e,t,i,n,s,o){var a=i.extend({events:{"click .site-index":"toggle","click .footer-more-trigger":"showMore"},initialize:function(e){this.$scrollEl=o.get("scrollEl"),this.$nav=this.$("nav"),this.$toggle=this.$(".site-index"),i.prototype.initialize.call(this,e)},showMore:function(t){t.preventDefault();var i=e(t.currentTarget);i.hide().siblings(".footer-more-item").show()},toggle:function(e){e&&e.preventDefault();var t=this.$el.offset().top-(o.get("headerHeight")||0);this.$toggle.toggleClass("open"),this.$scrollEl.animate({scrollTop:t},500,"easeInOutCubic"),this.$nav.slideToggle(500,"easeInOutCubic")}});return a}),define("apps/member-guide-social",["jquery","base-app","site-manager"],function(e,t){var i=t.extend({events:{"click .js-mga-icon-link":"showSocial"},showSocial:function(t){t.preventDefault();var i=e(t.currentTarget).data("network-type");this.$(".js-mga-icon-link").removeClass("mga-icon-active"),this.$(".js-mga-page-panel").removeClass("mga-page-active"),this.$(".js-mga-icon-link[data-network-type="+i+"]").addClass("mga-icon-active"),this.$(".js-mga-page-panel[data-network-type="+i+"]").addClass("mga-page-active");var n=e(window).width();670>n&&e("html, body").animate({scrollTop:this.$(".mga-page-content").offset().top-60},500)},afterPageReveal:function(){e("body").addClass("mga-body mga-body-subpage"),e(".js-mga-container").addClass("mga-body-subpage mga-section-inline")},beforeAppRemove:function(){e("body").removeClass("mga-body mga-body-subpage")}});return i});var swfobject=function(){function e(){if(!U){try{var e=N.getElementsByTagName("body")[0].appendChild(m("span"));e.parentNode.removeChild(e)}catch(t){return}U=!0;for(var i=O.length,n=0;i>n;n++)O[n]()}}function t(e){U?e():O[O.length]=e}function i(e){if(typeof R.addEventListener!=$)R.addEventListener("load",e,!1);else if(typeof N.addEventListener!=$)N.addEventListener("load",e,!1);else if(typeof R.attachEvent!=$)v(R,"onload",e);else if("function"==typeof R.onload){var t=R.onload;R.onload=function(){t(),e()}}else R.onload=e}function n(){B?s():o()}function s(){var e=N.getElementsByTagName("body")[0],t=m(P);t.setAttribute("type",L);var i=e.appendChild(t);if(i){var n=0;!function(){if(typeof i.GetVariable!=$){var s=i.GetVariable("$version");s&&(s=s.split(" ")[1].split(","),V.pv=[parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10)])}else if(10>n)return n++,void setTimeout(arguments.callee,10);e.removeChild(t),i=null,o()}()}else o()}function o(){var e=z.length;if(e>0)for(var t=0;e>t;t++){var i=z[t].id,n=z[t].callbackFn,s={success:!1,id:i};if(V.pv[0]>0){var o=g(i);if(o)if(!b(z[t].swfVersion)||V.wk&&V.wk<312)if(z[t].expressInstall&&r()){var d={};d.data=z[t].expressInstall,d.width=o.getAttribute("width")||"0",d.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(d.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(d.align=o.getAttribute("align"));for(var c={},u=o.getElementsByTagName("param"),p=u.length,f=0;p>f;f++)"movie"!=u[f].getAttribute("name").toLowerCase()&&(c[u[f].getAttribute("name")]=u[f].getAttribute("value"));l(d,c,i,n)}else h(o),n&&n(s);else w(i,!0),n&&(s.success=!0,s.ref=a(i),n(s))}else if(w(i,!0),n){var m=a(i);m&&typeof m.SetVariable!=$&&(s.success=!0,s.ref=m),n(s)}}}function a(e){var t=null,i=g(e);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=$)t=i;else{var n=i.getElementsByTagName(P)[0];n&&(t=n)}return t}function r(){return!W&&b("6.0.65")&&(V.win||V.mac)&&!(V.wk&&V.wk<312)}function l(e,t,i,n){W=!0,S=n||null,T={success:!1,id:i};var s=g(i);if(s){"OBJECT"==s.nodeName?(C=d(s),x=null):(C=s,x=i),e.id=E,(typeof e.width==$||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==$||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),N.title=N.title.slice(0,47)+" - Flash Player Installation";var o=V.ie&&V.win?"ActiveX":"PlugIn",a="MMredirectURL="+R.location.toString().replace(/&/g,"%26")+"&MMplayerType="+o+"&MMdoctitle="+N.title;if(typeof t.flashvars!=$?t.flashvars+="&"+a:t.flashvars=a,V.ie&&V.win&&4!=s.readyState){var r=m("div");i+="SWFObjectNew",r.setAttribute("id",i),s.parentNode.insertBefore(r,s),s.style.display="none",function(){4==s.readyState?s.parentNode.removeChild(s):setTimeout(arguments.callee,10)}()}c(e,t,i)}}function h(e){if(V.ie&&V.win&&4!=e.readyState){var t=m("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(d(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(d(e),e)}function d(e){var t=m("div");if(V.win&&V.ie)t.innerHTML=e.innerHTML;else{var i=e.getElementsByTagName(P)[0];if(i){var n=i.childNodes;if(n)for(var s=n.length,o=0;s>o;o++)1==n[o].nodeType&&"PARAM"==n[o].nodeName||8==n[o].nodeType||t.appendChild(n[o].cloneNode(!0))}}return t}function c(e,t,i){var n,s=g(i);if(V.wk&&V.wk<312)return n;if(s)if(typeof e.id==$&&(e.id=i),V.ie&&V.win){var o="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?o+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(o+=" "+a+'="'+e[a]+'"'));var r="";for(var l in t)t[l]!=Object.prototype[l]&&(r+='<param name="'+l+'" value="'+t[l]+'" />');s.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+o+">"+r+"</object>",j[j.length]=e.id,n=g(e.id)}else{var h=m(P);h.setAttribute("type",L);for(var d in e)e[d]!=Object.prototype[d]&&("styleclass"==d.toLowerCase()?h.setAttribute("class",e[d]):"classid"!=d.toLowerCase()&&h.setAttribute(d,e[d]));for(var c in t)t[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&u(h,c,t[c]);s.parentNode.replaceChild(h,s),n=h}return n}function u(e,t,i){var n=m("param");n.setAttribute("name",t),n.setAttribute("value",i),e.appendChild(n)}function p(e){var t=g(e);t&&"OBJECT"==t.nodeName&&(V.ie&&V.win?(t.style.display="none",function(){4==t.readyState?f(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function f(e){var t=g(e);if(t){for(var i in t)"function"==typeof t[i]&&(t[i]=null);t.parentNode.removeChild(t)}}function g(e){var t=null;try{t=N.getElementById(e)}catch(i){}return t}function m(e){return N.createElement(e)}function v(e,t,i){e.attachEvent(t,i),H[H.length]=[e,t,i]}function b(e){var t=V.pv,i=e.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,t[0]>i[0]||t[0]==i[0]&&t[1]>i[1]||t[0]==i[0]&&t[1]==i[1]&&t[2]>=i[2]?!0:!1}function y(e,t,i,n){if(!V.ie||!V.mac){var s=N.getElementsByTagName("head")[0];if(s){var o=i&&"string"==typeof i?i:"screen";if(n&&(A=null,k=null),!A||k!=o){var a=m("style");a.setAttribute("type","text/css"),a.setAttribute("media",o),A=s.appendChild(a),V.ie&&V.win&&typeof N.styleSheets!=$&&N.styleSheets.length>0&&(A=N.styleSheets[N.styleSheets.length-1]),k=o}V.ie&&V.win?A&&typeof A.addRule==P&&A.addRule(e,t):A&&typeof N.createTextNode!=$&&A.appendChild(N.createTextNode(e+" {"+t+"}"))}}}function w(e,t){if(q){var i=t?"visible":"hidden";U&&g(e)?g(e).style.visibility=i:y("#"+e,"visibility:"+i)}}function _(e){var t=/[\\\"<>\.;]/,i=null!=t.exec(e);return i&&typeof encodeURIComponent!=$?encodeURIComponent(e):e}{var C,x,S,T,A,k,$="undefined",P="object",D="Shockwave Flash",I="ShockwaveFlash.ShockwaveFlash",L="application/x-shockwave-flash",E="SWFObjectExprInst",M="onreadystatechange",R=window,N=document,F=navigator,B=!1,O=[n],z=[],j=[],H=[],U=!1,W=!1,q=!0,V=function(){var e=typeof N.getElementById!=$&&typeof N.getElementsByTagName!=$&&typeof N.createElement!=$,t=F.userAgent.toLowerCase(),i=F.platform.toLowerCase(),n=/win/.test(i?i:t),s=/mac/.test(i?i:t),o=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,r=[0,0,0],l=null;if(typeof F.plugins!=$&&typeof F.plugins[D]==P)l=F.plugins[D].description,!l||typeof F.mimeTypes!=$&&F.mimeTypes[L]&&!F.mimeTypes[L].enabledPlugin||(B=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),r[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),r[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),r[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof R.ActiveXObject!=$)try{var h=new ActiveXObject(I);h&&(l=h.GetVariable("$version"),l&&(a=!0,l=l.split(" ")[1].split(","),r=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(d){}return{w3:e,pv:r,wk:o,ie:a,win:n,mac:s}}();!function(){V.w3&&((typeof N.readyState!=$&&"complete"==N.readyState||typeof N.readyState==$&&(N.getElementsByTagName("body")[0]||N.body))&&e(),U||(typeof N.addEventListener!=$&&N.addEventListener("DOMContentLoaded",e,!1),V.ie&&V.win&&(N.attachEvent(M,function(){"complete"==N.readyState&&(N.detachEvent(M,arguments.callee),e())}),R==top&&!function(){if(!U){try{N.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),V.wk&&!function(){return U?void 0:/loaded|complete/.test(N.readyState)?void e():void setTimeout(arguments.callee,0)}(),i(e)))}(),function(){V.ie&&V.win&&window.attachEvent("onunload",function(){for(var e=H.length,t=0;e>t;t++)H[t][0].detachEvent(H[t][1],H[t][2]);for(var i=j.length,n=0;i>n;n++)p(j[n]);for(var s in V)V[s]=null;V=null;for(var o in swfobject)swfobject[o]=null;swfobject=null})}()}return{registerObject:function(e,t,i,n){if(V.w3&&e&&t){var s={};s.id=e,s.swfVersion=t,s.expressInstall=i,s.callbackFn=n,z[z.length]=s,w(e,!1)}else n&&n({success:!1,id:e})},getObjectById:function(e){return V.w3?a(e):void 0},embedSWF:function(e,i,n,s,o,a,h,d,u,p){var f={success:!1,id:i};V.w3&&!(V.wk&&V.wk<312)&&e&&i&&n&&s&&o?(w(i,!1),t(function(){n+="",s+="";var t={};if(u&&typeof u===P)for(var g in u)t[g]=u[g];t.data=e,t.width=n,t.height=s;var m={};if(d&&typeof d===P)for(var v in d)m[v]=d[v];if(h&&typeof h===P)for(var y in h)typeof m.flashvars!=$?m.flashvars+="&"+y+"="+h[y]:m.flashvars=y+"="+h[y];if(b(o)){var _=c(t,m,i);t.id==i&&w(i,!0),f.success=!0,f.ref=_}else{if(a&&r())return t.data=a,void l(t,m,i,p);w(i,!0)}p&&p(f)})):p&&p(f)},switchOffAutoHideShow:function(){q=!1},ua:V,getFlashPlayerVersion:function(){return{major:V.pv[0],minor:V.pv[1],release:V.pv[2]}},hasFlashPlayerVersion:b,createSWF:function(e,t,i){return V.w3?c(e,t,i):void 0},showExpressInstall:function(e,t,i,n){V.w3&&r()&&l(e,t,i,n)},removeSWF:function(e){V.w3&&p(e)},createCSS:function(e,t,i,n){V.w3&&y(e,t,i,n)},addDomLoadEvent:t,addLoadEvent:i,getQueryParamValue:function(e){var t=N.location.search||N.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return _(t);for(var i=t.split("&"),n=0;n<i.length;n++)if(i[n].substring(0,i[n].indexOf("="))==e)return _(i[n].substring(i[n].indexOf("=")+1))}return""},expressInstallCallback:function(){if(W){var e=g(E);e&&C&&(e.parentNode.replaceChild(C,e),x&&(w(x,!0),V.ie&&V.win&&(C.style.display="block")),S&&S(T)),W=!1}}}}();define("libs/swfobject/swfobject",function(){}),define("partner/iab",["jquery","underscore","baseview","adLogger","libs/swfobject/swfobject"],function(e,t,i,n){"use strict";var s=i.extend({destroy:function(t){this.$markup&&this.$markup.remove(),this.$iabThirdParty.remove(),this.adData.cleanUpSelectors&&e(this.adData.cleanUpSelectors).remove(),i.prototype.destroy.call(this,t)},render:function(t){if(this.adData=t,this.$el.addClass("iab-risingstar"),this.$(".ad-slot").hide(),"flash"===t.adCreativeType)this.setupFlash(t);else if("image"===t.adCreativeType)this.setupImage(t);else if("third"===t.adCreativeType)return this.setupThirdParty(t);return e.Deferred().resolve()},setupFlash:function(i){var n={clickTag:i.clickUrl+i.clickThruUrl},s={allowscriptaccess:"always",wmode:"transparent"},o=i.flashAttr||{},a=t.uniqueId("flashiab_");this.$markup=e('<div id="'+a+'"></div>'),this.$el.append(this.$markup),window.swfobject&&window.swfobject.embedSWF(i.flashUrl,a,i.width,i.height,"9.0.0",null,n,s,o)},setupImage:function(t){this.$markup=e('<a href="'+t.clickUrl+t.clickThruUrl+'" target="_blank"><img src="'+t.imageUrl+'"></a>'),this.$el.append(this.$markup)},setupThirdParty:function(i){var s=document.createElement("iframe");if(s.id=s.name="google_ads_"+i.dfp.ecid,s.src="about:blank",s.width=i.width||0,s.height=i.height||0,s.width&&s.height||(s.style.display="none"),s.scrolling="no",s.marginWidth=0,s.marginHeight=0,s.frameBorder=0,s.className="iab-iframe",this.$el.append('<div class="iab-third-party"></div>'),this.$iabThirdParty=this.$(".iab-third-party"),this.$iabThirdParty[0].appendChild(s),s.doc=null,s.contentDocument?s.doc=s.contentDocument:s.contentWindow?s.doc=s.contentWindow.document:s.document&&(s.doc=s.document),!s.doc)return n.logError("IAB iFrame failed creation, container must be inserted into DOM before creating the iFrame"),e.Deferred().reject();var o="<!doctype html><head><script>window.template = "+JSON.stringify(i)+"; var inDapIF = true; var gnEbMinZIndex = 1; "+i.extraVars+'</script></head><body><script src="'+i.thirdPartyScript+'"></script><script>'+i.scriptOverrides+"</script></body></html>";return i.fullDump&&(o="<!doctype html><head><script>var inDapIF = true; var gnEbMinZIndex = 1;</script></head><body>"+i.thirdPartyTag+"</body></html>"),s.doc.open(),s.doc.write(o),this.$markup=e(s),e.Deferred(function(e){t.defer(function(){e.resolve()})}).promise()},onResize:function(){},onStopToClose:function(){}});return s}),define("partner/ad-position",["jquery","underscore","baseview","utils","admanager","managers/cachemanager","pubsub","partner/iab","adLogger"],function(e,t,i,n,s,o,a,r,l){"use strict";var h=i.extend({$head:e("head"),initialize:function(n){n=e.extend({adSizes:[],adPlacement:null,subSection:null,slotType:"in",adWidth:null,adHeight:null,onAdReady:null,onNoAd:null,beforeAdRender:null},n),this._debounceAdReady=t.debounce(this._adReady,30),this.$el.prop("id")||this.$el.prop("id",t.uniqueId("ad-position-")),i.prototype.initialize.call(this,n),this.tracked=!1,this.adState="pending",this.$el.css({width:"",height:"",display:""});var s=this.$el.closest(".partner-placement");s.attr("data-monetization-id",this.options.adPlacement.replace(/\/.*/,"")),s.attr("data-monetization-sizes",this.options.adSizes.join(","))},render:function(e,t){this.options.beforeAdRender&&this.options.beforeAdRender(e,t),t||e?this._renderHighImpact(e,t):this._adReady()},_renderHighImpact:function(e,t){this.adType=t,this.adData=e,l.logDebug("AdPosition HighImpact Ad recieved with type: "+t,e),"risingstar"===t||"generic"===t?this._renderHighImpactIAB(e):this._renderCustomAd(e)},_renderHighImpactIAB:function(e){var i=this.subviews.partnerView=new r({el:this.$el});i.render(e).done(t.bind(function(){this.destroyed||this._adReady()},this))},noAd:function(){this.adState="noad",this.options.onNoAd&&this.options.onNoAd()},getAdState:function(){return this.adState},_renderCustomAd:function(i){return i.dfp&&i.dfp.ecid?(i.html&&(this.$adEl=e(e.parseHTML(i.html,document,!0)),this.$el.append(this.$adEl)),i.stylesheet&&(this.$stylesheet=e('<link rel="stylesheet" data-ad-stylesheet="'+i.dfp.ecid+'" href="'+i.stylesheet+'">'),this.$head.append(this.$stylesheet)),void(i.script?(i.el=this.$el,n.requireSingleUseScript(i.script).done(t.bind(function(e){var t=this._getPubSubKey();if(!this.destroyed){i.initialWidth=this.options.adWidth,i.initialHeight=this.options.adHeight,a.on(t,this._debounceAdReady,this);try{this.subviews.partnerView=new e(i)}catch(n){l.logError("AdSlot("+this.options.adUnit+"): ad delivered threw exception on creation",n.stack||n.stacktrace||n.message)}}},this))):this._adReady())):void l.logError("invalid ad returned, no dfp/ecid found",i)},_getPubSubKey:function(){return"partner:"+this.adData.dfp.ecid+":ready"},destroy:function(e){"hasad"===this.adState&&this.$el.css({width:this.getWidth(),height:this.getHeight()}),this.destroyAdPlacement();var t=this.$el.closest(".partner-placement");t.removeAttr("data-monetization-id"),t.removeAttr("data-monetization-sizes"),this.destroyed=!0,i.prototype.destroy.call(this,e)},destroyAdPlacement:function(){if(this.tracked=!1,this.subviews.partnerView&&(this.stopAd(),this._dispatchToPartner("destroy",!1),this.subviews.partnerView=null),this.adData&&this.adData.script&&a.off(this._getPubSubKey(),this._debounceAdReady,this),this.adType=this.adData=null,this.$adEl)this.$adEl.remove(),this.$adEl=null;else if(this.$el.hasClass("partner-billboard-ad")){var t=n.getNested(window.site_vars,"ADS","cleanup_selectors");e(t).remove()}else this.$("iframe").remove(),this.$(".ad-slot > div").remove();this.$stylesheet&&(this.$stylesheet.remove(),this.$stylesheet=null)},getAdPlacement:function(){var e=this.options.adPlacement;return this.options.subSection&&(e+="/"+this.options.subSection),e},getAdSizes:function(){return this.options.adSizes},getSlotType:function(){return this.options.slotType},_adReady:function(){l.logDebug("AdPosition("+this.getAdPlacement()+") "+this.adType+" ready"),this.adData&&this.adData.script&&a.off(this._getPubSubKey(),this._debounceAdReady,this),this.adState="hasad",this.options.onAdReady?this.options.onAdReady(this.adData,this.adType):"in"===this.options.slotType&&(this.adType&&"risingstar"!==this.adType?this.playAd():(this.show(),this.$el&&this.$el.height()>1&&this.$el.addClass("partner-placement-visible")))},isAdReady:function(){var e="hasad"===this.adState;return e&&"blank"===n.getNested(this.adData,"adType")?(this.trackAd(),!1):e},getCreativeState:function(e,t){return this.adData&&this.adData.dfp&&this.adData.dfp.ecid?o.getValue("dfpc_"+this.adData.dfp.ecid,e,t):void l.logWarn("Attempted to get state on non high impact ad")},setCreativeState:function(e,t){this.adData&&this.adData.dfp&&this.adData.dfp.ecid?o.setValue("dfpc_"+this.adData.dfp.ecid,e,t):l.logWarn("Attempted to set state on non high impact ad")},getHeight:function(){return this.$el.outerHeight()},getWidth:function(){return this.$el.outerWidth()},showAd:function(e,t){this.$el.show(),this._dispatchToPartner("onShow",e,t),this.trackAd()},resizeAd:function(e,t){this.options.adWidth=e,this.options.adHeight=t,this._dispatchToPartner("onResize",e,t)},setInitialDimensions:function(e,t){this.options.adWidth=e,this.options.adHeight=t},_dispatchToPartner:function(e){var t,i=this.subviews.partnerView;if(i)if(i[e]){t=Array.prototype.slice.call(arguments,1),l.logDebug.apply(l,["AdPosition("+this.getAdPlacement()+") "+e].concat());try{i[e].apply(i,t)}catch(n){l.logError("Ad threw an exception in function "+e,n.stack||n.stacktrace||n.message)}}else l.logWarn("Ad does not implement "+e)},stopAd:function(){this._dispatchToPartner("onStopToClose"),s.updateActiveSlotStatistics(this.adType,"stopped")},pauseAd:function(){this._dispatchToPartner("onPause"),s.updateActiveSlotStatistics(this.adType,"paused")},resumeAd:function(){this._dispatchToPartner("onResume"),s.updateActiveSlotStatistics(this.adType,"playing")},trackAd:function(t){var i;if(!this.tracked&&this.adData){if(this.tracked=!0,this.adData.viewUrl){var n=e('<img src="'+this.adData.viewUrl+encodeURIComponent(window.site_static_url+"images/pixels/pixel-transparent.png")+'" style="display:none;">');this.$adEl?this.$adEl.append(n):(this.$adEl=n,this.$el.append(n)),l.logDebug("Fired Tracking Pixel",this.adData.viewUrl)}if("Yes"===this.adData.trackVCE&&this.adData.vCEUrl){t=t||this.$el,i=t.prop("id");var o=this.adData.vCEUrl.replace(/\[domid\]/g,i);s._createScript("vce_"+i,o,t),l.logDebug("Tracked vCE",o)}}},playAd:function(){this.trackAd(),this._dispatchToPartner("onPlay"),s.updateActiveSlotStatistics(this.adType,"playing")}});return h}),define("sharedAdPosition",["jquery","underscore","partner/ad-position","utils","admanager"],function(e,t,i,n,s){"use strict";var o=i.extend({initialize:function(t){t=e.extend({adType:null,defaultPosition:!1},t),i.prototype.initialize.call(this,t),s.registerSharedAdPosition(this)},isDefaultPosition:function(){return this.options.defaultPosition},getAdType:function(){return this.options.adType},refreshPosition:function(){s.refreshSharedAdPosition(this.getAdPlacement())},destroy:function(e){i.prototype.destroy.call(this,e),s.destroySharedAdPosition(this)}});return o}),define("modules/global/taboola",["jquery","underscore","utils","managers/cachemanager"],function(e,t,i,n){"use strict";var s=function(n){var s=i.getNested(window.site_vars,"THIRDPARTYAPI","Taboola")||{};this.options=e.extend({apiBase:s.apiBase+s.api_id,apiKey:s.apiKey,widgetUrl:"http://cdn.taboola.com/libtrc/"+s.publisher_id+"/loader.js",isWidgetPresent:s.widget,taboola_enabled:s.ENABLED},n),this.options.isWidgetPresent&&i.loadScript(this.options.widgetUrl,"_taboola",t.bind(this.getWidget,this))};return s.prototype={setUserTaboolaSession:function(e){n.setValue("taboola_user_session_id",e)},getUserTaboolaSession:function(){return n.getValue("taboola_user_session_id","init")},registerTaboolaClick:function(e,t,i){var n=this.options.apiBase+"/recommendations.notify-click?app.type=desktop&app.apikey="+this.options.apiKey+"&response.id="+i+"&item.type="+t+"&item.id="+e+"&response.session="+this.getUserTaboolaSession();(new Image).src=n},registerTaboolaVisible:function(e){var t=this.options.apiBase+"/recommendations.notify-visible?app.type=desktop&app.apikey="+this.options.apiKey+"&response.id="+e+"&response.session="+this.getUserTaboolaSession();(new Image).src=t},getRelated:function(e,n,s,o,a,r,l,h){if(this.options.taboola_enabled){if(!e)return;n=n||"video",s=s||"video",o=o||6,a=a||window.location.href,r=r||0,h=h===!1?h:!0,l=l||"";var d=this.options.apiBase+"/recommendations.get";d+="?output.callback=define&app.type=desktop&app.apikey="+this.options.apiKey,d+="&source.id="+r+"&source.url="+encodeURIComponent(a)+"&source.type="+n+"&rec.type="+s+"&rec.visible="+h+"&rec.count="+o+"&source.placement="+l+"&user.session="+this.getUserTaboolaSession(),i.requireSingleUseScript(d).done(t.bind(function(t){i.set("taboolaResponseID",t.id),t.list||(t.list={}),this.setUserTaboolaSession(t.session),h&&this.registerTaboolaVisible(t.id),e(t)},this))}},getWidget:function(i){var n=window.location.href;this.options.taboola_enabled&&(i.push({notify:"newPageLoad"}),t.each(this.options.widget,function(e){i.push({mode:e.mode,container:e.container,placement:e.placement,target_type:e.target_type,url:e.url})}),i.push(e.extend(this.options.pagetypeWidget,{url:n})))}},s}),define("directAdPosition",["jquery","underscore","partner/ad-position","state","admanager"],function(e,t,i,n,s){"use strict";var o=i.extend({initialize:function(t){t=e.extend({targeting:{},subSection:n.getActivePageInfo().cst,slotType:"in"},t),i.prototype.initialize.call(this,t),"in"==t.slotType&&this.refreshPosition()},prefetchAd:function(){return this.subviews.adSlot?!1:(this.adSlotPlacement=this.getAdPlacement(),this.subviews.adSlot=s.getAdSlot(this.adSlotPlacement,this.options.targeting,this.options.adSizes,this,this.options.slotType),!0)},setTargeting:function(e){this.options.targeting=e,this.subviews.adSlot&&this.subviews.adSlot.setTargeting(this.options.targeting)},destroy:function(){this.destroyAdSlot(),i.prototype.destroy.apply(this,arguments)},destroyAdSlot:function(){this.subviews.adSlot&&(this.subviews.adSlot.destroy(),this.subviews.adSlot=null)},setPageInfo:function(t){t.cst&&this.setSubSection(t.cst),this.setTargeting(e.extend(s.getPageAdTargeting(t),this.options.targeting))},setSubSection:function(e){this.options.subSection=e},refreshPosition:function(){this.adState="pending",this.subviews.adSlot&&this.adSlotPlacement!==this.getAdPlacement()&&(this.destroyAdPlacement(),this.destroyAdSlot()),this.prefetchAd()||(this.destroyAdPlacement(),this.subviews.adSlot.refresh())}});return o}),define("meteredAdPosition",["jquery","underscore","directAdPosition","utils","managers/cachemanager","admanager","adLogger"],function(e,t,i,n,s,o,a){"use strict";var r=i.extend({initialize:function(t){t=e.extend({slotType:"out",rateMeterId:null},t),i.prototype.initialize.call(this,t)},getDefaultThreshold:function(e){var t=e||this.options.meterThreshold||this.options.adPlacement,i=t.indexOf("/");-1!==i&&(t=t.substring(0,i));var s=n.getNested(window.site_vars,"ADS","THRESHOLDS",t.toUpperCase());return s||a.logError("Could not find default threshold for metered ad: "+t),s},tickMeter:function(e,t){var i=!1,n=this.getCurrentMeter(t);return n.length?(n[0]=Math.max(0,n[0]-1),n[0]<1&&(i=!0,e||(n[0]=n[1])),s.setValue(this.getRateMeterId(t),n),i):i},resetMeter:function(e){var t=this.getCurrentMeter(e);t[0]=t[1],s.setValue(this.getRateMeterId(e),t)},getRateMeterId:function(e){return"dfpc_"+(e||this.options.rateMeterId)},getCurrentMeterCount:function(e){return this.getCurrentMeter(e)[0]||0},getCurrentMeter:function(e){var t=this.getRateMeterId(e),i=this.getDefaultThreshold(e);return i?s.getValue(t,i):[]},shouldShowAd:function(){var e=this.tickMeter();return this.prefetchAd(),e&&!this.isAdReady()&&(a.logDebug("ad skipped due to no ad being delivered in time, refreshing slot"),this.refreshPosition(),e=!1),a.logDebug("shouldShowAd: "+e,this),e}});return r}),define("modules/carousel/gallery",["jquery","underscore","backbone","baseview","pubsub","utils","state","modules/global/taboola","meteredAdPosition","directAdPosition","adLogger","cookie"],function(e,t,i,n,s,o,a,r,l,h,d){var c=n.extend({events:{"click .gallery-actions-replay, .gallery-photo":"nextSlide","click .gallery-related-link":"taboolaClick"},selectors:{endSlate:".endslate",slides:".slide:not(.partner-placement)",hiddenWhileSurvey:".p402_hide"},endSlateTemplate:'<% _.each(data, function(item) { %><li class="gallery-related-item"><a class="gallery-related-link" data-taboola-type="<%= item.type %>" data-taboola-id="<%= item.id %>" data-taboola-response-id="<%=response_id%>"href="<%= item.url %>"><span class="taboola-image-crop"><img src="<%= item.thumbnail[0].url %>" class="taboola-related-img" alt="" /></span><%= item.name %></a><span class="gallery-related-date"><%= item.created %></span></li><% }); %>',initialize:function(i){t.bindAll(this,"_showEndslate","setAdSize","beforeAdRender"),i=e.extend({ads:!0,slideTransition:0,imageLazySrcAttr:"data-src",lookAheadAmount:2,transitionSlides:null},i),this.index=i.index,n.prototype.initialize.call(this,i),this.adCount=0,this.googleSurveyNeeded=!1,o.getNested(window.site_vars,"ADS","GALLERY","SURVEY")&&(this.googleSurveyNeeded=!0),this._initializeAds(),this.endSlateBuilt=!1,this.isRotating=!1,this.galleryThumbnails=this.$(".gallery-thumbs")},destroy:function(){e.cookie("GoogleSurveyDropped")&&(e.cookie("GoogleSurveyDropped",""),0!==this.$el.parent(".p402_premium").length&&this.$el.unwrap(),e("#contain-402").remove()),this._destroySurveyCallback(),n.prototype.destroy.call(this)},_initializeAds:function(){var e,t,i,n,s,o;this.options.ads&&(this.galleryData=this.$el.data()||{},this.setAdCount(),e=this.getAdTargeting(),this.$sponsorshipAd=this.$(".snapshot-sponsor"),this.$sponsorshipAd.length&&(o=this._getSlideIn(this.index).data("qqid"),e.snapshotid=o,this.subviews.sponsorshipAd=new h({el:this.$sponsorshipAd,adPlacement:"sponsor_logo/snapshots",adSizes:["sponsor_logo"],targeting:e})),this.$viewport=this.$(".viewport"),i=this.$viewport.width(),t=this.$viewport.height(),s=a.getActivePageInfo().excludeTransitionAd,450>t||600>i?d.logWarn("Advertisement viewport is too small: "+i+"x"+t):s||(this.$adSlide=this.$(".partner-slide-ad"),this.$adContents=this.$(".partner-slide-ad .gallery-photo-border"),n=null,"snapshot"===this.galleryData.galleryId&&(n="transition_snapshot"),this.subviews.ad=new l({el:this.$adContents,adPlacement:"transition_gallery/"+this.galleryData.cst,adSizes:["elastic"],beforeAdRender:this.beforeAdRender,meterThreshold:n,rateMeterId:"gallery_"+this.galleryData.galleryId,targeting:e})))},setAdCount:function(){this.adCount++},getAdTargeting:function(){return{pageType:this.galleryData.basePageType,contentid:this.galleryData.galleryId,sitePage:"usat/"+(this.galleryData.ssts||"").replace(/\/\/*$/,""),series:this.galleryData.series,topic:this.galleryData.topic,count:this.adCount,surveyCookie:""+(e.cookie("GoogleSurveyTaken")||!1),surveyOn:this.googleSurveyNeeded.toString()}
},completedSurvey:function(){if(e.cookie("GoogleSurveyTaken","true",{expires:1}),e.cookie("GoogleSurveyDropped",""),this.isRotating)this.options.carousel.autoplay();else{var t=this.options.carousel.subviews.controls.selectors,i=!!e(t.nextArrow).attr("data-lastClicked"),n="none"==e(t.prevArrow).css("display"),s=-1;(i||n)&&(s=1),this.options.carousel.switchSlide(null,s)}var o=this.options.carousel.subviews.controls.$el;o.find(this.selectors.hiddenWhileSurvey).css("display","block"),this._destroySurveyCallback()},_destroySurveyCallback:function(){if(window.USATGoogleSurvey){window.USATGoogleSurvey=void 0;try{delete window.USATGoogleSurvey}catch(e){}}},render:function(){this._loadImage(this.$$(this.selectors.slides).eq(this.index))},taboolaClick:function(t){if(!this.$overrideTaboola){var i=e(t.currentTarget);r.prototype.registerTaboolaClick(i.attr("data-taboola-id"),i.attr("data-taboola-type"),i.attr("data-taboola-response-id"),"end-slate")}},nextSlide:function(e){e.preventDefault(),this.options.carousel.switchSlide(null,1)},_buildEndslate:function(){var e=this.$(".gallery-endslate-related"),t=this.options.endslateOptions,i=[];if(this.endSlateBuilt=!0,t&&t.overrideTaboola){{t.currentGallery}i=t.endslateGalleries.join("-"),this.$(".override_taboola").hide(),a.fetchData("/picture-gallery/"+i+"/").done(function(t){e.html(t)},this)}else{var n=window.location.href;this.$el.hasClass("hasendslate")&&this.$el.data("gallery-id")&&(n=window.location.protocol+"//"+window.location.host+"/picture-gallery/"+this.$el.data("gallery-id")+"/");var s=new r({isWidgetPresent:!1});this.$$(this.selectors.endSlate).addClass("loading"),s.getRelated(this._showEndslate,"photo","photo",4,n,this.$el.data("gallery-id"),this.getPlacement())}},getPlacement:function(){switch(a.getActivePageInfo().texttype){case"gallery":return"Endslate - Cinematic Gallery";case"galleries":return"Endslate - Gallery";case"story":return"Endslate - Asset Gallery"}},_showEndslate:function(e){{var i=this.$$(this.selectors.endSlate).removeClass("loading");i.find(".gallery-endslate-related").attr("data-media-url")||""}if(t.each(e.list,function(e){e.thumbnail[0].url.indexOf("images.taboola.com")>-1&&(e.thumbnail[0].url=decodeURIComponent((e.thumbnail[0].url+"").replace(/\+/g,"%20")),e.thumbnail[0].url=e.thumbnail[0].url.replace("http://images.taboola.com/taboola/image/fetch/f_jpg,q_80,c_fill,g_face,e_sharpen/",""))}),1===i.length){var n=t.template(this.endSlateTemplate,{data:e.list,response_id:e.id});i.find(".gallery-endslate-related").html(n)}},goToSlide:function(t){var i=this._getSlideOut(),n=this._getSlideIn(t);return n.length?(this.index=t,s.trigger("carousel:switchSlide"),this.options.triggerAdRefresh&&s.trigger("carousel:refreshAd"),this._switchSlides(n,i)):e.Deferred().reject()},shouldShowAd:function(){return!this.showingAd&&this.options.ads&&this.subviews.ad&&this.subviews.ad.shouldShowAd()?!0:!1},showAd:function(){var i=this._getSlideOut();return this.showingAd=this.$adSlide,i[0]!==this.showingAd[0]?(this.$sponsorshipAd&&this.$sponsorshipAd.hide(),this._switchSlides(this.showingAd,i).done(t.bind(function(){if(e.cookie("GoogleSurveyDropped")+""=="true"){var t=this.options.carousel.subviews.controls.$el,i=this.selectors.hiddenWhileSurvey.substr(1);t.find(".media-playlist").wrap('<div class="'+i+'"></div>'),this.options.carousel.playTimer&&(this.isRotating=!0,this.options.carousel._stopCarouselRotate())}this.subviews.ad.playAd(),this.hideThumbnails()},this))):e.Deferred().reject()},hideThumbnails:function(){this.galleryThumbnails.hide()},showThumbnails:function(){this.galleryThumbnails.show()},_transitionSlides:function(e,i){var n=this.options.slideTransition;if(this.options.transitionSlides){var s=this.$$(this.selectors.slides);return this.options.transitionSlides(s.index(e),s.index(i))}return i.css({opacity:1}),this.animate(i,"opacity",0,n,"ease-in-out").then(t.bind(function(){return this._fadeInSlide(e,n).done(t.bind(function(){i.css({visibility:"hidden",opacity:0})},this))},this))},_switchSlides:function(e,i){return i===this.showingAd&&(this.subviews.ad.stopAd(),this.showThumbnails()),this._transitionSlides(e,i).then(t.bind(function(){if(i.removeClass("active"),i===this.showingAd){this.setAdCount();var t=this.getAdTargeting();this.subviews.ad.setTargeting(t),this.subviews.ad.refreshPosition(),this.showingAd=null}e!==this.showingAd&&this.$sponsorshipAd&&this.$sponsorshipAd.length&&this.refreshSponsorshipAd(e.data("qqid"))},this))},refreshSponsorshipAd:function(e){var t=this.getAdTargeting();t.snapshotid=e,this.subviews.sponsorshipAd.setTargeting(t),this.subviews.sponsorshipAd.refreshPosition()},_getSlideOut:function(){var e;return e=this.showingAd?this.showingAd:this.$$(this.selectors.slides).eq(this.index)},_getSlideIn:function(e){var t;return t=this.$$(this.selectors.slides).eq(e),this._loadImage(t,this.index>e),!this.endSlateBuilt&&t.hasClass("endslate")&&this._buildEndslate(),t},_loadImage:function(e,t){var i=this.options.lookAheadAmount;do this._fetchImage(e.find("img")),i--,e=t?e.prev():e.next();while(i>=0&&e.length>0)},_fetchImage:function(e){if(e.length>0&&o.lazyLoadImage(e,this.options.imageLazySrcAttr)){var i=e.parent();i.addClass("loading"),e.load(t.bind(function(){i.removeClass("loading"),this._resizeMeta(e)},this))}},_fadeInSlide:function(e,t){return e.css({visibility:"visible","z-index":1}),e.addClass("active"),this._resizeMeta(e.find(".gallery-photo")),this.animate(e,"opacity",1,t,"ease-in-out")},_resizeMeta:function(e){if(e.length){var t=this._getImageWidth(e);t&&e.parent().width(t)}},_getImageWidth:function(e){return e.width()},viewportResize:function(i,n){this.$(".active .gallery-photo").each(t.bind(function(t,i){this._resizeMeta(e(i))},this)),this.$adSlide&&this.subviews.ad&&(this.setAdSize(i,n),this.subviews.ad.resizeAd(i,n))},beforeAdRender:function(e){e.survey&&(window.USATGoogleSurvey={completedSurvey:t.bind(this.completedSurvey,this)}),this.setAdSize()},setAdSize:function(e,t){e=e||this.$viewport.outerWidth(),t=t||this.$viewport.outerHeight();var i=this.findSizeForAd(e,t);this.$adContents.removeClass("size-s size-m size-l size-xl").addClass(i.adSizeClass),this.subviews.ad.setInitialDimensions(e,t)},findSizeForAd:function(e,t){var i={adSizeClass:"size-s",marginTop:"5px"},n=450;return e>1080&&t>810?(i.adSizeClass="size-xl",n=810):e>936&&t>700?(i.adSizeClass="size-l",n=700):e>768&&t>576&&(i.adSizeClass="size-m",n=576),i.marginTop=(t-n)/2+"px",i}});return c}),define("modules/myCapture/myCapture",["jquery","underscore","baseview","pubsub","utils"],function(e,t,i,n,s){"use strict";var o=i.extend({events:{"click .js-mycapture-btn":"mycaptureBtnClick"},initialize:function(e){i.prototype.initialize.call(this,e)},mycaptureBtnClick:function(t){t.preventDefault(),n.trigger("uotrack","mycapturepurchase");var i=this.buildLink(e(t.currentTarget.parentElement).parent());window.open(i,"mycapture")},switchMyCaptureBtn:function(e){var t=e.$(".single-photo"),i=t.find(".js-mycapture-btn-small"),n=t.find(".js-mycapture-btn"),s=e.$(".js-caption-wrapper");t.hasClass("expandable-collapsed")?(i.hide(),n.show(),s.addClass("expandable-photo-caption-with-mycapture")):(n.hide(),i.show(),s.removeClass("expandable-photo-caption-with-mycapture"))},toggleSmallTag:function(e){this.$(".mycapture-small-btn").toggle(e)},buildLink:function(t){var i=this.getHost(),n=".mycapture.com/mycapture/remoteimage.asp?",o=t.parent().find("img"),a={image:o.attr("data-mycapture-sm-src"),notes:o.attr("data-mycapture-src"),caption:e.trim(t.find(".js-caption").text()),credit:e.trim(t.find(".credit").text()),backtext:"Back to Site",backurl:location.href,pricingsheetid:s.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","PRICING_SHEET_ID")||""};return"http://"+i+n+e.param(a)},getHost:function(){return s.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","SITE_OVERRIDE")||s.getNested(window.site_vars,"site_key")}});return o}),define("modules/carousel/controls",["jquery","underscore","backbone","baseview","modules/myCapture/myCapture","pubsub","utils"],function(e,t,i,n,s,o,a){var r=n.extend({events:{"click .slide-nav":"switchSlide","click .autoplay":"autoplay","click .thumbnails":"thumbsToggle","click .captions":"captionsToggle",mouseenter:"mouseover",mouseleave:"mouseout","click .fullscreen":"launchFullscreen"},selectors:{allCaptions:".meta",captionBtnLabel:".captionLabel",nextArrow:".slide-nav.next",playBtn:".playbtn",prevArrow:".slide-nav.prev",thumbsBtnLabel:".thumbLabel",thumbsWrapper:".thumbs",ticker:".ticker",viewport:".viewport",activeSlide:".gallery-viewport-slide.active"},initialize:function(t){t=e.extend({index:0,hoverShowControls:!0,interactionDemo:!0,interactionShowDelay:600,interactionHideDelay:3600,totalImages:0,totalSlides:0},t),this.index=t.index,n.prototype.initialize.call(this,t),a.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","ENABLED")&&this.setupMyCapture()},render:function(){this.updateTicker(),this.updateNextPrevArrows(this.index),this.options.interactionDemo&&this.startInteractionDemo()},destroy:function(e){this.clearUserInteractionDemo(),n.prototype.destroy.call(this,e)},setupMyCapture:function(){this.subviews.mycapture=new s({el:this.$el})},switchSlide:function(t){t.preventDefault();var i=e(t.currentTarget),n=i.hasClass("prev");if(i.attr("data-lastClicked","true").siblings(".slide-nav").removeAttr("data-lastClicked"),n?this.options.carousel.switchSlide(null,-1,!1):this.options.carousel.switchSlide(null,1,!1),this.subviews.mycapture){var s=this.$(this.selectors.allCaptions).hasClass("on");this.subviews.mycapture.toggleSmallTag(!s)}},autoplay:function(e){e.preventDefault(),this.options.carousel.autoplay()},startInteractionDemo:function(){var e=this;this.uxTimeout1=setTimeout(function(){e.$el.addClass("hover")},this.options.interactionShowDelay),this.uxTimeout2=setTimeout(function(){e.$el.removeClass("hover")},this.options.interactionHideDelay)},clearUserInteractionDemo:function(){clearTimeout(this.uxTimeout1),clearTimeout(this.uxTimeout2)},mouseover:function(){this.options.hoverShowControls&&this.$$(this.selectors.viewport).addClass("hover"),this.$el.addClass("hover"),this.clearUserInteractionDemo()},mouseout:function(){this.options.hoverShowControls&&this.$$(this.selectors.viewport).removeClass("hover"),this.$el.removeClass("hover")},launchFullscreen:function(e){e.preventDefault(),o.trigger("openFullScreenCarousel",{carousel:this,fullScreen:!0,parent:this.$el})},captionsToggle:function(e){var t=this.$$(this.selectors.allCaptions),i=this.$$(this.selectors.captionBtnLabel);e.preventDefault(),t.hasClass("on")?(t.removeClass("on"),i.html("Show Captions")):(t.addClass("on"),i.html("Hide Captions")),this.subviews.mycapture&&this.subviews.mycapture.toggleSmallTag(!t.hasClass("on"))},thumbsToggle:function(e){var t=this.$$(this.selectors.thumbsBtnLabel),i=this.$$(this.selectors.thumbsWrapper);e.preventDefault(),i.hasClass("on")?(i.removeClass("on"),t.html("Show Thumbnails"),this.options.carousel.toggleThumbnail(!1)):(i.addClass("on"),t.html("Hide Thumbnails"),this.options.carousel.toggleThumbnail(!0))},updateNextPrevArrows:function(e){var t=this.$$(this.selectors.prevArrow),i=this.$$(this.selectors.nextArrow);0===e?t.hide():t.show(),e<this.options.totalSlides-1?i.show():i.hide()},updateTicker:function(){var e=this.$$(this.selectors.ticker);e.length&&(e.css(this.index<this.options.totalImages?{visibility:"visible"}:{visibility:"hidden"}),e.html("<b>"+(this.index+1)+"</b> of <b>"+this.options.totalImages+"</b>"))},goToSlide:function(e){this.index=e,this.updateNextPrevArrows(e),this.updateTicker()},onPlay:function(){this.$$(this.selectors.playBtn).addClass("pause").text("Pause")},onStop:function(){this.$$(this.selectors.playBtn).removeClass("pause").text("Autoplay")}});return r}),function(e){"function"==typeof define&&define.amd?define("mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var a=t||window.event,r=l.call(arguments,1),h=0,c=0,u=0,p=0,f=0,g=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(u=-1*a.detail),"wheelDelta"in a&&(u=a.wheelDelta),"wheelDeltaY"in a&&(u=a.wheelDeltaY),"wheelDeltaX"in a&&(c=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(c=-1*u,u=0),h=0===u?c:u,"deltaY"in a&&(u=-1*a.deltaY,h=u),"deltaX"in a&&(c=a.deltaX,0===u&&(h=-1*c)),0!==u||0!==c){if(1===a.deltaMode){var m=e.data(this,"mousewheel-line-height");h*=m,u*=m,c*=m}else if(2===a.deltaMode){var v=e.data(this,"mousewheel-page-height");h*=v,u*=v,c*=v}if(p=Math.max(Math.abs(u),Math.abs(c)),(!o||o>p)&&(o=p,n(a,p)&&(o/=40)),n(a,p)&&(h/=40,c/=40,u/=40),h=Math[h>=1?"floor":"ceil"](h/o),c=Math[c>=1?"floor":"ceil"](c/o),u=Math[u>=1?"floor":"ceil"](u/o),d.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();f=t.clientX-b.left,g=t.clientY-b.top}return t.deltaX=c,t.deltaY=u,t.deltaFactor=o,t.offsetX=f,t.offsetY=g,t.deltaMode=0,r.unshift(t,h,c,u),s&&clearTimeout(s),s=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,r)}}function i(){o=null}function n(e,t){return d.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var s,o,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var h=a.length;h;)e.event.fixHooks[a[--h]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=r.length;i;)this.addEventListener(r[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=r.length;i;)this.removeEventListener(r[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();return n.length||(n=e("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),define("modules/scroller/base-scroll",["jquery","underscore","backbone","baseview","pubsub","utils","mousewheel"],function(e,t,i,n,s,o){var a=n.extend({events:{mousewheel:"handleMouseWheel",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchstart:"onTouchStart","mousedown .scrolldragger":"onDraggerMouseDown","mouseenter .scrolldragger":"onDraggerMouseOver","mouseleave .scrolldragger":"onDraggerMouseOut","mousedown .scrollbar":"onBarClick"},removeActiveDelay:300,initialize:function(i){i=e.extend({disabled:!1,contentClass:".scrollable-content",lockPageScroll:!0,delayScroll:!1,minDraggerSize:40,template:null},i),t.bindAll(this,"onDraggerMouseUp","onDraggerMouseMove","onTouchMove","onTouchStop","_setMouseInHouse","_clearMouseInHouse"),this.content=this.$(i.contentClass),this.bar=e(i.template).hide(),this.bar.addClass("scrollbar"),this.dragger=this.bar.find(".scrolldragger"),this.body=o.get("body"),this.$el.append(this.bar),this.isMouseDown=!1,this.isMouseOver=!1,this.draggerOffset=0,n.prototype.initialize.call(this,i),this.refresh()},bindEvents:function(){this.delegateEvents()},unbindEvents:function(e){e||this.undelegateEvents(),this.body.off("."+this.cid),clearInterval(this.accelerationTimer),clearTimeout(this.enterDelay),clearTimeout(this.leaveDelay)},refresh:function(){if(this.content=this.$(this.options.contentClass),!this.options.disabled&&0!==this.content.length)if(this.viewportSize=this.getViewportSize(),this.contentSize=this.getContentSize(),this.contentViewportRatio=this.viewportSize/this.contentSize,this.contentViewportRatio<1){var e=this._calculateDraggerSize(this.viewportSize,this.contentViewportRatio,this.contentSize);this.draggerSize=this._setDraggerSize(e),this.active||(this.bar.show(),this.bindEvents(),this.active=!0,this.origPosition&&this.moveContentToPosition(this.origPosition.left,this.origPosition.top)),this.shiftContent(0,0)}else this.active&&(this.origPosition=this.content.position(),this.moveContentToPosition(0,0),this.bar.hide(),this.unbindEvents(),this.active=!1)},_calculateDraggerSize:function(e,t,i){var n=Math.round(e*t);if(n<this.options.minDraggerSize){var s=i-e,o=e-this.options.minDraggerSize;this.contentViewportRatio=o/s,n=this.options.minDraggerSize}return n},onTouchStart:function(e){var t=e.originalEvent.touches;t.length>1||this.options.disabled||!this.active||(clearInterval(this.accelerationTimer),this.touchX=t[0].pageX,this.touchY=t[0].pageY,this.touchVectorX=0,this.touchVectorY=0,this.touchDragStarted=!1,this.touchLastMove=(new Date).getTime(),this.body.on("touchend."+this.cid,this.onTouchStop),this.body.on("touchcancel."+this.cid,this.onTouchStop),this.body.on("touchmove."+this.cid,this.onTouchMove))},onTouchStop:function(e){if(0===e.originalEvent.touches.length&&(this.body.off("."+this.cid),this.touchDragStarted)){var t=(new Date).getTime(),i=t-this.touchLastMove;return e.preventDefault(),100>i&&this._triggerScrollingDecelerate(this.touchVectorX,this.touchVectorY,1500),!1}},_triggerScrollingDecelerate:function(e,i,n){var s=(new Date).getTime(),o=s+n,a=s,r=window.requestAnimationFrame||window.webkitRequestAnimationFrame,l=t.bind(function(){var t=(new Date).getTime(),h=t-a;a=t,o>t&&r(l),t-=s;var d=this._adjustVelocityVector(e,t,n),c=this._adjustVelocityVector(i,t,n);this.shiftContent(d*h,c*h)},this);this.accelerationTimer=r(l)},_adjustVelocityVector:function(e,t,i){return e*Math.pow(1-t/i,3)},onTouchMove:function(e){if(1===e.originalEvent.touches.length){var t=e.originalEvent.touches,i=t[0].pageX-this.touchX,n=t[0].pageY-this.touchY;if(this.touchDragStarted||Math.abs(i)>10||Math.abs(n)>10){var s=(new Date).getTime();this.touchDragStarted=!0,this.touchX=t[0].pageX,this.touchVectorX=i/(s-this.touchLastMove),this.touchY=t[0].pageY,this.touchVectorY=n/(s-this.touchLastMove),this.touchLastMove=(new Date).getTime(),this.shiftContent(i,n)===!1&&e.preventDefault()}}},onBarClick:function(e){if(1===e.which&&!e.isDefaultPrevented()){e.preventDefault();var t=this.bar.offset(),i=e.pageX-t.left-this.draggerSize/2,n=e.pageY-t.top-this.draggerSize/2;this.moveDraggerToPosition(i,n),this.onDraggerMouseOver(e),this.onDraggerMouseDown(e)}},onDraggerMouseDown:function(e){if(1===e.which){this.isMouseDown=!0,e.preventDefault(),this.body.on("mousemove."+this.cid,this.onDraggerMouseMove),this.body.on("mouseup."+this.cid,this.onDraggerMouseUp);var t=this.dragger.offset();this.draggerClickOffset={left:e.pageX-t.left,top:e.pageY-t.top}}},onDraggerMouseUp:function(e){1===e.which&&(e.preventDefault(),this.isMouseDown=!1,this.body.off("."+this.cid),this.isMouseOver||this.dragger.removeClass("hover"))},onDraggerMouseMove:function(e){if(this.isMouseDown){var t=this.bar.offset(),i=e.pageX-t.left-this.draggerClickOffset.left,n=e.pageY-t.top-this.draggerClickOffset.top;this.moveDraggerToPosition(i,n)}},onDraggerMouseOver:function(){this.isMouseOver=!0,this.dragger.addClass("hover")},onDraggerMouseOut:function(){this.isMouseOver=!1,this.isMouseDown||this.dragger.removeClass("hover")},onMouseEnter:function(){clearTimeout(this.leaveDelay),this.enterDelay=setTimeout(this._setMouseInHouse,300)},onMouseLeave:function(){clearTimeout(this.enterDelay),this.leaveDelay=setTimeout(this._clearMouseInHouse,300)},_setMouseInHouse:function(){this.isMouseInTheHouse=!0},_clearMouseInHouse:function(){this.isMouseInTheHouse=!1},handleMouseWheel:function(e){if(!this.isMouseDown&&this.active&&(!this.options.delayScroll||this.isMouseInTheHouse)){var t=e.deltaY*e.deltaFactor,i=-1*e.deltaX*e.deltaFactor||t;this.shiftContent(i,t)===!1&&e.preventDefault()}},shiftContent:function(e,t){var i=this.content.position(),n=this.content.parent(),s=i.left+e-(parseInt(n.css("padding-left"),10)||0)-(parseInt(n.css("margin-left"),10)||0),o=i.top+t-(parseInt(n.css("padding-top"),10)||0)-(parseInt(n.css("margin-top"),10)||0);return this.moveContentToPosition(s,o)?!1:this.options.lockPageScroll?!1:void 0},destroy:function(){this.unbindEvents(!0),this.bar.remove(),n.prototype.destroy.apply(this,arguments)},moveDraggerToPosition:function(){},moveContentToPosition:function(){},scrollToElement:function(){},animateContentToPosition:function(){},getViewportSize:function(){return 0},getContentSize:function(){return 0},_setDraggerSize:function(e){return e}});return a}),define("modules/scroller/horizontal-scroll",["jquery","underscore","modules/scroller/base-scroll"],function(e,t,i){var n=i.extend({initialize:function(n){n=e.extend({color:"light",draggerPaddingLeft:0,draggerPaddingRight:2,delayScroll:!0},n);var s=t.template('<div class="horizontal-scroll ui-<%= color %>"><div class="scrolldragger"><div class="over-icon"></div></div></div>');n.template=s({color:n.color}),this.$(".horizontal-scroll").remove(),i.prototype.initialize.call(this,n)},getViewportSize:function(){return this.$el.width()},getContentSize:function(){return this.content.width()},_setDraggerSize:function(e){return e-=this.options.draggerPaddingLeft+this.options.draggerPaddingRight,this.dragger.css({width:e}),e},animateContentToPosition:function(i,n,s,o){var a=this.viewportSize-this.contentSize,r=Math.max(a,Math.min(i,0));return o=o||"ease-out",e.when(this.animate(this.dragger,"left",-1*r*this.contentViewportRatio+"px",s||0,o),this.animate(this.content,"left",r+"px",s,o)).done(t.bind(function(){this.$el.trigger("scrollBarUpdate",[r/a])},this))},scrollToElement:function(e,t,i,n){var s,o=e.outerWidth(),a=e.position().left+e.parent().position().left,r=a+o;if(0>a){var l=this.getViewportSize();s=t?a+(o-l):a}else r>this.getViewportSize()&&(s=t?a:a+(o-this.getViewportSize()));if(s){var h=this.content.position().left-s;this.animateContentToPosition(h,0,i,n)}},moveContentToPosition:function(e){if(!this.active)return!1;var t=Math.min(this.viewportSize-this.contentSize,0),i=Math.max(t,Math.min(e,0));return this._positionDragger(-1*i*this.contentViewportRatio),this._positionContent(i),this.$el.trigger("scrollBarUpdate",[i/t]),i===e},moveDraggerToPosition:function(e){if(!this.active)return!1;var t=this.viewportSize-(this.draggerSize+this.options.draggerPaddingRight+this.options.draggerPaddingLeft),i=Math.max(0,Math.min(e,t));return this._positionDragger(i),this._positionContent(-1*i/this.contentViewportRatio),this.$el.trigger("scrollBarUpdate",i/t),i===e},_positionDragger:function(e){e+=this.options.draggerPaddingLeft,e=Math.round(e),this.dragger.css({left:e})},_positionContent:function(e){e=Math.round(e),this.content.css({left:e})}});return n}),define("modules/carousel/thumbs",["jquery","underscore","backbone","baseview","pubsub","utils","modules/scroller/horizontal-scroll"],function(e,t,i,n,s,o,a){var r=n.extend({events:{"mouseenter li":"thumbMouseover","mouseleave li":"thumbMouseout","click li":"switchSlide"},selectors:{thumbs:"li"},initialize:function(t){t=e.extend({hoverTransition:0},t),this.index=t.index,n.prototype.initialize.call(this,t),this.subviews.scrollbar=new a({el:this.$el,color:this.options.scrollerColor,padding:2}),this.goToSlide(this.index)},switchSlide:function(t){t.preventDefault();var i=e(t.currentTarget).index();this.options.carousel.switchSlide(i)},showAd:function(){var e=this.$$(this.selectors.thumbs);e.eq(this.index).removeClass("active")},thumbMouseover:function(i){var n=i.currentTarget;this.options.hoverTransition&&(this.hoverTimeout=setTimeout(t.bind(function(){this.hoverTimeout=null,this.options.carousel.switchSlide(e(n).index(),null,!0)},this),this.options.hoverTransition))},thumbMouseout:function(){this.options.hoverTransition&&this.hoverTimeout&&clearTimeout(this.hoverTimeout)},goToSlide:function(e){var t=this.$$(this.selectors.thumbs),i=t.eq(e);t.eq(this.index).removeClass("active"),i.addClass("active"),this.index=e,i.length&&this.subviews.scrollbar.scrollToElement(i,!1,300)},viewportResize:function(){this.subviews.scrollbar&&this.subviews.scrollbar.refresh()}});return r}),define("modules/partner/simple-ad",["jquery","underscore","baseview","state","sharedAdPosition","directAdPosition"],function(e,t,i,n,s,o){"use strict";var a=i.extend({initialize:function(s){t.bindAll(this,"onAdReady"),s=e.extend({adPlacement:"poster_front",adSizes:"mediumrectangle",pageInfo:n.getActivePageInfo(),onAdReady:this.onAdReady,isShared:!1},s),i.prototype.initialize.call(this,s)},_initAds:function(){var e=this.options,t=e.adSizes;t&&"string"==typeof t&&(t=t.split(","));var i={el:this.$el,adPlacement:e.adPlacement,pageInfo:e.pageInfo,adSizes:t,onAdReady:this.onAdReady,adType:e.adType};e.isShared?(i.defaultPosition=!0,this.subviews.simpleAd=new s(i)):this.subviews.simpleAd=new o(i)},onAdReady:function(){this.subviews.simpleAd.show()}});return a}),define("modules/partner/companion-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var n=i.extend({initialize:function(t){t=e.extend({adPlacement:"poster_gallery_companion"},t),i.prototype.initialize.call(this,t),this._initAds()},refresh:function(){this.subviews.simpleAd.refreshPosition()}});return n}),define("modules/carousel/companion",["jquery","underscore","baseview","modules/partner/companion-ad","utils"],function(e,t,i,n,s){"use strict";var o=i.extend({PROGRESSIVE_GALLERY_REFRESH_RATE:s.getNested(window.site_vars,"ADS","progressive_gallery_refresh_rate"),refreshCount:0,initialize:function(e){i.prototype.initialize.call(this,e),this.slides=e.slides,this.currentInfo=this.$(".pag-current-info"),this.subviews.ad=new n({el:this.$(".pag-ad"),adPlacement:"poster_gallery_companion"})},goToSlide:function(e){++this.refreshCount%this.PROGRESSIVE_GALLERY_REFRESH_RATE===0&&this.subviews.ad.refresh();var t=this.slides.eq(e),i=t.find(".pag-photo-info").html();this.currentInfo.html(i)}});return o}),define("modules/carousel/carousel",["jquery","underscore","backbone","baseview","pubsub","state","utils","modules/carousel/gallery","modules/carousel/controls","modules/carousel/thumbs","modules/carousel/companion"],function(e,t,i,n,s,o,a,r,l,h,d){var c=n.extend({events:{mouseenter:"mouseEnter"},selectors:{slides:".slide:not(.partner-placement)",images:".slide:not(.partner-placement,.endslate)",companion:".pag-companion-wrapper"},initialize:function(i){i=e.extend({ads:!0,slideTransition:0,hoverShowControls:!0,hoverTransition:0,interactionDemo:!0,linkPath:null,rotate:!1,controlsSelector:null,gallerySelector:null,thumbsSelector:".thumbs",imageLazySrcAttr:"data-src",scrollerColor:"light",rotateInterval:3e3,autostart:!1},i),t.bindAll(this,"rotateCarousel"),this.index=this.$(".slide.active").index(),-1===this.index&&(this.index=0),this.linkPath=i.linkPath?i.linkPath:"",this.playTimer=null,this.subviews={},this.triggerAdRefresh=0===this.$$(this.selectors.companion).length,this._initializeGallery(i.imageLazySrcAttr,i.slideTransition,i.ads,i.gallerySelector,this.triggerAdRefresh,i.endslateOptions),this._initializeControls(i.hoverShowControls,i.interactionDemo,i.controlsSelector),this._initializeThumbs(i.hoverTransition,i.scrollerColor,i.thumbsSelector),this._initializeCompanion(this.selectors.slides),this.pubSub={"carousel:stoptimer":this.stoptimer,"carousel:starttimer":this.resumeAutoPlay},n.prototype.initialize.call(this,i),i.autostart&&this._startCarouselRotate()},_initializeCompanion:function(e){this.$$(this.selectors.companion).each(t.bind(function(t,i){this.subviews.companion=new d({el:i,slides:this.$$(e)})},this))},_initializeGallery:function(e,t,i,n,s,o){this.subviews.gallery=new r({ads:i,el:n?this.$(n):this.$el,index:this.index,imageLazySrcAttr:e,slideTransition:t,carousel:this,triggerAdRefresh:s,endslateOptions:o})},_initializeControls:function(e,t,i){var n=this.$(this.selectors.images),s=this.$$(this.selectors.slides);this.subviews.controls=new l({el:i?this.$(i):this.$el,hoverShowControls:e,interactionDemo:t,index:this.index,totalSlides:s.length,totalImages:n.length,carousel:this}),this.subviews.controls.render()},_initializeThumbs:function(e,t,i){this.subviews.thumbs=new h({el:i?this.$(i):this.$el,hoverTransition:e,index:this.index,scrollerColor:t,carousel:this})},mouseEnter:function(){this.options.autostart&&this._stopCarouselRotate()},rotateCarousel:function(){var e=this.$$(this.selectors.slides).length-1;this.switchSlide(null,1,!0),this.index!==e||this.options.rotate||this._stopCarouselRotate()},destroy:function(e){this.playTimer&&this._stopCarouselRotate(),n.prototype.destroy.call(this,e)},stoptimer:function(){clearInterval(this.playTimer),this.playTimer=null},switchSlide:function(e,t,i){var n=this.$$(this.selectors.slides).length;if(!this.showingAd&&this.subviews.gallery.shouldShowAd())return this.showingAd=!0,this.slideAdStep=t,void this.triggerEvent("showAd");if(t){this.slideAdStep&&this.slideAdStep!==t&&(t+=this.slideAdStep);var s=this.index+t;e=0>s?n-1:s>=n?0:s}else 0>e?e=0:e>=n&&(e=n-1);(this.index!==e||this.showingAd)&&(this.showingAd=!1,this.slideAdStep=0,this.index=e,this.triggerEvent("goToSlide",e),i||this._trackSlideChange())},_trackSlideChange:function(){var t;t=this.$el.hasClass("galleries")?this.$el:this.$(".galleries");var i=t.attr("data-gallery-id"),n=(t.attr("data-gal-pageurl")||"").replace(/^.*\/\/[^\/]+/,""),a=o.getActivePageInfo().contenttype;a?-1===a.indexOf("gallery")&&(a=e.trim(a)+" gallery"):a="galleries";var r={gallery_id:i,gallery_title:t.attr("data-title"),gallery_index:this.index+1,slide_id:t.find(".slide.active img").attr("data-id"),ssts:t.attr("data-ssts"),cst:(t.attr("data-cst")||"bugpages").replace(/\/+$/,""),contenttype:"snapshot"===i?"snapshot":a,pathName:""===n?this.linkPath:n};s.trigger("slide:change",r),e.ajax({url:window.site_static_path+"html/comscorepvcandidate.xml"})},autoplay:function(){this.playTimer?this._stopCarouselRotate():this._startCarouselRotate(!0)},_startCarouselRotate:function(e){0===this.options.rotateInterval?this.stoptimer():this.playTimer=setInterval(this.rotateCarousel,this.options.rotateInterval),e&&this.rotateCarousel(),this.triggerEvent("onPlay")},_stopCarouselRotate:function(){this.stoptimer(),this.options.autostart=!1,this.triggerEvent("onStop")},resumeAutoPlay:function(){this.options.autostart&&!this.playTimer&&this._startCarouselRotate()},toggleThumbnail:function(){this.triggerEvent("viewportResize")},viewportResize:function(){this.triggerEvent("viewportResize")}});return c}),define("modules/carousel/carousel-autosize",["jquery","underscore","backbone","baseview","utils","modules/carousel/carousel"],function(e,t,i,n,s,o){var a=o.extend({initialize:function(i){t.bindAll(this,"handleResizeWindow"),this.options=e.extend({hoverShowControls:!1,verticalAdjust:80,interactionDemo:!1,horizontalAdjust:0,thumbSize:84,imageLazySrcAttr:"data-large-src"},i),this.$win=s.get("win"),this.$el.hasClass("galleries")?this.$el.addClass("autosize"):this.$(".galleries").addClass("autosize");var n=t.throttle(this.handleResizeWindow,50);this.$win.on("resize."+this.cid,n),this.handleResizeWindow(),o.prototype.initialize.call(this,this.options),this.subviews.gallery.render()},destroy:function(e){this.$win.off("."+this.cid),o.prototype.destroy.call(this,e)},handleResizeWindow:function(){this.windowHeight=this.$win.height(),this.windowWidth=this.$win.width(),this.viewportResize()},viewportResize:function(){var e=this.windowHeight-this.options.verticalAdjust;this.showThumbs&&(e-=this.options.thumbSize),this.$$(".viewport").height(e),this.triggerEvent("viewportResize",this.windowWidth-this.options.horizontalAdjust,e)},toggleThumbnail:function(e){this.showThumbs=e,this.viewportResize()}});return a}),define("modules/videos/video-transcript",["jquery","underscore","baseview","state","pubsub"],function(e,t,i,n,s){"use strict";var o=i.extend({events:{"click .video-transcript-caption":"onClickVideoSeek","click .video-transcript-keywordresult":"onClickkeyword","keydown .video-search-input":"onKeyDown","click .ui-ramp-transcriptplus":"onClickTranscriptSlide","click .toggle-transcript":"onClickTranscriptSlide","click .video-search-btn":"onClickVideoSearch","click .video-search-close-btn":"onClickSearchCloseBtn","click .transcript-navigate-next-active":"nextslide","click .transcript-navigate-prev-active":"prevslide","mouseenter .video-full-transcript-text":"toggleautoscroll","mouseleave .video-full-transcript-text":"toggleautoscroll"},initialize:function(t){var n=e.extend(!0,{animations:{useCSSTransitions:!1}},t);
i.prototype.initialize.call(this,n),this.currentplayer=this.options.player||{},this.$viewport=this.$(".keywords-viewport"),this.$searchViewport=this.$(".search-viewport"),this.$keywordWindow=this.$(".video-keywords-result"),this.$searchWindow=this.$(".video-search-result"),this.initializeTranscript(),this.$searchinput=this.$(".video-search-input"),this.$keywords=this.$(".video-transcript-keywords"),this.$search=this.$(".video-transcript-search"),this.$searchresults=this.$(".video-search-display"),this.$searchCancelBtn=this.$(".video-search-close-btn"),this.$search.hide(),this._currentSlideCount=1,this.autoscroll=!0},onClickVideoSearch:function(t){this.$currentcaption.blur();var i,n;this.$searchresults.empty(),this.$searchWindow.empty(),this.clearActiveArrows();var s=this.$searchinput.val().toLowerCase(),o=new RegExp("\\b"+s+"\\b"),a=s.split(" ");if(0!==s.length){var r=this.$videotranscriptmain.filter(function(){return e(this).text().toLowerCase().search(o)>-1});if(2==a.length){var l=this.$videotranscriptmain.filter(function(){var t=e(this),i=e.trim(t.text().toLowerCase()).split(" ");if(i[i.length-1]==a[0]){var n=e.trim(t.next().text().toLowerCase()).split(" ");return n[0]==a[1]}return!1});l.length>0&&(r=r.add(l))}if(0===r.length&&"undefined"!=typeof t&&t.currentTarget.getAttribute("data-startoffset")&&(r=r.add(e(t.currentTarget))),this.trackclicks(this.$searchinput.data().track),this.$keywords.hide(),this.$search.show(),this.$searchOpen=this.$(".transcript-search-input"),this.$searchOpen.removeClass("video-search-open-button"),this.$searchCancelBtn.addClass("video-search-close-btn-visible"),this.$searchresults.addClass("show-results"),0!==r.length){this.$searchresults.append("<span class='video-search-term'>"+s+"</span> found at");for(var h=0;h<r.length;h++)i=r[h].getAttribute("data-startoffset"),n=r[h].getAttribute("data-startoffset_display"),this.$searchWindow.append("<span class='video-transcript-caption transcript-search-result' data-track='searchclick' data-startoffset="+i+">"+n+"</span>")}else this.$searchresults.append("<span class='no-results'>No results found for <span class='video-search-term'>\""+s+'"</span></span>')}this.updateSlideCount(),this.loadActiveArrows(),this._currentSlideCount=1},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&(this.$searchresults.empty(),this.$searchWindow.empty(),this.onClickVideoSearch(e))},onClickSearchCloseBtn:function(){this.$searchCancelBtn.removeClass("video-search-close-btn-visible"),this.$searchOpen.addClass("video-search-open-button"),this.$searchresults.removeClass("show-results"),this.$searchresults.empty(),this.$searchWindow.empty(),this.clearActiveArrows(),this.$searchWindow.css("left","auto"),this.$keywordWindow.css("left","auto"),this.$searchinput.val(""),this.$search.hide(),this.$keywords.show(),this.updateSlideCount(),this.loadActiveArrows(),this._currentSlideCount=1},togglesearch:function(e){var t=this.$(".video-full-transcript-control");e&&t.hasClass("searchcontroloff")?(t.removeClass("searchcontroloff"),this.trackclicks("open-search"),this.updateSlideCount(),this.loadActiveArrows()):(t.addClass("searchcontroloff"),this.trackclicks("close-search"))},isTranscriptAvailable:function(){return this.$videotranscriptmain.length>0},initializeTranscript:function(){this.$videotranscriptmain=this.$(".video-transcript-caption"),this.$currentcaption=e(this.$videotranscriptmain[0]),this.clearHighlight(this.$currentcaption),this.addHighlight(this.$currentcaption),!this.options.player.hidesearchcontrol&&this.options.player.flashsearchcontrolOn&&(this.updateSlideCount(),this.loadActiveArrows())},loadActiveArrows:function(){this.$(".video-transcript-keywords").is(":visible")?!this.$(".video-transcript-navigate-next").hasClass("transcript-navigate-next-active")&&this.$keywordWindow.width()>this.$viewport.width()&&this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active"):this.$search.is(":visible")&&!this.$(".video-transcript-navigate-next").hasClass("transcript-navigate-next-active")&&this.$searchWindow.width()>this.$searchViewport.width()&&this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active")},clearActiveArrows:function(){this.$(".video-transcript-navigate-next").removeClass("transcript-navigate-next-active"),this.$(".video-transcript-navigate-prev").removeClass("transcript-navigate-prev-active")},onClickVideoSeek:function(t){var i=e(t.currentTarget),n=i.data();this.trackclicks(n.track),this.options.seek&&this.options.seek(n.startoffset)},onClickkeyword:function(t){var i=e(t.currentTarget).text();this.$searchinput.val(e.trim(i)),this.onClickVideoSearch(t)},progressHighlight:function(e){this.$currentcaption&&e.position>parseFloat(this.$currentcaption.attr("data-startoffset"))+parseFloat(this.$currentcaption.attr("data-duration"))&&(this.clearHighlight(this.$currentcaption),this.addHighlight(this.$currentcaption.next()))},clearHighlight:function(e){e.hasClass("active-transcript")&&e.removeClass("active-transcript")},toggleautoscroll:function(e){this.autoscroll="mouseenter"==e.type?!1:!0},transcriptautoscroll:function(e){if(this.autoscroll){var t=e.offsetTop-e.parentElement.offsetTop;this.$(".video-full-transcript-text").animate({scrollTop:t},1e3)}},addHighlight:function(e){e.length>0&&(this.transcriptautoscroll(e[0]),this.$currentcaption=e,this.$currentcaption.addClass("active-transcript"))},onStatusChange:function(i){if("mediaSeekNotify"===i.type){this.clearHighlight(this.$currentcaption);{t.find(this.$videotranscriptmain,function(t){var n=e(t);return i.position<n.data().startoffset+n.data().duration?(this.$currentcaption=n,this.addHighlight(n),!0):void 0},this)}}else"mediaBegin"===i.type&&i.media.referenceId.toString()!=this.options.video.id&&this.$el.hide()},onClickTranscriptSlide:function(){this.trackclicks("transcript"),this.$(".video-full-transcript-text").toggle("slow")},keywordSlide:function(e,t){return this.animate(e,"left",t+"px",250,"easeInOutQuad")},nextslide:function(){var e=this.getCurrentSlide();0!==this.totalSlides&&e!=this.totalSlides&&(this.targetWindow=1==e?-1*this.slideWidth:this.slideWidth*e*-1,this.$(".video-transcript-keywords").is(":visible")?this.keywordSlide(this.$keywordWindow,this.targetWindow):this.$search.is(":visible")&&this.keywordSlide(this.$searchWindow,this.targetWindow),this._currentSlideCount+=1,this.$(".video-transcript-navigate-prev").addClass("transcript-navigate-prev-active")),this._currentSlideCount==this.totalSlides&&this.$(".video-transcript-navigate-next").removeClass("transcript-navigate-next-active")},prevslide:function(){var e=this.getCurrentSlide();0!==this.totalSlides&&1!=e&&(this.targetWindow=this.slideWidth*(e-2)*-1,this.$(".video-transcript-keywords").is(":visible")?this.keywordSlide(this.$keywordWindow,this.targetWindow):this.$search.is(":visible")&&this.keywordSlide(this.$searchWindow,this.targetWindow),this._currentSlideCount-=1,this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active"),1==this._currentSlideCount&&this.$(".video-transcript-navigate-prev").removeClass("transcript-navigate-prev-active"))},getCurrentSlide:function(){return this._currentSlideCount},updateSlideCount:function(){var e,t;this.$(".video-transcript-keywords").is(":visible")?(e=this.$keywordWindow,t=e.width(),this.viewportWidth=this.$viewport.width()):this.$search.is(":visible")&&(e=this.$searchWindow,t=e.width(),this.viewportWidth=this.$searchViewport.width()),this.slideWidth=Math.floor(this.viewportWidth/2),t>this.viewportWidth/2&&(this.totalSlides=2*Math.ceil(t/this.viewportWidth))},trackclicks:function(e){s.trigger("uotrack","ramp"+this.currentplayer.name+e)}});return o}),define("fwinfo",["jquery","underscore"],function(){function e(){if(!s&&(s={},document.cookie.match(/\bfwutil=([^\;]*)/))){var e,t,o,a=RegExp.$1.split(i),r=a.length;for(e=0;r>e;e++)t=a[e].split(n),o=t.length,2==o&&(s[t[0]]=decodeURIComponent(t[1]))}}function t(){var e,t="fwutil=",o="";for(e in s)s.hasOwnProperty(e)&&(t+=o+e+n+encodeURIComponent(s[e]),o=i);document.cookie=t+";path=/"}var i="~",n=":",s=null,o={setsessionvalue:function(i,n){s||e(),s[i]=n,t()},getsessionvalue:function(t){return s||e(),s[t]},getandclearsessionvalue:function(e){var t=o.getsessionvalue(e);return t?(o.setsessionvalue(e,""),t):null}};return o}),define("modules/stories/taboola-recommendations",["jquery","underscore","baseview","state","fwinfo","managers/routemanager","utils","modules/global/taboola","pubsub"],function(e,t,i,n,s,o,a,r,l){"use strict";var h=i.extend({initialize:function(s){s=e.extend({videoResponse:{}},s),this.texttype=n.getActivePageInfo().texttype||"story",t.bindAll(this,"showTaboola","showNextRecommendation","getPlacement","renderEndslate","isVideo"),i.prototype.initialize.call(this,s),this.$endslate=this.$("#endslate-taboola-template"),this.$endslate_template=this.$(".video-endslate");var o=n.getActivePageInfo().basePageType;"section-front"==o||"subsection-front"==o?this.createSectionTaboolaWidget():this.options.isContinuousEndslate||this.render()},render:function(){var t,i;if(t=e(".transition-wrap:first"),"interactive"!==this.texttype){if(-1!==this.texttype.indexOf("video")||"galleries"==this.texttype)i=!1;else if("story"==this.texttype){var n=t.find(".double-wide"),s=t.find(".story-right-rail");if(!n.length)return;if(s.length){var o=n.position().top,a=n.height(),r=s.position().top+s.height()+650-o;r>a&&(i=!0)}else i=!1}e(".iframe-auto").length>0&&(i=!0),this.createTaboola(i)}},createSectionTaboolaWidget:function(){var e=[],t={},i={};e.push(this.getMetadata("thumbnails-g","taboola-section-front-thumbnails","Section Front Thumbnails","mix")),t.category="auto",i.widget=e,i.pagetypeWidget=t,this.subviews.taboola=new r(i)},createTaboola:function(e){var t,i,s,o,l={},h={},d=[];s=a.getPageUrl(),t=-1!==s.indexOf("/sports/")||-1!==s.indexOf("/gameon/"),i=-1!==s.indexOf("/story/"),e?(d.push(this.getMetadata("thumbnails-j","taboola-short-article-2x5","short-article-2x5","mix")),d.push(this.getMetadata("thumbnails-k","taboola-organic-short-article-2x5","organic-short-article-2x5","mix")),l.article="auto",this.$(".more-stories-wrap").addClass("vertical")):this.isVideo()?(d.push(this.getMetadata("thumbnails-b","taboola-below-video-thumbnails","Below Video Thumbnails","mix")),d.push(this.getMetadata("organic-thumbnails-d","taboola-below-video-thumbnails-2nd","Below Video Thumbnails-2nd","mix")),l.video="auto","video"==this.texttype&&(o=n.getActivePageInfo().assetid,l.id=o)):"galleries"==this.texttype?(d.push(this.getMetadata("thumbnails-b","taboola-below-photo-thumbnails","Below Photo Thumbnails","mix")),d.push(this.getMetadata("organic-thumbnails-d","taboola-below-photo-thumbnails-2nd","Below Photo Thumbnails-2nd","mix")),l.photo="auto"):t?(d.push(this.getMetadata("thumbnails-l","taboola-grid-sports-3x3","grid-sports-3x3","mix")),d.push(this.getMetadata("thumbnails-m","taboola-organic-grid-sports-3x3","organic-grid-sports-3x3","mix")),l.article="auto"):i&&(d.push(this.getMetadata("thumbnails-h","taboola-grid-3x3","grid-3x3","mix")),d.push(this.getMetadata("thumbnails-i","taboola-organic-grid-3x3","organic-grid-3x3","mix")),l.article="auto"),h.widget=d,h.pagetypeWidget=l,this.subviews.taboola=new r(h)},getMetadata:function(e,t,i,n){return{mode:e,container:t,placement:i||"",target_type:n||""}},isVideo:function(){return-1!==["video","video-playlist","brightcove-video-playlist"].indexOf(this.texttype)},showTaboola:function(e){var i=this.$("#more-galleries-template");if(1===i.length){var n=t.template(i.html(),{data:e.list});this.$(".headlines.gallery-more").append(n)}},renderEndslate:function(e,t,i){this.subviews.taboola||(this.subviews.taboola=new r),this.subviews.taboola.getRelated(this.showNextRecommendation,"video","video",1,e,t,this.getPlacement(i),!1)},getPlacement:function(e){if(e)return"Continuous Endslate - Cinematic";switch(this.texttype){case"story":case"data":return"Continuous Endslate - Article";case"video":return"Continuous Endslate - Asset";case"video-playlist":return"Continuous Endslate - Presto Playlist";case"brightcove-video-playlist":return"Continuous Endslate - Brightcove playlist"}},showNextRecommendation:function(e){var i=decodeURIComponent(e.list[0].url.match(/\&redir\=(.+)/)[1]),s=i.replace(/^.*\/\/[^\/]+/,""),o=s.replace(/^\D+/g,"");n.fetchData("/videos/services/"+o).done(t.bind(function(t){t?(this.videoResponse=t,this.videoResponse.taboolaResponseId=e.id,this.video_media_url=decodeURIComponent(e.list[0].url.match(/\&redir\=(.+)/)[1]),this.temp_media_url="/media/cinematic/video/"+o):l.trigger("uotrack","taboola-no-recommendations")},this))},populateEndslate:function(i,n){this.$endslate_markup=i;var a=n,l="",h=3;if(this.subviews.taboola||(this.subviews.taboola=new r),this.videoResponse||(this.videoResponse=this.options.videoResponse),!e.isEmptyObject(this.videoResponse)){l=this.videoResponse.url.replace(/^.*\/\/[^\/]+/,""),this.$endslate=this.$endslate_markup.find("#endslate-taboola-template"),a&&(l=this.video_media_url.replace(/^.*\/\/[^\/]+/,""));var d=t.template(this.$endslate.html(),{data:this.videoResponse});this.$endslate_markup.append(d),this.showendslate(),this.subviews.taboola.registerTaboolaVisible(this.videoResponse.taboolaResponseId),this.$endslate_div=e(".next-video-data"),this.timer=setInterval(t.bind(function(){this.$endslate_markup.find(".counter").text("0"+h--),-1==h&&(clearInterval(this.timer),this.refreshEndslate(),this.subviews.taboola.registerTaboolaClick(this.videoResponse.brightcove_id,"video",this.videoResponse.taboolaResponseId),s.setsessionvalue("clickName","taboola-autoplay"),"video"==this.texttype||a?o.goTo(l):this.options.playRecommendedVideo(this.videoResponse))},this),1e3)}},showendslate:function(){this.$endslate_markup.addClass("video-endslate-active")},refreshEndslate:function(){this.$endslate_markup.removeClass("video-endslate-active"),this.$endslate_div.find(".next-video-thumbnail").empty(),this.$endslate_div.find(".next-video-title").empty(),this.$endslate_div.remove()},destroy:function(){clearInterval(this.timer),i.prototype.destroy.apply(this,arguments)}});return h}),define("modules/videos/brightcove-video",["jquery","underscore","baseview","state","utils","admanager","managers/cachemanager","pubsub","modules/videos/video-transcript","adLogger","modules/stories/taboola-recommendations","managers/autoplay"],function(e,t,i,n,s,o,a,r,l,h,d,c){"use strict";var u=i.extend({events:{"click .ui-video-still-image-active, .ui-video-play-btn-active":"onClickVideoStill"},initialize:function(n){n=e.extend({video:this.$(".ui-video-data").eq(0).html(),player:this.$(".ui-video-player-data").eq(0).html(),brightcovePlayerParams:null,onStatusChange:null,onProgressChange:null,onClickPlay:null,customContainerClass:""},n),t.bindAll(this,"onVideoStatusChange","onVideoProgressChange","seekVideo","onVideoError","destroy","playRecommendedVideo","startAutoPlay"),this.pubSub={"pause:videos":this.onPauseVideo,"page:load":this.onPageLoad},i.prototype.initialize.call(this,n),this.$videoStill=this.$(".ui-video-still-image"),this.$playBtn=this.$(".ui-video-play-btn"),this.isVideoStillActiveClassPreExisting=this.$videoStill.hasClass("ui-video-still-image-active"),this.isPlayBtnActiveClassPreExisting=this.$playBtn.hasClass("ui-video-play-btn-active"),window.BCCallbacks||(window.BCCallbacks={}),this.video=this._buildVideoData(),this.player=this._buildPlayerData()},playerKey:1,_buildVideoData:function(){var e=this.options.video||{};return"string"==typeof e&&(e=JSON.parse(e)),e},startAutoPlay:function(){return this.playVideo(),!0},playVideo:function(){var e=this.getVideoData()||{},t=e.id,i=e.brightcove_id;t||i?(this.hideStill(),this.loadPlayer().then(function(e){e.getIsPlaying(function(n){n?e.pause(!1):t?e.loadVideoByReferenceID(t):i&&e.loadVideoByID(i)})})):console.warn("cannot autoplay video: no video id was specified!")},_buildPlayerData:function(){var t=this.options.player||{};return"string"==typeof t&&(t=e.parseJSON(t)),e.extend({width:480,height:270},t)},getVideoData:function(){return this.video},getPlayerData:function(){return this.player},onPageLoad:function(){this.getPlayerData().autoplay&&!this.destroyed&&c.register("brightcove-video",this.startAutoPlay)},_loadScript:function(){return this._loadScriptPromise||(this._loadScriptPromise=e.Deferred(function(e){require(["http://admin.brightcove.com/js/BrightcoveExperiences.js"],function(){"undefined"!=typeof window.brightcove?e.resolve():(console.warn("Error loading Brightcove"),e.reject())})})),this._loadScriptPromise.promise()},loadPlayer:function(){return this._loadScript().then(t.bind(function(){if(!this._loadPlayerPromise){var e=this.getPlayerKey();this.video.transcript_available&&(this.subviews.videotranscript=new l({el:this.$el.siblings(".ui-video-controls"),seek:this.seekVideo,video:this.video,player:this.player})),this._loadPlayerPromise=this._createPlayer(e).then(t.bind(function(t){return this.setupPlayer(t,e),this.$el.addClass("video-player-loaded"),this._player=t,t},this))}return this._loadPlayerPromise},this))},setupPlayer:function(e,i){this.setupEventListeners(e),this.addPlayerCallback(i,"onClickShareButton",t.bind(function(){this.onClickShareButton()},this)),this.addPlayerCallback(i,"onClickSearchButton",t.bind(function(e){this.onClickSearchButton(e)},this))},_neonEnabled:function(){return s.getNested(window.site_vars,"flags","neon")&&window.NeonPlayerTracker},_createPlayer:function(i){return this._videoObjEl=this._buildVideoObjectHtml(i),e.Deferred(t.bind(function(e){this.getPlayerData().id?(this.addPlayerCallback(i,this.getPlayerReadyCallbackKey(),t.bind(function(t){var n=window.brightcove.api.getExperience(i),s=n.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER);this._triggerNeon("onTemplateReady",t),e.resolve(s)},this)),this.addPlayerCallback(i,this.getPlayerLoadCallbackKey(),t.bind(function(){var e=window.brightcove.api.getExperience(i);this._triggerNeon("onTemplateLoad",e.id)},this)),this.addPlayerCallback(i,this.getPlayerErrorCallbackKey(),function(t){var i=t.errorType;4===t.code?i="error creating video player because of "+t.errorType:(console.warn("video player error: "+i),e.reject(t))}),window.brightcove.createExperiencesPostLoad=function(){},window.brightcove.createExperience(this._videoObjEl,this.$el[0],!0)):(console.warn("error creating video player: no video player id was specified!"),e.reject())},this))},_triggerNeon:function(e,i){this._neonEnabled()&&t.isFunction(window.NeonPlayerTracker[e])&&window.NeonPlayerTracker[e](i)},onClickShareButton:function(){n.getActiveApp().$(".util-bar-btn-email").click()},onClickSearchButton:function(e){this.subviews.videotranscript.togglesearch(e)},onPauseVideo:function(){this._player&&this._player.pause()},addPlayerCallback:function(e,t,i){window.BCCallbacks[e]||(window.BCCallbacks[e]={}),window.BCCallbacks[e][t]||(window.BCCallbacks[e][t]={}),window.BCCallbacks[e][t]=function(){i.apply(this,arguments)}},setupEventListeners:function(e){this.eventListeners={BEGIN:this.onVideoStatusChange,COMPLETE:this.onVideoStatusChange,PLAY:this.onVideoStatusChange,STOP:this.onVideoStatusChange,SEEK_NOTIFY:this.onVideoStatusChange,PROGRESS:this.onVideoProgressChange,ERROR:this.onVideoError,CHANGE:this.onVideoProgressChange},this.mediaEventApi=window.brightcove.api.events.MediaEvent,t.each(this.eventListeners,function(t,i){e.addEventListener(this.mediaEventApi[i],t)},this)},removeEventListeners:function(e){t.each(this.eventListeners,function(t,i){e.removeEventListener(this.mediaEventApi[i],t)},this)},onVideoStatusChange:function(e){if("mediaBegin"===e.type){var t="video:load";n.stopRefreshTimer(),r.trigger(t,this.getVideoEventAnalyticsData(e,t))}else"mediaComplete"===e.type?this.player.gannett_continuous_endslate&&this.shouldIncludeRecommendation()&&!this.options.overrideGetRecommendations&&(this.subviews.TaboolaOutbrain?(this.$endslate_template=this.$(".video-endslate"),this.subviews.TaboolaOutbrain.populateEndslate(this.$endslate_template,this.player.mediatemplate)):this.reset()):r.trigger("uotrack",e.type);this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&this.subviews.videotranscript.onStatusChange(e),this.options.onStatusChange&&this.options.onStatusChange(e)},onVideoProgressChange:function(e){this.trackVideoProgressEvent(e),this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&this.subviews.videotranscript.progressHighlight(e),this.options.onProgressChange&&this.options.onProgressChange(e)},onVideoError:function(e){r.trigger("uotrack","videoError:"+this.player.name+":"+(e.errorType||e.code))},trackVideoProgressEvent:function(e){var t=e.duration,i=e.position,n=Math.round(i/t*100),s=this.video.url||e.media.customFields.gdp_canonical_url;!this.fiftypercent&&n>=50&&95>n?(r.trigger("vitrack",{percentage:"50%",video_url:s}),this.fiftypercent=!0):!this.ninetyfivepercent&&n>=95&&99>n&&(r.trigger("vitrack",{percentage:"95%",video_url:s}),this.ninetyfivepercent=!0,this.options.overrideGetRecommendations?this.player.gannett_continuous_endslate&&this.options.overrideGetRecommendations(e):this.shouldIncludeRecommendation()&&!this.subviews.TaboolaOutbrain&&(this.subviews.TaboolaOutbrain=new d({playRecommendedVideo:this.playRecommendedVideo,isContinuousEndslate:!0}),this.subviews.TaboolaOutbrain.renderEndslate(this.video.url,this.video.brightcove_id)))},playRecommendedVideo:function(e){this.destroy(),this.subviews.nextVideo=new u({video:e,el:this.$el}),this.subviews.nextVideo.playVideo(),this.$el.parent().find(".video-desc").html(e.description+"<span class=credit>"+e.credit+"</span>")},_buildVideoObjectHtml:function(t){var i=document.createElement("object"),n=this.getPlayerData(),s=this.getVideoData();i.setAttribute("id",t),i.className="brightcove-video-object "+this.options.customContainerClass,i.setAttribute("style","width: "+n.width+"px; height: "+n.height+"px;");var o=e.extend({},this.getDefaultParams(t),this.options.brightcovePlayerParams);for(var a in o)if(o.hasOwnProperty(a)){var r=document.createElement("param");r.name=a,r.value=o[a],i.appendChild(r)}if(s&&(s.id||s.brightcove_id)){var l=document.createElement("param");l.name="@videoPlayer",l.value=s.id?"ref:"+s.id:s.brightcove_id,i.appendChild(l)}return i},getDefaultParams:function(e){var t=this.getVideoData(),i=this.getPlayerData(),n={};return n={bgcolor:"#FFFFFF",playerID:i.id,width:i.width,height:i.height,autoStart:!1,isVid:!0,isUI:!0,wmode:"transparent",htmlFallback:!0,dynamicStreaming:!0,includeAPI:!0,usat_hasEmbed:!0,templateReadyHandler:"BCCallbacks."+e+"."+this.getPlayerReadyCallbackKey(),templateLoadHandler:"BCCallbacks."+e+"."+this.getPlayerLoadCallbackKey(),templateErrorHandler:"BCCallbacks."+e+"."+this.getPlayerErrorCallbackKey(),adServerURL:this._buildAdServerParam(),usat_linkurl:t.url||"",SSTSCode:(t.ssts_string||"")+"/"},!this.player.hidesearchcontrol&&this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&(n.usat_searchToggled=this.player.flashsearchcontrolOn?"true":"false",n.usat_searchFunction="function(e){setTimeout(BCCallbacks."+e+".onClickSearchButton(e), 1)}"),this.video.sharecontrol&&(this.player.overridesharecontrol=!1),this.player.overridesharecontrol&&(n.usat_shareFunction="function(){setTimeout(BCCallbacks."+e+".onClickShareButton(), 1)}"),n},_buildAdServerParam:function(){var t=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),i=e.cookie("aam_uuid"),s="",a=n.getActivePageInfo(),r=this.getVideoData();a.series&&(s+="&series="+encodeURIComponent(a.series)),a.topic&&(s+="&topic="+encodeURIComponent(a.topic)),a.basePageType&&(s+="&pagetype="+encodeURIComponent(a.basePageType)),s+="&aam="+t+"&u="+i;var l="http://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output=xml_vast2&iu="+o.buildAdUnit("preroll_video")+"/"+r.cst+"&sz=920x508&unviewed_position_start=1&cust_params=contentid%3D"+r.id+encodeURIComponent(s)+'&cmsid=12768&url=""';return h.logInfo("Built ad call for video, "+r.id+".",a,r),h.logInfo("Video Ad call: "+l),l},getVideoEventAnalyticsData:function(e,t){var i=e.duration,n=e.media,s=Math.round(e.position/i*100),o=this.getVideoData(),a=this.getPlayerData(),r={completion:s+"%",videoFulllengthUrl:n.FLVFullLengthURL,eventtype:t||e.type,videoName:n.customFields.liveVideoSubject||n.displayName,contentid:n.id,assetid:n.referenceId,ssts:o.ssts_string||n.customFields.gdp_ssts,cst:o.cst||n.customFields.gdp_cst,keywords:o.keywords||n.customFields.gdp_tags,videoplayername:a.name,videocontentprovider:o.videocontentprovider||n.customFields.gannetttracking+"|"+n.displayName,contenttype:o.type||"video",videotranscript:this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()?"yes":"no"};return r.videoDuration=0>i?"":120>i?"less than 2 min":"greater than 2 min",o.url&&(r.pathName=o.url.replace(/^.*\/\/[^\/]+/,"")),r},shouldIncludeRecommendation:function(){return"sponsor-story"!=n.getActivePageInfo().section_name&&"sponsor-story"!=s.getNested(this.video,"ssts","section")},getPlayerReadyCallbackKey:function(){return"onTemplateReady"},getPlayerLoadCallbackKey:function(){return"onTemplateLoad"},getPlayerErrorCallbackKey:function(){return"onTemplateError"},getPlayerKey:function(){return this._playerKey||u.prototype.playerKey++,this._playerKey="myExperience"+u.prototype.playerKey,this._playerKey},onClickVideoStill:function(e){this.options.onClickPlay?this.options.onClickPlay(e):this.playVideo()},hideStill:function(){this.$videoStill.removeClass("ui-video-still-image-active"),this.$playBtn.removeClass("ui-video-play-btn-active")},showStill:function(){this.$videoStill.addClass("ui-video-still-image-active"),this.$playBtn.addClass("ui-video-play-btn-active")},reset:function(){var e=this._player;this.fiftypercent=!1,this.ninetyfivepercent=!1,this.showStill(),e&&e.getIsPlaying(function(t){t&&e.getVideoPosition(!1,function(t){0!==t&&e.seek(0),e.pause(!0)})})},_destroyVideoObjectElement:function(){this._videoObjEl&&(e("#"+this.getPlayerKey()).remove(),this._videoObjEl=null)},seekVideo:function(e){this._player&&this._player.seek(e)},_resetPlayerModule:function(){this._player&&(this.removeEventListeners(this._player),this._player=null)},_getPreExistingActiveClass:function(e){var t=e+"-active";return this.isPlayBtnActiveClassPreExisting||this.isVideoStillActiveClassPreExisting?t:""},destroy:function(t,s){if(n.startRefreshTimer(),!s){var o=this.getPlayerKey();window.BCCallbacks&&window.BCCallbacks[o]&&delete window.BCCallbacks[o],window.BCCallbacks&&e.isEmptyObject(window.BCCallbacks)&&delete window.BCCallbacks,this._resetPlayerModule(),this.fiftypercent=!1,this.ninetyfivepercent=!1,this._destroyVideoObjectElement(),this.$el.removeClass("video-player-loaded"),this.$videoStill.addClass(this._getPreExistingActiveClass("ui-video-still-image")),this.$playBtn.addClass(this._getPreExistingActiveClass("ui-video-play-btn"))}i.prototype.destroy.apply(this,arguments)}});return u}),define("modules/scroller/vertical-scroll",["jquery","underscore","utils","modules/scroller/base-scroll"],function(e,t,i,n){var s=n.extend({initialize:function(i){i=e.extend({color:"light",fadeout:!1,draggerPaddingTop:3,draggerPaddingBottom:3},i);var s=this.options.fadeout?"fadeout":"",o=t.template('<div class="vertical-scroll ui-<%= color %> <%= fade %>"><div class="scrolldragger"><div class="over-icon"></div></div></div>');i.template=o({color:i.color,fade:s}),this.$(".vertical-scroll").remove(),n.prototype.initialize.call(this,i)},getViewportSize:function(){return this.$el.height()},getContentSize:function(){return this.content.height()},_setDraggerSize:function(e){return e-=this.options.draggerPaddingTop+this.options.draggerPaddingBottom,this.dragger.css({height:e}),e},animateContentToPosition:function(i,n,s,o){var a=this.viewportSize-this.contentSize,r=Math.max(a,Math.min(n,0));return o=o||"ease-out",e.when(this.animate(this.dragger,"top",-1*r*this.contentViewportRatio+"px",s||0,o),this.animate(this.content,"top",r+"px",s,o)).done(t.bind(function(){this.$el.trigger("scrollBarUpdate",[r/a])},this))},scrollToElement:function(e,t,i,n){var s,o=e.outerHeight(),a=e.position().top+e.parent().position().top,r=a+o;if(0>a){var l=this.getViewportSize();s=t?a+(o-l):a}else r>this.getViewportSize()&&(s=t?a:a+(o-this.getViewportSize()));if(s){var h=this.content.position().top-s;this.animateContentToPosition(0,h,i,n)}},moveContentToPosition:function(e,t){if(!this.active)return!1;var i=Math.min(this.viewportSize-this.contentSize,0),n=Math.max(i,Math.min(t,0));return this._positionDragger(-1*n*this.contentViewportRatio),this._positionContent(n),this.$el.trigger("scrollBarUpdate",[n/i]),n===t},moveDraggerToPosition:function(e,t){if(!this.active)return!1;var i=this.viewportSize-(this.draggerSize+this.options.draggerPaddingBottom+this.options.draggerPaddingTop),n=Math.max(0,Math.min(t,i));return this._positionDragger(n),this._positionContent(-1*n/this.contentViewportRatio),this.$el.trigger("scrollBarUpdate",n/i),n===t},_positionDragger:function(e){e+=this.options.draggerPaddingTop,e=Math.round(e),this.dragger.css({top:e})},_positionContent:function(e){e=Math.round(e),this.content.css({top:e}),"function"==typeof this.options.onScroll&&this.options.onScroll(e)}});return s}),define("ui/dropdown",["jquery","underscore","utils","managers/routemanager","baseview","state","modules/scroller/vertical-scroll"],function(e,t,i,n,s,o,a){"use strict";var r=s.extend({events:{"click .ui-dropdown-value":"onClick",keydown:"onKeyDown","click .ui-dropdown-item":"onItemClick","mouseenter .ui-dropdown-item":"onItemHover","click .ui-dropdown-item-link":"onItemLinkClick"},initialize:function(n){n=e.extend({onSelect:null},n),t.bindAll(this,"refresh"),s.prototype.initialize.call(this,n),this.body=i.get("body"),this.$el.attr("tabindex")||this.$el.attr("tabindex",0),this.dropdownItems=this._setupDropdownItems(this.$(".ui-dropdown-item")),this.dropdownValueDiv=this.$(".ui-dropdown-value"),this.defaultItem=this.dropdownItems.filter('[data-selected="selected"]'),this.setValue(this.defaultItem.data("value"),this.defaultItem.text())},_setupDropdownItems:function(t){var i=t.filter('[data-selected="selected"]');if(1!==i.length){var n=t.eq(0);n.length&&n.attr("data-selected","selected")}return t.each(function(t,i){var n=e(i),s=n.find("a");n.addClass(s.length?"ui-dropdown-item-with-link":"ui-dropdown-item-without-link")}),t},open:function(){var i=this.getDataValue(),n=this.getDropdownItemByDataValue(i);n.eq(0).attr("data-selected","selected").addClass("ui-dropdown-item-highlight"),this.$el.addClass("expanded"),this.isDropdownOpen=!0,this.subviews.scrollbar?this.subviews.scrollbar.refresh():this.subviews.scrollbar=new a({el:this.$(".ui-dropdown-content"),contentClass:".ui-dropdown-items-container",padding:6}),n.length&&this.subviews.scrollbar.scrollToElement(n,!1,50),this.body.on("click."+this.cid,t.bind(function(t){0===e(t.target).closest(this.el).length&&this.close()},this))},close:function(){this.$el.removeClass("expanded"),this.dropdownItems.removeClass("ui-dropdown-item-highlight"),this.isDropdownOpen=!1,this.body.off("click."+this.cid)},onClick:function(){this.isDropdownOpen?this.close():this.open()},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;38===t||40===t?(this.isDropdownOpen?this.onResultItemUpDownArrowKeyPress(t):this.open(),e.preventDefault()):27===t?this.isDropdownOpen&&(e.preventDefault(),this.close()):9===t?this.isDropdownOpen&&(e.preventDefault(),this.close()):(32===t||13===t)&&(this.onSpaceBarOrEnterKeyPress(),e.preventDefault())},onResultItemUpDownArrowKeyPress:function(e){var t=this.dropdownItems.filter(".ui-dropdown-item-highlight").eq(0);this.dropdownItems.removeClass("ui-dropdown-item-highlight"),t.length?38===e?(t=t.prev(),t.length||(t=this.dropdownItems.last()),this.subviews.scrollbar&&this.subviews.scrollbar.scrollToElement(t,!1,50)):40===e&&(t=t.next(),t.length||(t=this.dropdownItems.first()),this.subviews.scrollbar&&this.subviews.scrollbar.scrollToElement(t,!1,50)):t=this.dropdownItems.eq(0),t.addClass("ui-dropdown-item-highlight")
},onSpaceBarOrEnterKeyPress:function(){var e=this.dropdownItems.filter(".ui-dropdown-item-highlight").eq(0),t=e.find("a").attr("href"),i=e.data("value"),s=e.text();e.length&&this.setValue(i,s),this.options.onSelect&&this.options.onSelect(i,s,e),t&&n.goTo(t)},onItemClick:function(t){var i=e(t.currentTarget),n=i.data("value"),s=i.text();this.setValue(n,s),this.options.onSelect&&this.options.onSelect(n,s,i)},onItemLinkClick:function(t){var i=e(t.currentTarget).closest(".ui-dropdown-item");this.setValue(i.data("value"),i.text())},onItemHover:function(t){this.dropdownItems.removeClass("ui-dropdown-item-highlight"),e(t.currentTarget).addClass("ui-dropdown-item-highlight")},setValue:function(e,t){var i;this.dropdownItems.removeAttr("data-selected"),void 0!==e?(this.dropdownValueDiv.data("value",e),i=this.getDropdownItemByDataValue(e)):i=this.getDropdownItemByDisplayValue(t),this.dropdownValueDiv.html(t),"selected"!==i.eq(0).data("selected")&&i.eq(0).attr("data-selected","selected"),this.isDropdownOpen&&this.close()},getDataValue:function(){return this.dropdownValueDiv.data("value")||""},getDisplayValue:function(){return this.dropdownValueDiv.text()||""},getDropdownItemByDataValue:function(e){return this.dropdownItems.filter('[data-value="'+e+'"]')},getDropdownItemByDisplayValue:function(e){return this.dropdownItems.filter(':contains("'+e+'")')},refresh:function(t){if(t){var i=this._setupDropdownItems(e(t));this.$(".ui-dropdown-items-container").html(i),this.dropdownItems=i}var n=this.dropdownItems.filter('[data-selected="selected"]');this.setValue(n.data("value"),n.text()),this.defaultItem=n},reset:function(){this.setValue(this.defaultItem.data("value"),this.defaultItem.text())},destroy:function(e){this.body.off("."+this.cid),s.prototype.destroy.call(this,e)}});return r}),define("apps/media",["jquery","underscore","pubsub","utils","state","base-app","sharedAdPosition","modules/carousel/carousel-autosize","modules/videos/brightcove-video","modules/global/taboola","ui/dropdown"],function(e,t,i,n,s,o,a,r,l,h,d){"use strict";var c=o.extend({el:"#media-view",events:{"click .recommended, .more-from, .expando":"mediaTabClick","mouseout .media-playlist":"mediaPlaylistMouseOut","mouseover .media-playlist":"mediaPlaylistMouseIn","click .media-playlist a":"changeMediaClick","click .media-sidebar-list li.sub":"sectionHighlight",click:"userInteraction"},initialize:function(i){i=e.extend(!0,{delay:{playlistAutoClose:250},animations:{slide:{duration:350,easing:"ease-in-out"},cinematic:{change:{fadeOut:{duration:300,easing:"ease-in-out"},fadeIn:{duration:300,easing:"ease-in-out"}}}}},i),t.bindAll(this,"switchToNextVideo","handleResizeWindow"),this.win=n.get("win"),this.scrollEl=n.get("scrollEl"),this.win.on("resize."+this.cid,t.throttle(this.handleResizeWindow,50)),this.playlistTimer=null,this.init=!1,this.subviews={},o.prototype.initialize.call(this,i);var s=e(".sidenav > li.sub-active");this.lastSectionName=s.attr("data-section")},getAd:function(){this.subviews.skinad=new a({el:this.$(".partner-media-ad"),adSizes:["cinematicvideoskin"],adPlacement:"skin_media",adType:"skinmedia",defaultPosition:!0})},handleResizeWindow:function(){this.browse&&this.columnize(this.$el)},beforePageReveal:function(e,t,i){this.isCinematicPath(t)||this.columnize(i)},afterPageReveal:function(e,t){this.isCinematicPath(t)?("galleries"==this.pageInfo.media_type?this._initializeGallery():"videopage"==this.pageInfo.media_type&&(this._initializeVideo(this.$(".ui-video")),this.getAd()),this.browse=!1,this.isCinematicPath(e)||(this.playlistStuckOpen=!1,this.delayClosePlaylist(),e&&this.$(".back-to-media").attr("href",e))):this._initializeBrowse(),this.handleResizeWindow(),this.subviews.filterDropdown||(this.subviews.filterDropdown=new d({el:this.$(".media-view-sort-by-dropdown")})),n.lazyLoadImage(this.$(".more-from").find("img"),"data-src",!0)},animateChangePagePostData:function(e,t,i){return this.isCinematicPath(t)?this.isCinematicPath(e)?this._fadeInNewCinematicContent(t,i):this.slide(i,"left",this.options.animations.slide.duration,this.options.animations.slide.easing):this.isCinematicPath(e)?this.slide(i,"right",this.options.animations.slide.duration,this.options.animations.slide.easing):o.prototype.animateChangePagePostData.apply(this,arguments)},animateChangePagePreData:function(e,t){return this.isCinematicPath(e)||this.isCinematicPath(t)?void 0:this.changeBrowseSection(e,t)},changeBrowseSection:function(t,i){var n=this.$(".media-sidebar-list"),o=this._getSubSectionPath(t),a=this._getSubSectionPath(i);if(o!==a){var r,l;return n.children().each(function(t,i){i=e(i);var n=i.attr("data-section")||"";n===o?(r=i.find(".media-sidenav-sublist").slideUp(250).promise(),r.done(function(){i.removeClass("active")})):n===a&&(l=i.find(".media-sidenav-sublist").slideDown(250).promise(),l.done(function(){i.addClass("active")}))}),r&&s.registerAnimation(r),l&&s.registerAnimation(l),e.when(r,l)}},_getSubSectionPath:function(e){if(e=e.replace(/^media\/((latest|popular)\/)?/,"")){var t=e.indexOf("/");return-1===t?e:e.substring(0,t)}return""},isCinematicPath:function(e){return e&&-1!==e.indexOf("/cinematic")},_fadeInNewCinematicContent:function(i,n){return e.Deferred(t.bind(function(e){this._swapRelatedMedia(n),this._swapNavBar(n),this._swapMainView(n,e)},this)).promise()},_swapNavBar:function(e){var i=this.animate(this.$(".cinematic-side-nav-ul"),"opacity",0,this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);i.done(t.bind(function(){var t=e.find(".cinematic-side-nav-ul");t.css("opacity",0),this.$(".cinematic-side-nav-ul").replaceWith(t),this.animate(t,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing)},this))},_swapMainView:function(e,i){var n=this.animate(this.$(".media-main-view"),"opacity",0,this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);n.done(t.bind(function(){var n=e.find(".media-main-view");if(n.css("opacity",0),this.$(".media-main-view").replaceWith(n),n.length){var s=this.animate(n,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing);s.done(t.bind(function(){i.resolve()},this))}else i.resolve()},this))},_swapRelatedMedia:function(e){var i=this.animate(this.$(".recommended"),"opacity",this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);i.done(t.bind(function(){var t=e.find(".media-tabs-ul .recommended"),i=e.find(".media-playlist > .recommended");t.css("opacity",0),this.$(".media-tabs-ul .recommended").replaceWith(t),this.$(".media-playlist > .recommended").replaceWith(i),t.length&&this.animate(t,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing)},this))},_initializeGallery:function(){var e=this.$(".galleries"),t=e.data().galleryId||0;this.subviews.carousel=new r({el:this.$el,gallerySelector:e,scrollerColor:"dark",horizontalAdjust:126,verticalAdjust:117}),this.subviews.taboola=new h({isWidgetPresent:!1}),this.subviews.taboola.getRelated(this.showRecommended,"photo","photo",10,null,t,"Recommended – Cinematic Photo")},_initializeVideo:function(e){this.subviews.video=new l({el:e,onVideoStatusChange:this.switchToNextVideo,autostart:!0});var t=this.subviews.video.getVideoData().brightcove_id;this.subviews.taboola=new h({isWidgetPresent:!1}),this.subviews.taboola.getRelated(this.showRecommended,"video","video",10,null,t,"Recommended – Cinematic Video")},userInteraction:function(){this.switchVideoTimer&&clearTimeout(this.switchVideoTimer)},switchToNextVideo:function(){var e=this.$(".more-from .active").next();e.length&&(this.switchVideoTimer=setTimeout(function(){e.find("a").click()},5e3))},destroyModules:function(){clearTimeout(this.switchVideoTimer),o.prototype.destroyModules.apply(this,arguments)},destroy:function(e){this.win.off("."+this.cid),o.prototype.destroy.call(this,e)},changeMediaClick:function(t){var i=e(t.target);this.$(".playlist li.active").removeClass("active"),i.closest("li").addClass("active")},mediaTabClick:function(t){var i=this.$(".media-playlist"),n=e(t.target).closest("li");n.hasClass("expando")?i.hasClass("open")?(this.playlistStuckOpen=!1,i.removeClass("open")):(this.playlistStuckOpen=!0,i.addClass("open")):n.hasClass("tab")&&(i.addClass("open"),n.hasClass("active")||(i.find(".media-tabs .active").removeClass("active"),n.addClass("active"),i.find(".playlist").addClass("hidden"),i.find("."+n.attr("for")).removeClass("hidden")))},mediaPlaylistMouseOut:function(){this.playlistStuckOpen||this.delayClosePlaylist()},mediaPlaylistMouseIn:function(){clearTimeout(this.playlistTimer)},delayClosePlaylist:function(){this.$(".media-playlist").removeClass("initial")},_initializeBrowse:function(){this.gridWrapper=this.$(".grid-wrapper"),this.browse=!0},columnize:function(t){var i=360,s=t.find(".medialistitems"),o=e(window).width(),a=o-130-31,r=Math.floor(a/i);1>r&&(r=1),t.find(".media-content").width(r*i),s.removeClass("mediaview-featured"),s.slice(0,r).addClass("mediaview-featured"),n.lazyLoadImage(this.$(".mediaview-featured").find("img"),"data-large-src",!0)},sectionHighlight:function(t){var i=e(t.currentTarget);if(i.hasClass("active")&&!e(t.target).attr("href")){var n=i.children("ul");i.hasClass("collapsed")?(s.registerAnimation(n.slideDown(250).promise()),i.removeClass("collapsed")):(s.registerAnimation(n.slideUp(250).promise()),i.addClass("collapsed"))}},slide:function(i,s,o,a){var r=null,l=null;"left"===s?(r="left",l=-100):"right"===s&&(r="left",l=100);var h=n.getScrollPosition(),d=this.$el.offset().top;h-=d,this.$el.css(r,"0%"),this.$el.css({position:"absolute",top:-1*h}),i=e(i),i.css(r,-1*l+"%"),i.css({position:"absolute",top:d}),i.insertAfter(this.$el);var c=e.Deferred();return t.defer(t.bind(function(){0!==this.$el.length&&this.animate(this.$el,r,l+"%",o,a);var e=this.animate(i,r,"0%",o,a);e.done(t.bind(function(){this.$el.remove(),i.css({position:"",top:""}),this.setElement(i),c.resolve()},this))},this)),c.promise()},showRecommended:function(i){var n=e("#mediaview-recommended-template");if(1===n.length){var s=t.template(n.html(),{data:i.list});e("#mediaview-cinematic-recommended").append(s)}}});return c}),function(){var e={},t={};document.writeln=(self.console||{}).log||function(){},document.write=function(){for(var i in e)if(e.hasOwnProperty(i))try{e[i].apply({},arguments)}catch(n){}for(var s=Array.prototype.join.call(arguments,""),o="<script[^<>]*src=['\"]?([^'\"<> :/]*:*//[a-z0-9.]*google.com/[^'\"<> ]*)['\"]?[^<>]*>[^<>]*</script>",a=new RegExp(o,"gi"),r=new RegExp(o,"i"),l=s.match(a)||[],h=0;h<l.length;h++)l[h].match(r),$.ajax({cache:!0,dataType:"script",success:function(){for(var e in t)if(t.hasOwnProperty(e))try{t[e].apply({},arguments)}catch(i){}},url:RegExp.$1}),s=s.replace(l[h],"");if(!s.match(/^\s*$/))try{console.log("document.write ignoring ",s)}catch(n){}},document.addOnWrite=function(t,i){"function"==typeof i&&(e[t]||(e[t]=i))},document.addOnScript=function(e,i){"function"==typeof i&&(t[e]||(t[e]=i))},document.delOnWrite=function(t){delete e[t]||(e[t]=void 0)},document.delOnScript=function(e){delete t[e]||(t[e]=void 0)}}(),define("global/document-write",function(){}),define("apps/search",["jquery","underscore","backbone","pubsub","utils","base-app","state","site-manager","global/document-write"],function(e,t,i,n,s,o,a,r){"use strict";var l=o.extend({el:".search-results",events:{"click .grid-btn":"gridView","click .list-btn":"listView"},initialize:function(i){i=e.extend(!0,{delay:{playlistAutoClose:250},animations:{open:{duration:250,easing:"ease-in-out"},close:{duration:250,easing:"ease-in-out"}}},i),this.win=s.get("win"),this.body=s.get("body"),this.scrollEl=s.get("scrollEl"),this.header=r.getHeader(),t.bindAll(this,"lazyload"),this.currentView="view-grid",this.init=!1,this.requestInProgress=!1,this.win.on("scroll."+this.cid,t.throttle(this.lazyload,200)),e(".site-masthead-search-close-btn").addClass("site-masthead-search-close-btn-visible"),o.prototype.initialize.call(this,i)},getRevealAppLoader:function(){return'<article class="search-results ui-loading dark-medium"></article>'},isSearchPage:!0,animateRevealApp:function(i){if(null===i)return e.Deferred().resolve();this.$("#search-form").css("height",""),this.$el.css({opacity:1,position:"absolute",overflow:"hidden",display:"block",top:"-100%",height:"100%"});var n=this.animate(this.$el,"top","0%",this.options.animations.open.duration,this.options.animations.open.easing);return n.done(t.bind(function(){this.body.addClass("show-search"),this.$el.css({height:"",top:"",position:""})},this)),n},setFixedPosition:function(){this.$(".summary").css({top:this.header.getCurrentHeight()}),o.prototype.setFixedPosition.apply(this,arguments)},clearFixedPosition:function(){this.$(".summary").css({top:"",position:""}),o.prototype.clearFixedPosition.apply(this,arguments)},_onHeaderFixed:function(){o.prototype._onHeaderFixed.apply(this,arguments),this._fixedOffset&&this.$(".summary").css({top:this.header.getCollapsedHeight(),position:"fixed"})},_onHeaderUnfixed:function(){this._fixedOffset&&this.$(".summary").css({top:-1*this._fixedOffset+this.header.getCollapsedHeight(),position:"absolute"}),o.prototype._onHeaderUnfixed.apply(this,arguments)},animateRemoveApp:function(){var e=s.getScrollPosition();return this.$el.css({marginTop:-1*e,overflow:"hidden",height:this.win.height()+e}),this.$(".summary").css("position","absolute"),this.body.removeClass("show-search"),this.animate(this.$el,"top","-100%",this.options.animations.close.duration,this.options.animations.close.easing)},afterAppRemove:function(){e(".site-masthead-search-close-btn").removeClass("site-masthead-search-close-btn-visible"),n.trigger("uotrack","searchResultsclose")},afterPageReveal:function(e){this.init||(this.init=!0,this.originalPath=e),this.moreResultsPlacer=this.$(".more-results"),this.lazyload(),this.searchWrap=this.$("#search-form"),this.searchTextInput=this.searchWrap.find(".text-input"),this.setup(),this.setupTextAd()},getMoreResults:function(e){return this.requestInProgress=!0,this.moreResultsPlacer.show(),a.fetchHtml(e).done(t.bind(function(e){this.moreResultsPlacer.parent().append(e),this.moreResultsPlacer.remove(),this.moreResultsPlacer=this.$(".more-results")},this)).fail(t.bind(function(){this.moreResultsPlacer.remove(),this.moreResultsPlacer=null},this)).always(t.bind(function(){this.requestInProgress=!1},this)),!1},getTerm:function(){return e(".search-term .term",this.$el).attr("data-term")},getPubId:function(){return s.getNested(window.site_vars,"THIRDPARTYAPI","ADSENSE","pubId")||""},setup:function(){this.results=this.$(".results"),this.summary=this.$(".summary"),this.sidebar=this.$(".sidebar"),this.viewGrid=this.$(".grid-btn"),this.viewList=this.$(".list-btn"),"view-list"===this.currentView&&this.listView()},setupTextAd:function(){var t="partner_search_text_ads"+(new Date).getTime();e(".tile.ad",this.$el).attr("id",t);var i={pubId:this.getPubId(),query:this.getTerm(),hl:"en"},n={container:t,lines:"3",fontFamily:"arial",fontSizeTitle:"13px",fontSizeDescription:"12px",fontSizeDomainLink:"12px",colorTitleLink:"1EA3FF",colorText:"FFFFFF",colorDomainLink:"00C641",colorBackground:"2C2C2C"};this.loadGoogleSearchAds(i,n)},gridView:function(){return this.viewGrid.addClass("active"),this.viewList.removeClass("active"),this.summary.removeClass("list").addClass("grid"),this.results.removeClass("view-list").addClass("view-grid"),this.currentView="view-grid",e(".ad").appendTo(".sidebar"),!1},listView:function(){return this.viewList.addClass("active"),this.viewGrid.removeClass("active"),this.summary.removeClass("grid").addClass("list"),this.results.removeClass("view-grid").addClass("view-list"),this.currentView="view-list",e(".ad").prependTo(".list-content"),!1},lazyload:function(){if(this.init&&this.moreResultsPlacer&&this.moreResultsPlacer.length&&!this.requestInProgress){var e=s.getScrollPosition(),t=this.body.height();this.moreResultsPlacer.offset().top<=e+t&&this.getMoreResults(this.moreResultsPlacer.data("href"))}},loadGoogleSearchAds:function(e,t){var i=!1,n=function(){return i?(document.delOnWrite("searchads"),void document.delOnScript("searchads")):void(window.google&&window.google.ads&&window.google.ads.search&&window.google.ads.search.Ads&&(i=new window.google.ads.search.Ads(e,t),document.delOnWrite("searchads"),document.delOnScript("searchads")))};n()||(document.addOnWrite("searchads",n),document.addOnScript("searchads",n),a.fetchData("http://www.google.com/adsense/search/ads.js",{cache:!0,dataType:"script",success:n}))},destroy:function(){document.delOnWrite("searchads"),document.delOnScript("searchads"),this.win.off("."+this.cid),o.prototype.destroy.apply(this,arguments)}});return l}),function(window,document,undefined){!function(e){"use strict";"function"==typeof define&&define.amd?define("libs/jquery/plugins/jquery.dataTables",["jquery"],e):jQuery&&!jQuery.fn.dataTable&&e(jQuery)}(function($){"use strict";var DataTable=function(oInit){function _fnAddColumn(e,t){var i=DataTable.defaults.columns,n=e.aoColumns.length,s=$.extend({},DataTable.models.oColumn,i,{sSortingClass:e.oClasses.sSortable,sSortingClassJUI:e.oClasses.sSortJUI,nTh:t?t:document.createElement("th"),sTitle:i.sTitle?i.sTitle:t?t.innerHTML:"",aDataSort:i.aDataSort?i.aDataSort:[n],mData:i.mData?i.oDefaults:n});if(e.aoColumns.push(s),e.aoPreSearchCols[n]===undefined||null===e.aoPreSearchCols[n])e.aoPreSearchCols[n]=$.extend({},DataTable.models.oSearch);else{var o=e.aoPreSearchCols[n];o.bRegex===undefined&&(o.bRegex=!0),o.bSmart===undefined&&(o.bSmart=!0),o.bCaseInsensitive===undefined&&(o.bCaseInsensitive=!0)}_fnColumnOptions(e,n,null)}function _fnColumnOptions(e,t,i){var n=e.aoColumns[t];i!==undefined&&null!==i&&(i.mDataProp&&!i.mData&&(i.mData=i.mDataProp),i.sType!==undefined&&(n.sType=i.sType,n._bAutoType=!1),$.extend(n,i),_fnMap(n,i,"sWidth","sWidthOrig"),i.iDataSort!==undefined&&(n.aDataSort=[i.iDataSort]),_fnMap(n,i,"aDataSort"));var s=n.mRender?_fnGetObjectDataFn(n.mRender):null,o=_fnGetObjectDataFn(n.mData);n.fnGetData=function(e,t){var i=o(e,t);return n.mRender&&t&&""!==t?s(i,t,e):i},n.fnSetData=_fnSetObjectDataFn(n.mData),e.oFeatures.bSort||(n.bSortable=!1),!n.bSortable||-1==$.inArray("asc",n.asSorting)&&-1==$.inArray("desc",n.asSorting)?(n.sSortingClass=e.oClasses.sSortableNone,n.sSortingClassJUI=""):-1==$.inArray("asc",n.asSorting)&&-1==$.inArray("desc",n.asSorting)?(n.sSortingClass=e.oClasses.sSortable,n.sSortingClassJUI=e.oClasses.sSortJUI):-1!=$.inArray("asc",n.asSorting)&&-1==$.inArray("desc",n.asSorting)?(n.sSortingClass=e.oClasses.sSortableAsc,n.sSortingClassJUI=e.oClasses.sSortJUIAscAllowed):-1==$.inArray("asc",n.asSorting)&&-1!=$.inArray("desc",n.asSorting)&&(n.sSortingClass=e.oClasses.sSortableDesc,n.sSortingClassJUI=e.oClasses.sSortJUIDescAllowed)}function _fnAdjustColumnSizing(e){if(e.oFeatures.bAutoWidth===!1)return!1;_fnCalculateColumnWidths(e);for(var t=0,i=e.aoColumns.length;i>t;t++)e.aoColumns[t].nTh.style.width=e.aoColumns[t].sWidth}function _fnVisibleToColumnIndex(e,t){var i=_fnGetColumns(e,"bVisible");return"number"==typeof i[t]?i[t]:null}function _fnColumnIndexToVisible(e,t){var i=_fnGetColumns(e,"bVisible"),n=$.inArray(t,i);return-1!==n?n:null}function _fnVisbleColumns(e){return _fnGetColumns(e,"bVisible").length}function _fnGetColumns(e,t){var i=[];return $.map(e.aoColumns,function(e,n){e[t]&&i.push(n)}),i}function _fnDetectType(e){for(var t=DataTable.ext.aTypes,i=t.length,n=0;i>n;n++){var s=t[n](e);if(null!==s)return s}return"string"}function _fnReOrderIndex(e,t){for(var i=t.split(","),n=[],s=0,o=e.aoColumns.length;o>s;s++)for(var a=0;o>a;a++)if(e.aoColumns[s].sName==i[a]){n.push(a);break}return n}function _fnColumnOrdering(e){for(var t="",i=0,n=e.aoColumns.length;n>i;i++)t+=e.aoColumns[i].sName+",";return t.length==n?"":t.slice(0,-1)}function _fnApplyColumnDefs(e,t,i,n){var s,o,a,r,l,h;if(t)for(s=t.length-1;s>=0;s--){var d=t[s].aTargets;for($.isArray(d)||_fnLog(e,1,"aTargets must be an array of targets, not a "+typeof d),a=0,r=d.length;r>a;a++)if("number"==typeof d[a]&&d[a]>=0){for(;e.aoColumns.length<=d[a];)_fnAddColumn(e);n(d[a],t[s])}else if("number"==typeof d[a]&&d[a]<0)n(e.aoColumns.length+d[a],t[s]);else if("string"==typeof d[a])for(l=0,h=e.aoColumns.length;h>l;l++)("_all"==d[a]||$(e.aoColumns[l].nTh).hasClass(d[a]))&&n(l,t[s])}if(i)for(s=0,o=i.length;o>s;s++)n(s,i[s])}function _fnAddData(e,t){var i,n=$.isArray(t)?t.slice():$.extend(!0,{},t),s=e.aoData.length,o=$.extend(!0,{},DataTable.models.oRow);o._aData=n,e.aoData.push(o);for(var a,r=0,l=e.aoColumns.length;l>r;r++)if(i=e.aoColumns[r],"function"==typeof i.fnRender&&i.bUseRendered&&null!==i.mData?_fnSetCellData(e,s,r,_fnRender(e,s,r)):_fnSetCellData(e,s,r,_fnGetCellData(e,s,r)),i._bAutoType&&"string"!=i.sType){var h=_fnGetCellData(e,s,r,"type");null!==h&&""!==h&&(a=_fnDetectType(h),null===i.sType?i.sType=a:i.sType!=a&&"html"!=i.sType&&(i.sType="string"))}return e.aiDisplayMaster.push(s),e.oFeatures.bDeferRender||_fnCreateTr(e,s),s}function _fnGatherData(e){var t,i,n,s,o,a,r,l,h,d,c,u,p,f,g;if(e.bDeferLoading||null===e.sAjaxSource)for(r=e.nTBody.firstChild;r;){if("TR"==r.nodeName.toUpperCase())for(l=e.aoData.length,r._DT_RowIndex=l,e.aoData.push($.extend(!0,{},DataTable.models.oRow,{nTr:r})),e.aiDisplayMaster.push(l),a=r.firstChild,n=0;a;)p=a.nodeName.toUpperCase(),("TD"==p||"TH"==p)&&(_fnSetCellData(e,l,n,$.trim(a.innerHTML)),n++),a=a.nextSibling;r=r.nextSibling}for(o=_fnGetTrNodes(e),s=[],t=0,i=o.length;i>t;t++)for(a=o[t].firstChild;a;)p=a.nodeName.toUpperCase(),("TD"==p||"TH"==p)&&s.push(a),a=a.nextSibling;for(c=0,u=e.aoColumns.length;u>c;c++){f=e.aoColumns[c],null===f.sTitle&&(f.sTitle=f.nTh.innerHTML);var m,v,b,y,w=f._bAutoType,_="function"==typeof f.fnRender,C=null!==f.sClass,x=f.bVisible;if(w||_||C||!x)for(h=0,d=e.aoData.length;d>h;h++)g=e.aoData[h],m=s[h*u+c],w&&"string"!=f.sType&&(y=_fnGetCellData(e,h,c,"type"),""!==y&&(v=_fnDetectType(y),null===f.sType?f.sType=v:f.sType!=v&&"html"!=f.sType&&(f.sType="string"))),f.mRender?m.innerHTML=_fnGetCellData(e,h,c,"display"):f.mData!==c&&(m.innerHTML=_fnGetCellData(e,h,c,"display")),_&&(b=_fnRender(e,h,c),m.innerHTML=b,f.bUseRendered&&_fnSetCellData(e,h,c,b)),C&&(m.className+=" "+f.sClass),x?g._anHidden[c]=null:(g._anHidden[c]=m,m.parentNode.removeChild(m)),f.fnCreatedCell&&f.fnCreatedCell.call(e.oInstance,m,_fnGetCellData(e,h,c,"display"),g._aData,h,c)}if(0!==e.aoRowCreatedCallback.length)for(t=0,i=e.aoData.length;i>t;t++)g=e.aoData[t],_fnCallbackFire(e,"aoRowCreatedCallback",null,[g.nTr,g._aData,t])}function _fnNodeToDataIndex(e,t){return t._DT_RowIndex!==undefined?t._DT_RowIndex:null}function _fnNodeToColumnIndex(e,t,i){for(var n=_fnGetTdNodes(e,t),s=0,o=e.aoColumns.length;o>s;s++)if(n[s]===i)return s;return-1}function _fnGetRowData(e,t,i,n){for(var s=[],o=0,a=n.length;a>o;o++)s.push(_fnGetCellData(e,t,n[o],i));return s}function _fnGetCellData(e,t,i,n){var s,o=e.aoColumns[i],a=e.aoData[t]._aData;if((s=o.fnGetData(a,n))===undefined)return e.iDrawError!=e.iDraw&&null===o.sDefaultContent&&(_fnLog(e,0,"Requested unknown parameter "+("function"==typeof o.mData?"{mData function}":"'"+o.mData+"'")+" from the data source for row "+t),e.iDrawError=e.iDraw),o.sDefaultContent;if(null===s&&null!==o.sDefaultContent)s=o.sDefaultContent;else if("function"==typeof s)return s();return"display"==n&&null===s?"":s}function _fnSetCellData(e,t,i,n){var s=e.aoColumns[i],o=e.aoData[t]._aData;s.fnSetData(o,n)}function _fnGetObjectDataFn(e){if(null===e)return function(){return null};if("function"==typeof e)return function(t,i,n){return e(t,i,n)};if("string"!=typeof e||-1===e.indexOf(".")&&-1===e.indexOf("["))return function(t){return t[e]};var t=function(e,i,n){var s,o,a,r=n.split(".");if(""!==n)for(var l=0,h=r.length;h>l;l++){if(s=r[l].match(__reArray)){r[l]=r[l].replace(__reArray,""),""!==r[l]&&(e=e[r[l]]),o=[],r.splice(0,l+1),a=r.join(".");for(var d=0,c=e.length;c>d;d++)o.push(t(e[d],i,a));var u=s[0].substring(1,s[0].length-1);e=""===u?o:o.join(u);break}if(null===e||e[r[l]]===undefined)return undefined;e=e[r[l]]}return e};return function(i,n){return t(i,n,e)}}function _fnSetObjectDataFn(e){if(null===e)return function(){};if("function"==typeof e)return function(t,i){e(t,"set",i)};if("string"!=typeof e||-1===e.indexOf(".")&&-1===e.indexOf("["))return function(t,i){t[e]=i};var t=function(e,i,n){for(var s,o,a,r,l=n.split("."),h=0,d=l.length-1;d>h;h++){if(o=l[h].match(__reArray)){l[h]=l[h].replace(__reArray,""),e[l[h]]=[],s=l.slice(),s.splice(0,h+1),r=s.join(".");for(var c=0,u=i.length;u>c;c++)a={},t(a,i[c],r),e[l[h]].push(a);return}(null===e[l[h]]||e[l[h]]===undefined)&&(e[l[h]]={}),e=e[l[h]]}e[l[l.length-1].replace(__reArray,"")]=i};return function(i,n){return t(i,n,e)}}function _fnGetDataMaster(e){for(var t=[],i=e.aoData.length,n=0;i>n;n++)t.push(e.aoData[n]._aData);return t}function _fnClearTable(e){e.aoData.splice(0,e.aoData.length),e.aiDisplayMaster.splice(0,e.aiDisplayMaster.length),e.aiDisplay.splice(0,e.aiDisplay.length),_fnCalculateEnd(e)}function _fnDeleteIndex(e,t){for(var i=-1,n=0,s=e.length;s>n;n++)e[n]==t?i=n:e[n]>t&&e[n]--;-1!=i&&e.splice(i,1)}function _fnRender(e,t,i){var n=e.aoColumns[i];return n.fnRender({iDataRow:t,iDataColumn:i,oSettings:e,aData:e.aoData[t]._aData,mDataProp:n.mData},_fnGetCellData(e,t,i,"display"))}function _fnCreateTr(e,t){var i,n=e.aoData[t];if(null===n.nTr){n.nTr=document.createElement("tr"),n.nTr._DT_RowIndex=t,n._aData.DT_RowId&&(n.nTr.id=n._aData.DT_RowId),n._aData.DT_RowClass&&(n.nTr.className=n._aData.DT_RowClass);for(var s=0,o=e.aoColumns.length;o>s;s++){var a=e.aoColumns[s];i=document.createElement(a.sCellType),i.innerHTML="function"!=typeof a.fnRender||a.bUseRendered&&null!==a.mData?_fnGetCellData(e,t,s,"display"):_fnRender(e,t,s),null!==a.sClass&&(i.className=a.sClass),a.bVisible?(n.nTr.appendChild(i),n._anHidden[s]=null):n._anHidden[s]=i,a.fnCreatedCell&&a.fnCreatedCell.call(e.oInstance,i,_fnGetCellData(e,t,s,"display"),n._aData,t,s)}_fnCallbackFire(e,"aoRowCreatedCallback",null,[n.nTr,n._aData,t])}}function _fnBuildHead(e){var t,i,n,s=$("th, td",e.nTHead).length;if(0!==s)for(t=0,n=e.aoColumns.length;n>t;t++)i=e.aoColumns[t].nTh,i.setAttribute("role","columnheader"),e.aoColumns[t].bSortable&&(i.setAttribute("tabindex",e.iTabIndex),i.setAttribute("aria-controls",e.sTableId)),null!==e.aoColumns[t].sClass&&$(i).addClass(e.aoColumns[t].sClass),e.aoColumns[t].sTitle!=i.innerHTML&&(i.innerHTML=e.aoColumns[t].sTitle);else{var o=document.createElement("tr");for(t=0,n=e.aoColumns.length;n>t;t++)i=e.aoColumns[t].nTh,i.innerHTML=e.aoColumns[t].sTitle,i.setAttribute("tabindex","0"),null!==e.aoColumns[t].sClass&&$(i).addClass(e.aoColumns[t].sClass),o.appendChild(i);$(e.nTHead).html("")[0].appendChild(o),_fnDetectHeader(e.aoHeader,e.nTHead)}if($(e.nTHead).children("tr").attr("role","row"),e.bJUI)for(t=0,n=e.aoColumns.length;n>t;t++){i=e.aoColumns[t].nTh;var a=document.createElement("div");a.className=e.oClasses.sSortJUIWrapper,$(i).contents().appendTo(a);var r=document.createElement("span");r.className=e.oClasses.sSortIcon,a.appendChild(r),i.appendChild(a)}if(e.oFeatures.bSort)for(t=0;t<e.aoColumns.length;t++)e.aoColumns[t].bSortable!==!1?_fnSortAttachListener(e,e.aoColumns[t].nTh,t):$(e.aoColumns[t].nTh).addClass(e.oClasses.sSortableNone);if(""!==e.oClasses.sFooterTH&&$(e.nTFoot).children("tr").children("th").addClass(e.oClasses.sFooterTH),null!==e.nTFoot){var l=_fnGetUniqueThs(e,null,e.aoFooter);for(t=0,n=e.aoColumns.length;n>t;t++)l[t]&&(e.aoColumns[t].nTf=l[t],e.aoColumns[t].sClass&&$(l[t]).addClass(e.aoColumns[t].sClass))}}function _fnDrawHead(e,t,i){var n,s,o,a,r,l,h,d,c,u=[],p=[],f=e.aoColumns.length;for(i===undefined&&(i=!1),n=0,s=t.length;s>n;n++){for(u[n]=t[n].slice(),u[n].nTr=t[n].nTr,o=f-1;o>=0;o--)e.aoColumns[o].bVisible||i||u[n].splice(o,1);p.push([])}for(n=0,s=u.length;s>n;n++){if(h=u[n].nTr)for(;l=h.firstChild;)h.removeChild(l);for(o=0,a=u[n].length;a>o;o++)if(d=1,c=1,p[n][o]===undefined){for(h.appendChild(u[n][o].cell),p[n][o]=1;u[n+d]!==undefined&&u[n][o].cell==u[n+d][o].cell;)p[n+d][o]=1,d++;for(;u[n][o+c]!==undefined&&u[n][o].cell==u[n][o+c].cell;){for(r=0;d>r;r++)p[n+r][o+c]=1;c++}u[n][o].cell.rowSpan=d,u[n][o].cell.colSpan=c}}}function _fnDraw(e){var t=_fnCallbackFire(e,"aoPreDrawCallback","preDraw",[e]);if(-1!==$.inArray(!1,t))return void _fnProcessingDisplay(e,!1);var i,n,s,o=[],a=0,r=e.asStripeClasses.length,l=e.aoOpenRows.length;if(e.bDrawing=!0,e.iInitDisplayStart!==undefined&&-1!=e.iInitDisplayStart&&(e._iDisplayStart=e.oFeatures.bServerSide?e.iInitDisplayStart:e.iInitDisplayStart>=e.fnRecordsDisplay()?0:e.iInitDisplayStart,e.iInitDisplayStart=-1,_fnCalculateEnd(e)),e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++;else if(e.oFeatures.bServerSide){if(!e.bDestroying&&!_fnAjaxUpdate(e))return}else e.iDraw++;if(0!==e.aiDisplay.length){var h=e._iDisplayStart,d=e._iDisplayEnd;e.oFeatures.bServerSide&&(h=0,d=e.aoData.length);for(var c=h;d>c;c++){var u=e.aoData[e.aiDisplay[c]];null===u.nTr&&_fnCreateTr(e,e.aiDisplay[c]);var p=u.nTr;if(0!==r){var f=e.asStripeClasses[a%r];u._sRowStripe!=f&&($(p).removeClass(u._sRowStripe).addClass(f),u._sRowStripe=f)}if(_fnCallbackFire(e,"aoRowCallback",null,[p,e.aoData[e.aiDisplay[c]]._aData,a,c]),o.push(p),a++,0!==l)for(var g=0;l>g;g++)if(p==e.aoOpenRows[g].nParent){o.push(e.aoOpenRows[g].nTr);break}}}else{o[0]=document.createElement("tr"),e.asStripeClasses[0]&&(o[0].className=e.asStripeClasses[0]);var m=e.oLanguage,v=m.sZeroRecords;1!=e.iDraw||null===e.sAjaxSource||e.oFeatures.bServerSide?m.sEmptyTable&&0===e.fnRecordsTotal()&&(v=m.sEmptyTable):v=m.sLoadingRecords;var b=document.createElement("td");b.setAttribute("valign","top"),b.colSpan=_fnVisbleColumns(e),b.className=e.oClasses.sRowEmpty,b.innerHTML=_fnInfoMacros(e,v),o[a].appendChild(b)}_fnCallbackFire(e,"aoHeaderCallback","header",[$(e.nTHead).children("tr")[0],_fnGetDataMaster(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay]),_fnCallbackFire(e,"aoFooterCallback","footer",[$(e.nTFoot).children("tr")[0],_fnGetDataMaster(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay]);var y,w=document.createDocumentFragment(),_=document.createDocumentFragment();if(e.nTBody){if(y=e.nTBody.parentNode,_.appendChild(e.nTBody),!e.oScroll.bInfinite||!e._bInitComplete||e.bSorted||e.bFiltered)for(;s=e.nTBody.firstChild;)e.nTBody.removeChild(s);for(i=0,n=o.length;n>i;i++)w.appendChild(o[i]);e.nTBody.appendChild(w),null!==y&&y.appendChild(e.nTBody)}_fnCallbackFire(e,"aoDrawCallback","draw",[e]),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1,e.oFeatures.bServerSide&&(_fnProcessingDisplay(e,!1),e._bInitComplete||_fnInitComplete(e))}function _fnReDraw(e){e.oFeatures.bSort?_fnSort(e,e.oPreviousSearch):e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch):(_fnCalculateEnd(e),_fnDraw(e))}function _fnAddOptionsHtml(e){var t=$("<div></div>")[0];e.nTable.parentNode.insertBefore(t,e.nTable),e.nTableWrapper=$('<div id="'+e.sTableId+'_wrapper" class="'+e.oClasses.sWrapper+'" role="grid"></div>')[0],e.nTableReinsertBefore=e.nTable.nextSibling;for(var i,n,s,o,a,r,l,h=e.nTableWrapper,d=e.sDom.split(""),c=0;c<d.length;c++){if(n=0,s=d[c],"<"==s){if(o=$("<div></div>")[0],a=d[c+1],"'"==a||'"'==a){for(r="",l=2;d[c+l]!=a;)r+=d[c+l],l++;if("H"==r?r=e.oClasses.sJUIHeader:"F"==r&&(r=e.oClasses.sJUIFooter),-1!=r.indexOf(".")){var u=r.split(".");o.id=u[0].substr(1,u[0].length-1),o.className=u[1]}else"#"==r.charAt(0)?o.id=r.substr(1,r.length-1):o.className=r;c+=l}h.appendChild(o),h=o}else if(">"==s)h=h.parentNode;else if("l"==s&&e.oFeatures.bPaginate&&e.oFeatures.bLengthChange)i=_fnFeatureHtmlLength(e),n=1;else if("f"==s&&e.oFeatures.bFilter)i=_fnFeatureHtmlFilter(e),n=1;else if("r"==s&&e.oFeatures.bProcessing)i=_fnFeatureHtmlProcessing(e),n=1;else if("t"==s)i=_fnFeatureHtmlTable(e),n=1;else if("i"==s&&e.oFeatures.bInfo)i=_fnFeatureHtmlInfo(e),n=1;
else if("p"==s&&e.oFeatures.bPaginate)i=_fnFeatureHtmlPaginate(e),n=1;else if(0!==DataTable.ext.aoFeatures.length)for(var p=DataTable.ext.aoFeatures,f=0,g=p.length;g>f;f++)if(s==p[f].cFeature){i=p[f].fnInit(e),i&&(n=1);break}1==n&&null!==i&&("object"!=typeof e.aanFeatures[s]&&(e.aanFeatures[s]=[]),e.aanFeatures[s].push(i),h.appendChild(i))}t.parentNode.replaceChild(e.nTableWrapper,t)}function _fnDetectHeader(e,t){var i,n,s,o,a,r,l,h,d,c,u,p=$(t).children("tr"),f=function(e,t,i){for(var n=e[t];n[i];)i++;return i};for(e.splice(0,e.length),s=0,r=p.length;r>s;s++)e.push([]);for(s=0,r=p.length;r>s;s++)for(i=p[s],h=0,n=i.firstChild;n;){if("TD"==n.nodeName.toUpperCase()||"TH"==n.nodeName.toUpperCase())for(d=1*n.getAttribute("colspan"),c=1*n.getAttribute("rowspan"),d=d&&0!==d&&1!==d?d:1,c=c&&0!==c&&1!==c?c:1,l=f(e,s,h),u=1===d?!0:!1,a=0;d>a;a++)for(o=0;c>o;o++)e[s+o][l+a]={cell:n,unique:u},e[s+o].nTr=i;n=n.nextSibling}}function _fnGetUniqueThs(e,t,i){var n=[];i||(i=e.aoHeader,t&&(i=[],_fnDetectHeader(i,t)));for(var s=0,o=i.length;o>s;s++)for(var a=0,r=i[s].length;r>a;a++)!i[s][a].unique||n[a]&&e.bSortCellsTop||(n[a]=i[s][a].cell);return n}function _fnAjaxUpdate(e){if(e.bAjaxDataGet){e.iDraw++,_fnProcessingDisplay(e,!0);var t=(e.aoColumns.length,_fnAjaxParameters(e));return _fnServerParams(e,t),e.fnServerData.call(e.oInstance,e.sAjaxSource,t,function(t){_fnAjaxUpdateDraw(e,t)},e),!1}return!0}function _fnAjaxParameters(e){var t,i,n,s,o,a=e.aoColumns.length,r=[];for(r.push({name:"sEcho",value:e.iDraw}),r.push({name:"iColumns",value:a}),r.push({name:"sColumns",value:_fnColumnOrdering(e)}),r.push({name:"iDisplayStart",value:e._iDisplayStart}),r.push({name:"iDisplayLength",value:e.oFeatures.bPaginate!==!1?e._iDisplayLength:-1}),s=0;a>s;s++)t=e.aoColumns[s].mData,r.push({name:"mDataProp_"+s,value:"function"==typeof t?"function":t});if(e.oFeatures.bFilter!==!1)for(r.push({name:"sSearch",value:e.oPreviousSearch.sSearch}),r.push({name:"bRegex",value:e.oPreviousSearch.bRegex}),s=0;a>s;s++)r.push({name:"sSearch_"+s,value:e.aoPreSearchCols[s].sSearch}),r.push({name:"bRegex_"+s,value:e.aoPreSearchCols[s].bRegex}),r.push({name:"bSearchable_"+s,value:e.aoColumns[s].bSearchable});if(e.oFeatures.bSort!==!1){var l=0;for(i=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),s=0;s<i.length;s++)for(n=e.aoColumns[i[s][0]].aDataSort,o=0;o<n.length;o++)r.push({name:"iSortCol_"+l,value:n[o]}),r.push({name:"sSortDir_"+l,value:i[s][1]}),l++;for(r.push({name:"iSortingCols",value:l}),s=0;a>s;s++)r.push({name:"bSortable_"+s,value:e.aoColumns[s].bSortable})}return r}function _fnServerParams(e,t){_fnCallbackFire(e,"aoServerParams","serverParams",[t])}function _fnAjaxUpdateDraw(e,t){if(t.sEcho!==undefined){if(1*t.sEcho<e.iDraw)return;e.iDraw=1*t.sEcho}(!e.oScroll.bInfinite||e.oScroll.bInfinite&&(e.bSorted||e.bFiltered))&&_fnClearTable(e),e._iRecordsTotal=parseInt(t.iTotalRecords,10),e._iRecordsDisplay=parseInt(t.iTotalDisplayRecords,10);var i,n=_fnColumnOrdering(e),s=t.sColumns!==undefined&&""!==n&&t.sColumns!=n;s&&(i=_fnReOrderIndex(e,t.sColumns));for(var o=_fnGetObjectDataFn(e.sAjaxDataProp)(t),a=0,r=o.length;r>a;a++)if(s){for(var l=[],h=0,d=e.aoColumns.length;d>h;h++)l.push(o[a][i[h]]);_fnAddData(e,l)}else _fnAddData(e,o[a]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,_fnDraw(e),e.bAjaxDataGet=!0,_fnProcessingDisplay(e,!1)}function _fnFeatureHtmlFilter(e){var t=e.oPreviousSearch,i=e.oLanguage.sSearch;i=-1!==i.indexOf("_INPUT_")?i.replace("_INPUT_",'<input type="text" />'):""===i?'<input type="text" />':i+' <input type="text" />';var n=document.createElement("div");n.className=e.oClasses.sFilter,n.innerHTML="<label>"+i+"</label>",e.aanFeatures.f||(n.id=e.sTableId+"_filter");var s=$('input[type="text"]',n);return n._DT_Input=s[0],s.val(t.sSearch.replace('"',"&quot;")),s.bind("keyup.DT",function(){for(var i=e.aanFeatures.f,n=""===this.value?"":this.value,s=0,o=i.length;o>s;s++)i[s]!=$(this).parents("div.dataTables_filter")[0]&&$(i[s]._DT_Input).val(n);n!=t.sSearch&&_fnFilterComplete(e,{sSearch:n,bRegex:t.bRegex,bSmart:t.bSmart,bCaseInsensitive:t.bCaseInsensitive})}),s.attr("aria-controls",e.sTableId).bind("keypress.DT",function(e){return 13==e.keyCode?!1:void 0}),n}function _fnFilterComplete(e,t,i){var n=e.oPreviousSearch,s=e.aoPreSearchCols,o=function(e){n.sSearch=e.sSearch,n.bRegex=e.bRegex,n.bSmart=e.bSmart,n.bCaseInsensitive=e.bCaseInsensitive};if(e.oFeatures.bServerSide)o(t);else{_fnFilter(e,t.sSearch,i,t.bRegex,t.bSmart,t.bCaseInsensitive),o(t);for(var a=0;a<e.aoPreSearchCols.length;a++)_fnFilterColumn(e,s[a].sSearch,a,s[a].bRegex,s[a].bSmart,s[a].bCaseInsensitive);_fnFilterCustom(e)}e.bFiltered=!0,$(e.oInstance).trigger("filter",e),e._iDisplayStart=0,_fnCalculateEnd(e),_fnDraw(e),_fnBuildSearchArray(e,0)}function _fnFilterCustom(e){for(var t=DataTable.ext.afnFiltering,i=_fnGetColumns(e,"bSearchable"),n=0,s=t.length;s>n;n++)for(var o=0,a=0,r=e.aiDisplay.length;r>a;a++){var l=e.aiDisplay[a-o],h=t[n](e,_fnGetRowData(e,l,"filter",i),l);h||(e.aiDisplay.splice(a-o,1),o++)}}function _fnFilterColumn(e,t,i,n,s,o){if(""!==t)for(var a=0,r=_fnFilterCreateSearch(t,n,s,o),l=e.aiDisplay.length-1;l>=0;l--){var h=_fnDataToSearch(_fnGetCellData(e,e.aiDisplay[l],i,"filter"),e.aoColumns[i].sType);r.test(h)||(e.aiDisplay.splice(l,1),a++)}}function _fnFilter(e,t,i,n,s,o){var a,r=_fnFilterCreateSearch(t,n,s,o),l=e.oPreviousSearch;if(i||(i=0),0!==DataTable.ext.afnFiltering.length&&(i=1),t.length<=0)e.aiDisplay.splice(0,e.aiDisplay.length),e.aiDisplay=e.aiDisplayMaster.slice();else if(e.aiDisplay.length==e.aiDisplayMaster.length||l.sSearch.length>t.length||1==i||0!==t.indexOf(l.sSearch))for(e.aiDisplay.splice(0,e.aiDisplay.length),_fnBuildSearchArray(e,1),a=0;a<e.aiDisplayMaster.length;a++)r.test(e.asDataSearch[a])&&e.aiDisplay.push(e.aiDisplayMaster[a]);else{var h=0;for(a=0;a<e.asDataSearch.length;a++)r.test(e.asDataSearch[a])||(e.aiDisplay.splice(a-h,1),h++)}}function _fnBuildSearchArray(e,t){if(!e.oFeatures.bServerSide){e.asDataSearch=[];for(var i=_fnGetColumns(e,"bSearchable"),n=1===t?e.aiDisplayMaster:e.aiDisplay,s=0,o=n.length;o>s;s++)e.asDataSearch[s]=_fnBuildSearchRow(e,_fnGetRowData(e,n[s],"filter",i))}}function _fnBuildSearchRow(e,t){var i=t.join("  ");return-1!==i.indexOf("&")&&(i=$("<div>").html(i).text()),i.replace(/[\n\r]/g," ")}function _fnFilterCreateSearch(e,t,i,n){var s,o;return i?(s=t?e.split(" "):_fnEscapeRegex(e).split(" "),o="^(?=.*?"+s.join(")(?=.*?")+").*$",new RegExp(o,n?"i":"")):(e=t?e:_fnEscapeRegex(e),new RegExp(e,n?"i":""))}function _fnDataToSearch(e,t){return"function"==typeof DataTable.ext.ofnSearch[t]?DataTable.ext.ofnSearch[t](e):null===e?"":"html"==t?e.replace(/[\r\n]/g," ").replace(/<.*?>/g,""):"string"==typeof e?e.replace(/[\r\n]/g," "):e}function _fnEscapeRegex(e){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"],i=new RegExp("(\\"+t.join("|\\")+")","g");return e.replace(i,"\\$1")}function _fnFeatureHtmlInfo(e){var t=document.createElement("div");return t.className=e.oClasses.sInfo,e.aanFeatures.i||(e.aoDrawCallback.push({fn:_fnUpdateInfo,sName:"information"}),t.id=e.sTableId+"_info"),e.nTable.setAttribute("aria-describedby",e.sTableId+"_info"),t}function _fnUpdateInfo(e){if(e.oFeatures.bInfo&&0!==e.aanFeatures.i.length){var t,i=e.oLanguage,n=e._iDisplayStart+1,s=e.fnDisplayEnd(),o=e.fnRecordsTotal(),a=e.fnRecordsDisplay();t=0===a?i.sInfoEmpty:i.sInfo,a!=o&&(t+=" "+i.sInfoFiltered),t+=i.sInfoPostFix,t=_fnInfoMacros(e,t),null!==i.fnInfoCallback&&(t=i.fnInfoCallback.call(e.oInstance,e,n,s,o,a,t));for(var r=e.aanFeatures.i,l=0,h=r.length;h>l;l++)$(r[l]).html(t)}}function _fnInfoMacros(e,t){var i=e._iDisplayStart+1,n=e.fnFormatNumber(i),s=e.fnDisplayEnd(),o=e.fnFormatNumber(s),a=e.fnRecordsDisplay(),r=e.fnFormatNumber(a),l=e.fnRecordsTotal(),h=e.fnFormatNumber(l);return e.oScroll.bInfinite&&(n=e.fnFormatNumber(1)),t.replace(/_START_/g,n).replace(/_END_/g,o).replace(/_TOTAL_/g,r).replace(/_MAX_/g,h)}function _fnInitialise(e){var t,i,n=e.iInitDisplayStart;if(e.bInitialised===!1)return void setTimeout(function(){_fnInitialise(e)},200);for(_fnAddOptionsHtml(e),_fnBuildHead(e),_fnDrawHead(e,e.aoHeader),e.nTFoot&&_fnDrawHead(e,e.aoFooter),_fnProcessingDisplay(e,!0),e.oFeatures.bAutoWidth&&_fnCalculateColumnWidths(e),t=0,i=e.aoColumns.length;i>t;t++)null!==e.aoColumns[t].sWidth&&(e.aoColumns[t].nTh.style.width=_fnStringToCss(e.aoColumns[t].sWidth));if(e.oFeatures.bSort?_fnSort(e):e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch):(e.aiDisplay=e.aiDisplayMaster.slice(),_fnCalculateEnd(e),_fnDraw(e)),null!==e.sAjaxSource&&!e.oFeatures.bServerSide){var s=[];return _fnServerParams(e,s),void e.fnServerData.call(e.oInstance,e.sAjaxSource,s,function(i){var s=""!==e.sAjaxDataProp?_fnGetObjectDataFn(e.sAjaxDataProp)(i):i;for(t=0;t<s.length;t++)_fnAddData(e,s[t]);e.iInitDisplayStart=n,e.oFeatures.bSort?_fnSort(e):(e.aiDisplay=e.aiDisplayMaster.slice(),_fnCalculateEnd(e),_fnDraw(e)),_fnProcessingDisplay(e,!1),_fnInitComplete(e,i)},e)}e.oFeatures.bServerSide||(_fnProcessingDisplay(e,!1),_fnInitComplete(e))}function _fnInitComplete(e,t){e._bInitComplete=!0,_fnCallbackFire(e,"aoInitComplete","init",[e,t])}function _fnLanguageCompat(e){var t=DataTable.defaults.oLanguage;!e.sEmptyTable&&e.sZeroRecords&&"No data available in table"===t.sEmptyTable&&_fnMap(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&e.sZeroRecords&&"Loading..."===t.sLoadingRecords&&_fnMap(e,e,"sZeroRecords","sLoadingRecords")}function _fnFeatureHtmlLength(e){if(e.oScroll.bInfinite)return null;var t,i,n='name="'+e.sTableId+'_length"',s='<select size="1" '+n+">",o=e.aLengthMenu;if(2==o.length&&"object"==typeof o[0]&&"object"==typeof o[1])for(t=0,i=o[0].length;i>t;t++)s+='<option value="'+o[0][t]+'">'+o[1][t]+"</option>";else for(t=0,i=o.length;i>t;t++)s+='<option value="'+o[t]+'">'+o[t]+"</option>";s+="</select>";var a=document.createElement("div");return e.aanFeatures.l||(a.id=e.sTableId+"_length"),a.className=e.oClasses.sLength,a.innerHTML="<label>"+e.oLanguage.sLengthMenu.replace("_MENU_",s)+"</label>",$('select option[value="'+e._iDisplayLength+'"]',a).attr("selected",!0),$("select",a).bind("change.DT",function(){var n=$(this).val(),s=e.aanFeatures.l;for(t=0,i=s.length;i>t;t++)s[t]!=this.parentNode&&$("select",s[t]).val(n);e._iDisplayLength=parseInt(n,10),_fnCalculateEnd(e),e.fnDisplayEnd()==e.fnRecordsDisplay()&&(e._iDisplayStart=e.fnDisplayEnd()-e._iDisplayLength,e._iDisplayStart<0&&(e._iDisplayStart=0)),-1==e._iDisplayLength&&(e._iDisplayStart=0),_fnDraw(e)}),$("select",a).attr("aria-controls",e.sTableId),a}function _fnCalculateEnd(e){e._iDisplayEnd=e.oFeatures.bPaginate===!1?e.aiDisplay.length:e._iDisplayStart+e._iDisplayLength>e.aiDisplay.length||-1==e._iDisplayLength?e.aiDisplay.length:e._iDisplayStart+e._iDisplayLength}function _fnFeatureHtmlPaginate(e){if(e.oScroll.bInfinite)return null;var t=document.createElement("div");return t.className=e.oClasses.sPaging+e.sPaginationType,DataTable.ext.oPagination[e.sPaginationType].fnInit(e,t,function(e){_fnCalculateEnd(e),_fnDraw(e)}),e.aanFeatures.p||e.aoDrawCallback.push({fn:function(e){DataTable.ext.oPagination[e.sPaginationType].fnUpdate(e,function(e){_fnCalculateEnd(e),_fnDraw(e)})},sName:"pagination"}),t}function _fnPageChange(e,t){var i=e._iDisplayStart;if("number"==typeof t)e._iDisplayStart=t*e._iDisplayLength,e._iDisplayStart>e.fnRecordsDisplay()&&(e._iDisplayStart=0);else if("first"==t)e._iDisplayStart=0;else if("previous"==t)e._iDisplayStart=e._iDisplayLength>=0?e._iDisplayStart-e._iDisplayLength:0,e._iDisplayStart<0&&(e._iDisplayStart=0);else if("next"==t)e._iDisplayLength>=0?e._iDisplayStart+e._iDisplayLength<e.fnRecordsDisplay()&&(e._iDisplayStart+=e._iDisplayLength):e._iDisplayStart=0;else if("last"==t)if(e._iDisplayLength>=0){var n=parseInt((e.fnRecordsDisplay()-1)/e._iDisplayLength,10)+1;e._iDisplayStart=(n-1)*e._iDisplayLength}else e._iDisplayStart=0;else _fnLog(e,0,"Unknown paging action: "+t);return $(e.oInstance).trigger("page",e),i!=e._iDisplayStart}function _fnFeatureHtmlProcessing(e){var t=document.createElement("div");return e.aanFeatures.r||(t.id=e.sTableId+"_processing"),t.innerHTML=e.oLanguage.sProcessing,t.className=e.oClasses.sProcessing,e.nTable.parentNode.insertBefore(t,e.nTable),t}function _fnProcessingDisplay(e,t){if(e.oFeatures.bProcessing)for(var i=e.aanFeatures.r,n=0,s=i.length;s>n;n++)i[n].style.visibility=t?"visible":"hidden";$(e.oInstance).trigger("processing",[e,t])}function _fnFeatureHtmlTable(e){if(""===e.oScroll.sX&&""===e.oScroll.sY)return e.nTable;var t=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),r=e.nTable.cloneNode(!1),l=e.nTable.cloneNode(!1),h=e.nTable.getElementsByTagName("thead")[0],d=0===e.nTable.getElementsByTagName("tfoot").length?null:e.nTable.getElementsByTagName("tfoot")[0],c=e.oClasses;i.appendChild(n),o.appendChild(a),s.appendChild(e.nTable),t.appendChild(i),t.appendChild(s),n.appendChild(r),r.appendChild(h),null!==d&&(t.appendChild(o),a.appendChild(l),l.appendChild(d)),t.className=c.sScrollWrapper,i.className=c.sScrollHead,n.className=c.sScrollHeadInner,s.className=c.sScrollBody,o.className=c.sScrollFoot,a.className=c.sScrollFootInner,e.oScroll.bAutoCss&&(i.style.overflow="hidden",i.style.position="relative",o.style.overflow="hidden",s.style.overflow="auto"),i.style.border="0",i.style.width="100%",o.style.border="0",n.style.width=""!==e.oScroll.sXInner?e.oScroll.sXInner:"100%",r.removeAttribute("id"),r.style.marginLeft="0",e.nTable.style.marginLeft="0",null!==d&&(l.removeAttribute("id"),l.style.marginLeft="0");var u=$(e.nTable).children("caption");return u.length>0&&(u=u[0],"top"===u._captionSide?r.appendChild(u):"bottom"===u._captionSide&&d&&l.appendChild(u)),""!==e.oScroll.sX&&(i.style.width=_fnStringToCss(e.oScroll.sX),s.style.width=_fnStringToCss(e.oScroll.sX),null!==d&&(o.style.width=_fnStringToCss(e.oScroll.sX)),$(s).scroll(function(){i.scrollLeft=this.scrollLeft,null!==d&&(o.scrollLeft=this.scrollLeft)})),""!==e.oScroll.sY&&(s.style.height=_fnStringToCss(e.oScroll.sY)),e.aoDrawCallback.push({fn:_fnScrollDraw,sName:"scrolling"}),e.oScroll.bInfinite&&$(s).scroll(function(){e.bDrawing||0===$(this).scrollTop()||$(this).scrollTop()+$(this).height()>$(e.nTable).height()-e.oScroll.iLoadGap&&e.fnDisplayEnd()<e.fnRecordsDisplay()&&(_fnPageChange(e,"next"),_fnCalculateEnd(e),_fnDraw(e))}),e.nScrollHead=i,e.nScrollFoot=o,t}function _fnScrollDraw(e){var t,i,n,s,o,a,r,l,h,d,c,u=e.nScrollHead.getElementsByTagName("div")[0],p=u.getElementsByTagName("table")[0],f=e.nTable.parentNode,g=[],m=[],v=null!==e.nTFoot?e.nScrollFoot.getElementsByTagName("div")[0]:null,b=null!==e.nTFoot?v.getElementsByTagName("table")[0]:null,y=e.oBrowser.bScrollOversize,w=function(e){r=e.style,r.paddingTop="0",r.paddingBottom="0",r.borderTopWidth="0",r.borderBottomWidth="0",r.height=0};$(e.nTable).children("thead, tfoot").remove(),h=$(e.nTHead).clone()[0],e.nTable.insertBefore(h,e.nTable.childNodes[0]),n=e.nTHead.getElementsByTagName("tr"),s=h.getElementsByTagName("tr"),null!==e.nTFoot&&(d=$(e.nTFoot).clone()[0],e.nTable.insertBefore(d,e.nTable.childNodes[1]),a=e.nTFoot.getElementsByTagName("tr"),o=d.getElementsByTagName("tr")),""===e.oScroll.sX&&(f.style.width="100%",u.parentNode.style.width="100%");var _=_fnGetUniqueThs(e,h);for(t=0,i=_.length;i>t;t++)l=_fnVisibleToColumnIndex(e,t),_[t].style.width=e.aoColumns[l].sWidth;if(null!==e.nTFoot&&_fnApplyToChildren(function(e){e.style.width=""},o),e.oScroll.bCollapse&&""!==e.oScroll.sY&&(f.style.height=f.offsetHeight+e.nTHead.offsetHeight+"px"),c=$(e.nTable).outerWidth(),""===e.oScroll.sX?(e.nTable.style.width="100%",y&&($("tbody",f).height()>f.offsetHeight||"scroll"==$(f).css("overflow-y"))&&(e.nTable.style.width=_fnStringToCss($(e.nTable).outerWidth()-e.oScroll.iBarWidth))):""!==e.oScroll.sXInner?e.nTable.style.width=_fnStringToCss(e.oScroll.sXInner):c==$(f).width()&&$(f).height()<$(e.nTable).height()?(e.nTable.style.width=_fnStringToCss(c-e.oScroll.iBarWidth),$(e.nTable).outerWidth()>c-e.oScroll.iBarWidth&&(e.nTable.style.width=_fnStringToCss(c))):e.nTable.style.width=_fnStringToCss(c),c=$(e.nTable).outerWidth(),_fnApplyToChildren(w,s),_fnApplyToChildren(function(e){g.push(_fnStringToCss($(e).width()))},s),_fnApplyToChildren(function(e,t){e.style.width=g[t]},n),$(s).height(0),null!==e.nTFoot&&(_fnApplyToChildren(w,o),_fnApplyToChildren(function(e){m.push(_fnStringToCss($(e).width()))},o),_fnApplyToChildren(function(e,t){e.style.width=m[t]},a),$(o).height(0)),_fnApplyToChildren(function(e,t){e.innerHTML="",e.style.width=g[t]},s),null!==e.nTFoot&&_fnApplyToChildren(function(e,t){e.innerHTML="",e.style.width=m[t]},o),$(e.nTable).outerWidth()<c){var C=f.scrollHeight>f.offsetHeight||"scroll"==$(f).css("overflow-y")?c+e.oScroll.iBarWidth:c;y&&(f.scrollHeight>f.offsetHeight||"scroll"==$(f).css("overflow-y"))&&(e.nTable.style.width=_fnStringToCss(C-e.oScroll.iBarWidth)),f.style.width=_fnStringToCss(C),e.nScrollHead.style.width=_fnStringToCss(C),null!==e.nTFoot&&(e.nScrollFoot.style.width=_fnStringToCss(C)),""===e.oScroll.sX?_fnLog(e,1,"The table cannot fit into the current element which will cause column misalignment. The table has been drawn at its minimum possible width."):""!==e.oScroll.sXInner&&_fnLog(e,1,"The table cannot fit into the current element which will cause column misalignment. Increase the sScrollXInner value or remove it to allow automatic calculation")}else f.style.width=_fnStringToCss("100%"),e.nScrollHead.style.width=_fnStringToCss("100%"),null!==e.nTFoot&&(e.nScrollFoot.style.width=_fnStringToCss("100%"));if(""===e.oScroll.sY&&y&&(f.style.height=_fnStringToCss(e.nTable.offsetHeight+e.oScroll.iBarWidth)),""!==e.oScroll.sY&&e.oScroll.bCollapse){f.style.height=_fnStringToCss(e.oScroll.sY);var x=""!==e.oScroll.sX&&e.nTable.offsetWidth>f.offsetWidth?e.oScroll.iBarWidth:0;e.nTable.offsetHeight<f.offsetHeight&&(f.style.height=_fnStringToCss(e.nTable.offsetHeight+x))}var S=$(e.nTable).outerWidth();p.style.width=_fnStringToCss(S),u.style.width=_fnStringToCss(S);var T=$(e.nTable).height()>f.clientHeight||"scroll"==$(f).css("overflow-y");u.style.paddingRight=T?e.oScroll.iBarWidth+"px":"0px",null!==e.nTFoot&&(b.style.width=_fnStringToCss(S),v.style.width=_fnStringToCss(S),v.style.paddingRight=T?e.oScroll.iBarWidth+"px":"0px"),$(f).scroll(),(e.bSorted||e.bFiltered)&&(f.scrollTop=0)}function _fnApplyToChildren(e,t,i){for(var n,s,o=0,a=0,r=t.length;r>a;){for(n=t[a].firstChild,s=i?i[a].firstChild:null;n;)1===n.nodeType&&(i?e(n,s,o):e(n,o),o++),n=n.nextSibling,s=i?s.nextSibling:null;a++}}function _fnConvertToWidth(e,t){if(!e||null===e||""===e)return 0;t||(t=document.body);var i,n=document.createElement("div");return n.style.width=_fnStringToCss(e),t.appendChild(n),i=n.offsetWidth,t.removeChild(n),i}function _fnCalculateColumnWidths(e){var t,i,n,s,o=(e.nTable.offsetWidth,0),a=0,r=e.aoColumns.length,l=$("th",e.nTHead),h=e.nTable.getAttribute("width"),d=e.nTable.parentNode;for(i=0;r>i;i++)e.aoColumns[i].bVisible&&(a++,null!==e.aoColumns[i].sWidth&&(t=_fnConvertToWidth(e.aoColumns[i].sWidthOrig,d),null!==t&&(e.aoColumns[i].sWidth=_fnStringToCss(t)),o++));if(r==l.length&&0===o&&a==r&&""===e.oScroll.sX&&""===e.oScroll.sY)for(i=0;i<e.aoColumns.length;i++)t=$(l[i]).width(),null!==t&&(e.aoColumns[i].sWidth=_fnStringToCss(t));else{var c=e.nTable.cloneNode(!1),u=e.nTHead.cloneNode(!0),p=document.createElement("tbody"),f=document.createElement("tr");c.removeAttribute("id"),c.appendChild(u),null!==e.nTFoot&&(c.appendChild(e.nTFoot.cloneNode(!0)),_fnApplyToChildren(function(e){e.style.width=""},c.getElementsByTagName("tr"))),c.appendChild(p),p.appendChild(f);var g=$("thead th",c);0===g.length&&(g=$("tbody tr:eq(0)>td",c));var m=_fnGetUniqueThs(e,u);for(n=0,i=0;r>i;i++){var v=e.aoColumns[i];v.bVisible&&null!==v.sWidthOrig&&""!==v.sWidthOrig?m[i-n].style.width=_fnStringToCss(v.sWidthOrig):v.bVisible?m[i-n].style.width="":n++}for(i=0;r>i;i++)if(e.aoColumns[i].bVisible){var b=_fnGetWidestNode(e,i);null!==b&&(b=b.cloneNode(!0),""!==e.aoColumns[i].sContentPadding&&(b.innerHTML+=e.aoColumns[i].sContentPadding),f.appendChild(b))}d.appendChild(c),""!==e.oScroll.sX&&""!==e.oScroll.sXInner?c.style.width=_fnStringToCss(e.oScroll.sXInner):""!==e.oScroll.sX?(c.style.width="",$(c).width()<d.offsetWidth&&(c.style.width=_fnStringToCss(d.offsetWidth))):""!==e.oScroll.sY?c.style.width=_fnStringToCss(d.offsetWidth):h&&(c.style.width=_fnStringToCss(h)),c.style.visibility="hidden",_fnScrollingWidthAdjust(e,c);var y=$("tbody tr:eq(0)",c).children();if(0===y.length&&(y=_fnGetUniqueThs(e,$("thead",c)[0])),""!==e.oScroll.sX){var w=0;for(n=0,i=0;i<e.aoColumns.length;i++)e.aoColumns[i].bVisible&&(w+=null===e.aoColumns[i].sWidthOrig?$(y[n]).outerWidth():parseInt(e.aoColumns[i].sWidth.replace("px",""),10)+($(y[n]).outerWidth()-$(y[n]).width()),n++);c.style.width=_fnStringToCss(w),e.nTable.style.width=_fnStringToCss(w)}for(n=0,i=0;i<e.aoColumns.length;i++)e.aoColumns[i].bVisible&&(s=$(y[n]).width(),null!==s&&s>0&&(e.aoColumns[i].sWidth=_fnStringToCss(s)),n++);var _=$(c).css("width");e.nTable.style.width=-1!==_.indexOf("%")?_:_fnStringToCss($(c).outerWidth()),c.parentNode.removeChild(c)}h&&(e.nTable.style.width=_fnStringToCss(h))}function _fnScrollingWidthAdjust(e,t){if(""===e.oScroll.sX&&""!==e.oScroll.sY){{$(t).width()}t.style.width=_fnStringToCss($(t).outerWidth()-e.oScroll.iBarWidth)}else""!==e.oScroll.sX&&(t.style.width=_fnStringToCss($(t).outerWidth()))}function _fnGetWidestNode(e,t){var i=_fnGetMaxLenString(e,t);if(0>i)return null;if(null===e.aoData[i].nTr){var n=document.createElement("td");return n.innerHTML=_fnGetCellData(e,i,t,""),n}return _fnGetTdNodes(e,i)[t]}function _fnGetMaxLenString(e,t){for(var i=-1,n=-1,s=0;s<e.aoData.length;s++){var o=_fnGetCellData(e,s,t,"display")+"";o=o.replace(/<.*?>/g,""),o.length>i&&(i=o.length,n=s)}return n}function _fnStringToCss(e){if(null===e)return"0px";if("number"==typeof e)return 0>e?"0px":e+"px";var t=e.charCodeAt(e.length-1);return 48>t||t>57?e:e+"px"}function _fnScrollBarWidth(){var e=document.createElement("p"),t=e.style;t.width="100%",t.height="200px",t.padding="0px";var i=document.createElement("div");t=i.style,t.position="absolute",t.top="0px",t.left="0px",t.visibility="hidden",t.width="200px",t.height="150px",t.padding="0px",t.overflow="hidden",i.appendChild(e),document.body.appendChild(i);var n=e.offsetWidth;i.style.overflow="scroll";var s=e.offsetWidth;return n==s&&(s=i.clientWidth),document.body.removeChild(i),n-s}function _fnSort(e,t){var i,n,s,o,a,r,l,h,d=[],c=[],u=DataTable.ext.oSort,p=e.aoData,f=e.aoColumns,g=e.oLanguage.oAria;if(!e.oFeatures.bServerSide&&(0!==e.aaSorting.length||null!==e.aaSortingFixed)){for(d=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),i=0;i<d.length;i++){var m=d[i][0],v=_fnColumnIndexToVisible(e,m);if(l=e.aoColumns[m].sSortDataType,DataTable.ext.afnSortData[l]){var b=DataTable.ext.afnSortData[l].call(e.oInstance,e,m,v);if(b.length===p.length)for(s=0,o=p.length;o>s;s++)_fnSetCellData(e,s,m,b[s]);else _fnLog(e,0,"Returned data sort array (col "+m+") is the wrong length")}}for(i=0,n=e.aiDisplayMaster.length;n>i;i++)c[e.aiDisplayMaster[i]]=i;var y,w,_=d.length;for(i=0,n=p.length;n>i;i++)for(s=0;_>s;s++)for(w=f[d[s][0]].aDataSort,a=0,r=w.length;r>a;a++)l=f[w[a]].sType,y=u[(l?l:"string")+"-pre"],p[i]._aSortData[w[a]]=y?y(_fnGetCellData(e,i,w[a],"sort")):_fnGetCellData(e,i,w[a],"sort");e.aiDisplayMaster.sort(function(e,t){var i,n,s,o,a,r;for(i=0;_>i;i++)for(a=f[d[i][0]].aDataSort,n=0,s=a.length;s>n;n++)if(r=f[a[n]].sType,o=u[(r?r:"string")+"-"+d[i][1]](p[e]._aSortData[a[n]],p[t]._aSortData[a[n]]),0!==o)return o;return u["numeric-asc"](c[e],c[t])})}for(t!==undefined&&!t||e.oFeatures.bDeferRender||_fnSortingClasses(e),i=0,n=e.aoColumns.length;n>i;i++){var C=f[i].sTitle.replace(/<.*?>/g,"");if(h=f[i].nTh,h.removeAttribute("aria-sort"),h.removeAttribute("aria-label"),f[i].bSortable)if(d.length>0&&d[0][0]==i){h.setAttribute("aria-sort","asc"==d[0][1]?"ascending":"descending");var x=f[i].asSorting[d[0][2]+1]?f[i].asSorting[d[0][2]+1]:f[i].asSorting[0];h.setAttribute("aria-label",C+("asc"==x?g.sSortAscending:g.sSortDescending))}else h.setAttribute("aria-label",C+("asc"==f[i].asSorting[0]?g.sSortAscending:g.sSortDescending));else h.setAttribute("aria-label",C)}e.bSorted=!0,$(e.oInstance).trigger("sort",e),e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch,1):(e.aiDisplay=e.aiDisplayMaster.slice(),e._iDisplayStart=0,_fnCalculateEnd(e),_fnDraw(e))}function _fnSortAttachListener(e,t,i,n){_fnBindAction(t,{},function(t){if(e.aoColumns[i].bSortable!==!1){var s=function(){var n,s;if(t.shiftKey){for(var o=!1,a=0;a<e.aaSorting.length;a++)if(e.aaSorting[a][0]==i){o=!0,n=e.aaSorting[a][0],s=e.aaSorting[a][2]+1,e.aoColumns[n].asSorting[s]?(e.aaSorting[a][1]=e.aoColumns[n].asSorting[s],e.aaSorting[a][2]=s):e.aaSorting.splice(a,1);break}o===!1&&e.aaSorting.push([i,e.aoColumns[i].asSorting[0],0])}else 1==e.aaSorting.length&&e.aaSorting[0][0]==i?(n=e.aaSorting[0][0],s=e.aaSorting[0][2]+1,e.aoColumns[n].asSorting[s]||(s=0),e.aaSorting[0][1]=e.aoColumns[n].asSorting[s],e.aaSorting[0][2]=s):(e.aaSorting.splice(0,e.aaSorting.length),e.aaSorting.push([i,e.aoColumns[i].asSorting[0],0]));_fnSort(e)};e.oFeatures.bProcessing?(_fnProcessingDisplay(e,!0),setTimeout(function(){s(),e.oFeatures.bServerSide||_fnProcessingDisplay(e,!1)},0)):s(),"function"==typeof n&&n(e)}})}function _fnSortingClasses(e){var t,i,n,s,o,a,r=e.aoColumns.length,l=e.oClasses;for(t=0;r>t;t++)e.aoColumns[t].bSortable&&$(e.aoColumns[t].nTh).removeClass(l.sSortAsc+" "+l.sSortDesc+" "+e.aoColumns[t].sSortingClass);for(o=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),t=0;t<e.aoColumns.length;t++)if(e.aoColumns[t].bSortable){for(a=e.aoColumns[t].sSortingClass,s=-1,n=0;n<o.length;n++)if(o[n][0]==t){a="asc"==o[n][1]?l.sSortAsc:l.sSortDesc,s=n;break}if($(e.aoColumns[t].nTh).addClass(a),e.bJUI){var h=$("span."+l.sSortIcon,e.aoColumns[t].nTh);h.removeClass(l.sSortJUIAsc+" "+l.sSortJUIDesc+" "+l.sSortJUI+" "+l.sSortJUIAscAllowed+" "+l.sSortJUIDescAllowed);var d;d=-1==s?e.aoColumns[t].sSortingClassJUI:"asc"==o[s][1]?l.sSortJUIAsc:l.sSortJUIDesc,h.addClass(d)}}else $(e.aoColumns[t].nTh).addClass(e.aoColumns[t].sSortingClass);if(a=l.sSortColumn,e.oFeatures.bSort&&e.oFeatures.bSortClasses){var c,u,p=_fnGetTdNodes(e),f=[];for(t=0;r>t;t++)f.push("");for(t=0,c=1;t<o.length;t++)u=parseInt(o[t][0],10),f[u]=a+c,3>c&&c++;var g,m,v,b=new RegExp(a+"[123]");for(t=0,i=p.length;i>t;t++)u=t%r,m=p[t].className,v=f[u],g=m.replace(b,v),g!=m?p[t].className=$.trim(g):v.length>0&&-1==m.indexOf(v)&&(p[t].className=m+" "+v)}}function _fnSaveState(e){if(e.oFeatures.bStateSave&&!e.bDestroying){var t,i,n=e.oScroll.bInfinite,s={iCreate:(new Date).getTime(),iStart:n?0:e._iDisplayStart,iEnd:n?e._iDisplayLength:e._iDisplayEnd,iLength:e._iDisplayLength,aaSorting:$.extend(!0,[],e.aaSorting),oSearch:$.extend(!0,{},e.oPreviousSearch),aoSearchCols:$.extend(!0,[],e.aoPreSearchCols),abVisCols:[]};for(t=0,i=e.aoColumns.length;i>t;t++)s.abVisCols.push(e.aoColumns[t].bVisible);_fnCallbackFire(e,"aoStateSaveParams","stateSaveParams",[e,s]),e.fnStateSave.call(e.oInstance,e,s)}}function _fnLoadState(e,t){if(e.oFeatures.bStateSave){var i=e.fnStateLoad.call(e.oInstance,e);if(i){var n=_fnCallbackFire(e,"aoStateLoadParams","stateLoadParams",[e,i]);if(-1===$.inArray(!1,n)){e.oLoadedState=$.extend(!0,{},i),e._iDisplayStart=i.iStart,e.iInitDisplayStart=i.iStart,e._iDisplayEnd=i.iEnd,e._iDisplayLength=i.iLength,e.aaSorting=i.aaSorting.slice(),e.saved_aaSorting=i.aaSorting.slice(),$.extend(e.oPreviousSearch,i.oSearch),$.extend(!0,e.aoPreSearchCols,i.aoSearchCols),t.saved_aoColumns=[];for(var s=0;s<i.abVisCols.length;s++)t.saved_aoColumns[s]={},t.saved_aoColumns[s].bVisible=i.abVisCols[s];_fnCallbackFire(e,"aoStateLoaded","stateLoaded",[e,i])}}}}function _fnCreateCookie(sName,sValue,iSecs,sBaseName,fnCallback){var date=new Date;date.setTime(date.getTime()+1e3*iSecs);var aParts=window.location.pathname.split("/"),sNameFile=sName+"_"+aParts.pop().replace(/[\/:]/g,"").toLowerCase(),sFullCookie,oData;null!==fnCallback?(oData="function"==typeof $.parseJSON?$.parseJSON(sValue):eval("("+sValue+")"),sFullCookie=fnCallback(sNameFile,oData,date.toGMTString(),aParts.join("/")+"/")):sFullCookie=sNameFile+"="+encodeURIComponent(sValue)+"; expires="+date.toGMTString()+"; path="+aParts.join("/")+"/";var aCookies=document.cookie.split(";"),iNewCookieLen=sFullCookie.split(";")[0].length,aOldCookies=[];if(iNewCookieLen+document.cookie.length+10>4096){for(var i=0,iLen=aCookies.length;iLen>i;i++)if(-1!=aCookies[i].indexOf(sBaseName)){var aSplitCookie=aCookies[i].split("=");try{oData=eval("("+decodeURIComponent(aSplitCookie[1])+")"),oData&&oData.iCreate&&aOldCookies.push({name:aSplitCookie[0],time:oData.iCreate})}catch(e){}}for(aOldCookies.sort(function(e,t){return t.time-e.time});iNewCookieLen+document.cookie.length+10>4096;){if(0===aOldCookies.length)return;var old=aOldCookies.pop();document.cookie=old.name+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+aParts.join("/")+"/"}}document.cookie=sFullCookie}function _fnReadCookie(e){for(var t=window.location.pathname.split("/"),i=e+"_"+t[t.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",n=document.cookie.split(";"),s=0;s<n.length;s++){for(var o=n[s];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(i))return decodeURIComponent(o.substring(i.length,o.length))}return null}function _fnSettingsFromNode(e){for(var t=0;t<DataTable.settings.length;t++)if(DataTable.settings[t].nTable===e)return DataTable.settings[t];return null}function _fnGetTrNodes(e){for(var t=[],i=e.aoData,n=0,s=i.length;s>n;n++)null!==i[n].nTr&&t.push(i[n].nTr);return t}function _fnGetTdNodes(e,t){var i,n,s,o,a,r,l,h,d=[],c=e.aoData.length,u=0,p=c;for(t!==undefined&&(u=t,p=t+1),o=u;p>o;o++)if(l=e.aoData[o],null!==l.nTr){for(n=[],s=l.nTr.firstChild;s;)h=s.nodeName.toLowerCase(),("td"==h||"th"==h)&&n.push(s),s=s.nextSibling;for(i=0,a=0,r=e.aoColumns.length;r>a;a++)e.aoColumns[a].bVisible?d.push(n[a-i]):(d.push(l._anHidden[a]),i++)}return d}function _fnLog(e,t,i){var n=null===e?"DataTables warning: "+i:"DataTables warning (table id = '"+e.sTableId+"'): "+i;if(0===t){if("alert"!=DataTable.ext.sErrMode)throw new Error(n);return void alert(n)}window.console&&console.log&&console.log(n)}function _fnMap(e,t,i,n){n===undefined&&(n=i),t[i]!==undefined&&(e[n]=t[i])}function _fnExtend(e,t){var i;for(var n in t)t.hasOwnProperty(n)&&(i=t[n],"object"==typeof oInit[n]&&null!==i&&$.isArray(i)===!1?$.extend(!0,e[n],i):e[n]=i);return e}function _fnBindAction(e,t,i){$(e).bind("click.DT",t,function(t){e.blur(),i(t)}).bind("keypress.DT",t,function(e){13===e.which&&i(e)}).bind("selectstart.DT",function(){return!1})}function _fnCallbackReg(e,t,i,n){i&&e[t].push({fn:i,sName:n})}function _fnCallbackFire(e,t,i,n){for(var s=e[t],o=[],a=s.length-1;a>=0;a--)o.push(s[a].fn.apply(e.oInstance,n));return null!==i&&$(e.oInstance).trigger(i,n),o}function _fnBrowserDetect(e){var t=$('<div style="position:absolute; top:0; left:0; height:1px; width:1px; overflow:hidden"><div style="position:absolute; top:1px; left:1px; width:100px; overflow:scroll;"><div id="DT_BrowserTest" style="width:100%; height:10px;"></div></div></div>')[0];document.body.appendChild(t),e.oBrowser.bScrollOversize=100===$("#DT_BrowserTest",t)[0].offsetWidth?!0:!1,document.body.removeChild(t)}function _fnExternApiFunc(e){return function(){var t=[_fnSettingsFromNode(this[DataTable.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return DataTable.ext.oApi[e].apply(this,t)}}var __reArray=/\[.*?\]$/,_fnJsonString=window.JSON?JSON.stringify:function(e){var t=typeof e;if("object"!==t||null===e)return"string"===t&&(e='"'+e+'"'),e+"";var i,n,s=[],o=$.isArray(e);for(i in e)n=e[i],t=typeof n,"string"===t?n='"'+n+'"':"object"===t&&null!==n&&(n=_fnJsonString(n)),s.push((o?"":'"'+i+'":')+n);
return(o?"[":"{")+s+(o?"]":"}")};this.$=function(e,t){var i,n,s,o=[],a=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),r=a.aoData,l=a.aiDisplay,h=a.aiDisplayMaster;if(t||(t={}),t=$.extend({},{filter:"none",order:"current",page:"all"},t),"current"==t.page)for(i=a._iDisplayStart,n=a.fnDisplayEnd();n>i;i++)s=r[l[i]].nTr,s&&o.push(s);else if("current"==t.order&&"none"==t.filter)for(i=0,n=h.length;n>i;i++)s=r[h[i]].nTr,s&&o.push(s);else if("current"==t.order&&"applied"==t.filter)for(i=0,n=l.length;n>i;i++)s=r[l[i]].nTr,s&&o.push(s);else if("original"==t.order&&"none"==t.filter)for(i=0,n=r.length;n>i;i++)s=r[i].nTr,s&&o.push(s);else if("original"==t.order&&"applied"==t.filter)for(i=0,n=r.length;n>i;i++)s=r[i].nTr,-1!==$.inArray(i,l)&&s&&o.push(s);else _fnLog(a,1,"Unknown selection options");var d=$(o),c=d.filter(e),u=d.find(e);return $([].concat($.makeArray(c),$.makeArray(u)))},this._=function(e,t){var i,n,s=[],o=this.$(e,t);for(i=0,n=o.length;n>i;i++)s.push(this.fnGetData(o[i]));return s},this.fnAddData=function(e,t){if(0===e.length)return[];var i,n=[],s=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if("object"==typeof e[0]&&null!==e[0])for(var o=0;o<e.length;o++){if(i=_fnAddData(s,e[o]),-1==i)return n;n.push(i)}else{if(i=_fnAddData(s,e),-1==i)return n;n.push(i)}return s.aiDisplay=s.aiDisplayMaster.slice(),(t===undefined||t)&&_fnReDraw(s),n},this.fnAdjustColumnSizing=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnAdjustColumnSizing(t),e===undefined||e?this.fnDraw(!1):(""!==t.oScroll.sX||""!==t.oScroll.sY)&&this.oApi._fnScrollDraw(t)},this.fnClearTable=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnClearTable(t),(e===undefined||e)&&_fnDraw(t)},this.fnClose=function(e){for(var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=0;i<t.aoOpenRows.length;i++)if(t.aoOpenRows[i].nParent==e){var n=t.aoOpenRows[i].nTr.parentNode;return n&&n.removeChild(t.aoOpenRows[i].nTr),t.aoOpenRows.splice(i,1),0}return 1},this.fnDeleteRow=function(e,t,i){var n,s,o,a=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);o="object"==typeof e?_fnNodeToDataIndex(a,e):e;var r=a.aoData.splice(o,1);for(n=0,s=a.aoData.length;s>n;n++)null!==a.aoData[n].nTr&&(a.aoData[n].nTr._DT_RowIndex=n);var l=$.inArray(o,a.aiDisplay);return a.asDataSearch.splice(l,1),_fnDeleteIndex(a.aiDisplayMaster,o),_fnDeleteIndex(a.aiDisplay,o),"function"==typeof t&&t.call(this,a,r),a._iDisplayStart>=a.fnRecordsDisplay()&&(a._iDisplayStart-=a._iDisplayLength,a._iDisplayStart<0&&(a._iDisplayStart=0)),(i===undefined||i)&&(_fnCalculateEnd(a),_fnDraw(a)),r},this.fnDestroy=function(e){var t,i,n=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),s=n.nTableWrapper.parentNode,o=n.nTBody;if(e=e===undefined?!1:e,n.bDestroying=!0,_fnCallbackFire(n,"aoDestroyCallback","destroy",[n]),!e)for(t=0,i=n.aoColumns.length;i>t;t++)n.aoColumns[t].bVisible===!1&&this.fnSetColumnVis(t,!0);for($(n.nTableWrapper).find("*").andSelf().unbind(".DT"),$("tbody>tr>td."+n.oClasses.sRowEmpty,n.nTable).parent().remove(),n.nTable!=n.nTHead.parentNode&&($(n.nTable).children("thead").remove(),n.nTable.appendChild(n.nTHead)),n.nTFoot&&n.nTable!=n.nTFoot.parentNode&&($(n.nTable).children("tfoot").remove(),n.nTable.appendChild(n.nTFoot)),n.nTable.parentNode.removeChild(n.nTable),$(n.nTableWrapper).remove(),n.aaSorting=[],n.aaSortingFixed=[],_fnSortingClasses(n),$(_fnGetTrNodes(n)).removeClass(n.asStripeClasses.join(" ")),$("th, td",n.nTHead).removeClass([n.oClasses.sSortable,n.oClasses.sSortableAsc,n.oClasses.sSortableDesc,n.oClasses.sSortableNone].join(" ")),n.bJUI&&($("th span."+n.oClasses.sSortIcon+", td span."+n.oClasses.sSortIcon,n.nTHead).remove(),$("th, td",n.nTHead).each(function(){var e=$("div."+n.oClasses.sSortJUIWrapper,this),t=e.contents();$(this).append(t),e.remove()})),!e&&n.nTableReinsertBefore?s.insertBefore(n.nTable,n.nTableReinsertBefore):e||s.appendChild(n.nTable),t=0,i=n.aoData.length;i>t;t++)null!==n.aoData[t].nTr&&o.appendChild(n.aoData[t].nTr);if(n.oFeatures.bAutoWidth===!0&&(n.nTable.style.width=_fnStringToCss(n.sDestroyWidth)),i=n.asDestroyStripes.length){var a=$(o).children("tr");for(t=0;i>t;t++)a.filter(":nth-child("+i+"n + "+t+")").addClass(n.asDestroyStripes[t])}for(t=0,i=DataTable.settings.length;i>t;t++)DataTable.settings[t]==n&&DataTable.settings.splice(t,1);n=null,oInit=null},this.fnDraw=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);e===!1?(_fnCalculateEnd(t),_fnDraw(t)):_fnReDraw(t)},this.fnFilter=function(e,t,i,n,s,o){var a=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(a.oFeatures.bFilter)if((i===undefined||null===i)&&(i=!1),(n===undefined||null===n)&&(n=!0),(s===undefined||null===s)&&(s=!0),(o===undefined||null===o)&&(o=!0),t===undefined||null===t){if(_fnFilterComplete(a,{sSearch:e+"",bRegex:i,bSmart:n,bCaseInsensitive:o},1),s&&a.aanFeatures.f)for(var r=a.aanFeatures.f,l=0,h=r.length;h>l;l++)try{r[l]._DT_Input!=document.activeElement&&$(r[l]._DT_Input).val(e)}catch(d){$(r[l]._DT_Input).val(e)}}else $.extend(a.aoPreSearchCols[t],{sSearch:e+"",bRegex:i,bSmart:n,bCaseInsensitive:o}),_fnFilterComplete(a,a.oPreviousSearch,1)},this.fnGetData=function(e,t){var i=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(e!==undefined){var n=e;if("object"==typeof e){var s=e.nodeName.toLowerCase();"tr"===s?n=_fnNodeToDataIndex(i,e):"td"===s&&(n=_fnNodeToDataIndex(i,e.parentNode),t=_fnNodeToColumnIndex(i,n,e))}return t!==undefined?_fnGetCellData(i,n,t,""):i.aoData[n]!==undefined?i.aoData[n]._aData:null}return _fnGetDataMaster(i)},this.fnGetNodes=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);return e!==undefined?t.aoData[e]!==undefined?t.aoData[e].nTr:null:_fnGetTrNodes(t)},this.fnGetPosition=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=e.nodeName.toUpperCase();if("TR"==i)return _fnNodeToDataIndex(t,e);if("TD"==i||"TH"==i){var n=_fnNodeToDataIndex(t,e.parentNode),s=_fnNodeToColumnIndex(t,n,e);return[n,_fnColumnIndexToVisible(t,s),s]}return null},this.fnIsOpen=function(e){for(var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=(t.aoOpenRows,0);i<t.aoOpenRows.length;i++)if(t.aoOpenRows[i].nParent==e)return!0;return!1},this.fnOpen=function(e,t,i){var n=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),s=_fnGetTrNodes(n);if(-1!==$.inArray(e,s)){this.fnClose(e);var o=document.createElement("tr"),a=document.createElement("td");o.appendChild(a),a.className=i,a.colSpan=_fnVisbleColumns(n),"string"==typeof t?a.innerHTML=t:$(a).html(t);var r=$("tr",n.nTBody);return-1!=$.inArray(e,r)&&$(o).insertAfter(e),n.aoOpenRows.push({nTr:o,nParent:e}),o}},this.fnPageChange=function(e,t){var i=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnPageChange(i,e),_fnCalculateEnd(i),(t===undefined||t)&&_fnDraw(i)},this.fnSetColumnVis=function(e,t,i){var n,s,o,a,r,l=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),h=l.aoColumns,d=l.aoData;if(h[e].bVisible!=t){if(t){var c=0;for(n=0;e>n;n++)h[n].bVisible&&c++;if(a=c>=_fnVisbleColumns(l),!a)for(n=e;n<h.length;n++)if(h[n].bVisible){r=n;break}for(n=0,s=d.length;s>n;n++)null!==d[n].nTr&&(a?d[n].nTr.appendChild(d[n]._anHidden[e]):d[n].nTr.insertBefore(d[n]._anHidden[e],_fnGetTdNodes(l,n)[r]))}else for(n=0,s=d.length;s>n;n++)null!==d[n].nTr&&(o=_fnGetTdNodes(l,n)[e],d[n]._anHidden[e]=o,o.parentNode.removeChild(o));for(h[e].bVisible=t,_fnDrawHead(l,l.aoHeader),l.nTFoot&&_fnDrawHead(l,l.aoFooter),n=0,s=l.aoOpenRows.length;s>n;n++)l.aoOpenRows[n].nTr.colSpan=_fnVisbleColumns(l);(i===undefined||i)&&(_fnAdjustColumnSizing(l),_fnDraw(l)),_fnSaveState(l)}},this.fnSettings=function(){return _fnSettingsFromNode(this[DataTable.ext.iApiIndex])},this.fnSort=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);t.aaSorting=e,_fnSort(t)},this.fnSortListener=function(e,t,i){_fnSortAttachListener(_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),e,t,i)},this.fnUpdate=function(e,t,i,n,s){var o,a,r=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),l="object"==typeof t?_fnNodeToDataIndex(r,t):t;if($.isArray(e)&&i===undefined)for(r.aoData[l]._aData=e.slice(),o=0;o<r.aoColumns.length;o++)this.fnUpdate(_fnGetCellData(r,l,o),l,o,!1,!1);else if($.isPlainObject(e)&&i===undefined)for(r.aoData[l]._aData=$.extend(!0,{},e),o=0;o<r.aoColumns.length;o++)this.fnUpdate(_fnGetCellData(r,l,o),l,o,!1,!1);else{_fnSetCellData(r,l,i,e),a=_fnGetCellData(r,l,i,"display");var h=r.aoColumns[i];null!==h.fnRender&&(a=_fnRender(r,l,i),h.bUseRendered&&_fnSetCellData(r,l,i,a)),null!==r.aoData[l].nTr&&(_fnGetTdNodes(r,l)[i].innerHTML=a)}var d=$.inArray(l,r.aiDisplay);return r.asDataSearch[d]=_fnBuildSearchRow(r,_fnGetRowData(r,l,"filter",_fnGetColumns(r,"bSearchable"))),(s===undefined||s)&&_fnAdjustColumnSizing(r),(n===undefined||n)&&_fnReDraw(r),0},this.fnVersionCheck=DataTable.ext.fnVersionCheck,this.oApi={_fnExternApiFunc:_fnExternApiFunc,_fnInitialise:_fnInitialise,_fnInitComplete:_fnInitComplete,_fnLanguageCompat:_fnLanguageCompat,_fnAddColumn:_fnAddColumn,_fnColumnOptions:_fnColumnOptions,_fnAddData:_fnAddData,_fnCreateTr:_fnCreateTr,_fnGatherData:_fnGatherData,_fnBuildHead:_fnBuildHead,_fnDrawHead:_fnDrawHead,_fnDraw:_fnDraw,_fnReDraw:_fnReDraw,_fnAjaxUpdate:_fnAjaxUpdate,_fnAjaxParameters:_fnAjaxParameters,_fnAjaxUpdateDraw:_fnAjaxUpdateDraw,_fnServerParams:_fnServerParams,_fnAddOptionsHtml:_fnAddOptionsHtml,_fnFeatureHtmlTable:_fnFeatureHtmlTable,_fnScrollDraw:_fnScrollDraw,_fnAdjustColumnSizing:_fnAdjustColumnSizing,_fnFeatureHtmlFilter:_fnFeatureHtmlFilter,_fnFilterComplete:_fnFilterComplete,_fnFilterCustom:_fnFilterCustom,_fnFilterColumn:_fnFilterColumn,_fnFilter:_fnFilter,_fnBuildSearchArray:_fnBuildSearchArray,_fnBuildSearchRow:_fnBuildSearchRow,_fnFilterCreateSearch:_fnFilterCreateSearch,_fnDataToSearch:_fnDataToSearch,_fnSort:_fnSort,_fnSortAttachListener:_fnSortAttachListener,_fnSortingClasses:_fnSortingClasses,_fnFeatureHtmlPaginate:_fnFeatureHtmlPaginate,_fnPageChange:_fnPageChange,_fnFeatureHtmlInfo:_fnFeatureHtmlInfo,_fnUpdateInfo:_fnUpdateInfo,_fnFeatureHtmlLength:_fnFeatureHtmlLength,_fnFeatureHtmlProcessing:_fnFeatureHtmlProcessing,_fnProcessingDisplay:_fnProcessingDisplay,_fnVisibleToColumnIndex:_fnVisibleToColumnIndex,_fnColumnIndexToVisible:_fnColumnIndexToVisible,_fnNodeToDataIndex:_fnNodeToDataIndex,_fnVisbleColumns:_fnVisbleColumns,_fnCalculateEnd:_fnCalculateEnd,_fnConvertToWidth:_fnConvertToWidth,_fnCalculateColumnWidths:_fnCalculateColumnWidths,_fnScrollingWidthAdjust:_fnScrollingWidthAdjust,_fnGetWidestNode:_fnGetWidestNode,_fnGetMaxLenString:_fnGetMaxLenString,_fnStringToCss:_fnStringToCss,_fnDetectType:_fnDetectType,_fnSettingsFromNode:_fnSettingsFromNode,_fnGetDataMaster:_fnGetDataMaster,_fnGetTrNodes:_fnGetTrNodes,_fnGetTdNodes:_fnGetTdNodes,_fnEscapeRegex:_fnEscapeRegex,_fnDeleteIndex:_fnDeleteIndex,_fnReOrderIndex:_fnReOrderIndex,_fnColumnOrdering:_fnColumnOrdering,_fnLog:_fnLog,_fnClearTable:_fnClearTable,_fnSaveState:_fnSaveState,_fnLoadState:_fnLoadState,_fnCreateCookie:_fnCreateCookie,_fnReadCookie:_fnReadCookie,_fnDetectHeader:_fnDetectHeader,_fnGetUniqueThs:_fnGetUniqueThs,_fnScrollBarWidth:_fnScrollBarWidth,_fnApplyToChildren:_fnApplyToChildren,_fnMap:_fnMap,_fnGetRowData:_fnGetRowData,_fnGetCellData:_fnGetCellData,_fnSetCellData:_fnSetCellData,_fnGetObjectDataFn:_fnGetObjectDataFn,_fnSetObjectDataFn:_fnSetObjectDataFn,_fnApplyColumnDefs:_fnApplyColumnDefs,_fnBindAction:_fnBindAction,_fnExtend:_fnExtend,_fnCallbackReg:_fnCallbackReg,_fnCallbackFire:_fnCallbackFire,_fnJsonString:_fnJsonString,_fnRender:_fnRender,_fnNodeToColumnIndex:_fnNodeToColumnIndex,_fnInfoMacros:_fnInfoMacros,_fnBrowserDetect:_fnBrowserDetect,_fnGetColumns:_fnGetColumns},$.extend(DataTable.ext.oApi,this.oApi);for(var sFunc in DataTable.ext.oApi)sFunc&&(this[sFunc]=_fnExternApiFunc(sFunc));var _that=this;return this.each(function(){var e,t,i,n=0,s=this.getAttribute("id"),o=!1,a=!1;if("table"!=this.nodeName.toLowerCase())return void _fnLog(null,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName);for(n=0,e=DataTable.settings.length;e>n;n++){if(DataTable.settings[n].nTable==this){if(oInit===undefined||oInit.bRetrieve)return DataTable.settings[n].oInstance;if(oInit.bDestroy){DataTable.settings[n].oInstance.fnDestroy();break}return void _fnLog(DataTable.settings[n],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, pass no arguments or see the docs for bRetrieve and bDestroy")}if(DataTable.settings[n].sTableId==this.id){DataTable.settings.splice(n,1);break}}(null===s||""===s)&&(s="DataTables_Table_"+DataTable.ext._oExternConfig.iNextUnique++,this.id=s);var r=$.extend(!0,{},DataTable.models.oSettings,{nTable:this,oApi:_that.oApi,oInit:oInit,sDestroyWidth:$(this).width(),sInstance:s,sTableId:s});if(DataTable.settings.push(r),r.oInstance=1===_that.length?_that:$(this).dataTable(),oInit||(oInit={}),oInit.oLanguage&&_fnLanguageCompat(oInit.oLanguage),oInit=_fnExtend($.extend(!0,{},DataTable.defaults),oInit),_fnMap(r.oFeatures,oInit,"bPaginate"),_fnMap(r.oFeatures,oInit,"bLengthChange"),_fnMap(r.oFeatures,oInit,"bFilter"),_fnMap(r.oFeatures,oInit,"bSort"),_fnMap(r.oFeatures,oInit,"bInfo"),_fnMap(r.oFeatures,oInit,"bProcessing"),_fnMap(r.oFeatures,oInit,"bAutoWidth"),_fnMap(r.oFeatures,oInit,"bSortClasses"),_fnMap(r.oFeatures,oInit,"bServerSide"),_fnMap(r.oFeatures,oInit,"bDeferRender"),_fnMap(r.oScroll,oInit,"sScrollX","sX"),_fnMap(r.oScroll,oInit,"sScrollXInner","sXInner"),_fnMap(r.oScroll,oInit,"sScrollY","sY"),_fnMap(r.oScroll,oInit,"bScrollCollapse","bCollapse"),_fnMap(r.oScroll,oInit,"bScrollInfinite","bInfinite"),_fnMap(r.oScroll,oInit,"iScrollLoadGap","iLoadGap"),_fnMap(r.oScroll,oInit,"bScrollAutoCss","bAutoCss"),_fnMap(r,oInit,"asStripeClasses"),_fnMap(r,oInit,"asStripClasses","asStripeClasses"),_fnMap(r,oInit,"fnServerData"),_fnMap(r,oInit,"fnFormatNumber"),_fnMap(r,oInit,"sServerMethod"),_fnMap(r,oInit,"aaSorting"),_fnMap(r,oInit,"aaSortingFixed"),_fnMap(r,oInit,"aLengthMenu"),_fnMap(r,oInit,"sPaginationType"),_fnMap(r,oInit,"sAjaxSource"),_fnMap(r,oInit,"sAjaxDataProp"),_fnMap(r,oInit,"iCookieDuration"),_fnMap(r,oInit,"sCookiePrefix"),_fnMap(r,oInit,"sDom"),_fnMap(r,oInit,"bSortCellsTop"),_fnMap(r,oInit,"iTabIndex"),_fnMap(r,oInit,"oSearch","oPreviousSearch"),_fnMap(r,oInit,"aoSearchCols","aoPreSearchCols"),_fnMap(r,oInit,"iDisplayLength","_iDisplayLength"),_fnMap(r,oInit,"bJQueryUI","bJUI"),_fnMap(r,oInit,"fnCookieCallback"),_fnMap(r,oInit,"fnStateLoad"),_fnMap(r,oInit,"fnStateSave"),_fnMap(r.oLanguage,oInit,"fnInfoCallback"),_fnCallbackReg(r,"aoDrawCallback",oInit.fnDrawCallback,"user"),_fnCallbackReg(r,"aoServerParams",oInit.fnServerParams,"user"),_fnCallbackReg(r,"aoStateSaveParams",oInit.fnStateSaveParams,"user"),_fnCallbackReg(r,"aoStateLoadParams",oInit.fnStateLoadParams,"user"),_fnCallbackReg(r,"aoStateLoaded",oInit.fnStateLoaded,"user"),_fnCallbackReg(r,"aoRowCallback",oInit.fnRowCallback,"user"),_fnCallbackReg(r,"aoRowCreatedCallback",oInit.fnCreatedRow,"user"),_fnCallbackReg(r,"aoHeaderCallback",oInit.fnHeaderCallback,"user"),_fnCallbackReg(r,"aoFooterCallback",oInit.fnFooterCallback,"user"),_fnCallbackReg(r,"aoInitComplete",oInit.fnInitComplete,"user"),_fnCallbackReg(r,"aoPreDrawCallback",oInit.fnPreDrawCallback,"user"),r.oFeatures.bServerSide&&r.oFeatures.bSort&&r.oFeatures.bSortClasses?_fnCallbackReg(r,"aoDrawCallback",_fnSortingClasses,"server_side_sort_classes"):r.oFeatures.bDeferRender&&_fnCallbackReg(r,"aoDrawCallback",_fnSortingClasses,"defer_sort_classes"),oInit.bJQueryUI?($.extend(r.oClasses,DataTable.ext.oJUIClasses),oInit.sDom===DataTable.defaults.sDom&&"lfrtip"===DataTable.defaults.sDom&&(r.sDom='<"H"lfr>t<"F"ip>')):$.extend(r.oClasses,DataTable.ext.oStdClasses),$(this).addClass(r.oClasses.sTable),(""!==r.oScroll.sX||""!==r.oScroll.sY)&&(r.oScroll.iBarWidth=_fnScrollBarWidth()),r.iInitDisplayStart===undefined&&(r.iInitDisplayStart=oInit.iDisplayStart,r._iDisplayStart=oInit.iDisplayStart),oInit.bStateSave&&(r.oFeatures.bStateSave=!0,_fnLoadState(r,oInit),_fnCallbackReg(r,"aoDrawCallback",_fnSaveState,"state_save")),null!==oInit.iDeferLoading){r.bDeferLoading=!0;var l=$.isArray(oInit.iDeferLoading);r._iRecordsDisplay=l?oInit.iDeferLoading[0]:oInit.iDeferLoading,r._iRecordsTotal=l?oInit.iDeferLoading[1]:oInit.iDeferLoading}if(null!==oInit.aaData&&(a=!0),""!==oInit.oLanguage.sUrl?(r.oLanguage.sUrl=oInit.oLanguage.sUrl,$.getJSON(r.oLanguage.sUrl,null,function(e){_fnLanguageCompat(e),$.extend(!0,r.oLanguage,oInit.oLanguage,e),_fnInitialise(r)}),o=!0):$.extend(!0,r.oLanguage,oInit.oLanguage),null===oInit.asStripeClasses&&(r.asStripeClasses=[r.oClasses.sStripeOdd,r.oClasses.sStripeEven]),e=r.asStripeClasses.length,r.asDestroyStripes=[],e){var h=!1,d=$(this).children("tbody").children("tr:lt("+e+")");for(n=0;e>n;n++)d.hasClass(r.asStripeClasses[n])&&(h=!0,r.asDestroyStripes.push(r.asStripeClasses[n]));h&&d.removeClass(r.asStripeClasses.join(" "))}var c,u=[],p=this.getElementsByTagName("thead");if(0!==p.length&&(_fnDetectHeader(r.aoHeader,p[0]),u=_fnGetUniqueThs(r)),null===oInit.aoColumns)for(c=[],n=0,e=u.length;e>n;n++)c.push(null);else c=oInit.aoColumns;for(n=0,e=c.length;e>n;n++)oInit.saved_aoColumns!==undefined&&oInit.saved_aoColumns.length==e&&(null===c[n]&&(c[n]={}),c[n].bVisible=oInit.saved_aoColumns[n].bVisible),_fnAddColumn(r,u?u[n]:null);for(_fnApplyColumnDefs(r,oInit.aoColumnDefs,c,function(e,t){_fnColumnOptions(r,e,t)}),n=0,e=r.aaSorting.length;e>n;n++){r.aaSorting[n][0]>=r.aoColumns.length&&(r.aaSorting[n][0]=0);var f=r.aoColumns[r.aaSorting[n][0]];for(r.aaSorting[n][2]===undefined&&(r.aaSorting[n][2]=0),oInit.aaSorting===undefined&&r.saved_aaSorting===undefined&&(r.aaSorting[n][1]=f.asSorting[0]),t=0,i=f.asSorting.length;i>t;t++)if(r.aaSorting[n][1]==f.asSorting[t]){r.aaSorting[n][2]=t;break}}_fnSortingClasses(r),_fnBrowserDetect(r);var g=$(this).children("caption").each(function(){this._captionSide=$(this).css("caption-side")}),m=$(this).children("thead");0===m.length&&(m=[document.createElement("thead")],this.appendChild(m[0])),r.nTHead=m[0];var v=$(this).children("tbody");0===v.length&&(v=[document.createElement("tbody")],this.appendChild(v[0])),r.nTBody=v[0],r.nTBody.setAttribute("role","alert"),r.nTBody.setAttribute("aria-live","polite"),r.nTBody.setAttribute("aria-relevant","all");var b=$(this).children("tfoot");if(0===b.length&&g.length>0&&(""!==r.oScroll.sX||""!==r.oScroll.sY)&&(b=[document.createElement("tfoot")],this.appendChild(b[0])),b.length>0&&(r.nTFoot=b[0],_fnDetectHeader(r.aoFooter,r.nTFoot)),a)for(n=0;n<oInit.aaData.length;n++)_fnAddData(r,oInit.aaData[n]);else _fnGatherData(r);r.aiDisplay=r.aiDisplayMaster.slice(),r.bInitialised=!0,o===!1&&_fnInitialise(r)}),_that=null,this};DataTable.fnVersionCheck=function(e){for(var t=function(e,t){for(;e.length<t;)e+="0";return e},i=DataTable.ext.sVersion.split("."),n=e.split("."),s="",o="",a=0,r=n.length;r>a;a++)s+=t(i[a],3),o+=t(n[a],3);return parseInt(s,10)>=parseInt(o,10)},DataTable.fnIsDataTable=function(e){for(var t=DataTable.settings,i=0;i<t.length;i++)if(t[i].nTable===e||t[i].nScrollHead===e||t[i].nScrollFoot===e)return!0;return!1},DataTable.fnTables=function(e){var t=[];return jQuery.each(DataTable.settings,function(i,n){(!e||e===!0&&$(n.nTable).is(":visible"))&&t.push(n.nTable)}),t},DataTable.version="1.9.4",DataTable.settings=[],DataTable.models={},DataTable.models.ext={afnFiltering:[],afnSortData:[],aoFeatures:[],aTypes:[],fnVersionCheck:DataTable.fnVersionCheck,iApiIndex:0,ofnSearch:{},oApi:{},oStdClasses:{},oJUIClasses:{},oPagination:{},oSort:{},sVersion:DataTable.version,sErrMode:"alert",_oExternConfig:{iNextUnique:0}},DataTable.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},DataTable.models.oRow={nTr:null,_aData:[],_aSortData:[],_anHidden:[],_sRowStripe:""},DataTable.models.oColumn={aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bUseRendered:null,bVisible:null,_bAutoType:!0,fnCreatedCell:null,fnGetData:null,fnRender:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},DataTable.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollAutoCss:!0,bScrollCollapse:!1,bScrollInfinite:!1,bServerSide:!1,bSort:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCookieCallback:null,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){if(1e3>e)return e;for(var t=e+"",i=t.split(""),n="",s=t.length,o=0;s>o;o++)o%3===0&&0!==o&&(n=this.oLanguage.sInfoThousands+n),n=i[s-o-1]+n;return n},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:function(e,t,i,n){n.jqXHR=$.ajax({url:e,data:t,success:function(e){e.sError&&n.oApi._fnLog(n,0,e.sError),$(n.oInstance).trigger("xhr",[n,e]),i(e)},dataType:"json",cache:!1,type:n.sServerMethod,error:function(e,t){"parsererror"==t&&n.oApi._fnLog(n,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},fnServerParams:null,fnStateLoad:function(oSettings){var sData=this.oApi._fnReadCookie(oSettings.sCookiePrefix+oSettings.sInstance),oData;try{oData="function"==typeof $.parseJSON?$.parseJSON(sData):eval("("+sData+")")}catch(e){oData=null}return oData},fnStateLoadParams:null,fnStateLoaded:null,fnStateSave:function(e,t){this.oApi._fnCreateCookie(e.sCookiePrefix+e.sInstance,this.oApi._fnJsonString(t),e.iCookieDuration,e.sCookiePrefix,e.fnCookieCallback)},fnStateSaveParams:null,iCookieDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iScrollLoadGap:100,iTabIndex:0,oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sUrl:"",sZeroRecords:"No matching records found"},oSearch:$.extend({},DataTable.models.oSearch),sAjaxDataProp:"aaData",sAjaxSource:null,sCookiePrefix:"SpryMedia_DataTables_",sDom:"lfrtip",sPaginationType:"two_button",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET"},DataTable.defaults.columns={aDataSort:null,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bUseRendered:!0,bVisible:!0,fnCreatedCell:null,fnRender:null,iDataSort:-1,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},DataTable.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortClasses:null,bStateSave:null},oScroll:{bAutoCss:null,bCollapse:null,bInfinite:null,iBarWidth:0,iLoadGap:null,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1},aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],asDataSearch:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:null,asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iCookieDuration:0,sCookiePrefix:"",fnCookieCallback:null,aoStateSave:[],aoStateLoad:[],oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iDisplayEnd:10,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsTotal,10):this.aiDisplayMaster.length},fnRecordsDisplay:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsDisplay,10):this.aiDisplay.length},fnDisplayEnd:function(){return this.oFeatures.bServerSide?this.oFeatures.bPaginate===!1||-1==this._iDisplayLength?this._iDisplayStart+this.aiDisplay.length:Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay):this._iDisplayEnd},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null},DataTable.ext=$.extend(!0,{},DataTable.models.ext),$.extend(DataTable.ext.oStdClasses,{sTable:"dataTable",sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button paginate_button_disabled",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:"",sJUIHeader:"",sJUIFooter:""}),$.extend(DataTable.ext.oJUIClasses,DataTable.ext.oStdClasses,{sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPageLast:"last ui-corner-tr ui-corner-br",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollFoot:"dataTables_scrollFoot ui-state-default",sFooterTH:"ui-state-default",sJUIHeader:"fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix",sJUIFooter:"fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"}),$.extend(DataTable.ext.oPagination,{two_button:{fnInit:function(e,t,i){var n=e.oLanguage.oPaginate,s=(e.oClasses,function(t){e.oApi._fnPageChange(e,t.data.action)&&i(e)}),o=e.bJUI?'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUIPrev+'"></span></a><a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUINext+'"></span></a>':'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+n.sPrevious+'</a><a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+n.sNext+"</a>";$(t).append(o);var a=$("a",t),r=a[0],l=a[1];e.oApi._fnBindAction(r,{action:"previous"},s),e.oApi._fnBindAction(l,{action:"next"},s),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",r.id=e.sTableId+"_previous",l.id=e.sTableId+"_next",r.setAttribute("aria-controls",e.sTableId),l.setAttribute("aria-controls",e.sTableId))},fnUpdate:function(e){if(e.aanFeatures.p)for(var t,i=e.oClasses,n=e.aanFeatures.p,s=0,o=n.length;o>s;s++)t=n[s].firstChild,t&&(t.className=0===e._iDisplayStart?i.sPagePrevDisabled:i.sPagePrevEnabled,t=t.nextSibling,t.className=e.fnDisplayEnd()==e.fnRecordsDisplay()?i.sPageNextDisabled:i.sPageNextEnabled)}},iFullNumbersShowPages:5,full_numbers:{fnInit:function(e,t,i){var n=e.oLanguage.oPaginate,s=e.oClasses,o=function(t){e.oApi._fnPageChange(e,t.data.action)&&i(e)};$(t).append('<a  tabindex="'+e.iTabIndex+'" class="'+s.sPageButton+" "+s.sPageFirst+'">'+n.sFirst+'</a><a  tabindex="'+e.iTabIndex+'" class="'+s.sPageButton+" "+s.sPagePrevious+'">'+n.sPrevious+'</a><span></span><a tabindex="'+e.iTabIndex+'" class="'+s.sPageButton+" "+s.sPageNext+'">'+n.sNext+'</a><a tabindex="'+e.iTabIndex+'" class="'+s.sPageButton+" "+s.sPageLast+'">'+n.sLast+"</a>");var a=$("a",t),r=a[0],l=a[1],h=a[2],d=a[3];e.oApi._fnBindAction(r,{action:"first"},o),e.oApi._fnBindAction(l,{action:"previous"},o),e.oApi._fnBindAction(h,{action:"next"},o),e.oApi._fnBindAction(d,{action:"last"},o),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",r.id=e.sTableId+"_first",l.id=e.sTableId+"_previous",h.id=e.sTableId+"_next",d.id=e.sTableId+"_last")},fnUpdate:function(e,t){if(e.aanFeatures.p){var i,n,s,o,a,r,l,h=DataTable.ext.oPagination.iFullNumbersShowPages,d=Math.floor(h/2),c=Math.ceil(e.fnRecordsDisplay()/e._iDisplayLength),u=Math.ceil(e._iDisplayStart/e._iDisplayLength)+1,p="",f=e.oClasses,g=e.aanFeatures.p,m=function(n){e.oApi._fnBindAction(this,{page:n+i-1},function(i){e.oApi._fnPageChange(e,i.data.page),t(e),i.preventDefault()})};for(-1===e._iDisplayLength?(i=1,n=1,u=1):h>c?(i=1,n=c):d>=u?(i=1,n=h):u>=c-d?(i=c-h+1,n=c):(i=u-Math.ceil(h/2)+1,n=i+h-1),s=i;n>=s;s++)p+=u!==s?'<a tabindex="'+e.iTabIndex+'" class="'+f.sPageButton+'">'+e.fnFormatNumber(s)+"</a>":'<a tabindex="'+e.iTabIndex+'" class="'+f.sPageButtonActive+'">'+e.fnFormatNumber(s)+"</a>";for(s=0,o=g.length;o>s;s++)l=g[s],l.hasChildNodes()&&($("span:eq(0)",l).html(p).children("a").each(m),a=l.getElementsByTagName("a"),r=[a[0],a[1],a[a.length-2],a[a.length-1]],$(r).removeClass(f.sPageButton+" "+f.sPageButtonActive+" "+f.sPageButtonStaticDisabled),$([r[0],r[1]]).addClass(1==u?f.sPageButtonStaticDisabled:f.sPageButton),$([r[2],r[3]]).addClass(0===c||u===c||-1===e._iDisplayLength?f.sPageButtonStaticDisabled:f.sPageButton))}}}}),$.extend(DataTable.ext.oSort,{"string-pre":function(e){return"string"!=typeof e&&(e=null!==e&&e.toString?e.toString():""),e.toLowerCase()},"string-asc":function(e,t){return t>e?-1:e>t?1:0},"string-desc":function(e,t){return t>e?1:e>t?-1:0},"html-pre":function(e){return e.replace(/<.*?>/g,"").toLowerCase()},"html-asc":function(e,t){return t>e?-1:e>t?1:0},"html-desc":function(e,t){return t>e?1:e>t?-1:0
},"date-pre":function(e){var t=Date.parse(e);return(isNaN(t)||""===t)&&(t=Date.parse("01/01/1970 00:00:00")),t},"date-asc":function(e,t){return e-t},"date-desc":function(e,t){return t-e},"numeric-pre":function(e){return"-"==e||""===e?0:1*e},"numeric-asc":function(e,t){return e-t},"numeric-desc":function(e,t){return t-e}}),$.extend(DataTable.ext.aTypes,[function(e){if("number"==typeof e)return"numeric";if("string"!=typeof e)return null;var t,i="0123456789-",n="0123456789.",s=!1;if(t=e.charAt(0),-1==i.indexOf(t))return null;for(var o=1;o<e.length;o++){if(t=e.charAt(o),-1==n.indexOf(t))return null;if("."==t){if(s)return null;s=!0}}return"numeric"},function(e){var t=Date.parse(e);return null!==t&&!isNaN(t)||"string"==typeof e&&0===e.length?"date":null},function(e){return"string"==typeof e&&-1!=e.indexOf("<")&&-1!=e.indexOf(">")?"html":null}]),$.fn.DataTable=DataTable,$.fn.dataTable=DataTable,$.fn.dataTableSettings=DataTable.settings,$.fn.dataTableExt=DataTable.ext})}(window,document),define("modules/tools/staff-listing",["jquery","underscore","baseview","state","utils","modules/scroller/vertical-scroll","libs/jquery/plugins/jquery.dataTables"],function(e,t,i,n,s,o){var a=i.extend({events:{"mouseenter .staff-filter-dropdown":"onHoverFilterDropdown","mouseleave .staff-filter-dropdown":"onHoverFilterDropdown","click .staff-details-open":"onDetailsOpen","click .staff-details-close":"onDetailsClose"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.$popupBox=this.$(".staff-details-box"),this.$popupFilm=this.$(".staff-details-film"),this.$popupTop=parseInt(this.$popupBox.css("top"),10);var t=e.extend({},e.fn.dataTable.defaults,{bAutoWidth:!1,bFilter:!1,bDestroy:!0,bPaginate:!1,bInfo:!1});this.$staffList=this.$(".staff-listing-table").dataTable(t)},onDetailsOpen:function(t){t.preventDefault(),this.openedOnce=!0,this.$popupLink=e(t.currentTarget);var i=this.$popupLink.data("class"),n=s.getScrollPosition();this.$popupBox.css("top",n),this.$popupBox.data("url")!=this.$popupLink.data("url")&&this.loadDetails(),this.$popupBox.addClass(i),this.$popupFilm.show(),this.$popupBox.show(),e(".site-footer").css({visibility:"hidden"})},onDetailsClose:function(t){if(this.openedOnce){t&&t.preventDefault();var i=this.$popupLink.data("class");this.$popupBox.removeClass(i),this.$popupBox.hide(),this.$popupFilm.hide(),this.$(".staff-details-data").addClass("staff-loading-details"),e(".site-footer").css({visibility:"visible"})}},loadDetails:function(){this.$(".staff-details-loaded").remove();var e=this.$popupLink.data("url");this.$popupBox.data("url",e),n.fetchHtml(e).done(t.bind(function(t){t.find(".staff-details-loaded").length?(this.$(".staff-details-data").removeClass("staff-details-loading"),this.$(".staff-details-data").html(t)):console.log("Unable to load details for: "+e)},this))},onHoverFilterDropdown:function(t){if("mouseenter"===t.type){var i=e(t.currentTarget),n=i.find(".staff-filter-scroll-wrap");this.subviews.vscroll=new o({el:n,padding:6})}else this.subviews.vscroll&&this.subviews.vscroll.destroy()}});return a}),define("uiPageTurn",["jquery","transformSupport"],function(e){"use strict";var t="uiPageTurn",i={useTransforms:!!e.support.css.transform,fallback:"crossfade",pageSelector:".ui-page-turn",placerSelector:".ui-placer",transitionTiming:"linear",turnDuration:300,perspective:"2200px",slideDuration:200,fadeDuration:200,shadow:!0,shadowOpacity:.7,onPageTurn:function(){}},n={init:function(n){return this.each(function(){var s=e(this),o=e.extend({},i,n),a=s.find(o.pageSelector+".active");0===a.length&&(a=s.children(":first")),a.next(o.pageSelector).addClass("preload"),s.data(t,{currentPage:a,busy:!1,settings:o})})},option:function(e,i){var n=this.data(t);if(n&&e){if(!i)return n[e];("function"==typeof i||"onPageTurn"!==e)&&(n[e]=i)}},nextPage:function(e,i){var n=this.data(t),o=n.settings,a=n.currentPage,r=a.next(o.pageSelector);return s.transition(this,a,r,!1,o,n,e,i)},prevPage:function(e,i){var n=this.data(t),o=n.settings,a=n.currentPage,r=a.prev(o.pageSelector);return s.transition(this,a,r,!0,o,n,e,i)},goToPage:function(i,n,o){var a=this.data(t),r=a.settings,l=a.currentPage,h=this.children(r.pageSelector),d=h.eq(i),c=h.index(l);return c===i?e.Deferred().reject():s.transition(this,l,d,c>i,r,a,n,o)},getCurrentPage:function(){var e=this.data(t);return e.currentPage}},s={transition:function(t,i,n,o,a,r,l,h){var d;return!n.length||r.busy?e.Deferred().reject():l?(s.finishTransition(i,n,o,a,r),e.Deferred().resolve()):(r.busy=!0,n.removeClass("preload"),d=!h&&a.useTransforms?s.flipTransform(t,i,n,o,a):"slide"===a.fallback?s.slideTransition(i,n,o,a):s.fadeTransition(i,n,a),d.done(function(){s.finishTransition(i,n,o,a,r)}),d)},finishTransition:function(e,t,i,n,s){n.onPageTurn(t),s.busy=!1,e.removeClass("active"),t.addClass("active"),i?t.prev(n.pageSelector).addClass("preload"):t.next(n.pageSelector).addClass("preload"),s.currentPage=t},flipTransform:function(t,i,n,o,a){i.removeClass("active");var r=i.clone(),l=n.clone(),h=e('<div class="ui-shadow"></div>'),d=e('<div class="ui-shadow"></div>'),c=e('<div class="ui-page-turn-animator"></div>');a.shadow&&(n.append(h),i.append(d),h.css({opacity:a.shadowOpacity}),d.css({opacity:0})),c.append(r),c.append(l),t.append(c),o?(i.addClass("right"),n.addClass("left"),l.addClass("right"),r.addClass("left")):(i.addClass("left"),n.addClass("right"),l.addClass("left"),r.addClass("right")),s.setupTransition(t[0],c[0],r[0],l[0],o,a);var u=e.Deferred();return e.support.css.transition.registerTransitionEndListener(c[0],u).done(function(){d.remove(),h.remove(),c.remove(),n.removeClass("left right"),i.removeClass("left right"),t[0].style[e.support.css.transform.perspectiveCssName]="",t[0].style[e.support.css.transform.styleCssName]=""}),setTimeout(function(){var t=o?"rotateY(180deg)":"rotateY(-180deg)";c[0].style[e.support.css.transform.cssName]=t,a.shadow&&(h[0].style[e.support.css.transition.cssName]=s.getTransitionStyle("opacity",a.turnDuration/2,a.transitionTiming),d[0].style[e.support.css.transition.cssName]=s.getTransitionStyle("opacity",a.turnDuration/2,a.transitionTiming,a.turnDuration/2),h.css({opacity:0}),d.css({opacity:a.shadowOpacity}))},20),u.promise()},slideTransition:function(t,i,n,o){if(i.addClass("active"),t.css({left:"0%"}),i.css(n?{left:"-100%"}:{left:"100%"}),e.support.css.transition){var a=s.getTransitionStyle("left",o.slideDuration,o.transitionTiming);return i[0].style[e.support.css.transition.cssName]=a,t[0].style[e.support.css.transition.cssName]=a,setTimeout(function(){i.css({left:"0%"}),t.css({left:n?"100%":"-100%"})},20),e.support.css.transition.registerTransitionEndListener(i[0])}return t.animate({left:n?"100%":"-100%"},o.slideDuration,o.transitionTiming),i.animate({left:"0%"},o.slideDuration,o.transitionTiming).promise()},fadeTransition:function(e,t,i){e.css({opacity:1,"z-index":11}).show(),t.css({opacity:1,"z-index":10}).show();var n=e.fadeOut(i.fadeDuration).promise();return n.done(function(){e.css({"z-index":""}),t.css({"z-index":""})}),n},getTransitionStyle:function(e,t,i,n){var s=e+" "+t+"ms "+i;return n&&(s+=" "+n+"ms"),s},setupTransition:function(t,i,n,o,a,r){t.style[e.support.css.transform.perspectiveCssName]=r.perspective,t.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.perspectiveCssName]=r.perspective,i.style[e.support.css.transition.cssName]=s.getTransitionStyle(e.support.css.transform.cssHyphenName,r.turnDuration,r.transitionTiming),n.style[e.support.css.transform.styleCssName]="preserve-3d",n.style[e.support.css.transform.cssName]="rotateY(0deg)",n.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",o.style[e.support.css.transform.styleCssName]="preserve-3d",a?(n.style[e.support.css.transform.originCssName]="right center",o.style[e.support.css.transform.originCssName]="left center",o.style[e.support.css.transform.cssName]="rotateY(-180deg) translateZ(1px)"):(n.style[e.support.css.transform.originCssName]="left center",o.style[e.support.css.transform.originCssName]="right center",o.style[e.support.css.transform.cssName]="rotateY(180deg) translateZ(1px)")}};e.fn.uiPageTurn=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.uiPageTurn"):n.init.apply(this,arguments)}}),define("apps/bigpage",["jquery","underscore","backbone","pubsub","utils","state","admanager","base-app","directAdPosition","uiPageTurn"],function(e,t,i,n,s,o,a,r,l){var h=r.extend({el:"#cover-view",events:{"click .big-page-prev":"prevSlide","click .ui-page-turn":"palmSlide","click .big-page-next":"nextSlide"},initialize:function(i){i=e.extend(!0,{animation:{slideDuration:350}},i),t.bindAll(this,"keyboardShortcuts","onPageTurn","resizeHandler","moveSlide","playAd"),this.$body=s.get("body"),this.$doc=s.get("doc"),this.$win=s.get("win"),this.$adContents=this.$(".partner-coverview-contents");var n=t.throttle(this.resizeHandler,50);this.$win.on("resize."+this.cid,n),r.prototype.initialize.call(this,i)},resizeHandler:function(){if(this.$pages){var t=this.$win.width(),i=this.$win.height()-40;t%2?this.$pages.addClass("width-wiggler"):this.$pages.removeClass("width-wiggler"),this.$adContents.css({width:t+"px",top:40,height:i+"px"}),e.each(this.subviews,function(e,n){0===e.indexOf("ad_")&&n.resizeAd(t,i)})}},palmSlide:function(t){var i=e(t.target);if(!(i.hasClass("load-story")||i.hasClass("parent-label")||i.closest(".partner-placement").length)){var n=t.screenX,s=this.$win.width()>>1;n>s?this.nextSlide(t):this.prevSlide(t)}},prevSlide:function(e){e&&e.preventDefault(),this.moveSlide(-1),n.trigger("heattrack","thebigpageleft")},nextSlide:function(e){e&&e.preventDefault(),this.moveSlide(1),n.trigger("heattrack","thebigpageright")},moveSlide:function(e){var t=this.$pages.uiPageTurn("getCurrentPage").index(),i=t+e,n=!1,s=this.playAd;this.isIndexAd(i)?(n=this.isAdReady(i),n||(i+=e)):this.prepareNextAd(t),o.registerAnimation(this.$pages.uiPageTurn("goToPage",i)).done(function(){n&&s(i)})},playAd:function(e){var t=this.subviews["ad_"+e];t&&(t.playAd(),t.show())},fetchAd:function(e){var t,i,n=this.$pagesChildren.eq(e),o=s.getNested(window.site_vars,"aws_site_name")||"usat",a=n.find(".partner-coverview-contents");return t=this.getPageInfo(n.prev()),this.subviews["ad_"+e]=i=new l({el:a,adPlacement:"coverview/"+t.cst,adSizes:["coverviewfullpage"],targeting:{sitePage:o+"/"+(t.ssts||"").replace(/\/\/*$/,"")},slotType:"out"}),i.prefetchAd(),this.resizeHandler(),!0},getNextAdIndex:function(e){return this.$pagesChildren.eq(e).nextAll(".partner-placement").first().index()},checkIfAdHasBeenFetched:function(e){e>0&&!this.subviews["ad_"+e]&&this.fetchAd(e)},isIndexAd:function(e){return this.$pagesChildren.eq(e).hasClass("partner-placement")},prepareNextAd:function(e){var t=this.getNextAdIndex(e);this.checkIfAdHasBeenFetched(t)},isAdReady:function(e){var t=this.subviews["ad_"+e];return t?t.isAdReady():!1},slideTransition:function(e,i){e.addClass("active"),i?e.css("left","100%"):e.css("left","-100%"),this.animate(e,"left",0,this.options.animation.slideDuration,"linear").done(t.bind(function(){this.$activePage=e,this.busy=!1},this)),this.$activePage.css("left","0%"),this.animate(this.$activePage,"left",i?"-100%":"100%",this.options.animation.slideDuration,"linear")},keyboardShortcuts:function(e){e.target===this.$body[0]&&(37===e.which?this.prevSlide(e):39===e.which&&this.nextSlide())},afterPageReveal:function(){this.$prev=this.$(".big-page-prev"),this.$next=this.$(".big-page-next"),this.$pages=this.$("#cover-view-pages"),this.$pagesChildren=this.$pages.children(),this.$pages.uiPageTurn({onPageTurn:this.onPageTurn,turnDuration:600,fallback:"slide",shadow:!1}),this.resizeHandler(),this.$doc.on("keyup."+this.cid,this.keyboardShortcuts),this.trackPageChange(this.$(".ui-page-turn.active"))},onPageTurn:function(e){e.prev(".ui-page-turn").length?this.$prev.show():this.$prev.hide(),e.next(".ui-page-turn").length?this.$next.show():this.$next.hide(),this.trackPageChange(e)},trackPageLoad:function(){},trackPageChange:function(e){this.pageInfo=this.getPageInfo(e),n.trigger("page:load",this.pageInfo)},getPageInfo:function(e){var t,i=e.find(".coverInfo").html()||"{}";try{t=JSON.parse(i)}catch(n){console.error("could not get current asset page info",n.stack||n.stacktrace||n.message)}return t||{}},pause:function(){this.$doc.off("."+this.cid),r.prototype.pause.apply(this,arguments)},destroy:function(){this.$doc.off("."+this.cid),this.$win.off("."+this.cid),r.prototype.destroy.apply(this,arguments)}});return h}),define("apps/404",["jquery","underscore","backbone","state","pubsub","apps/simple-overlay"],function(e,t,i,n,s,o){var a=o.extend({initialize:function(e){o.prototype.initialize.call(this,e),this.options.ajax&&(this.render(this.options.htmlFrag),n.registerFullScreenView(this),this.afterPageReveal())},close:function(e){return e&&e.target!==e.currentTarget?void 0:(this.options.ajax?(n.clearFullScreenView(this),this.destroy(!0)):n.navigateToPreloadedUrl(),!1)}});return a}),define("apps/cards/layouts",[],function(){return{"primary-suspender-sidebar-page":[{name:"large",adClass:"size-l",adTargeting:"large",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:340,belowHeroAd:!1,belowTheFoldAd:!0,cardWidth:1180,windowWidth:1250},{name:"medium",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!1,sidebarWidth:240,belowHeroAd:!0,belowTheFoldAd:!0,cardWidth:1080,windowWidth:1150},{name:"small",adClass:"size-s",adTargeting:"small",sidebarOpen:!1,sidebarAds:!1,sidebarWidth:240,belowHeroAd:!0,belowTheFoldAd:!0,cardWidth:840,windowWidth:980}],"primary-flex-sidebar-page":[{name:"1320w",adClass:"size-xl",adTargeting:"xlarge",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,belowTheFoldAd:!0,primaryFlexWidth:960,cardWidth:1320,windowWidth:1320},{name:"1080w",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,belowTheFoldAd:!0,primaryFlexWidth:720,cardWidth:1080,windowWidth:1150,layout:"flexCard"}]}}),define("partner/ad-utils",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=function(){};return n.prototype={changeBg:function(e,n,s){if(!n||"transparent"===n)return!1;var o=e.css("background-color");return"transparent"!==o&&o?(e.addClass("partner-background"),i.prototype.animate(e,"background-color",n,200,"ease-in").done(t.bind(function(){s?this.changeBgImg(e,s):this.changeBgImg(e,window.site_static_url+"images/pixels/pixel-transparent.png")},this)),!0):!1},changeBgImg:function(e,t){e.css({"background-image":"url('"+t+"')","background-repeat":"repeat"})},clearBg:function(e,n){e.css("background-color")!==n?i.prototype.animate(e,"background-color",n,200,"ease-in").done(t.bind(function(){e.removeClass("partner-background")},this)):(e.css("background-color",""),e.removeClass("partner-background"))}},new n}),define("partner/leavebehind",["jquery","underscore","baseview","adLogger","utils","managers/cachemanager","partner/ad-utils","state"],function(e,t,i,n,s,o,a,r){"use strict";var l=i.extend({events:{"click .js-partner-lb-click":"onClick"},initialize:function(o){o=e.extend({onShowAd:null,isCompact:!0,isNative:!1,behavior:{}},o),i.prototype.initialize.call(this,o),this.$el.prop("id")||this.$el.prop("id",t.uniqueId("ad-position-")),this.$body=s.get("body"),this.startBgColor=this.$body.css("background-color"),this.$clickArea=this.$(".js-partner-lb-click"),n.logDebug("LeaveBehind initialized",this)},destroy:function(){this.hide(),this.startBgColor&&a.clearBg(this.$body,this.startBgColor),this.$("img").remove(),this.$frame&&this.$frame.remove(),this.$el.removeClass("partner-lb-frame"),this.$clickArea.find(".partner-lb-click-arrow").remove(),this.options.cards&&this.addedSpace&&this.options.cards.animate({paddingTop:"-=10px"},350,function(){e(this).css("padding-top","")}),this.$body.removeClass("partner-background"),i.prototype.destroy.call(this,!1)},render:function(i,n){var s=new e.Deferred;return this.adData=n,n.frameSliver?this._setupFrame(n,s):this.options.isNative?s.resolve():this._setupLb(n,s),s.then(t.bind(function(){this._showAdOrLb(i,n)},this)),s},_setupLb:function(t,i){var n=this.$el;this.options.isCompact?n.addClass("compact"):n.removeClass("compact"),n.append(e("<img>").attr({"class":"leavebehind-image",src:t.leaveBehindImage,alt:t.leaveBehindText})),i.resolve()},_setupFrame:function(i,n){this.$branding=e("<img>").attr({src:i.frameSliver,alt:i.leaveBehindText,"class":"lb-brand"}),i.frameArrowColor&&"None"!==i.frameArrowColor&&this.$clickArea.prepend('<svg class="partner-lb-click-arrow" fill="'+i.frameArrowColor+'" x="0px" y="0px" viewBox="0 0 26 26" enable-background="new 0 0 26 26"><path fill-rule="evenodd" clip-rule="evenodd" d="M13,0.5C6.1,0.5,0.5,6.1,0.5,13c0,6.9,5.6,12.5,12.5,12.5S25.5,19.9,25.5,13C25.5,6.1,19.9,0.5,13,0.5z M19,12l-5.3,5.3c-0.2,0.2-0.4,0.3-0.6,0.3c-0.2,0-0.5-0.1-0.6-0.3L7.1,12c-0.2-0.2-0.3-0.4-0.3-0.6c0-0.2,0.1-0.5,0.3-0.6c0.2-0.2,0.4-0.3,0.6-0.3c0.2,0,0.5,0.1,0.6,0.3l4.7,4.7l4.7-4.7c0.4-0.4,0.9-0.4,1.3,0C19.3,11,19.3,11.6,19,12z" /></svg>'),i.frameBackground?e("<img>").load(t.bind(function(t){e(t.currentTarget).remove(),this.$frame=e("<div>").css("background-image",'url("'+i.frameBackground+'")').addClass("lb-frame"),r.getActiveApp().$el.prepend(this.$frame),this.$body.addClass("partner-background"),n.resolve()},this)).attr("src",i.frameBackground):(this.$frame=e([]),n.resolve()),this.$el.append(this.$branding).addClass("partner-lb-frame")},shouldShowAd:function(e){var t=this.options.maxDisplayed||1,i=this.getAdState(e);return i.displayed<t},getStateKey:function(e){return"dfpc_"+e.dfp.ecid},getAdState:function(e){return o.getValue(this.getStateKey(e),{displayed:0},this.getExpirationMinutes(e.leaveBehindExp))},getExpirationMinutes:function(e){var t=parseInt(e,10);return isNaN(t)?s.getNested(window.site_vars,"ADS","LEAVEBEHIND_EXPIRATION_MINUTES"):t},incrementAdViewCount:function(e){var t=this.getAdState(e);t.displayed+=1,o.setValue(this.getStateKey(e),t,this.getExpirationMinutes(e.leaveBehindExp))},_showAdOrLb:function(e,t){var i=this.options;this.shouldShowAd(t)?(this.incrementAdViewCount(t),i.onShowAd&&i.onShowAd(),s.getNested(i,"behavior","initShow")&&this.$frame&&(this.$frame.fadeIn(350),a.changeBg(this.$body,t.frameColor))):(this.show(),e.trackAd(this.$el),this.track(t.leaveBehindTracking))},show:function(){if(!this.options.isNative&&this.adData&&(i.prototype.show.call(this),this.adData.frameSliver)){var e=this.options.cards;e&&!this.addedSpace&&(e.animate({paddingTop:"+=10px"},350),this.addedSpace=!0),this.$el.show(),this.$branding.fadeIn(350),this.$frame.fadeIn(350),a.changeBg(this.$body,this.adData.frameColor)}},hide:function(e){var n=this.options.behavior,s=this.options.cards,o=this.adData;!this.options.isNative&&o&&(o.frameSliver||i.prototype.hide.call(this),n.hidebrand&&this.$branding&&(!s||"Pushdown"!==o.adType&&"Pushdown+"!==o.adType||(s.animate({paddingTop:"-=10px"},350),this.addedSpace=!1),this.$branding.fadeOut(350,t.bind(function(){this.$el.hide()},this))),n.hideframe&&this.$frame&&this.$frame.fadeOut(350),this.startBgColor&&n.clearBgColor&&a.clearBg(this.$body,this.startBgColor),e&&this.track(o.reexpandTracking))},onClick:function(){return this.hide(!0),this.options.onShowAd&&this.options.onShowAd(!0),!1},track:function(e){var t;if(e)for(t=0;t<e.length;++t)(new Image).src=e[t]}});return l}),define("partner/high-impact-base",["jquery","underscore","baseview","sharedAdPosition","admanager","managers/autoplay","partner/leavebehind"],function(e,t,i,n,s,o,a){"use strict";var r=i.extend({initialize:function(n){t.bindAll(this,"onAdReady","showAd","beforeAdRender","startAutoPlay"),n=e.extend({leaveBehindEl:e(".partner-leavebehind"),frameBehavior:{clearBgColor:!0,hideframe:!0,hidebrand:!0}},n),i.prototype.initialize.call(this,n)},_createAd:function(e,t,i){var s=this._filterAdsByCardWidth(e,i);this.subviews.adPosition=new n({el:this.$el,adPlacement:"high_impact",adSizes:s,adType:t,onAdReady:this.onAdReady,beforeAdRender:this.beforeAdRender}),this.currentCardInfo=i},_filterAdsByCardWidth:function(e,i){var n,o;return t.filter(e,function(e){return n=s.isFlexibleAdSize(e),o=s.getSize(e),n||o&&o[0]<=i.cardWidth})},beforeAdRender:function(e){this.adData=e,o.register("high-impact-ad",this.startAutoPlay),(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText&&(this.subviews.adLeaveBehind=new a({el:this.options.leaveBehindEl,cards:this.options.cards,onShowAd:this.showAd,isCompact:this.isCardBumped,isNative:this.options.isNative,maxDisplayed:parseInt(e.maxDisplayed,10)||this.options.maxDisplayed,behavior:this.options.frameBehavior||{}}))},startAutoPlay:function(){return this.subviews.adLeaveBehind?!this.subviews.adLeaveBehind.shouldShowAd(this.adData):!1},onAdReady:function(e){var t=this.options.slot;t&&t.addClass("show-slot"),this.subviews.adLeaveBehind?this.subviews.adLeaveBehind.render(this.subviews.adPosition,e):this.showAd()},showAd:function(){this.showingAd=!0,this.subviews.adPosition.show()}});return r}),define("partner/pushdown-ad",["jquery","underscore","utils","partner/high-impact-base","partner/ad-utils","adLogger"],function(e,t,i,n,s,o){"use strict";var a=n.extend({events:{"click .partner-close":"closeAdClick"},initialize:function(s){s=e.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}},ratio:{}},s),t.bindAll(this,"onAdReady","showAd","beforeAdRender"),n.prototype.initialize.call(this,s),this.$body=i.get("body"),this.startBgColor=this.$body.css("background-color"),this.$bigHeadline=this.$(".big-headline"),this.$aboveCardContent=this.options.cards.find(".card-above-content"),o.logDebug("Pushdown Advertisment initialized",this)},renderCardInfo:function(e,t){this._createAd(["pushdown"],["pushdown"],e),this.isCardBumped=t},beforeAdRender:function(e){var t=this.currentCardInfo;this.adData=e,t&&this.onCardWidthChange(t),n.prototype.beforeAdRender.apply(this,arguments)},destroy:function(e){this.showingAd?this.closeAd(!0):this.startBgColor&&s.clearBg(this.$body,this.startBgColor),n.prototype.destroy.call(this,e)},getAdHeight:function(e){var t=this.adData.ratio;return t?t.height/t.width*e:615},onAdReady:function(e){"Pushdown+"===e.adType&&(this.persistBackground=!0,s.changeBg(this.$body,e.backgroundSolidColor,e.backgroundRepeatingImage),this.$el.css({display:"block",height:0})),n.prototype.onAdReady.call(this,e),this.subviews.adLeaveBehind&&(this.subviews.adLeaveBehind.options.behavior.clearBgColor=!1)},showAd:function(){var i,o=this.options.animations.vertical.duration,a=this.getOffsetHeight(),r=this.$el;n.prototype.showAd.call(this),this.$aboveCardContent.animate({opacity:0},150).slideUp(o-150),r.hasClass("iab-risingstar")?this.isCardBumped&&r.css("margin","-5px auto 10px"):(r.css({height:0}),i=this.getAdHeight(this.currentCardInfo.cardWidth)-a,this.$bigHeadline.css("visibility","hidden"),e.when(this.animate(r,"height",i,o),a?this.animate(r,"top",0,o):null).done(t.bind(function(){this.subviews.adPosition&&(r.addClass("partner-pushdown-ad-open"),this.subviews.adPosition.playAd())},this)),this.$body.addClass("high-impact-ad-visible")),s.changeBg(this.$body,this.adData.backgroundSolidColor,this.adData.backgroundRepeatingImage)},closeAdClick:function(e){e.preventDefault(),this.closeAd(),this.$aboveCardContent.slideDown(this.options.animations.vertical.duration-150).animate({opacity:1},150)},getOffsetHeight:function(){return this.$bigHeadline.height()||0},closeAd:function(i){var n=this.subviews.adLeaveBehind,o=n.startBgColor||this.startBgColor,a=this.$el,r=this.getOffsetHeight(),l=this.options.animations.vertical.duration;a.hasClass("iab-risingstar")?this.isCardBumped&&a.css("margin",""):(this.showingAd=!1,this.subviews.adPosition.stopAd(),e.when(this.animate(a,"height",0,l),r?this.animate(a,"top",r+"px",l):null).done(t.bind(function(){a.removeClass("partner-pushdown-ad-open"),this.$bigHeadline.css("visibility","visible"),n&&!i&&n.show()},this))),this.$body.removeClass("high-impact-ad-visible"),this.startBgColor&&(!this.persistBackground&&!n.startBgColor||i)&&s.clearBg(this.$body,o)},onCardWidthChange:function(e){if(this.subviews.adPosition&&this.adData){var t=this.adData.adType,i=this.$el,n=this.getOffsetHeight(),s=this.getAdHeight(e.cardWidth);this.currentCardInfo=e,"Pushdown+"!==t||this.showingAd||i.css("top",n),i.removeClass(this.options.adClasses).addClass(e.adClass),this.subviews.adPosition.resizeAd(e.cardWidth,s),!i.hasClass("iab-risingstar")&&this.adData.ratio&&this.showingAd&&(s-=n,i.css("height",s)),i.hasClass("iab-risingstar")&&"small"===e.name&&(i.remove(),this.destroy())}}});return a}),define("partner/gravity-ad",["jquery","underscore","utils","state","user-manager","pubsub","partner/high-impact-base","site-manager","adLogger"],function(e,t,i,n,s,o,a,r,l){"use strict";var h=a.extend({haveBreakingNews:!1,pubSub:{},state:"stopped",events:{"click .partner-scroll":"scrollPage","click .partner-scroll-login":"showLogin","click .partner-login-modal-close":"closeLogin","click .ui-film":"closeLogin","click .partner-login-modal-btn":"onClickLogin"},initialize:function(n){n=e.extend({adClasses:"",maxDisplayed:2},n),this.pubSub={"user:statuschange":this.determineLoggedInStatus},t.bindAll(this,"onAdReady","onResizeWindow","onScrollWindow","scrollPage","countDown","shiftUnlockedContentDown"),a.prototype.initialize.call(this,n),this.header=r.getHeader(),this.header&&this.header.subviews&&(this.breakingbar=this.header.subviews.breakingbar),this.$body=i.get("body"),this.$loginOverlay=this.$(".partner-login-overlay"),this.$partnerScroll=this.$(".partner-scroll"),this.$leftCircleHalf=this.$(".left-half .scroll-circle"),this.$rightCircleHalf=this.$(".right-half .scroll-circle"),this.$partnerScrollMessage=this.$(".partner-scroll-message"),this.$window=i.get("win"),l.logDebug("Gravity Advertisment initialized",this)},renderCardInfo:function(e,t){this._createAd(["gravity"],"gravity",e),this.isCardBumped=t},beforeAdRender:function(){this.windowWidth=this.$window.width(),this.windowHeight=this.$window.height(),this.subviews.adPosition.setInitialDimensions(this.windowWidth,this.windowHeight),a.prototype.beforeAdRender.apply(this,arguments)},destroy:function(e){this.closeAd(),this.header&&(this.header.destroyTransparency(),this.header.restoreLastState()),this.$leftCircleHalf.removeAttr("style"),this.$rightCircleHalf.removeAttr("style"),this.$partnerScroll.removeAttr("style").removeClass("done").off("."+this.cid),a.prototype.destroy.call(this,e)},showAd:function(e){this.showingAd=!0,this.$partnerScroll=this.$(".partner-scroll");var n=t.throttle(this.onResizeWindow,50),a=t.throttle(this.onScrollWindow,50);this.$window.on("resize."+this.cid,n).on("scroll."+this.cid,a),this.pubSub={"breakingbar:before:open":this.onResizeWindow,"breakingbar:before:close":this.onResizeWindow},o.attach(this.pubSub,this),this.onResizeWindow(),this.subviews.adPosition.show(),this.options.contentSection.css("margin-top",this.cardOffset),this.onScrollWindow(),this.$body.addClass("high-impact-ad-visible"),this.header.setClosedFixed(!0),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.hide(),this.setBreakingNewsBarrier();var r=s.getLoginStatus();this.paywall=i.getNested(window.site_vars,"ADS","gravity_paywall"),!this.paywall||"loggedOut"!==r&&"loggingOut"!==r&&"loginFailed"!==r||e?this.$partnerScroll.addClass("done"):(this.$partnerScrollMessage.text("Loading your news..."),this.lockContent()),o.trigger("gravity:open")},lockContent:function(){if(this.count=i.getNested(window.site_vars,"ADS","gravity_paywall_wait")||30,this.contentLocked=!0,this.$loadingNumber=this.$(".partner-scroll-number"),e.support.css.transform){var t=this.count/2,n=e.support.css.transform.cssName+" "+t+"s "+t+"s linear",s=e.support.css.transform.cssName+" "+t+"s linear";this.$leftCircleHalf[0].style[e.support.css.transition.cssName]=n,this.$rightCircleHalf[0].style[e.support.css.transition.cssName]=s,this.$leftCircleHalf[0].style[e.support.css.transform.cssName]="rotate(180deg)",this.$rightCircleHalf[0].style[e.support.css.transform.cssName]="rotate(180deg)"}this.options.contentSection.css("position","fixed"),this.countDown(),this.countdownInterval=setInterval(this.countDown,1e3)},countDown:function(){this.$loadingNumber.text(this.count),this.count||this.unlockContent(),this.count--},unlockContent:function(){this.contentLocked=!1,clearInterval(this.countdownInterval),this.$partnerScrollMessage.text("Your news is ready!"),this.$partnerScroll.on("click."+this.cid,this.scrollPage),this.$partnerScroll.addClass("done"),this.options.contentSection.css("position",""),this.shiftUnlockedContentUp(this.$partnerScroll)},shiftUnlockedContentUp:function(){var e=this.cardOffset-this.header.getCollapsedHeight()-30;this.options.contentSection.animate({"margin-top":e},350).addClass("gravity-bumped"),this.shiftDownTimeout=t.delay(t.bind(function(){this.shiftUnlockedContentDown()},this),5e3)},shiftUnlockedContentDown:function(){this.options.contentSection.hasClass("gravity-bumped")&&(this.options.contentSection.removeClass("gravity-bumped"),e.when(this.animate(this.options.contentSection,"margin-top",this.cardOffset,500),this.animate(this.$partnerScroll,"margin-top",-75,500)).done(t.bind(function(){this.$partnerScroll.css("margin-top","").addClass("shifted")},this)))},determineLoggedInStatus:function(e,t,i){"loggedIn"===t?this.welcomeUser(i):"loggedOut"===t&&this.unWelcomeUser()},welcomeUser:function(t){if(!this.showingAd)return!1;var i=t.first_name;this.$partnerScrollMessage.fadeOut(350,function(){e(this).text("Welcome back "+i+", get the news").fadeIn(350)}),this.$partnerScroll.hasClass("done")||this.contentLocked?this.contentLocked&&(this.closeLogin(),this.unlockContent()):this.shiftUnlockedContentUp(this.$partnerScroll)},unWelcomeUser:function(){this.$partnerScrollMessage.fadeOut(350,function(){e(this).text("Get the news").fadeIn(350)})},showLogin:function(){this.$loginOverlay.show()},closeLogin:function(){this.$loginOverlay.hide()},onClickLogin:function(t){var i=e(t.target).data("user-account");s.loginUser(i)},setBreakingNewsBarrier:function(){this.breakingNewsBarrier&&"resolved"!==this.breakingNewsBarrier.state()||(this.breakingNewsBarrier=new e.Deferred,this.breakingbar.addToBarrier(this.breakingNewsBarrier,999999,!1))},getHeaderOffset:function(){return this.header&&this.breakingbar?this.header.getCollapsedHeight()+this.breakingbar.getHeight():0},closeAd:function(){this.subviews.adPosition&&this.adData&&(this.showingAd=!1,this.subviews.adPosition.stopAd(),this.breakingNewsBarrier&&this.breakingNewsBarrier.resolve(),this.options.contentSection.css({"margin-top":"",position:""}),this.$body.removeClass("high-impact-ad-visible"),clearInterval(this.countdownInterval),clearTimeout(this.shiftDownTimeout),this.$window.off("."+this.cid))},onResizeWindow:function(){return this.windowWidth=this.$window.width(),this.windowHeight=this.$window.height(),this.subviews.adPosition?(this.subviews.adPosition.resizeAd(this.windowWidth,this.windowHeight),this.cardOffset=this.windowHeight-this.getHeaderOffset(),this.options.contentSection.css("margin-top",this.cardOffset),void this.onScrollWindow()):!1},onScrollWindow:function(){var e=this.$window.scrollTop(),t=this.header.getCurrentHeight(),i=(this.windowHeight-e-t)/(this.windowHeight-t),n=i>0?i:0;this.$el.css("opacity",n),.1>n&&"playing"===this.state?(this.state="paused",this.subviews.adPosition&&(this.subviews.adPosition.pauseAd(),this.breakingNewsBarrier.resolve(),this.haveBreakingNews&&this.breakingbar.openBreakingBar()),this.header.toggleTransparency(!1)):n>.1&&"paused"===this.state?(this.state="playing",this.subviews.adPosition&&(this.subviews.adPosition.resumeAd(),this.haveBreakingNews=this.breakingbar.closeBreakingBar(),this.setBreakingNewsBarrier()),this.header.toggleTransparency(!0)):n>.1&&"stopped"===this.state&&(this.state="playing",this.subviews.adPosition&&(this.subviews.adPosition.playAd(),this.haveBreakingNews=this.breakingbar.closeBreakingBar(),this.setBreakingNewsBarrier()),this.header.toggleTransparency(!0)),0===n?this.$el.css("display","none"):this.$el.css("display","block"),this.onArticleScroll&&this.onArticleScroll(n,t)
},scrollPage:function(t){t.preventDefault();var i=this.windowHeight-this.header.getCurrentHeight();e("body, html").animate({scrollTop:i},500),this.shiftDownTimeout&&(clearTimeout(this.shiftDownTimeout),this.shiftUnlockedContentDown())}});return h}),define("partner/dual-pushdown-ad",["jquery","underscore","utils","partner/high-impact-base","site-manager","partner/ad-utils","adLogger"],function(e,t,i,n,s,o,a){"use strict";var r=n.extend({initialize:function(o){o=e.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}}},o),t.bindAll(this,"onAdReady","beforeAdRender","onResizeWindow","onScrollWindow"),n.prototype.initialize.call(this,o),this.header=s.getHeader(),this.headerHeight=this.header?this.header.getCurrentHeight():0,this.pubSub={"header:fixed":this.onHeaderHeightChange,"header:unfixed":this.onHeaderHeightChange},this.$body=i.get("body"),this.$bigHeadline=this.$(".big-headline"),this.$window=i.get("win"),a.logDebug("Pushdown Advertisment initialized",this)},renderCardInfo:function(e){this._createAd(["dual_pushdown"],"dualpushdown",e)},beforeAdRender:function(i){if(this.adType=i.adType,this.adData=e.extend({ratio:{height:9,width:16},fixed:!0},i),this.currentCardInfo&&this.onCardWidthChange(this.currentCardInfo,!0),(e("html").hasClass("lt-ie10")||Modernizr.touch)&&(this.adData.fixed=!0),!this.adData.fixed){var s=t.throttle(this.onResizeWindow,50),o=t.throttle(this.onScrollWindow,10);this.$window.on("resize."+this.cid,s).on("scroll."+this.cid,o),this.onResizeWindow()}this.$el.addClass("partner-dual-pushdown"),n.prototype.beforeAdRender.apply(this,arguments)},closeAd:function(){this.showingAd=!1,this.subviews.adPosition.stopAd(),e.when(this.animate(this.options.card,"margin-bottom",0,this.options.animations.vertical.duration),this.animate(this.options.card,"margin-top",0,this.options.animations.vertical.duration)).done(t.bind(function(){this.$bigHeadline.css("visibility","visible")},this)),this.$body.removeClass("high-impact-ad-visible"),this.stgoundColor&&o.clearBg(this.$body,this.startingBackgroundColor),this.$window.off("."+this.cid)},destroy:function(e){this.closeAd(),clearTimeout(this.calcWait),n.prototype.destroy.call(this,e)},getAdHeight:function(e){return this.adData.ratio.height/this.adData.ratio.width*e},getBigHeadlineHeight:function(){return this.$bigHeadline.height()||0},onAdReady:function(e){this.backgroundSolidColor=e.backgroundSolidColor,this.backgroundRepeatingImage=e.backgroundRepeatingImage,this.showAd()},onCardWidthChange:function(e,i){if(this.subviews.adPosition&&this.adType){this.currentCardInfo=e;var n=this.getAdHeight(e.cardWidth)-this.getBigHeadlineHeight();this.$el.removeClass(this.options.adClasses).addClass(e.adClass),this.subviews.adPosition.resizeAd(e.cardWidth,n),clearTimeout(this.calcWait),this.calcWait=setTimeout(t.bind(function(){if(!i)if(this.calculateScrollSpecs(n),this.options.card.css({"margin-bottom":n+50,"margin-top":n}),this.adData.fixed){var e=this.cardHeight;this.$(".partner-pushdown-container").css("height",e)}else this.onScrollWindow()},this),100)}},onHeaderHeightChange:function(){this.headerHeight=this.header.getCurrentHeight()},onScrollWindow:function(){var e=this.$window.scrollTop()-this.headerHeight,t=this.cardHeight-this.windowHeight,i=1-(t-e)/t;i>1?i=1:0>i&&(i=0);var n=50+this.adDiffHeight*i;this.$el.css("top",n)},onResizeWindow:function(){this.windowHeight=this.$window.height()},showAd:function(){n.prototype.showAd.call(this),this.adHeight=this.$el.height();var i=this.getAdHeight(this.currentCardInfo.cardWidth)-this.getBigHeadlineHeight();this.calculateScrollSpecs(i),this.adData.fixed?this.$(".partner-pushdown-container").css("height",this.cardHeight):this.onScrollWindow(),e.when(this.animate(this.options.card,"margin-bottom",i+50,this.options.animations.vertical.duration),this.animate(this.options.card,"margin-top",i,this.options.animations.vertical.duration)).done(t.bind(function(){this.subviews.adPosition&&this.subviews.adPosition.playAd()},this)),this.$bigHeadline.css("visibility","hidden"),this.$body.addClass("high-impact-ad-visible"),this.startBgColor=o.changeBackground(this.$body,this.adData.backgroundSolidColor,this.adData.backgroundRepeatingImage)},calculateScrollSpecs:function(e){this.cardHeight=this.options.card.height()+70+2*e,this.adDiffHeight=this.cardHeight-this.adHeight-this.headerHeight+100}});return r}),define("partner/overlay-ad-base",["jquery","underscore","pubsub","state","utils","baseview","site-manager"],function(e,t,i,n,s,o,a){"use strict";var r=o.extend({events:{"click .partner-close,.ui-film":"onClickCloseButton"},initialize:function(i){i=e.extend({getHeaderOffset:null},i),t.bindAll(this,"onResize"),this.header=a.getHeader(),this.listen(),this.$body=s.get("body"),o.prototype.initialize.call(this,i),this.$placement=this.$(".partner-placement")},showAd:function(){n.setActiveAppFixed(!0),this.header&&this.header.setClosedFixed(!0),this.showingAd=!0,this.show(!0).done(t.bind(function(){this.subviews.ad&&this.subviews.ad.playAd()},this)),this.$body.addClass("high-impact-ad-visible")},stopAd:function(){this.subviews.ad&&this.subviews.ad.stopAd()},onAdReady:function(e,t){var i=this.subviews.ad;i&&("blank"===t?i.trackAd():this.showAd())},destroy:function(e){this.close(),o.prototype.destroy.call(this,e)},findSizeForAd:function(){var e={adSizeClass:"size-s",adTop:"50%",adHeight:450,adWidth:600},t=0;this.options.getHeaderOffset&&(t=this.options.getHeaderOffset()||0);var i=document.documentElement.clientHeight-t-80,n=document.documentElement.clientWidth-160;return n>1080&&i>810?(e.adSizeClass="size-xl",e.adHeight=810,e.adWidth=1080):n>936&&i>700?(e.adSizeClass="size-l",e.adHeight=700,e.adWidth=936):n>768&&i>576&&(e.adSizeClass="size-m",e.adHeight=576,e.adWidth=768),e.adTop=(document.documentElement.clientHeight-t-e.adHeight)/2+t+"px",e},listen:function(){this.pubSub={},this.pubSub["resize:app"]=this.onResize,this.pubSub["breakingbar:after:open"]=this.onResize,this.pubSub["breakingbar:after:close"]=this.onResize},onClickCloseButton:function(e){e.preventDefault(),this.close(!0)},close:function(e){this.showingAd&&this.subviews.ad&&(this.showingAd=!1,n.clearActiveAppFixed(!0),this.header&&this.header.restoreLastState(),this.subviews.ad.stopAd(),this.hide(e)),this.$body.removeClass("high-impact-ad-visible")},onResize:function(){var e=this.findSizeForAd();this.$placement.removeClass("size-s size-m size-l size-xl").addClass(e.adSizeClass).css({top:e.adTop}),this.subviews.ad&&this.subviews.ad.resizeAd(e.adWidth,e.adHeight)}});return r}),define("partner/overlay-ad-fronts",["jquery","underscore","partner/overlay-ad-base","sharedAdPosition","partner/leavebehind","adLogger"],function(e,t,i,n,s,o){"use strict";var a=i.extend({initialize:function(n){n=e.extend({leaveBehindEl:e(".partner-leavebehind"),adSizes:["elastic"],adType:"elastic",adPlacement:"high_impact",isCardBumped:!0,isNative:!1},n),t.bindAll(this,"onAdReady","showAd"),i.prototype.initialize.call(this,n),this.loadAdPlacement(),o.logDebug("Partner Shared Overlay initialized",this)},destroy:function(e){var t=this.options.slot;t&&t.removeClass("show-slot"),i.prototype.destroy.call(this,e)},loadAdPlacement:function(){this.subviews.ad=new n({el:this.$placement,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:this.options.adType,onAdReady:this.onAdReady,beforeAdRender:this.onResize})},onAdReady:function(e){var t=this.options.slot;t&&t.addClass("show-slot"),(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText&&this.options.leaveBehindEl?(this.subviews.adLeaveBehind=new s({el:this.options.leaveBehindEl,cards:this.options.cards,onShowAd:this.showAd,isCompact:this.options.isCardBumped,isNative:this.options.isNative,maxDisplayed:parseInt(e.maxDisplayed,10),behavior:{clearBgColor:!1,hideframe:!1,hidebrand:!1}}),this.subviews.adLeaveBehind.render(this.subviews.ad,e)):this.showAd()},close:function(){this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show(),i.prototype.close.apply(this,arguments)}});return a}),define("partner/skyline-ad",["jquery","underscore","sharedAdPosition","partner/high-impact-base","adLogger"],function(e,t,i,n,s){"use strict";var o=n.extend({events:{"click .partner-close":"closeAdClick"},initialize:function(i){i=e.extend({adClasses:""},i),t.bindAll(this,"onAdReady","showAd"),n.prototype.initialize.call(this,i),s.logDebug("Skyline Advertisment initialized",this)},renderCardInfo:function(e){this._createAd(["skyline"],"skyline",e)},destroy:function(e){this.showingAd&&this.closeAd(),n.prototype.destroy.call(this,e)},closeAdClick:function(e){e.preventDefault(),this.closeAd()},closeAd:function(){this.showingAd=!1,this.subviews.adPosition.stopAd(),this.subviews.adPosition.hide(),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show()}});return o}),define("apps/cards/cards",["jquery","underscore","pubsub","utils","site-manager","base-app","apps/cards/layouts","partner/pushdown-ad","partner/gravity-ad","partner/dual-pushdown-ad","partner/overlay-ad-fronts","partner/skyline-ad","sharedAdPosition"],function(e,t,i,n,s,o,a,r,l,h,d,c,u){"use strict";var p=o.extend({cards:(window.section_arrows||"home").split("|"),cardsDisplay:(window.section_arrows_display||"home").split("|"),initialize:function(i){i=e.extend(!0,{animations:{horizontal:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"},fadeIn:{duration:200}},UPDATE_FREQUENCY:9e5,keyboard:!1,peekWidth:-100,template:'<div class="card-wrap-<%= layoutType %> card-wrap"><section class="card <%= section %> card-loading" id="section_<%= section %>"><div class="card-loading-border"></div></section></div>',overlayTemplate:'<div class="card-wrap-<%= layoutType %> card-wrap card-wrap-behind-overlay"><section class="card <%= section %> card-loading" id="section_<%= section %>"><div class="card-suspender-color <%= section %>"></div><div class="card-loading-border"></div><div class="sidebar"></div></section></div>'},i),t.bindAll(this,"handleResizeWindow"),this.$top=n.get("scrollEl"),this.$doc=n.get("doc"),this.$body=n.get("body"),this.$win=n.get("win"),this.template=t.template(i.template),this.overlayTemplate=t.template(i.overlayTemplate),this.containerOffset=0,this.header=s.getHeader(),this.cardSizes=[];var a=t.throttle(this.handleResizeWindow,50);this.$win.on("resize."+this.cid,a),this.options.keyboard&&this.$doc.on("keydown."+this.cid,this.keyNavigation),o.prototype.initialize.call(this,i)},destroy:function(e){this.$win.off("."+this.cid),this.$doc.off("."+this.cid),o.prototype.destroy.call(this,e)},animateChangePagePreData:function(e,t){var i=n.getSectionPath(t),o=this.goTo(i);if(this._updateNav(t,i),!o&&this.currentPath!==t){var a=this.createAndInitializeEmptyCard(i,this.$win.height()),r=n.getScrollPosition();r-=s.scrollTop(0),this.$currentCard.children(".card").css({top:-1*r}),a.css({position:"relative",margin:"",left:-1*this.containerOffset}),this.$currentCard.css({left:this.leftMargin+-1*this.containerOffset}),o=this.swapContent(this.$currentCard,a),this.$currentCard=a}return o},animateChangePagePostData:function(e,t,i){var n=this.$currentCard,s=i.find(".card-wrap");return s.css({left:-1*this.containerOffset}),n.css({height:"",overflow:"","padding-right":"",left:this.leftMargin+-1*this.containerOffset}),this.$currentCard=s,this.swapContent(n,s,!1,this.getHash(t))},animateRevealApp:function(t,i,n){return n?(this.afterOverlayReveal(0,i),e.Deferred().resolve()):o.prototype.animateRevealApp.apply(this,arguments)},beforePageReveal:function(e,t,i,n){n&&i.css("display","none")},afterPageReveal:function(e,s,o,r){var l=n.getSectionPath(s);this.domInitialized||this.initializeDom(),this.cardSizes=a[n.getNested(this.pageInfo,"layout_type")]||[],this.calculateCardDimensions(this.$win.width()),this._updateNav(s,l),this.$currentCard=this.$container.children(".card-wrap"),this.currentIndex=t.indexOf(this.cards,l),o||(r&&(this.subviews.view=new r({el:this.$currentCard})),this.setupAds(),this.triggerEvent("renderCardInfo",this.currentCardInfo,this.isCurrentCardBumped())),i.trigger("cards:loaded")},setupAds:function(){var e=this.$(".partner-billboard-ad"),i=this.$currentCard;this.subviews.billboardAd=new u({defaultPosition:!0,el:e,adPlacement:"high_impact",adSizes:n.getNested(window.site_vars,"ADS","front_billboard_ad_sizes")||["iabpushdown","iabpushdown2","billboard","risingstar"],adType:["billboard","risingstar"]}),this.subviews.pushdownAd=new r({el:this.$(".partner-pushdown-ad"),adClasses:t.pluck(this.cardSizes,"adClass").join(" "),cards:i,slot:e}),this.subviews.gravityAd=new l({el:this.$(".partner-gravity-ad"),contentSection:this.$el,cards:i,slot:e}),this.subviews.dualPushdownAd=new h({el:this.$(".partner-pushdown-ad"),card:i.children(".card"),cards:i,adClasses:t.pluck(this.cardSizes,"adClass").join(" "),slot:e}),this.subviews.overlayAd=new d({el:this.$(".partner-overlay"),cards:i,isCardBumped:this.isCurrentCardBumped(),getHeaderOffset:t.bind(function(){return this.header.getExpandedHeight()},this),slot:e}),this.subviews.skylineAd=new c({el:this.$(".partner-skyline-ad"),slot:e}),this.subviews.genericad=new u({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"})},isCurrentCardBumped:function(){return this.$currentCard.children(".card-bumped").length},beforeAppRemove:function(){e(".site-nav span.site-nav-span").removeClass("site-nav-active-span")},getRevealAppLoader:function(t){var i=n.getSectionPath(t),s=this.createAndInitializeEmptyCard(i,this.$win.height());return s.css({position:"relative",margin:""}),s=e('<div class="card-container"></div>').append(s),s=e('<article id="cards" class="cards"></article>').append(s)},initializeDom:function(){this.$container=this.$(".card-container"),this.$prevBtn=this.$("#cards-prev-link"),this.$nextBtn=this.$("#cards-next-link"),this.buttonWidth=this.$prevBtn.width(),this.buttonsVisible=!1,this.domInitialized=!0},handleResizeWindow:function(){if(this.domInitialized){var e=this.$win.width();if(this.windowWidth===e)return!1;var t=this.currentCardInfo;this.calculateCardDimensions(e),this.currentCardInfo!==t&&this.triggerEvent("onCardWidthChange",this.currentCardInfo)}},calculateCardDimensions:function(e){var i=this.getMinCardInfo();e<i.windowWidth&&(e=i.windowWidth),this.windowWidth=e;var n=i,s=(window.matchMedia||Modernizr.mq("only all"))&&!this.$top.hasClass("lt-ie9");return t.find(this.cardSizes,function(t){if(s){if(Modernizr.mq("only screen and (min-width: "+t.windowWidth+"px)"))return n=t,!0}else if(e>=t.windowWidth)return n=t,!0}),this.cardWrapWidth=n.cardWidth+((e-2*this.options.peekWidth-n.cardWidth)/2+.5)>>0,this.cardWrapWidth<i.cardWidth&&(this.cardWrapWidth=i.cardWidth),this.leftMargin=(e-n.cardWidth-2*this.options.peekWidth)/2+this.options.peekWidth+.5>>0,this.currentCardInfo=n,this._shouldShowBtns(n.cardWidth,e),n},_shouldShowBtns:function(e,t){var i=2*this.buttonWidth+e<t;i!==this.buttonsVisible&&(i?(this.$nextBtn.css("visibility","visible"),this.$prevBtn.css("visibility","visible")):(this.$nextBtn.css("visibility","hidden"),this.$prevBtn.css("visibility","hidden")),this.buttonsVisible=i)},updateNavLinks:function(e,t){t="home"===t?"/":"/"+t+"/",e.attr("href",t)},keyNavigation:function(e){switch(e.keyCode){case 37:this.previous();break;case 39:this.next()}},inBounds:function(e,t){return!isNaN(parseFloat(e,10))&&isFinite(e)&&e>=0&&t-1>=e},goTo:function(i){var s=t.indexOf(this.cards,i);if(-1!==s&&-1!==this.currentIndex&&s!==this.currentIndex){var o=n.getScrollPosition();return this.isApple&&o>0?e.Deferred(t.bind(function(e){this.$top.animate({scrollTop:0},200).promise().done(t.bind(function(){this._animateCards(s,o).done(function(){e.resolve()})},this))},this)).promise():this._animateCards(s,o)}},_animateCards:function(t,i){var n,o=0,a=e([]),r=this.$win.height(),l=this.$currentCard,h=this.currentIndex,d=this.$currentCard.height(),c=l.offset().top,u=0;u=Math.abs(t-h)>this.cards.length/2?t>h?-1:1:t>h?1:-1;do h=this._incrementIndex(h,u),n=this.createAndInitializeEmptyCard(this.cards[h],r),h!==t&&a.push(n[0]),this._positionCard(n,++o*u),this.$container.append(n);while(h!==t);this.$currentCard=n,this.containerOffset-=o*u*this.cardWrapWidth,i>d+c-r&&l.css({height:r,overflow:"hidden"}),i-=s.scrollTop(0),this.isApple||l.children(".card").css({top:-1*i});var p=this.animate(this.$container,"left",this.containerOffset+"px",this.options.animations.horizontal.duration,this.options.animations.horizontal.easing);return p.done(function(){n.css("position","relative")}).always(function(){l.remove(),a.remove()}),p},_incrementIndex:function(e,t){return(this.cards.length+e+t)%this.cards.length},createAndInitializeEmptyCard:function(t,i){var s=e(this.template({section:t,layoutType:n.getNested(this.pageInfo,"layout_type")||"primary-suspender-sidebar-page"}));return s.css({margin:0,position:"absolute",height:i,bottom:0}),s},_positionCard:function(e,t){e.css({left:this.leftMargin-this.containerOffset+t*this.cardWrapWidth})},getMinCardInfo:function(){return this.cardSizes[this.cardSizes.length-1]||{}},afterOverlayReveal:function(t,i){var s=n.getSectionPath(i||this.currentPath),o=this.$(".card-wrap > .card").position().top||50,a=this.header.getFixedThreshold(),r=o+this.header.getExpandedHeight();this.$el.hide(),r>t&&(t>a&&(r-=t-a),this.offsetPlaceholder=e('<div id="cards-offset-placeholder" style="height:'+r+'px"></div>'),this.$body.append(this.offsetPlaceholder)),this.header.isFixed()?this._fixPlaceholder():this._unfixPlaceholder(),this.fakeCardPlaceholder=e(this.overlayTemplate({section:s,layoutType:n.getNested(this.pageInfo,"layout_type")||"primary-suspender-sidebar-page"})),this.$body.append(this.fakeCardPlaceholder)},_fixPlaceholder:function(){this.offsetPlaceholder&&this.offsetPlaceholder.css({position:"fixed",top:-1*this.header.getFixedThreshold()})},_unfixPlaceholder:function(){this.offsetPlaceholder&&this.offsetPlaceholder.css({position:"absolute",top:0})},_onHeaderFixed:function(){this._fixPlaceholder(),o.prototype._onHeaderFixed.apply(this,arguments)},_onHeaderUnfixed:function(){this._unfixPlaceholder(),o.prototype._onHeaderUnfixed.apply(this,arguments)},beforeOverlayRemove:function(){this.$el.show(),this.offsetPlaceholder&&(this.offsetPlaceholder.remove(),this.offsetPlaceholder=null),this.fakeCardPlaceholder&&(this.fakeCardPlaceholder.remove(),this.fakeCardPlaceholder=null)},getClientAdInfo:function(){return{cardsize:this.currentCardInfo.adTargeting}},_updateNav:function(e,i){var n,s,o=t.indexOf(this.cards,i),a=this._incrementIndex(o,1),r=this._incrementIndex(o,-1);this.header&&this.header.updateNavigation(e),this.domInitialized&&(-1===o&&(a=t.indexOf(this.cards,"home"),r=this._incrementIndex(a,-1)),n=this.cards[a],s=this.cards[r],this.updateNavLinks(this.$nextBtn,n),this.updateNavLinks(this.$prevBtn,s),this.$(".front-next-arrow-label").html(this.cardsDisplay[a]||n),this.$(".front-prev-arrow-label").html(this.cardsDisplay[r]||s),this.$nextBtn.removeClass().addClass("front-arrow-"+n),this.$prevBtn.removeClass().addClass("front-arrow-"+s),this.$(".front-overlay-next-arrows-anchor").removeClass().addClass("front-overlay-next-arrows-anchor "+n+"-theme-bg"),this.$(".front-overlay-prev-arrows-anchor").removeClass().addClass("front-overlay-prev-arrows-anchor "+s+"-theme-bg"))}});return p}),define("modules/scroller/sidebar-scroll",["jquery","underscore","modules/scroller/vertical-scroll"],function(e,t,i){var n=i.extend({initialize:function(n){t.bindAll(this,"onScrollUpdated","removeActiveClass"),n=e.extend({removeActiveDelay:700},n),Modernizr.touch&&(this.$el.css({"-webkit-overflow-scrolling":"touch"}),"touch"===this.$el.css("-webkit-overflow-scrolling")&&(this.$el.css({overflow:"scroll"}),n.disabled=!0)),this._addBottomShadow(),this._addTopShadow(),i.prototype.initialize.call(this,n),this.bar.addClass("hide")},bindEvents:function(){this.options.disabled||(this.$el.on("scrollBarUpdate."+this.cid,this.onScrollUpdated),i.prototype.bindEvents.apply(this,arguments))},destroy:function(){this.$el.off("."+this.cid),this.topShadow.remove(),this.bottomShadow.remove(),clearTimeout(this.removeActiveClassDelay),clearTimeout(this.hideClassDelay),i.prototype.destroy.apply(this,arguments)},_addTopShadow:function(){this.topShadow=e('<div class="shadow top-shadow"></div>').hide(),this.$el.append(this.topShadow)},_addBottomShadow:function(){this.bottomShadow=e('<div class="shadow bottom-shadow"></div>').hide(),this.$el.append(this.bottomShadow)},removeActiveClass:function(){this.isMouseDown||this.isMouseOver||(this.bar.removeClass("active"),clearTimeout(this.removeActiveClassDelay),this.hideClassDelay=setTimeout(t.bind(function(){this.bar.addClass("hide")},this),1e3))},addActiveClass:function(e){this.bar.addClass("active"),this.bar.removeClass("hide"),this.startTimeout(e||this.options.removeActiveDelay)},startTimeout:function(e){clearTimeout(this.removeActiveClassDelay),this.removeActiveClassDelay=setTimeout(this.removeActiveClass,e)},onMouseOut:function(){i.prototype.onMouseOut.apply(this,arguments),this.isMouseDown||this.startTimeout(this.options.removeActiveDelay)},onMouseEnter:function(){i.prototype.onMouseEnter.apply(this,arguments),this.addActiveClass(this.options.removeActiveDelay)},onScrollUpdated:function(e,t){0===t?this.topShadow.hide():this.topShadow.show(),1===t?this.bottomShadow.hide():this.bottomShadow.show(),this.addActiveClass()}});return n}),define("modules/sidebar",["jquery","underscore","baseview","pubsub","state","modules/scroller/sidebar-scroll"],function(e,t,i,n,s,o){"use strict";var a=i.extend({events:{"click .open-sidebar":"openSidebarClick","click .close-sidebar":"closeSidebarClick"},initialize:function(n){this.sidebar=this.$(".sidebar"),this.sidebar.length&&(t.bindAll(this,"showSidebarOpenButton","showSidebarCloseButton","onScroll","_recalculateScrollBar"),n=e.extend(!0,{animations:{sidebar:{button:{fadeIn:200,fadeOut:200},slide:250}}}),this.pubSub={"sidebar:hide":this.closeSidebarClick,"sidebar:show":this.openSidebarClick,"showmore:headlines":this.onHeadlinesUpdated},this.refreshSidebarScroll=t.debounce(this._recalculateScrollBar,1e3),i.prototype.initialize.call(this,n),this._addSidebar())},renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&(this.isSidebarOpen=!0,this.refreshSidebarScroll())},onCardWidthChange:function(e){var t=e.sidebarOpen!==this.currentCardInfo.sidebarOpen||this.sidebarOpen!==e.sidebarOpen;this.currentCardInfo=e,this.resetSidebar(),t&&s.getActiveApp().triggerEvent(e.sidebarOpen?"openSideBar":"closeSideBar")},_recalculateScrollBar:function(){this._setSideBarTitles();var e=this.$(".sidebar-fixed-content"),t=e.height(),i=this.sidebar.height(),n=Math.max(0,i-t),o=this.$(".sidebar-scrollable-window");t>i&&(t=i,e.css("height",i)),n!==parseInt(o[0].style.height,10)&&(o.css("height",n),s.getActiveApp().triggerEvent("onSidebarScrollableHeightChange",t,n)),this.subviews.vscrollbar&&this.subviews.vscrollbar.refresh()},_addSidebar:function(){Modernizr.touch||this.initializeSidebarTitles(),this.openButton=this.$(".open-sidebar"),this.closeButton=this.$(".close-sidebar"),this.subviews.vscrollbar=new o({el:this.$(".sidebar-scrollable-window"),contentClass:this.$(".sidebar-scrollable-content"),padding:2,lockPageScroll:!1,delayScroll:!1,fadeout:!0,onScroll:this.onScroll})},initializeSidebarTitles:function(){this.$sidebarScrollableTitles=this.$(".sidebar-scrollable-content .sidebar-title-wrapper"),this.$sidebarStaticTitle=this.$(".sidebar-static-title-wrapper");var e=this.$(".sidebar-scrollable-content .sidebar-title-wrapper:first");e.length&&(e.hide(),this.$sidebarStaticTitle.html(e.html()).show())},_setSideBarTitles:function(){var t=this;this.sideBarTitles=[],this.$sidebarScrollableTitles&&this.$sidebarScrollableTitles.each(function(i,n){var s=e(n),o=!1;s.is(":hidden")&&(s.show(),o=!0);var a=s.position().top+s.outerHeight();o&&s.hide(),a=-1*a,t.sideBarTitles.push({position:a,html:s.html()})})},onScroll:function(e){if(this.$sidebarScrollableTitles.length>1&&0!==e){var t=this.$sidebarStaticTitle;this.sideBarTitles||this._setSideBarTitles();var i,n=this.sideBarTitles.length-1,s=t.html();for(n;n>=0;n--)if(i=this.sideBarTitles[n],i.position>e){s=i.html;break}t.html()!==s&&t.html(s)}},openSidebarClick:function(e){e&&e.preventDefault(),s.getActiveApp().triggerEvent("openSideBar"),this._slideSidebar(this.openButton,!0)},openSidebar:function(){this.isSidebarOpen=!0},closeSidebarClick:function(e){e&&e.preventDefault(),this._slideSidebar(this.closeButton,!1),s.getActiveApp().triggerEvent("closeSideBar")},closeSidebar:function(){this.isSidebarOpen=!1},_slideSidebar:function(e,i){var n=this.options.animations.sidebar.slide,o=this.options.animations.sidebar.button.fadeOut;s.registerAnimation(e.fadeOut(o,"easeInOutCubic").promise());var a=parseInt(this.sidebar.css("width"),10),r=null;if(this.currentCardInfo.sidebarOpen){var l=i?this.currentCardInfo:s.getActiveApp().getMinCardInfo();this.sidebar.removeClass("top"),r=this.animate(this.$.closest(".card"),"width",l.cardWidth,n,"ease-in-out")}else r=this.animate(this.sidebar,"right",-1*a,n,"ease-in-out");return r.then(t.bind(function(){var e=this.animate(this.sidebar,"right",0,n,"ease-in-out");return i?this.currentCardInfo.sidebarOpen?(this.sidebar.removeClass("top"),this.$el.closest(".card").css("width","")):(this.sidebar.addClass("top"),e.done(this.showSidebarCloseButton)):(e.done(this.showSidebarOpenButton),this.sidebar.removeClass("top")),e},this))},resetSidebar:function(){this.$el.closest(".card").css("width",""),this.sidebar.removeClass("top"),this.currentCardInfo.sidebarOpen?(this.openButton.hide(),this.closeButton.hide()):(this.adVisible?this.openButton.hide():this.openButton.show(),this.closeButton.hide()),this._setSideBarTitles()},showSidebarOpenButton:function(){this.adVisible||(this.openButton.css({visibility:"visible",display:"none"}),this.openButton.fadeIn(this.options.animations.sidebar.button.fadeIn,"easeInOutCubic"))},showSidebarCloseButton:function(){this.closeButton.fadeIn(this.options.animations.sidebar.button.fadeIn,"easeInOutCubic")},onHeadlinesUpdated:function(){this.headlinesUpdate=setTimeout(this._recalculateScrollBar,1e3)},onHeroAdClose:function(){this.adVisible=!1,this.isSidebarOpen||this.showSidebarOpenButton()},onHeroAdOpen:function(){this.adVisible=!0,this.isSidebarOpen?this.currentCardInfo.sidebarOpen||this.closeSidebar():this.openButton.fadeOut(this.options.animations.sidebar.button.fadeOut,"easeInOutCubic")}});return a}),define("partner/overlay-ad-asset",["jquery","underscore","partner/overlay-ad-base","meteredAdPosition","adLogger"],function(e,t,i,n,s){"use strict";var o=i.extend({initialize:function(n){n=e.extend({adSizes:["elastic"],adPlacement:"transition",rateMeterId:"transition",pageInfo:null},n),t.bindAll(this,"onAdReady"),i.prototype.initialize.call(this,n),this.loadAdPlacement(this.options.pageInfo),s.logDebug("Partner Metered Overlay initialized",this)},loadAdPlacement:function(e){e=e||this.options.pageInfo,this.subviews.ad=new n({el:this.$placement,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,rateMeterId:this.options.rateMeterId,pageInfo:e,onAdReady:this.onAdReady,beforeAdRender:this.onResize})},triggerAd:function(){var e="transition_referrer"===this.options.adPlacement,t=this.options.pageInfo.excludeTransitionAd;this._tickMeterFetchAd(t),e&&!t&&this.$placement.children(".partner-overlay-close").data("uotrack","referreradclosed")},getCurrentMeterCount:function(){return this._tellAd("getCurrentMeterCount")},_tickMeterFetchAd:function(e){this.tickMeter(e)&&!e&&this.subviews.ad.prefetchAd()},tickMeter:function(e,t){return this._tellAd("tickMeter",e,t)},_tellAd:function(e){var t=this.subviews.ad;return t&&t[e]?t[e].apply(t,Array.prototype.slice.call(arguments,1)):null},resetMeter:function(e){return this._tellAd("resetMeter",e)},refresh:function(e){this.destroyAdPosition(),this.loadAdPlacement(e)}});return o}),define("modules/partner/story-transition-ad",["jquery","underscore","baseview","state","site-manager","utils","admanager","partner/overlay-ad-asset"],function(e,t,i,n,s,o,a,r){"use strict";var l=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.renderAd()},renderAd:function(){var e=n.getReferrer(),i={el:this.$el,pageInfo:n.getActivePageInfo(),getHeaderOffset:function(){var e=s.getHeader();return e?e.getExpandedHeight():0}},o=!1;e&&-1===e.indexOf(window.location.protocol+"//"+window.location.hostname)&&(i.adPlacement="transition_referrer",i.rateMeterId="transition_referrer",o=!0),this.subviews.transitionAd=new r(i),Modernizr.history||(o=!0),0===this.subviews.transitionAd.getCurrentMeterCount()&&(o=!0),a.getActiveSlotStatistics().done(t.bind(function(e){this.destroyed||(t.findWhere(e.high_impact_info,{adType:"gravity"})&&o&&(o=!1,this.subviews.transitionAd.resetMeter("transition")),o?this.subviews.transitionAd.triggerAd():this.subviews.transitionAd.tickMeter(!0,"transition"),"transition_referrer"===i.rateMeterId&&this.subviews.transitionAd.resetMeter("transition"))},this))},getTransitionMeterCount:function(){return this.subviews.transitionAd?this.subviews.transitionAd.getCurrentMeterCount("transition"):0}});return l}),define("partner/gravity-ad-article",["jquery","underscore","utils","sharedAdPosition","partner/gravity-ad"],function(e,t,i,n,s){"use strict";var o=s.extend({articleElsHidden:!1,initialize:function(e){s.prototype.initialize.call(this,e);var t=this.options.contentSection;this.$recommended=t.find(".recommended-flyout-container"),this.$utilityBarPrimaryModules=t.find(".util-bar-primary-modules"),this.$utilityBarSecondaryModules=t.find(".util-bar-secondary-modules"),this.$closeWrap=t.find(".close-wrap"),this._createAd(["gravity"],"gravity")},_createAd:function(){var e=this._filterAdsByCardWidth(["gravity"]);this.subviews.adPosition=new n({el:this.$el,adPlacement:"high_impact",adSizes:e,adType:"gravity",onAdReady:this.onAdReady,beforeAdRender:this.beforeAdRender})},onAdReady:function(e){var t=this.subviews.adLeaveBehind;t&&t.shouldShowAd(e)&&(t.incrementAdViewCount(e),this.showAd(),i.get("scrollEl").animate({scrollTop:0},500))},onArticleScroll:function(e,t){var i=this.$utilityBarSecondaryModules.height();.1>e&&this.articleElsHidden?(this.$utilityBarSecondaryModules.stop("gravity").animate({bottom:0},{duration:200,queue:"gravity"}).dequeue("gravity"),this.$recommended.show(),this.$closeWrap.show(),this.$body.removeClass("high-impact-ad-visible"),this.articleElsHidden=!1):e>.1&&!this.articleElsHidden&&(this.$recommended.hide(),this.$closeWrap.hide(),this.$utilityBarSecondaryModules.stop("gravity").animate({bottom:-1*i},{duration:200,queue:"gravity"}).dequeue("gravity"),this.$body.addClass("high-impact-ad-visible"),this.articleElsHidden=!0),0>=e?(this.$utilityBarPrimaryModules.css({position:"fixed",top:80+t}),this.$closeWrap.css({position:"fixed",top:80+t})):e>0&&(this.$utilityBarPrimaryModules.css({position:"absolute",top:80}),this.$closeWrap.css({position:"absolute",top:80}))},shiftUnlockedContentUp:function(){s.prototype.shiftUnlockedContentUp.call(this),this.$utilityBarPrimaryModules.css({position:"absolute",top:80}),this.$partnerScroll.animate({"margin-top":-145},350)},showAd:function(){s.prototype.showAd.call(this),(!this.paywall||this.paywall&&("loggedIn"===status||"loggingIn"===status))&&this.shiftUnlockedContentUp()}});return o}),define("apps/overlay/overlay",["jquery","underscore","backbone","utils","site-manager","apps/simple-overlay","state","admanager","modules/partner/story-transition-ad","directAdPosition","meteredAdPosition","partner/gravity-ad-article","managers/routemanager","pubsub"],function(e,t,i,n,s,o,a,r,l,h,d,c,u,p){"use strict";var f=o.extend({el:"#overlay",events:function(){return e.extend({},o.prototype.events,{"click .overlay-content-arrows":"nextArticleClick"})},initialize:function(i){i=e.extend({inbetweenAdTemplate:'<div class="partner-inbetween transition-wrap"><div class="partner-inbetween-content partner-placement"></div></div>'},i),this.init=!1,this.$doc=n.get("doc"),this.$body=n.get("body"),t.bindAll(this,"keyboardEvent","beforeInbetweenAdRender"),this.currentStoryIndex=-1,this.storyCollection=[],this.animationIndex=0,o.prototype.initialize.call(this,i)
},resizeHandler:function(){o.prototype.resizeHandler.apply(this,arguments),this.inbetweenAd&&this.inbetweenAd.resizeAd(980,this.winSize.height),this.$inbetweenPartner&&this.$inbetweenPartner.css(this.winSize)},afterPageReveal:function(e){o.prototype.afterPageReveal.apply(this,arguments),this.$doc.on("keyup."+this.cid,this.keyboardEvent),this.init?(this.renderInbetweenAd(),this.updateArrowLinks()):(this.initializeDom(),this.init=!0,this.updateArrowLinks(!0),this.subviews.storyTransitionAd=new l({el:this.$(".partner-overlay")}),0===this.subviews.storyTransitionAd.getTransitionMeterCount()&&this.renderInbetweenAd()),null!==e&&this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex),this.freeTrialCheck(),this.loadAdPlacements()},loadAdPlacements:function(){var e=a.getActivePageInfo();e.sponsored_series||("video"!==e.priority_asset&&(this.subviews.gravityAd=new c({el:this.$(".partner-gravity-ad"),contentSection:this.$el})),!n.getNested(window.site_vars,"ADS","teads_enabled")||t.findWhere(e.js_modules,{oembedtype:"rich"})||t.findWhere(e.js_modules,{name:"gallery"})||"no"!==e.videoincluded||"Published"!==e.asset_status||(this.subviews.teadsAd=new h({el:this.$(".partner-teads"),adSizes:[1,1],adPlacement:"video_inread-partner_teads",adType:"teads",pageInfo:e})))},preloadPath:function(){a.preloadPath(this.preloadedUrl).done(t.bind(function(){this.updateArrowLinks(!0),this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex)},this))},beforeInbetweenAdRender:function(){this.inbetweenAd.setInitialDimensions(980,this.winSize.height)},renderInbetweenAd:function(){this.$inbetweenPartner?this.$inbetweenPartner.parent().length||this.$el.append(this.$inbetweenPartner.hide()):(this.$inbetweenPartner=e(this.options.inbetweenAdTemplate),this.$el.append(this.$inbetweenPartner)),this.inbetweenAd?this.isShowingAd&&(this.isShowingAd=!1):this.inbetweenAd=new d({el:this.$inbetweenPartner.find(".partner-inbetween-content"),adPlacement:"transition",adSizes:["bigpageflex"],beforeAdRender:this.beforeInbetweenAdRender,rateMeterId:"transition"}),this.inbetweenAd.setPageInfo(a.getActivePageInfo()),this.inbetweenAd.tickMeter(!0)&&r.getActiveSlotStatistics().done(t.bind(function(e){t.findWhere(e.high_impact_info,{adType:"gravity"})?this.inbetweenAd.resetMeter():(this.timeToShowAd=!0,this.inbetweenAd.refreshPosition())},this))},keyboardEvent:function(t){if(t.target===this.$body[0])switch(t.which){case 37:e(".overlay-content-arrows-previous-wrap").trigger("click");break;case 39:e(".overlay-content-arrows-next-wrap").trigger("click")}},nextArticleClick:function(i){var n=1,s=e(i.currentTarget),o=s.attr("href"),a=this.inbetweenAd;if(s.hasClass("overlay-content-arrows-previous-wrap")&&(n=-1),!this.isShowingAd&&this.timeToShowAd&&a.isAdReady()&&(a.tickMeter(),this.timeToShowAd=!1,i.preventDefault(),u.goToInterstitual(o))){var r=this.getStoryCollection();return s.siblings().remove(),this.arrowContainer.append(this.buildArrowDom(r[this.currentStoryIndex],0>n?"next":"previous")),this.currentStoryIndex+=n/2,a.showAd(980,this.winSize.height),this.animateToContent(this.$inbetweenPartner,n).done(t.bind(function(){this.inbetweenAd&&(this.isShowingAd=!0,a.playAd())},this))}},initializeDom:function(){this.arrowWrapTemplate=this.$("#overlay-arrow-wrap"),this.arrowContainer=this.$(".overlay-arrows")},destroyModules:function(){this.$doc.off("."+this.cid),o.prototype.destroyModules.apply(this,arguments)},beforeAppRemove:function(){this.inbetweenAd&&(this.inbetweenAd.destroy(),this.inbetweenAd=null),o.prototype.beforeAppRemove.apply(this,arguments)},updateArrowLinks:function(e){if(-1!==this.currentStoryIndex||(this.currentStoryIndex=this.getBestStoryIndex(window.location.pathname,e),-1!==this.currentStoryIndex)){var t=this.getStoryCollection(),i=this.buildArrowDom(t[this.currentStoryIndex-1],"previous"),n=this.buildArrowDom(t[this.currentStoryIndex+1],"next");this.arrowContainer.empty().append(i).append(n),this.animate(this.arrowContainer,"opacity",1,250)}},buildArrowDom:function(i,n){var s=!i;if(i?i.disabled="":i={disabled:"disabled"},i.dir=n,i.photo&&i.photo.crops&&i.photo.crops["1_1"]&&-1!==i.photo.crops["1_1"].indexOf(".jpg")&&(i.image=i.photo.crops["1_1"]),!this.arrowWrapTemplate.length)return e([]);var o=e(e.trim(t.template(this.arrowWrapTemplate.html(),i)));return s?o.css(this.isApple?{display:"none"}:{"z-index":1}):this.isApple&&o.find(".preview").remove(),o},getBestStoryIndex:function(e,t){e&&"/"!==e[0]&&(e="/"+e);var i=this.getStoryCollection();if(!i||0===i.length)return-1;var n=-1,s=-1,o=Math.round(this.currentStoryIndex);-1===o&&(o=0);var a;for(a=o;a>=0;a--)if(i[a].links===e){n=a;break}for(a=o;a<i.length;a++)if(i[a].links===e){s=a;break}if(-1===s&&-1===n&&t){var r={links:e};return this.storyCollection.unshift(r),0}return-1===s?n:-1===n?s:s-o>o-n?n:s},getStoryCollection:function(){if(0===this.storyCollection.length){var e=a.getPreloadedPageInfo(),i=e&&e.asset_collection;i&&(this.storyCollection=t.filter(i,this._filterStoryCollection))}return this.storyCollection},_filterStoryCollection:function(e){var t,i,n;return e.links&&(t=u.getInfo(e.links),i=t&&t.app&&t.app.AppClass),n=i===f,e.headline&&e.links&&!e.links.match("http")&&n},animateChangePagePreData:function(t,i){var n,s=this.getBestStoryIndex(i);return-1!==this.currentStoryIndex&&-1!==s&&(n=this.currentStoryIndex>s?"left":"right"),this.currentStoryIndex=s,this.animateToContent(e(this.options.template).find(".transition-wrap"),n)},animateToContent:function(i,o){var a=this.winSize.height,r=n.getScrollPosition(),l=this.$(".transition-wrap:first");if(r-=s.scrollTop(0),this.$el.css({position:"relative"}),this.prepareContentForTransition(l,r,a),i.css({position:"absolute",top:0,display:"block"}),i.attr("data-animation-index",++this.animationIndex),this.prepareContentForTransition(i,0,a),i.closest("body").length||this.$el.prepend(i),this.header.isFixed()&&this.positionCloseButton("absolute",r,l),o){l.css({left:"0%"});var h,d="0%";return"left"===o?(i.css("left","-100%"),h="100%"):(i.css("left","100%"),h="-100%"),e.Deferred(t.bind(function(n){var s=e.when(this.animate(l,"left",h,350,"ease-in-out"),this.animate(i,"left",d,350,"ease-in-out"));s.done(t.bind(function(){this.isShowingAd&&this.inbetweenAd&&this.inbetweenAd.destroyAdPlacement(),l.remove(),parseInt(i.attr("data-animation-index"),10)===this.animationIndex&&this.resetContentTransition(i),n.resolve()},this))},this)).promise()}return i.css({position:"relative"}),this.swapContent(l,i)},prepareContentForTransition:function(e,t,i){e.css({height:i}),e.children().css({top:-1*t})},resetContentTransition:function(e){e.css({position:"relative"}),this.$el.css({position:"",top:""})},freeTrialCheck:function(){var e=window.location.href;e.indexOf("freeTrialComplete")>-1&&p.trigger("freetrialtrack")}});return f}),define("third-party-apis/base-third-party-api",["jquery","underscore","backbone","pubsub","utils"],function(e,t,i,n,s){"use strict";var o=i.View.extend({SITE_CONFIG:s.getNested(window.site_vars,"THIRDPARTYAPI"),initialize:function(){n.on("page:load",t.bind(this.loadScript,this))},loadScript:function(){return this.loadScriptPromise||(this.loadScriptPromise=this._handleLoadScript()),this.loadScriptPromise},_handleLoadScript:function(){return e.Deferred().resolve()},setupOnLoadCallbacks:function(e,i){window[e]||(window[e]=t.bind(function(){i()},this))},getApiSiteConfig:function(e){var t=this.SITE_CONFIG;return t?t[e]:(console.error("No siteconfig set up for "+e+" api!"),{})}});return o}),define("modules/global/userUtil",["jquery","underscore","baseview","pubsub","managers/requestmanager","utils"],function(e,t,i,n,s,o){"use strict";var a=i.extend({initialize:function(){if(this.userData=o.getNested(window.site_vars,"userAuthentication","user"),this.personalLinkData=o.getNested(window.site_vars,"userAuthentication","personal_link"),this.userData&&this.personalLinkData){this.guidFromUrl=(window.location.search.split(this.personalLinkData.qsp+"=")[1]||"").split("&")[0];var e=window.location.pathname+this.removeParameter([this.personalLinkData.qsp]);this.returnUrl=window.location.host+window.location.pathname,Modernizr.history&&(window.history.replaceState({},"",e),this.returnUrl=window.location.href),t.isEmpty(this.guidFromUrl)||(n.trigger("userUtil:personal_link",this.guidFromUrl),this._isUserUtilLocalStorageExpired()&&this.redirectNonAnonymousUserToLogin(this.guidFromUrl))}i.prototype.initialize.call(this)},getUser:function(){if(this.userData&&this.personalLinkData){var t=s.fetchData(this.userData.url+"?callback=?",{dataType:"jsonp",data:{}}).done(function(e){return e}).fail(function(){return e.Deferred().reject()});return t}return e.Deferred().reject()},redirectNonAnonymousUserToLogin:function(){s.fetchData(this.userData.url+"?callback=?",{dataType:"jsonp",data:{}}).then(t.bind(function(e){e.response.anonymousId!=this.guidFromUrl&&(this._setuserUtilLocalStorageExpireTime(),this._loginRedirect())},this))},_isUserUtilLocalStorageExpired:function(){var e=new Date;return!localStorage.getItem("userUtil-redirect-datetime")||parseInt(localStorage.getItem("userUtil-redirect-datetime"),10)<e.getTime()},_loginRedirect:function(){window.location.href=this.personalLinkData.url+"?cancel-url="+encodeURIComponent(this.returnUrl)+"&success-url="+encodeURIComponent(this.returnUrl)},_setuserUtilLocalStorageExpireTime:function(){var e=new Date,t=2592e6+e.getTime();localStorage.setItem("userUtil-redirect-datetime",t)},removeParameter:function(e){var t=window.location.search,i=t.split("?");if(i.length>=2){for(var n=i.shift(),s=i.join("?"),o=encodeURIComponent(e)+"=",a=s.split(/[&;]/g),r=a.length;r-->0;)-1!==a[r].lastIndexOf(o,0)&&a.splice(r,1);t=n+"?"+a.join("&")}return t.length<2&&(t=""),t}});return a}),function(){var e="undefined"!=typeof exports?exports:window,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=function(){try{document.createElement("$")}catch(e){return e}}();e.btoa||(e.btoa=function(e){for(var n,s,o=0,a=t,r="";e.charAt(0|o)||(a="=",o%1);r+=a.charAt(63&n>>8-o%1*8)){if(s=e.charCodeAt(o+=.75),s>255)throw i;n=n<<8|s}return r}),e.atob||(e.atob=function(e){if(e=e.replace(/=+$/,""),e.length%4==1)throw i;for(var n,s,o=0,a=0,r="";s=e.charAt(a++);~s&&(n=o%4?64*n+s:s,o++%4)?r+=String.fromCharCode(255&n>>(-2*o&6)):0)s=t.indexOf(s);return r})}(),define("base64",function(){}),define("third-party-apis/firefly/firefly",["jquery","underscore","third-party-apis/base-third-party-api","managers/requestmanager","utils","modules/global/userUtil","base64"],function(e,t,i,n,s,o){"use strict";var a=i.extend({getUserInfo:function(){return this.userInfo&&"rejected"!==this.userInfo.state()||(this.userInfo=this.getUserResponse().then(function(i){var n=i,o=s.getNested(window.site_vars,"userAuthentication","user","response_user_path");return t.each(o,function(e){n=s.getNested(n,e)}),i.meta.isAuthenticatedInCurrentContext||0===i.meta.status?n:e.Deferred().reject("Not logged in.")})),this.userInfo},getUserResponse:function(){return this.userUtil||(this.userUtil=new o),this.userResponse||(this.userResponse=this.userUtil.getUser()),this.userResponse},sanitizeFireflyViewsObject:function(e){return t.isObject(e)?e.viewCount&&e.viewThreshold&&e.viewedContent?t.isNumber(e.viewCount)&&t.isNumber(e.viewThreshold)&&t.isArray(e.viewedContent)?(e.viewCount<1&&(e.viewCount=1),e.viewThreshold<1&&(e.viewThreshold=1),e.viewCount>e.viewThreshold&&(e.viewThreshold=e.viewCount),e):(console.error("Wrong format in Firefly views object values"),!1):(console.error("Missing Firefly views object properties"),!1):(console.error("Firefly views cookie is not an object"),!1)},getFireflyViewsCookie:function(){var t=null,i=e.cookie("firefly_akamai_open");if(i&&(t=this._parseCookie(i))){t=this.sanitizeFireflyViewsObject(t);var n=t.viewThreshold-t.viewCount;t.viewsRemaining=n}return t},_parseCookie:function(e){try{return JSON.parse(atob(e))}catch(t){try{return JSON.parse(e)}catch(i){}}return null},getLoginStatus:function(){return this.getUserInfo()},loginUser:function(){return this.getLoginStatus()},logoutUser:function(){return this.userInfo=null,this.userResponse=null,e.Deferred().resolve()}});return new a}),define("modules/stories/utility-bar-module-popups",["jquery","underscore","backbone"],function(e,t,i){var n=i.View.extend({});return new n}),define("modules/stories/utility-bar",["jquery","underscore","backbone","pubsub","utils","state","baseview","site-manager","managers/resourcemanager","third-party-apis/firefly/firefly","user-manager","modules/stories/utility-bar-module-popups"],function(e,t,i,n,s,o,a,r,l,h,d,c){var u=a.extend({el:".utility-bar-wrap",events:{"click .util-bar-btn":"onClickUtilityBtn"},initialize:function(e){t.bindAll(this,"onDestroySubview"),this.pubSub={"header:fixed":this.onHeaderFixed,"header:unfixed":this.onHeaderUnfixed,"user:statuschange":this._loginStatus,"fireflyout:open":this.allowOpenFireflyout},this.$primaryModules=this.$(".util-bar-primary-modules"),this.$secondaryModules=this.$(".util-bar-secondary-modules"),this.canFireflyoutOpen=!s.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY","ENABLED")||!1,this.isFireflyoutOpen=!1;var i=r.getHeader();i&&i.isFixed()&&this.onHeaderFixed(),a.prototype.initialize.call(this,e),this.autoPopoutComments(),this.setupFireflyout()},autoPopoutComments:function(){this.$commentsBtn=this.$(".util-bar-btn-comments"),window.location.search.search("[?&]fb_comment_id=.+")>-1&&t.defer(t.bind(function(){this.openComments()},this))},setupFireflyout:function(){this.$fireflyModule=this.$(".util-bar-module-firefly"),this.$fireflyBtn=this.$(".util-bar-btn-firefly"),this.$fireflyModule.length&&this._checkUserAccount()},_checkUserAccount:function(){var e=d.getAccount("firefly");e&&e.getUserInfo().always(t.bind(function(t){this._loginStatus("firefly",e.getLoginStatus(),t)},this))},_loginStatus:function(e,t,i){if("firefly"===e){"loggedIn"===t?this.$fireflyModule.addClass("util-bar-module-firefly-authenticated"):"loggingIn"!==t&&this.$fireflyModule.removeClass("util-bar-module-firefly-authenticated");var n=o.getActivePageInfo().content_protection_state,s=!n||"free"===n;"loggedIn"===t&&i&&i.hasMarketAccess||s?this.$fireflyModule.removeClass("util-bar-module-firefly-visible"):"loggingIn"!==t&&(this.$fireflyModule.addClass("util-bar-module-firefly-visible"),this.fireflyCookieCheck())}},fireflyCookieCheck:function(){var e=h.getFireflyViewsCookie();e&&this._canFireflyoutOpen()&&!this.isFireflyoutOpen&&(1===e.viewCount||e.viewsRemaining<2||this._overrideFlyoutOpen(e.viewsRemaining))&&t.delay(t.bind(function(){this.isFireflyoutOpen=!0,this.openFireflyout()},this),0)},_overrideFlyoutOpen:function(e){return t.indexOf(s.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","flyoutOverrideArticleViewsRemaining"),e)>-1},_canFireflyoutOpen:function(){return this.canFireflyoutOpen},allowOpenFireflyout:function(){this.canFireflyoutOpen=!0;var e=d.getAccount("firefly");if(e){var t=e.getLoginStatus();("loggedIn"!==t||"loggingIn"!==t)&&this.fireflyCookieCheck()}},openFireflyout:function(){this.$fireflyBtn.trigger("click")},openComments:function(){this.$commentsBtn.trigger("click")},onHeaderFixed:function(){this.$primaryModules.css({position:"fixed",top:"auto"})},onHeaderUnfixed:function(){this.$primaryModules.css({position:"absolute",top:""})},onClickUtilityBtn:function(i){var n=e(i.currentTarget);if(n.data("popup-callback")){var s=n.data("popup-callback");c[s]()}else if("A"!==n.prop("tagName")){i.preventDefault();var o=n.data("module-name"),a=n.data("module-section")||"";this.subviews[o]?a&&a!==this.subviews[o].activeSection?this.subviews[o].open(a):this.subviews[o].close&&this.subviews[o].close():(t.each(this.subviews,function(e){e&&e.close&&e.close()}),l.getSiteModuleByName(o).done(t.bind(function(e){this.destroyed||(this.subviews[e.name]=new e.ModuleClass(t.extend({el:e.selector,onDestroy:this.onDestroySubview},e.options)),this.subviews[e.name].open&&this.subviews[e.name].open(a))},this)).fail(function(){console.error("Failed to load utility bar module: "+o+".js")}))}},onDestroySubview:function(e){t.each(this.subviews,function(t,i){t===e&&(this.subviews[i]=null)},this)},show:function(){this.$el.addClass("show")},hide:function(){this.$el.removeClass("show")},destroy:function(e){this.destroyed=!0,this.$el.css("padding-top",s.getScrollPosition()),this.$primaryModules.css("position","absolute"),this.$secondaryModules.css("position","absolute"),a.prototype.destroy.call(this,e)}});return u}),define("modules/stories/recommended-flyout",["jquery","underscore","baseview","utils"],function(e,t,i,n){var s=i.extend({events:{"click .closed":"toggle","click .recommended-flyout-close":"toggle"},initialize:function(){this.isOpen=!1,this.forcedStatus=!1,this.hasOpened=!1,this.rendered=!1,this.$flyout=this.$(".recommended-flyout"),this.$flyoutWrap=this.$(".recommended-flyout-wrap"),this.$flyoutTemplate=this.$("#recommended-flyout-template"),this.$win=n.get("win"),this.winHeight=this.$win.height(),t.bindAll(this,"scrollListener"),i.prototype.initialize.apply(this,arguments)},storyCollectionLoaded:function(e,i){if(e&&e.length>0&&i>-1){var n=e[i+1];if(this.$triggerDom=this.$el.next(),this.triggerDomOffset=this.$triggerDom.offset().top,n&&this.$triggerDom.length){this.render(n);var s=t.throttle(this.scrollListener,100);this.$win.on("scroll."+this.cid,s)}}},scrollListener:function(){var e=n.getScrollPosition(),t=e+this.winHeight;this.triggerDomOffset<=t?this.openRecommendedFlyout():this.closeRecommendedFlyout()},render:function(e){try{e&&e.photo&&e.photo.crops&&(e.image=e.photo.crops["1_1"]);var i=t.template(this.$flyoutTemplate.html(),{data:e});this.$flyout.html(i),this.rendered=!0}catch(n){console.error("failed rendering flyout template",n)}},toggle:function(e){e.preventDefault(),this.isOpen?(this.forcedStatus="closed",this.closeRecommendedFlyout()):(this.forcedStatus="open",this.openRecommendedFlyout())},openRecommendedFlyout:function(){!this.isOpen&&this.rendered&&"closed"!=this.forcedStatus&&(this.animate(this.$flyoutWrap,"width",360,350,"ease-out"),this.$flyout.removeClass("closed"),this.isOpen=!0,this.hasOpened=!0)},closeRecommendedFlyout:function(){this.hasOpened&&this.isOpen&&"open"!=this.forcedStatus&&(this.animate(this.$flyoutWrap,"width",24,250,"ease-out"),this.$flyout.addClass("closed"),this.isOpen=!1)},destroy:function(){this.$win.off("."+this.cid),this.$el.remove(),i.prototype.destroy.apply(this,arguments)}});return s}),define("partner/slider",["jquery","underscore","baseview","sharedAdPosition","utils"],function(e,t,i,n,s){"use strict";var o=i.extend({el:".partner-slider-ad",events:{"click .partner-slider-close":"onClickCloseButton"},destroy:function(){this.stopCloseTimer(),this.hide(!0),i.prototype.destroy.call(this,!1)},initialize:function(s){t.bindAll(this,"onAdReady"),s=e.extend({adSizes:["mediumrectangle","halfpage","portrait","filmstrip"],adPlacement:"high_impact"},s),i.prototype.initialize.call(this,s),this.subviews.ad=new n({el:this.$el,adSizes:s.adSizes,adPlacement:s.adPlacement,adType:"slider",defaultPosition:!0,onAdReady:this.onAdReady})},onAdReady:function(){this.subviews.ad.show(),this.show(!0).done(t.bind(function(){this.startCloseTimer()},this))},onClickCloseButton:function(e){e.preventDefault(),this.destroy(!1)},startCloseTimer:function(){var e=s.getNested(window.site_vars,"ADS","SLIDER","CLOSETIME");e&&(this.closeTimer=setTimeout(t.bind(function(){this.hide()},this),e))},stopCloseTimer:function(){clearTimeout(this.closeTimer)}});return o}),define("modules/global/brightcove-video",["jquery","underscore","baseview","pubsub","state","admanager","adLogger","utils","cookie"],function(e,t,i,n,s,o,a,r){"use strict";var l=i.extend({events:{"click .videoStillPlay":"swapImageForVideo","click .videoStill":"swapImageForVideo","click .videoCloseButton":"hidePlayer"},initialize:function(r){r=e.extend({live:!1,onVideoComplete:null,onVideoShow:null,onVideoHide:null,onVideoLoaded:null},r),this.$videoObj=this.$(".videoObject"),this.$brightcove=this.$(".BrightcoveExperience"),this.brightcoveId=this.$(".BrightcoveExperience").attr("id"),this.playerHTML=this.$videoObj.html();var l=this.$videoObj.data()||{},h=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),d=e.cookie("aam_uuid"),c="";this.pageinfo=s.getActivePageInfo(),this.pageinfo.series&&(c+="&series="+encodeURIComponent(this.pageinfo.series)),this.pageinfo.topic&&(c+="&topic="+encodeURIComponent(this.pageinfo.topic)),this.pageinfo.basePageType&&(c+="&pagetype="+encodeURIComponent(this.pageinfo.basePageType)),c+="&aam="+h+"&u="+d,a.logInfo("Built ad call for video, "+l.id+".",this.pageinfo,l);var u="http://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output=xml_vast2&iu="+o.buildAdUnit("preroll_video")+"/"+l.cst+"&sz=920x508&unviewed_position_start=1&cust_params=contentid%3D"+l.brightcovevideoid+encodeURIComponent(c)+'&cmsid=12768&url=""';a.logInfo("Video Ad call: "+u),e("<param>",{name:"adServerURL",value:u}).appendTo(this.$(".BrightcoveExperience")),this.$videoObj.length&&this.brightcoveId&&(t.bindAll(this,"createPlayer","onBrightCoveLoad","onTemplateReady","onVideoComplete","onVideoStart","isPlayingHandler","determineCompletion"),this.throttledDetermine=t.throttle(this.determineCompletion,1500),i.prototype.initialize.call(this,r),(this.options.autostart||this.$videoObj.attr("data-autoplay"))&&this.createPlayer(),this._buildBrightCoveLoadCallback(),this._buildBrightCoveReadyCallback(),this.pubSub={"pause:videos":this.pauseVideo},n.attach(this.pubSub,this))},_buildBrightCoveLoadCallback:function(){window.BCCallbacks||(window.BCCallbacks={}),window.BCCallbacks[this.brightcoveId]=this.onBrightCoveLoad,window.BCLoad||(window.BCLoad=t.bind(function(e){this._triggerNeon("onTemplateLoad",e),window.BCCallbacks[e]?window.BCCallbacks[e](e):console.log("received brightcove callback for video that does not exist: "+e)},this))},_buildBrightCoveReadyCallback:function(){window.BCReady||(window.BCReady=t.bind(function(e){this._triggerNeon("onTemplateReady",e)},this))},_neonEnabled:function(){return r.getNested(window.site_vars,"flags","neon")&&window.NeonPlayerTracker},_triggerNeon:function(e,i){this._neonEnabled()&&t.isFunction(window.NeonPlayerTracker[e])&&window.NeonPlayerTracker[e](i)},onBrightCoveLoad:function(e){this.$(".temp-loader").fadeOut(),this.player=window.brightcove.api.getExperience(e),this.APIModules=window.brightcove.api.modules.APIModules,this.player?(console.log("brightcove loaded successfully",this.brightcoveId),this.options.onVideoLoaded&&this.options.onVideoLoaded(this.brightcoveId),this.modVP=this.player.getModule(this.APIModules.VIDEO_PLAYER),this.modCon=this.player.getModule(this.APIModules.CONTENT),this.modExp=this.player.getModule(this.APIModules.EXPERIENCE),this.modExp.addEventListener(window.brightcove.api.events.ExperienceEvent.TEMPLATE_READY,this.onTemplateReady)):console.warn("brightcove video loaded, but could not get experience: "+e)},onTemplateReady:function(){this.modVP&&(this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine))},onVideoStart:function(e){var t=this.getVideoDetail();t.videoDuration=e.duration<0?"":e.duration<120?"less than 2 min":"greater than 2 min",t.completion="0%",t.videoName=t.liveVideoSubject?t.liveVideoSubject:e.media.displayName,t.eventtype="video:load",t.contentid=e.target.experience.id,t.videoFulllengthUrl=e.media.FLVFullLengthURL,"undefined"!=typeof t.assetid&&e.media.referenceId!==t.assetid.toString()&&(t.assetid=e.media.referenceId,t.ssts=e.media.customFields.gdp_ssts||t.ssts,t.cst=e.media.customFields.gdp_cst||t.cst,t.videocontentprovider=e.media.customFields.gannetttracking+"|"+e.media.displayName,t.keywords=e.media.customFields.gdp_tags||t.keywords,"undefined"!=typeof e.media.customFields.gdp_canonical_url&&(t.pathName=e.media.customFields.gdp_canonical_url.replace(/^.*\/\/[^\/]+/,"")),t=this.setVideoDetailMeta(t)),n.trigger("video:load",t)},onVideoComplete:function(){console.log("video playback finished: "+this.brightcoveId),e.isFunction(this.options.onVideoComplete)&&this.options.onVideoComplete()},onMediaEventFired:function(e){n.trigger("uotrack",e.type)},determineCompletion:function(e){var t=e.duration,i=e.position,s=Math.round(i/t*100),o=this.$videoObj.data().videourl;!this.fiftypercent&&s>=50&&95>s?(n.trigger("vitrack",{percentage:"50%",video_url:o}),this.fiftypercent=!0):!this.ninetyfivepercent&&s>=95&&99>s&&(n.trigger("vitrack",{percentage:"95%",video_url:o}),this.ninetyfivepercent=!0)},createPlayer:function(){if(window.brightcove){var e=this.$brightcove;e.params={forceHTML:!1},window.brightcove.createExperiencesPostLoad=function(){},window.brightcove.createExperiences(null,this.brightcoveId),s.stopRefreshTimer(),this.$videoObj.show()}else this.loadScripts(this.createPlayer)},destroy:function(){if(s.startRefreshTimer(),this.brightcoveId&&window.brightcove&&(this.player||window.brightcove.api&&(this.player=window.brightcove.api.getExperience(this.brightcoveId)),this.player&&(this.modVP||(this.modVP=this.player.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER)),this.modVP&&this.resetVideoState()),window.brightcove&&(window.brightcove.experiences&&delete window.brightcove.experiences[this.brightcoveId],window.brightcove.instances&&delete window.brightcove.instances[this.brightcoveId])),window.BCCallbacks){if(window.BCCallbacks[this.brightcoveId]&&delete window.BCCallbacks[this.brightcoveId],0===t.size(window.BCCallbacks)){window.BCCallbacks=void 0,window.BCLoad=void 0,window.BCReady=void 0;try{delete window.BCCallbacks,delete window.BCLoad,delete window.BCReady}catch(e){}}}else console.warn("BCCallbacks no longer available on video destroy");i.prototype.destroy.apply(this,arguments)},resetVideoState:function(){this.player&&(this.modVP&&(this.pauseVideo(),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine),this.modVP=!1,this.modCon=!1,this.modExp=!1),this.player=!1),this.$(".videoStill, .videoStillPlay").show(),this.$videoObj.html(this.playerHTML),this.hidePlayer()},hidePlayer:function(){this.$videoObj&&this.$videoObj.hide(),this.options.onVideoHide&&this.options.onVideoHide(),s.startRefreshTimer()},loadScripts:function(e){require(["http://admin.brightcove.com/js/BrightcoveExperiences.js"],function(){"undefined"!=typeof window.brightcove?(console.log("Brightcove loaded"),e()):console.log("Error loading Brightcove")})},swapImageForVideo:function(){this.createPlayer(),this.options.onVideoShow&&this.options.onVideoShow(),this.$(".videoStill, .videoStillPlay").hide(),this.$(".temp-loader").show(),n.trigger("video:playClick")},getVideoDetail:function(){var e=this.$videoObj.data()||{};return e.pathName="",e.liveVideoSubject?e.pathName=e.liveVideoSubject:e.videourl&&(e.pathName=e.videourl.replace(/^.*\/\/[^\/]+/,"")),this.setVideoDetailMeta(e)},setVideoDetailMeta:function(e){try{e.cst||(e.cstlist=e.cst.split("/"),e.category=e.cstlist[0],e.cst=e.cstlist.slice(0,3).join(":"),e.subcategory=e.cstlist.slice(0,2).join(":")),e.sstslist||(e.sstslist=e.ssts.split("/"),e.section=e.sstslist[0],e.ssts=e.sstslist.join(":"),e.subsection=e.sstslist.slice(0,2).join(":"),e.topic=e.sstslist.slice(0,3).join(":"))}catch(t){return void console.error("Invalid page",t.stack||t.stacktrace||t.message)}return e},pauseVideo:function(){void 0!==this.modVP&&this.modVP.pause(!0)},isPlayingHandler:function(e){this.options.live||e&&this.modVP.pause(!0)},loadVideoById:function(e){this.modVP.loadVideoByID(e)}});return l}),define("apps/stag-front",["jquery","underscore","backbone","utils","state","site-manager","pubsub","base-app","sharedAdPosition","partner/slider","partner/overlay-ad-fronts","modules/global/brightcove-video"],function(e,t,i,n,s,o,a,r,l,h,d,c){"use strict";var u=r.extend({el:".cards.stag",afterPageReveal:function(e){this._initializeTopic(e,"stag")},_initializeTopic:function(){var t=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],e(".stag.hero .video").each(function(){var i=new c({el:e(this).parent().get(0)});t.subviews.video.push(i)}),this.subviews.overlayAd=new d({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-legal":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative,getHeaderOffset:function(){var e=o.getHeader();return e?e.getExpandedHeight():0}}),this.subviews.genericad=new l({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new h)}});return u}),define("ui/button-toggle",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({initialize:function(n){n=e.extend({onSelect:null},n),i.prototype.initialize.call(this,n),this.toggleItems=this.$(".ui-button-toggle-item"),this.toggleItems.on("click."+this.cid,t.bind(function(t){this.onClick(e(t.currentTarget))},this))},onClick:function(e){e.hasClass("active")||(this.toggleItems.removeClass("active"),e.addClass("active"),this.options.onSelect&&this.options.onSelect(e))},destroy:function(e){this.toggleItems.off("."+this.cid),i.prototype.destroy.call(this,e)}});return n}),define("modules/cxense-recommends/cxense-base",["jquery","underscore","baseview","utils","pubsub","managers/abtestmanager"],function(e,t,i,n,s,o){var a=i.extend({monthsAbbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],selectors:{itemsWrap:".cx-items-wrap",itemTemplate:".cx-item-template"},events:{"click .js-cx-item-link":"_onClickCxenseItem"},initialize:function(s){s=e.extend({relativeLinks:!0,getRecsOnInit:!0,cxenseWidgetId:null,cxenseUserObj:null,cxenseContextObj:null,cxenseMinRecs:0,cxenseMaxRecs:0,recsTimeout:5e3,appendTrackingParams:!0},s),i.prototype.initialize.call(this,s),t.bindAll(this,"renderRecs","_getRawRecs","getProcessedRecs"),this.cxScript=n.loadScript("http://cdn.cxense.com/cx.js","cX",this.cxScriptLoaded),this.userActiveTest=o.getUserActiveTest(),this.sectionNames=e.extend({tv:"TV",mmajunkie:"MMAjunkie",ftw:"FTW",entertainthis:"Entertain This!",usatodaycollege:"USA TODAY College",roadwarriorvoices:"Road Warrior Voices"},n.getNested(window,"section_display_names")),this.urlRegExp=new RegExp("http(s)?://(www\\.)?("+n.getNested(window.site_vars,"base_url")+")","gi"),this.itemTemplate=t.template(this.$(this.selectors.itemTemplate).html()||'<li class="cx-item"><%= headline %></li>');var a=this.options.cxenseWidgetId&&this.options.cxenseWidgetId.replace(/\s+/,"");s.getRecsOnInit&&a&&this.renderRecs(a)},_getRawRecs:function(i){var o=e.Deferred();return this.cxScript.then(t.bind(function(){var a,r=n.getNested(window.site_vars,"base_url"),l=r?window.location.protocol+"//"+r+window.location.pathname:window.location.href,h=!1,d=this.options.cxenseMinRecs,c=this.options.cxenseMaxRecs,u=Date.now(),p={context:{url:l}};this.options.cxenseUserObj&&(p.user=this.options.cxenseUserObj),this.options.cxenseContextObj&&e.extend(p.context,this.options.cxenseContextObj),a=setTimeout(function(){h=!0,s.trigger("cxresptrack","timeout|"+i+"|"+(Date.now()-u)),o.reject()
},this.options.recsTimeout),cX.insertWidget({widgetId:i,renderFunction:function(e){if(clearTimeout(a),200===e.httpStatus){if(!h){var r=n.getNested(e,"response","items")||[];r.length>0?(r=t.filter(r,function(e){return e["recs-publishtime"]!==e.createtime},this),c>0&&(r=r.slice(0,c)),r.length<d?(s.trigger("cxresptrack","results|"+i+"|"+r.length),o.reject()):o.resolveWith(this,[r])):(s.trigger("cxresptrack","results|"+i+"|0"),o.reject())}}else s.trigger("cxresptrack","fail|"+i+"|"+e.httpStatus),o.reject()}},p)},this),function(){o.reject()}),o.promise()},getProcessedRecs:function(e){return this._getRawRecs(e).then(t.bind(function(e){return this.processRecs(e)},this))},processRecs:function(i){i=i||[];var n=t.map(i,function(e,t){return this.formatItemForTemplate(e,t+1)},this);return e.Deferred().resolveWith(this,[n]).promise()},renderRecs:function(i){return i?this.getProcessedRecs(i).then(t.bind(function(e){if(e){var i="";t.each(e,function(e){i+=this.itemTemplate(e)},this),this.$(this.selectors.itemsWrap).append(i),this.afterRenderRecs(e)}},this)):e.Deferred().reject()},afterRenderRecs:function(){this.$el.addClass("js-cx-recs-rendered")},renderTestLink:function(t,i,s,o){s=s?s:n.getNested(o,"trackingPrefix")||n.getNested(this.userActiveTest,"trackingPrefix")||e(t).attr("data-track-label")||e(t).attr("data-ht")||"";var a=o?n.getNested(o,"url"):e(t).attr("href"),r=n.getNested(o,"tag"),l=n.getNested(o,"recType");return a=this._formatTestUrl(a,i+1,s,r,l),e(t).addClass("js-cx-item-link").attr("data-cx-pixel-url",n.getNested(o,"pixelUrl")),e(t).attr("href",a)},getDisplaySection:function(e){if(e){var t=e.split("/");return e=t.length>1?t[1]:t[0],e in this.sectionNames&&(e=this.sectionNames[e]),e.replace(/\-/g," ")}return""},_getPublishedTime:function(e){return e?this._formatTimestamp(new Date(e)):""},formatItemForTemplate:function(t,i){var s=t["recs-contenttype"]||null,o=this.options.relativeLinks===!0?t.url.replace(this.urlRegExp,""):t.url,a=n.getNested(this.userActiveTest,"trackingPrefix")||null,r=t.tag||"default",l=n.getNested(t,"_type")||null;this.options.appendTrackingParams&&this.userActiveTest&&(o=this._formatTestUrl(o,i,a,r,l));var h={recType:l,headline:t.title,url:o,pixelUrl:this._formatPixelUrl(t.click_url,r),imgSrc:n.getNested(t,"dominantthumbnail")||null,thumbSrc:n.getNested(t,"recs-image")||null,imgAlt:t.title,section:(t["recs-category"]?t["recs-category"].split("/")[0]:"home").toLowerCase(),sectionDisplay:t["recs-category"]?this.getDisplaySection(t["recs-category"]):"",time:t["recs-publishtime"]?this._formatTimestamp(t["recs-publishtime"]):"",timestamp:t["recs-publishtime"],type:s,isMedia:"galleries"==s||"video"==s,tag:r,position:i,trackingPrefix:a};return e.extend(h,this.additionalFormatItemForTemplate(t,h))},additionalFormatItemForTemplate:function(){return{}},_formatTestUrl:function(e,i,s,a,r){var l=n.getNested(this.userActiveTest,"activeVariant");if(e+="#cx_ab_test_id="+this.userActiveTest.id,e+="&cx_ab_test_variant="+l.id,e+="&cx_art_pos="+i,e+="&cx_navSource="+s,t.each(l.customParams,function(t){e+="&"+t.key+"="+t.value}),!l.control){e+="&cx_tag="+a,e+="&cx_rec_type="+r;var h=o.isUserInActiveCtrlCompareGrp(this.userActiveTest);void 0!==h&&(e+="&cx_ctrl_comp_grp="+h),e+="&cxrecs_s"}return e},_formatPixelUrl:function(e,t){return e.replace(/click/,"click/image")+"?cx_tag="+t},_formatTimestamp:function(e){var t,i=(new Date).getDate(),n=new Date(e),s=Math.floor((new Date-n)/1e3),o=Math.floor(s/60),a="";if(o>10){var r=n.getHours(),l=n.getMinutes(),h=r>=12?"p.m.":"a.m.",d=n.getDate(),c=n.getMonth();return r%=12,r=r?r:12,l=10>l?"0"+l:l,d!=i&&(a=this.monthsAbbreviated[c]+" "+d+", "),a+=r+":"+l+" "+h}return o>1&&10>=o?o+" min ago":(t=Math.floor(s),t>0?t+" sec ago":"")},_onClickCxenseItem:function(t){this.cxScript.done(function(){cX.sendSpaRecsClick(e(t.currentTarget).attr("data-cx-pixel-url"))})},logTestImpression:function(i){this.cxScript.done(t.bind(function(){i=e.extend({test_id:""+this.userActiveTest.id,test_variant:n.getNested(this.userActiveTest,"activeVariant","id")},i),cX.sendEvent("gci-impression",i)},this))},cxScriptLoaded:function(){var e=n.getNested(window.site_vars,"THIRDPARTYAPI","CXENSE");cX.setSiteId(e.site_id),cX.setEventAttributes({origin:e.origin,persistedQueryId:e.persisted_query_id})}});return a}),define("modules/cxense-recommends/cxense-headline-grid",["jquery","underscore","state","utils","modules/cxense-recommends/cxense-base"],function(e,t,i,n,s){var o=s.extend({initialize:function(t){t=e.extend({cxenseContextObj:{neighbors:this.getNeighbors()}},t),s.prototype.initialize.call(this,t),this.mmGridImgBase="http://www.gannett-cdn.com/-mm-/3082afecf818b4f454af81a4d259036225fa8c0c/c=864-0-4320-3456&r=x233&c=210x230/local/-/",this.mmListImgBase="http://www.gannett-cdn.com/-mm-/3fcdc686a1f05df1f66a590aff64da282580e7f1/c=0-432-4608-3024&r=x83&c=140x80/local/-/",this.mmRx=new RegExp(".*local\\/-\\/")},renderRecs:function(){return this.getProcessedRecs(this.options.cxenseWidgetId).then(t.bind(function(e){if(e){var i="",n=this.$(".headline-page.active");t.each(e,function(e){i+=this.itemTemplate(e)},this),n.children("li").slice(0,e.length).remove(),n.prepend(i)}},this))},additionalFormatItemForTemplate:function(t,i){var s="first";return i.position%2===0&&(s="middle"),i.position%3===0&&(s="last"),e.extend({columnPos:s,description:n.smartTruncate(t.description,250)||null},this.getImages(t))},getImages:function(e){var t=null,i=!1,s=null,o=!1,a=n.getNested(e,"dominantimage")||"",r=n.getNested(e,"dominantthumbnail")||null;return-1!==a.indexOf("-mm-")?(a=a.replace(this.mmRx,""),t=this.mmGridImgBase+a,s=this.mmListImgBase+a,i=o=!0):r&&(t=s=r),{gridImgSrc:t,gridImgUsesMin:i,listImgSrc:s,listImgUsesMin:o}},getNeighbors:function(){var e=[],n=this.$(".headline-page.active").children("li");return t.each(i.getActivePageInfo().asset_collection,t.bind(function(t){("headline-grid"===t.module&&t.position>=this.options.cxenseMaxRecs&&t.position<n.length||"hero"===t.module)&&e.push(t.assetId)},this)),e}});return o}),define("modules/fronts/headline-grid",["jquery","underscore","backbone","state","pubsub","utils","baseview","ui/button-toggle","modules/cxense-recommends/cxense-headline-grid"],function(e,t,i,n,s,o,a,r,l){"use strict";var h=a.extend({events:{"click .button-add-content":"showMore"},initialize:function(e){this.$button=this.$(".button-add-content"),a.prototype.initialize.call(this,e),t.bindAll(this,"transitionMore","toggleGridListView");var i=this.$(".headline-toggler");i.length&&(this.subviews.gridListViewToggler=new r({el:i,onSelect:this.toggleGridListView})),e.cxenseWidgetId&&(this.subviews.cxense=new l({el:this.$el,cxenseMaxRecs:e.cxenseMaxRecs,cxenseWidgetId:e.cxenseWidgetId,getRecsOnInit:!1})),this.$(".headline-page.active").hasClass("placeholder")&&this.render()},render:function(){var i=e.Deferred();this.subviews.cxense?this.subviews.cxense.renderRecs().done(function(){i.resolve()},function(){i.reject()}):i.resolve(),i.always(t.bind(function(){this.load()},this))},getMoreHeadlines:function(e,i){n.fetchHtml(window.location.pathname+e+"/").done(t.bind(function(e){var t=e.find(".headline-page").removeClass("active").addClass("inactive"),n=e.find(".button-add-content");this.$(".headline-collection").append(t),n.length>0?this.$(".headlines-show-more").empty().append(n):this.$button.addClass("inactive"),i(t)},this)).fail(t.bind(function(){var e=this.$button.attr("data-default");this.$button.removeClass("loading").addClass("inactive").text(e)},this))},showMore:function(t){if(e(t.target).hasClass("inactive"))return!1;if(this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading")),this.$el.hasClass("stagfront-primary")&&!this.$(".front-headlines-header").hasClass("staff")){var i=parseInt(e(t.target).data("next"),10);this.getMoreHeadlines(i,this.transitionMore)}else{var n=this.$(".headline-page.active:last").next(),a=n.attr("data-itemnum"),r=n.attr("data-items-per-page"),l=Math.round(a/r);this.load(),s.trigger("uotrack",o.getSectionPath(window.location.pathname)+"morestories"+l),this.transitionMore(n)}t.preventDefault()},toggleGridListView:function(e){var t=e.hasClass("grid-big")?"grid-big":"list-big",i=this.$(".headline-collection");"list-big"===t?(i.addClass("listview"),s.trigger("uotrack","listview")):(i.removeClass("listview"),s.trigger("uotrack","gridview")),this.load()},load:function(){var e=this.$(".headline-page.active"),t=this.$(".headline-collection").hasClass("listview");o.lazyLoadImage(e.find("img"),"data-"+(t?"list":"grid")+"-src",!1),e.removeClass("placeholder")},transitionMore:function(t){Modernizr.csstransitions?t.removeClass("inactive").addClass("active"):t.animate({"max-height":"5000px"},200,function(){e(this).removeClass("inactive").addClass("active").css("max-height","")}),this.$(".headline-page.inactive").length<=0&&this.$button.addClass("inactive"),this.load(),this.$button.removeClass("loading").text(this.$button.attr("data-default")),s.trigger("showmore:headlines")}});return h}),define("partner/pushdown-ad-article",["jquery","partner/pushdown-ad"],function(e,t){"use strict";var i=t.extend({initialize:function(i){i=e.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}},ratio:{},cardInfo:{}},i),t.prototype.initialize.call(this,i),this._createAd(["pushdown"],["pushdown"],i.cardInfo)}});return i}),define("modules/partner/poster-ad-asset2",["jquery","underscore","baseview","state","site-manager","utils","admanager","directAdPosition"],function(e,t,i,n,s,o,a,r){"use strict";var l=i.extend({initialize:function(a){t.bindAll(this,"_overlayScrollListener","_handleResizeWindow","onSecondAdReady","_isInViewport"),a=e.extend({minTimeForAd:5e3,topMargin:30,disableRefresh:o.getNested(window.site_vars,"ADS","poster_scroll_refresh_disabled"),articleSelector:"article > div[role=main]",rightRailSelector:".story-right-rail"},a);var r=n.getActiveApp();this.$win=o.get("win"),this.$body=o.get("body"),this.header=s.getHeader(),this.overlayScrollListenerThrottle=t.throttle(this._overlayScrollListener,16,{leading:!1,trailing:!0}),this.$win.on("scroll."+this.cid,this.overlayScrollListenerThrottle).on("resize."+this.cid,this._handleResizeWindow),this.partnerScrollHeight=0,this.belowModuleInView=!1,this.pubSub={"breakingbar:after:open":this._overlayScrollListener,"breakingbar:after:close":this._overlayScrollListener,"gravity:open":this._handleResizeWindow},this.$adEl=this.$(".poster-scroll-ad"),this.$adScroll=this.$(".poster-scroll"),this.$otherAds=r.$(".partner-asset-right-ad,.datasphere-community-module"),this.$rightRail=this.$el.closest(a.rightRailSelector),this.$body.on("bx_impression."+this.cid,this._setHeight()),i.prototype.initialize.call(this,a),this._handleResizeWindow()},_overlayScrollListener:function(){return this.moduleOffsetTop=this.$el.offset().top,this._getModuleHeight()<(this.partnerScrollHeight||250)?void this.hide():(this._checkIfBottomInView(),this._goToState(this._getCurrentState()),void this._handleRequestAds())},_getCurrentState:function(){return this._isOtherAdinViewPort()||!this._isInViewport(this.$adScroll,this._getModuleHeight)?"hidden":this._shouldDockBottom()?"dockBottom":this._shouldFixAd()?"fixed":"dockTop"},_goToState:function(e){e!==this.state&&("hidden"!==this.state&&this.state||this.$adScroll.css("opacity","1"),"hidden"===e?this.$adScroll.css("opacity","0"):"fixed"===e?this.$adScroll.css({position:"fixed",top:this._getHeaderHeight()+this.options.topMargin}):"dockTop"===e?this.$adScroll.css({position:"static",top:"auto"}):"dockBottom"===e&&this._dockBottom(),this.state=e)},_checkIfBottomInView:function(){var e=this.$body.scrollTop()+this.winHeight;e>=this._getModuleOffsetBottom()&&this.belowModuleInView===!1?(this._setHeight(),this._setArticleDimensions(),this.belowModuleInView=!0):e<this._getModuleOffsetBottom()&&this.belowModuleInView===!0&&(this.belowModuleInView=!1)},_shouldFixAd:function(){return this.moduleOffsetTop-this.options.topMargin<=this._getViewportOffset()},_getViewportOffset:function(){return o.getScrollPosition()+this._getHeaderHeight()},_shouldDockBottom:function(){var e=this._getModuleOffsetBottom()-this.partnerScrollHeight-this.options.topMargin;return e<this._getViewportOffset()},_getHeaderHeight:function(){return this.header?this.header.getFixedHeight():0},_isOtherAdinViewPort:function(){return void 0!==t.find(this.$otherAds,function(e){return this._isInViewport(e)},this)},_isInViewport:function(t,i){var n=e(t),s=n.offset().top,o=s+(i||n.outerHeight()),a=this._getViewportOffset(),r=a+this.winHeight-this._getHeaderHeight();return!(n.is(":hidden")||a>o||s>r)},_isTimeToRefresh:function(){if(this.lastAdRefreshedTime){var e=(new Date).getTime();return e-this.lastAdRefreshedTime>=this.options.minTimeForAd}return!0},_getModuleHeight:function(){return this.articleOffsetTop+this.articleHeight-this.moduleOffsetTop},_getModuleOffsetBottom:function(){return this.moduleOffsetTop+this._getModuleHeight()},_hasScrolledAViewportHeight:function(){var e=o.getScrollPosition(),t=Math.abs(e-this.scrollTopAdRequestedAt);return t>=this.winHeight},_handleResizeWindow:function(){this.winHeight=this.$win.height(),this._setArticleDimensions()},_handleRequestAds:function(){"dockTop"!==this.state||this.subviews.ad?("fixed"===this.state&&!this.subviews.ad||"fixed"===this.state&&!this.options.disableRefresh&&this._hasScrolledAViewportHeight()&&this._isTimeToRefresh())&&this._requestAd():this._requestAd()},_dockBottom:function(){this.$adScroll.css({position:"absolute",top:this.articleHeight-this.partnerScrollHeight+this.railPositionTop})},_setArticleDimensions:function(){var e=n.getActiveApp().$(this.options.articleSelector);e.length&&(this.articleHeight=e.height(),this.articleOffsetTop=e.offset().top,this.railPositionTop=this.$rightRail.position().top)},_requestAd:function(){a.getActiveSlotStatistics().done(t.bind(function(e){var i=this.subviews.ad;if(i){if(!i.isAdReady())return;i.refreshPosition()}else{var s=["mediumrectangle"],a=600+this.options.topMargin,l=t.findWhere(e.high_impact_info,{adType:"gravity"});this._getModuleHeight()>=a&&this.winHeight-this._getHeaderHeight()>=a&&(s=s.concat(["halfpage","portrait","filmstrip"])),this.subviews.ad=new r({el:this.$adEl,adSizes:s,adPlacement:"poster_scroll",adType:"poster",onAdReady:this.onSecondAdReady,pageInfo:n.getActivePageInfo(),targeting:l?{creativeid:l.ecid}:{}})}this.scrollTopAdRequestedAt=o.getScrollPosition()},this))},_setHeight:function(){this.partnerScrollHeight=this.$adScroll.outerHeight()},onSecondAdReady:function(){this.subviews.ad.show(),this._setHeight(),this.lastAdRefreshedTime=(new Date).getTime(),this._overlayScrollListener(),"dockBottom"===this.state&&this._dockBottom()},destroy:function(e){this.$body.off("."+this.cid),this.$win.off("."+this.cid),i.prototype.destroy.call(this,e)}});return l}),define("apps/topics",["jquery","underscore","state","site-manager","base-app","sharedAdPosition","directAdPosition","partner/slider","partner/overlay-ad-fronts","modules/global/brightcove-video","partner/gravity-ad-article","partner/pushdown-ad-article","modules/partner/poster-ad-asset2"],function(e,t,i,n,s,o,a,r,l,h,d,c,u){"use strict";var p=s.extend({initialize:function(e){this.pubSub={"topicgallery:open":this.gravityPause,"topicgallery:close":this.gravityResume,"topicarticles:fetched":this._handleFetchedArticles},s.prototype.initialize.call(this,e)},afterPageReveal:function(){this.$el.hasClass("topics-page-automated")?this._initNewTopicPage():this._initLegacyTopicPage(),i.stopRefreshTimer()},_initNewTopicPage:function(){this.$pageWrap=this.$(".tpa-page-wrap"),this.setupAds()},_initLegacyTopicPage:function(){var t=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],e(".stag.hero .video").each(function(){var i=new h({el:e(this).parent().get(0)});t.subviews.video.push(i)}),this.subviews.overlayAd=new l({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-legal":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative,getHeaderOffset:function(){var e=n.getHeader();return e?e.getExpandedHeight():0}}),this.subviews.genericad=new o({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new r)},activateLoader:function(){window.scrollTo(0,0),this.$el.html('<section class="tpa-page-loader"></section>')},deactivateLoader:function(){window.scrollTo(0,0),this.$el.html("")},setupAds:function(){this.subviews.pushdownAd=new c({defaultPosition:!0,el:this.$(".partner-pushdown-ad"),cards:this.$pageWrap,cardInfo:{adClass:"size-m",adTargeting:"medium",cardWidth:1080}}),this.subviews.gravityAd=new d({el:this.$(".partner-gravity-ad"),contentSection:this.$pageWrap}),this.subviews.ad=new a({el:this.$(".tpa-ad-sidebar-wrapper"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"sidebar"}),this.subviews.posterAd=new u({el:this.$(".tpa-scroller-ad-sidebar-wrapper"),articleSelector:".tpa-content-wrap",rightRailSelector:".tpa-sidebar-wrap",disableRefresh:!1,minTimeForAd:15e3})},gravityPause:function(){this.subviews.gravityAd&&this.subviews.gravityAd.showingAd&&(this.subviews.gravityAd.subviews.adPosition.pauseAd(),this.subviews.gravityAd.$el.css("display","none"))},gravityResume:function(){this.subviews.gravityAd&&this.subviews.gravityAd.showingAd&&(this.subviews.gravityAd.$el.css("display","block"),this.subviews.gravityAd.subviews.adPosition.resumeAd())},_handleFetchedArticles:function(){this.subviews.posterAd&&this.subviews.posterAd._setArticleDimensions()}});return p}),define("apps/cards/elections-card",["jquery","underscore","utils","apps/cards/cards"],function(e,t,i,n){"use strict";var s=n.extend({beforePageReveal:function(e,t,s){var o=s.find(".card-container"),a=s.find(".card-wrap"),r=s.find("#section_elections"),l=i.getSectionPath(t);return"elections"===l&&(this.electionsConfig=i.getNested(window.site_vars,"ELECTIONS"),this.electionsConfig&&(this.defaultCity=this.electionsConfig.CITY),s.addClass("elections-card"),o.addClass("elections-card-bg-overwrite"),a.addClass("elections-card-wrap-overwrite"),r.before('<div class="elections-logo">'+this.defaultCity+" Special Report</div>")),n.prototype.beforePageReveal.apply(this,arguments)}});return s}),define("apps/member-guide",["jquery","underscore","state","base-app","site-manager","pubsub"],function(e,t,i,n,s,o){var a=n.extend({afterPageReveal:function(){e("body").addClass("mga-body"),o.on("user:login",this.killLoginBanner,this)},killLoginBanner:function(){e(".mga-login-wrap").remove(),e(".js-mga-subscribe-hide").remove()},beforeAppRemove:function(){e("body").removeClass("mga-body"),o.off("user:login",this.killLoginBanner,this)}});return a}),define("modules/stories/expand-faq",["jquery","baseview"],function(e,t){var i=t.extend({events:{"click a":"expandFaq"},expandFaq:function(t){var i=e(t.target),n=i.next();n.is(":visible")?(i.parent().removeClass("active"),n.slideUp(200)):(i.parent().addClass("active"),n.slideDown(200))}});return i}),define("modules/real-men/real-men",["jquery","underscore","baseview"],function(e,t,i){var n=i.extend({events:{"click input.realmen-sendecard":"onSendECardClick"},initialize:function(e){i.prototype.initialize.call(this,e),this.$form=this.$(".realmen-reminder-bottom")},onSendECardClick:function(){this.showForm()},showForm:function(){this.$form.css({height:"0px"}),this.$form.removeClass("hidden");var t=this;e.when(this.$form.animate({height:"285px"},300)).done(function(){t.$form.css("overflow","visible")})}});return n}),define("modules/carousel/carousel-fullscreen",["jquery","exports","underscore","backbone","baseview","utils","state","site-manager","modules/carousel/carousel-autosize"],function(e,t,i,n,s,o,a,r,l){var h=l.extend({initialize:function(t){i.bindAll(this,"handleKeyPress","close"),t=e.extend({scrollerColor:"dark"},t),this.$body=o.get("body"),this.$doc=o.get("document"),this.carousel=t.carousel,this.parent=t.parent,a.registerFullScreenView(this),r.getHeader().setClosedFixed(!0),r.scrollTop(0),this.$doc.on("keydown."+this.cid,this.handleKeyPress),this.$body.on("click."+this.cid,".close",this.close),this.launch(),l.prototype.initialize.call(this,t)},close:function(t){t&&t.preventDefault(),r.getHeader().restoreLastState(),this.animate(this.$el.parent(),"opacity",0,300,"ease-in-out").done(i.bind(function(){this.destroy(!0),a.clearFullScreenView().done(i.bind(function(){if(this.carousel){var t=e(".thumbs li",this.parent);t.eq(this.index).click()}},this))},this))},destroy:function(e){this.$doc.off("."+this.cid),this.$body.off("."+this.cid),e&&this.$el.parent().remove(),l.prototype.destroy.call(this,!1)},launch:function(){var t=e('<article class="gallery fullscreen" style="opacity: 0"><a class="close" href="#"></a><div class="ui-film fullscreen"></div></article>'),i=this.parent.clone();i.find(".viewport").removeClass("hover");var n=i.find(".partner-placement");if(n.length){var s=n.attr("id")+"_fs";n.attr("id",s).attr("data-slot-id",s)}t.append(i),this.$body.append(t),this.animate(t,"opacity",1,300,"ease-in-out"),this.setElement(i)},handleKeyPress:function(e){return 37===e.keyCode?(this.prevSlide(),!1):39===e.keyCode?(this.nextSlide(),!1):27===e.keyCode?(this.close(),!1):void 0}});return h}),define("modules/global/livevideo",["jquery","underscore","backbone","pubsub","state","utils","modules/global/brightcove-video"],function(e,t,i,n,s,o,a){var r=i.View.extend({events:{"click #close_modal_link":"close"},initialize:function(t){this.m_uiModal={},this.m_uiModalBgrnd={},this.win=o.get("win")[0],this.body=o.get("body"),this.service=t&&t.service?t.service:"/services/livevideos/",this.win.gannett={};var i=this;this.win.gannett.videoplayer_modal={openPopup:function(){var t="/livevideos/popout/",n=e("#videoplayer_modal .video-title").text(),s=e("#videoplayer_modal .sponsor-text").text(),a=e("#videoplayer_modal .video-logo").attr("src"),r=e("#videoplayer_modal").attr("data-assetid");t+="?videoid="+r+"&description="+n+"&sponsor="+s+"&sourcelogo="+a,r&&(o.openPopup(t,640,440),i.close())}}},loadLiveVideo:function(t){var i=this;s.registerFullScreenView(this),s.fetchHtml(this.service+t+"/").done(function(t){i.body.append(t),i.video=new a({el:e("#videoplayer_modal"),autostart:!0,live:!0}),i.m_uiModal=e("#videoplayer_modal"),i.m_uiModalBgrnd=e("#lightbox"),i.m_uiModal.show(),i.m_uiModalBgrnd.fadeIn(300),i.setElement("#videoplayer_modal")})},close:function(){if(this.m_uiModal){s.clearFullScreenView();var e=this.m_uiModalBgrnd;this.destroy(!0),this.m_uiModalBgrnd.fadeOut(300,function(){e.remove()}),this.m_uiModal.remove(),this.m_uiModalBgrnd.remove(),this.m_uiModal=null,this.m_uiModalBgrnd=null,this.win.gannett={}}},destroy:function(e){this.video&&this.video.destroy(!0),this.undelegateEvents(),e&&this.remove()}});return r}),define("animatecolors",["jquery"],function(e){function t(e,t,i){var n="rgb"+(Modernizr.rgba?"a":"")+"("+parseInt(e[0]+i*(t[0]-e[0]),10)+","+parseInt(e[1]+i*(t[1]-e[1]),10)+","+parseInt(e[2]+i*(t[2]-e[2]),10);return Modernizr.rgba&&(n+=","+(e&&t?parseFloat(e[3]+i*(t[3]-e[3])):1)),n+=")"}function i(e){var t,i;return(t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(e))?i=[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),1]:(t=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(e))?i=[17*parseInt(t[1],16),17*parseInt(t[2],16),17*parseInt(t[3],16),1]:(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))?i=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),1]:(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(e))&&(i=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4])]),i}var n=["color","backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","outlineColor"];e.each(n,function(n,s){e.Tween.propHooks[s]={get:function(t){return e(t.elem).css(s)},set:function(n){var o=n.elem.style,a=i(e(n.elem).css(s)),r=i(n.end);n.run=function(e){o[s]=t(a,r,e)}}}}),e.Tween.propHooks.borderColor={set:function(s){var o=s.elem.style,a=[],r=n.slice(2,6);e.each(r,function(t,n){a[n]=i(e(s.elem).css(n))});var l=i(s.end);s.run=function(i){e.each(r,function(e,n){o[n]=t(a[n],l,i)})}}}}),define("modules/global/breaking-news",["jquery","underscore","baseview","pubsub","utils","state","modules/global/barrier","modules/global/livevideo","easing","animatecolors"],function(e,t,i,n,s,o,a,r){"use strict";var l=i.extend({events:{"click .bnm-breaking-link":"onClickBreakingLink","click .bnm-close-btn":"onClickCloseBreakingBtn"},breakingColors:{breaking:{normal:"rgb(247,0,0)",highlight:"rgb(191,49,49)"},live:{normal:"rgb(0,170,255)",highlight:"rgb(0,145,218)"},developing:{normal:"rgb(0,170,255)",highlight:"rgb(0,145,218)"}},breakingBarHeight:0,initialize:function(n){n=e.extend({slideSpeed:200,onBreakingNewsChange:null},n),t.bindAll(this,"updateBreakingBar","checkBreakingNewsBarrier"),this.lastUpdate=localStorage.getItem("breakingLastUpdateClosed"),this.initBreakingBar=setTimeout(this.updateBreakingBar,1e3),this.breakingBarPoll=setInterval(this.updateBreakingBar,91e3),this.barrier=new a,i.prototype.initialize.call(this,n)},destroy:function(){clearTimeout(this.initBreakingBar),clearInterval(this.breakingBarPoll),i.prototype.destroy.apply(this,arguments)},getHeight:function(){return this.breakingBarHeight},onClickCloseBreakingBtn:function(){this.closeBreakingBar(!0),n.trigger("uotrack","breakingnewsbarexit")},onClickBreakingLink:function(t){var i=e(t.currentTarget).attr("href");if(i.indexOf("livevideoassetid")>0){"undefined"!=typeof this.currentlivevideo&&this.currentlivevideo.close();var n=new r;n.loadLiveVideo(i.split("#")[1].split("=")[1]),this.currentlivevideo=n,t.preventDefault()}},closeBreakingBar:function(e){return this.breakingBarHeight?(e&&localStorage.setItem("breakingLastUpdateClosed",this.lastUpdate),this.breakingBarHeight=0,this.options.onBreakingNewsChange&&this.options.onBreakingNewsChange(!1),this.animate(this.$el,"height",0,this.options.slideSpeed).done(t.bind(function(){this.$el.css("background-color",""),this.$el.hide(),n.trigger("breakingbar:after:close")},this))):!1},openBreakingBar:function(){this.$el.show();var e=this.$(".bnm-bar").outerHeight();e!=this.breakingBarHeight&&(this.breakingBarHeight=e,this.options.onBreakingNewsChange&&this.options.onBreakingNewsChange(!0),this.animate(this.$el,"height",this.breakingBarHeight,this.options.slideSpeed).done(this.onCompleteOpenBreakingBar))},onCompleteOpenBreakingBar:function(){n.trigger("breakingbar:after:open")},updateBreakingBar:function(){this.busyCheckingBreakingNews||(this.busyCheckingBreakingNews=!0,o.fetchHtml("/services/breaking-news/nav-bar/").done(this.checkBreakingNewsBarrier))},addToBarrier:function(e,t,i){this.barrier.add(e,t,i)},checkBreakingNewsBarrier:function(e){var i=e.find(".bnm-bar");return i.length?void this.barrier.wait().done(t.bind(function(){this.parseBreakingNews(i)},this)):void(this.busyCheckingBreakingNews=!1)},parseBreakingNews:function(e){try{var t=e.data("type"),i=e.data("lastUpdate");if(this.lastUpdate!=i){this.$el.html(e).stop(),this.lastUpdate=i;var n=this.breakingBarHeight>0;if(this.openBreakingBar(),n){var s=this.breakingColors[t].highlight,o=this.breakingColors[t].normal;this.$(".bnm-bar").animate({backgroundColor:s}).animate({backgroundColor:o})}}}catch(a){this.closeBreakingBar()}finally{this.busyCheckingBreakingNews=!1}}});return l}),define("modules/header/site-nav-dropdown",["jquery","underscore","baseview","easing"],function(e,t,i){"use strict";var n=i.extend({events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .site-nav-dropdown":"closeDropdown"},initialize:function(e){t.bindAll(this,"openDropdown","closeDropdown"),this.fadeSpeed=80,this.showDelay=120,this.$dropdown=this.$(".site-nav-dropdown"),i.prototype.initialize.call(this,e)},onMouseEnter:function(e){clearTimeout(this.hideTimer),this.isMouseOnDropdown=!0,this.openDropdown(e)},onMouseLeave:function(e){this.isMouseOnDropdown=!1,this.hideTimer=setTimeout(t.partial(this.closeDropdown,e),this.hideDelay)},closeDropdown:function(e){!this.isDropdownOpen||"mouseout"==e.type&&this.isMouseOnDropdown||(this.isDropdownOpen=!1,this.animate(this.$dropdown,"opacity",0,this.fadeSpeed).done(t.bind(function(){this.$dropdown.css("display","none")},this)),this.$el.removeClass("site-nav-active-item"))},openDropdown:function(e){this.isDropdownOpen||"mouseover"==e.type&&!this.isMouseOnDropdown||(this.isDropdownOpen=!0,this.$el.addClass("site-nav-active-item"),this.$dropdown.css("display","block"),this.animate(this.$dropdown,"opacity",1,this.fadeSpeed))}});return n}),define("modules/header/site-nav-more-module",["underscore","modules/header/site-nav-dropdown"],function(e,t){"use strict";var i=t.extend({initialize:function(e){this.$navDropdown=this.$(".site-nav-dropdown"),this.$navDropdownList=this.$(".site-nav-more-dropdown-list"),this.$navDropdownItems=this.$(".site-nav-more-dropdown-item"),t.prototype.initialize.call(this,e)},convertColumnLayout:function(e){var t="1col"==e?"2col":"1col";this.$navDropdown.removeClass("site-nav-more-dropdown-"+t).addClass("site-nav-more-dropdown-"+e),this.$navDropdownList.removeClass("site-nav-more-dropdown-list-"+t).addClass("site-nav-more-dropdown-list-"+e),this.$navDropdownItems.removeClass("site-nav-more-dropdown-item-"+t).addClass("site-nav-more-dropdown-item-"+e)}});return i}),define("modules/global/header",["jquery","underscore","base-app","pubsub","utils","state","user-manager","managers/routemanager","modules/global/breaking-news","directAdPosition","modules/header/site-nav-more-module","modules/global/userUtil","easing","animatecolors"],function(e,t,i,n,s,o,a,r,l,h,d,c){"use strict";var u=i.extend({el:".site-header",events:{"click .site-nav-search-link":"onClickNavSearchIcon","click .site-masthead-search-close-btn":"onClickSearchCloseBtn","click .site-masthead-search-btn-div":"onClickSearchBtnDiv"},navHeaderHeight:40,mastheadHeight:80,fixedHeaderThreshold:80,hoverDropdownDelay:120,TWO_COL_THRESHOLD:5,SITE_NAV_HIDDEN_CLASS:"site-nav-item-hidden",SITE_NAV_MORE_VISIBLE_CLASS:"site-nav-more-dropdown-item-visible",initialize:function(){this.isMulti=!!this.$el.attr("data-multi-header"),this.isThirdParty=!!this.$el.attr("data-third-party"),this.$win=s.get("win"),this.$top=s.get("scrollEl"),this.$siteHeaderInnerWrap=this.$(".site-header-inner-wrap"),this.$siteMasthead=this.$(".site-masthead"),this.$searchWrap=this.$(".site-masthead-search-wrap"),this.$navLogo=this.$(".site-nav-logo-item"),this.$navLogoLink=this.$(".site-nav-logo-link"),this.$navMoreItem=this.$(".site-nav-more-item"),this.$navLogoImg=this.$navLogo.find(".site-nav-logo-img"),this.$searchCancelBtn=this.$(".site-masthead-search-close-btn"),this.navLogoImgWidth=this.$navLogoImg.outerWidth(!0),this.$specialOffersMastheadAd=this.$(".site-masthead-special-offers-ad"),this.$subscribeWrap=this.$(".site-masthead-subscribe-wrap"),this.$siteMoreDropdownItems=this.$(".site-nav-more-dropdown-item:not(.site-nav-more-dropdown-item-hidden)"),this.$searchInput=this.$$(".site-masthead-search-form-input"),this.navHeight=this.$siteHeaderInnerWrap.outerHeight(),this.minHeight=this.$el.outerHeight(),t.bindAll(this,"onBreakingNewsChange","onFixingScroll","onClosingScroll","_handleOnAdReady","_onResizeWindow"),this.slideSpeed=200,s.set("headerHeight",this.navHeight),this.slideEasing="ease-out";var e=this.$el.data("open"),n=this.$el.data("fixed"),o=this.$el.data("default-open")||!1,a=this.$el.data("default-fixed")||!1;void 0===e&&(e=o),void 0===n&&(n=a),this.state={open:e,defaultOpen:o,fixed:n,defaultFixed:a,hasFixingScroller:!1,hasClosingScroller:!1},this.pubSub={"user:statuschange":this._loginStatus,"page:load":this._onPageLoad,"header:open":this.navAutoFitItems,"header:closed":this.navAutoFitItems},i.prototype.initialize.apply(this,arguments),this.start(),n||(this._setState({hasFixingScroller:!0}),s.getScrollPosition()&&this.onFixingScroll())},start:function(){this.loadHeaderModules(),s.getNested(window.site_vars,"userAuthentication","personal_link","enabled")&&(this.subviews.userUtil=new c),this.subviews.breakingbar=new l({el:this.$(".bnm-container"),slideSpeed:this.slideSpeed,onBreakingNewsChange:this.onBreakingNewsChange}),this.moreLayout="1col",this.isThirdParty||(this.subviews.moreModule=new d({el:this.$navMoreItem[0]}));
var e=t.throttle(this._onResizeWindow,500);this.$win.on("resize."+this.cid,e),this.navAutoFitStart()},navAutoFitStart:function(){this.$siteNavDynamicPrimaryItems=this.$(".site-nav-primary-item:not(.site-nav-more-item,.site-nav-logo-item,.site-nav-always-visible-item,.site-nav-spacer-item)"),this.$siteNavAlwaysVisibleItems=this.$(".site-nav-always-visible-item,.site-nav-secondary-item"),this.siteNavDynamicItemsWidths=this.getNavGroupWidths(this.$siteNavDynamicPrimaryItems),this.siteNavAlwaysVisibleItemsWidths=this.getNavGroupWidths(this.$siteNavAlwaysVisibleItems),this.siteNavMoreItemWidth=this.$navMoreItem.outerWidth(),this.siteNavAlwaysVisibleItemsTotalWidth=t.reduce(this.siteNavAlwaysVisibleItemsWidths,function(e,t){return e+t},0),this.siteNavLogoWidth=this.navLogoImgWidth-10,this.isThirdParty||(this.hiddenPrimaryItemsCount=0),this._updateMastheadWidth(),this.navRevealed||(this.isThirdParty||0!==this.hiddenPrimaryItemsCount||this.$navMoreItem.addClass(this.SITE_NAV_HIDDEN_CLASS),this.$(".site-nav-item").addClass("site-nav-item-visible"),this.navRevealed=!0)},navAutoFitItems:function(){var e=this.state.open?0:this.siteNavLogoWidth,t=this.isThirdParty?0:this.siteNavMoreItemWidth,i=this.siteNavAlwaysVisibleItemsTotalWidth+e,n=this.siteNavDynamicItemsWidths.length;this.firstHiddenNavItemIndex||(this.firstHiddenNavItemIndex=n);for(var s=0;s<this.siteNavDynamicItemsWidths.length;s++){var o=this.siteNavDynamicItemsWidths[s];if(i+o>this.mastheadWidth){if(i+t<=this.mastheadWidth){n=s;break}for(var a=s-1;a>=0;a--){var r=this.siteNavDynamicItemsWidths[a];if(i+t-r<=this.mastheadWidth){n=a;break}i-=r}break}i+=o}if(n!==this.firstHiddenNavItemIndex){var l=n<this.firstHiddenNavItemIndex,h=l?n:this.firstHiddenNavItemIndex,d=l?this.firstHiddenNavItemIndex:n;this.togglePrimaryNavItems(n,h,d),this.toggleMoreNavItems(n,h,d),this.firstHiddenNavItemIndex=n}},togglePrimaryNavItems:function(e,t,i){this.$siteNavDynamicPrimaryItems.slice(t,i).toggleClass(this.SITE_NAV_HIDDEN_CLASS)},toggleMoreNavItems:function(e,t,i){if(!this.isThirdParty){var n=e<this.firstHiddenNavItemIndex,s=this.siteNavDynamicItemsWidths.length-e,o=this.willMoreDropdownAppear(s)||this.willMoreDropdownHide(s);if(this.$siteMoreDropdownItems.slice(t,i).toggleClass(this.SITE_NAV_MORE_VISIBLE_CLASS),o){var a=0===s;this.$navMoreItem.toggleClass(this.SITE_NAV_HIDDEN_CLASS,a),this.allPrimaryNavItemsShown=!n}this.hiddenPrimaryItemsCount=s,this._updateMoreColumnLayout()}},willMoreDropdownAppear:function(e){return 0===e&&this.hiddenPrimaryItemsCount>0},willMoreDropdownHide:function(e){return 0===this.hiddenPrimaryItemsCount&&e>0},getNavGroupWidths:function(i){return t.map(i,function(t){return e(t).outerWidth()})},_updateMastheadWidth:function(){var e=this.$siteMasthead.outerWidth();if(e!==this.mastheadWidth){var t=e>this.mastheadWidth?"wider":"narrower";this.mastheadWidth=e,"wider"===t&&this.allPrimaryNavItemsShown||this.navAutoFitItems()}},_updateMoreColumnLayout:function(){this.isThirdParty||(this.hiddenPrimaryItemsCount>this.TWO_COL_THRESHOLD&&"2col"!=this.moreLayout?(this.subviews.moreModule.convertColumnLayout("2col"),this.moreLayout="2col"):"1col"!=this.moreLayout&&(this.subviews.moreModule.convertColumnLayout("1col"),this.moreLayout="1col"))},_onPageLoad:function(e){this._buildSpecialOffersMastheadAd(),this._onResizeWindow(e)},_onResizeWindow:function(){this._updateMastheadWidth()},_buildSpecialOffersMastheadAd:function(){if(this.$specialOffersMastheadAd.length){var e,i=o.getActivePageInfo().numPageViewsLeft,n=a.getAccount("firefly");void 0!==i&&(e={pwvr:i>0?i:"0"}),this.subviews.specialOffersMastheadAd?e&&(this.subviews.specialOffersMastheadAd.setTargeting(e),this.subviews.specialOffersMastheadAd.refreshPosition()):n?n.getUserInfo().done(t.bind(function(t){t.hasMarketAccess||this._applyMastheadDirectPositionAd(e)},this)).fail(t.bind(function(){this._applyMastheadDirectPositionAd(e)},this)):this._applyMastheadDirectPositionAd(e)}},_applyMastheadDirectPositionAd:function(e){this.subviews.specialOffersMastheadAd=new h({el:this.$specialOffersMastheadAd,adSizes:[122,50],adPlacement:"consumer_sales-masthead",onAdReady:this._handleOnAdReady,targeting:e})},_handleOnAdReady:function(){this.$subscribeWrap.remove(),this.$specialOffersMastheadAd.addClass("site-masthead-subscribe-wrap-visible"),this.subviews.specialOffersMastheadAd.showAd()},destroy:function(){this._unregisterFixingScroller(),this.$win.off("."+this.cid),clearTimeout(this.headerTransparencyTimeout),i.prototype.destroy.call(this)},_loginStatus:function(e,t,i){"firefly"===e&&("loggedIn"===t&&i&&i.hasMarketAccess?this.$subscribeWrap.removeClass("site-masthead-subscribe-wrap-visible"):"loggingIn"!==t&&this.$subscribeWrap.addClass("site-masthead-subscribe-wrap-visible"))},isFixedAndClosed:function(e){return!(e.open||!e.fixed||e.hasFixingScroller||e.hasClosingScroller)},_setState:function(e){var i,s="";t.each(e,function(t,n){this.state[n]!==t&&("fixed"===n?t?(this.$siteHeaderInnerWrap.addClass("site-header-inner-wrap-fixed"),s+=" header:fixed"):(this.$siteHeaderInnerWrap.removeClass("site-header-inner-wrap-fixed"),s+=" header:unfixed"):"open"===n?(i=this.state.fixed===!0&&(void 0===e.fixed||e.fixed===!0)||void 0!==e.hasFixingScroller&&this.state.hasFixingScroller!==e.hasFixingScroller,this._setMasthead(t,i),s+=t?" header:open":" header:closed"):"hasFixingScroller"===n?t?this._registerFixingScroller():this._unregisterFixingScroller():"hasClosingScroller"===n?t?this._registerClosingScroller():this._unregisterClosingScroller():console.warn("Unknown state key: "+n))},this),this._checkTransition(this.state,e),t.extend(this.state,e),s&&n.trigger(s)},_checkTransition:function(t,i){i=e.extend({},t,i);var n=this.isFixedAndClosed(t),s=this.isFixedAndClosed(i),o=t.open!==i.open;n!==s&&(s?this._transitionToCloseFixed(o):this._transitionFromCloseFixed(o))},_transitionToCloseFixed:function(e){this.navHeight=this.navHeaderHeight,this.updateHeaderMinHeight(e)},_transitionFromCloseFixed:function(e){this.navHeight=this.navHeaderHeight+this.mastheadHeight,this.updateHeaderMinHeight(e)},_registerFixingScroller:function(){this.isMulti||(this.hasFixingScroller?console.warn("Attempting to register headerFixingScroller twice"):(this.hasFixingScroller=!0,this.$win.on("scroll.headerFixingScroller",t.throttle(this.onFixingScroll,20))))},_unregisterFixingScroller:function(){this.hasFixingScroller=!1,this.$win.off(".headerFixingScroller")},onFixingScroll:function(){var e=s.getScrollPosition()>=this.mastheadHeight;e!==this.state.fixed&&this._setState({open:!e,fixed:e})},_registerClosingScroller:function(){this.isApple||this.isMulti||(this.hasClosingScroller?console.warn("Attempting to register headerFixingScroller twice"):(this.hasClosingScroller=!0,this.$win.on("scroll.headerClosingScroller",t.throttle(this.onClosingScroll,20))))},_unregisterClosingScroller:function(){this.hasClosingScroller=!1,this.$win.off(".headerClosingScroller")},onClosingScroll:function(){this._setState({open:!1,fixed:!0,hasClosingScroller:!1}),this.transparencySetup&&!this.headerIsTransparent&&this.toggleTransparency(!0)},loadHeaderModules:function(){this.$(".headermodules").each(t.bind(function(t,i){try{var n=JSON.parse(e(i).html()).js_modules||[];this.buildModules(n)}catch(s){console.error("Failure loading header modules",s)}},this))},onClickNavSearchIcon:function(e){e.preventDefault(),s.getNested(window.site_vars,"search","ENABLED")&&(this.$searchInput.focus(),this.state.open||(this._setState({open:!0,fixed:!0,hasClosingScroller:!0}),this.$searchCancelBtn.addClass("site-masthead-search-close-btn-visible"),this.transparencySetup&&this.headerIsTransparent&&this.toggleTransparency(!1)))},scrollTop:function(e,t){if(!t)if(this.state.open){var i=s.getScrollPosition();if(e<this.fixedHeaderThreshold&&i<this.fixedHeaderThreshold)return i}else this.state.hasFixingScroller&&e<this.fixedHeaderThreshold&&(e=this.fixedHeaderThreshold);return this.$top.scrollTop(e),e},isFixed:function(){return this.state.fixed},isOpen:function(){return this.state.open},setOpenFixed:function(t){t&&(this.lastState=e.extend({},this.state)),this._setState({open:!0,fixed:!0,hasFixingScroller:!1,hasClosingScroller:!1})},getFixedHeight:function(){return this.isFixedAndClosed(this.state)?this.minHeight:this.minHeight-this.mastheadHeight},setFixingScroller:function(e){this._setState(e?{hasFixingScroller:!0,hasClosingScroller:!1}:{hasFixingScroller:!1,hasClosingScroller:!1})},setClosedFixed:function(t){t&&(this.lastState=e.extend({},this.state)),this._setState({open:!1,fixed:!0,hasFixingScroller:!1,hasClosingScroller:!1})},restoreLastState:function(){this.lastState&&(this._setState(this.lastState),this.lastState=null)},restoreDefaultState:function(){if(this.state.defaultFixed)this._setState({open:this.state.defaultOpen,fixed:this.state.defaultFixed,hasFixingScroller:!this.state.defaultFixed,hasClosingScroller:!1});else{var e=s.getScrollPosition()>=this.mastheadHeight;this._setState({open:!e,fixed:e,hasFixingScroller:!0,hasClosingScroller:!1})}},onClickSearchBtnDiv:function(t){e(t.currentTarget).parents("form").trigger("submit")},onClickSearchCloseBtn:function(){o.getActiveApp().isSearchPage?r.goTo("/"):(this._setState({open:!1,fixed:!0,hasClosingScroller:!1}),this.transparencySetup&&!this.headerIsTransparent&&this.toggleTransparency(!0))},_collapseMasthead:function(e){e?this.animate(this.$searchWrap,"height",0,this.slideSpeed,this.slideEasing).always(t.bind(function(){this.$searchCancelBtn.length&&this.$searchCancelBtn.removeClass("site-masthead-search-close-btn-visible")},this)):this.$searchWrap.css("height",0),this.toggleNavLogo(!0,!0)},_expandMasthead:function(e){e?this.animate(this.$searchWrap,"height",this.mastheadHeight+"px",this.slideSpeed,this.slideEasing).done(t.bind(function(){this.$searchInput.focus()},this)):this.$searchWrap.css("height",this.mastheadHeight),this.toggleNavLogo(!0,!1)},_setMasthead:function(e,t){e?this._expandMasthead(t):this._collapseMasthead(t)},getExpandedHeight:function(){return this.minHeight},getScrollOffset:function(){return this.isFixed()?this.minHeight!=this.navHeaderHeight?this.minHeight-this.navHeaderHeight:this.minHeight:0},getFixedThreshold:function(){return this.fixedHeaderThreshold},getCollapsedHeight:function(){return this.navHeaderHeight},getCurrentHeight:function(){return this.navHeight},toggleNavLogo:function(e,t){var i=t?1:0,n=t?this.navLogoImgWidth:0;this.$navLogoImg.css("opacity",i),this.$navLogoLink.css("width",n)},updateHeaderMinHeight:function(e){this.minHeight=this.navHeight+(this.subviews.breakingbar?this.subviews.breakingbar.getHeight():0),e?this.animate(this.$el,"min-height",this.minHeight,this.slideSpeed):this.$el.css("min-height",this.minHeight)},onBreakingNewsChange:function(e){this.updateHeaderMinHeight(),e?n.trigger("breakingbar:before:open",this.minHeight,this.options.slideSpeed):n.trigger("breakingbar:before:close",this.minHeight,this.options.slideSpeed)},updateNavigation:function(e){var t,i,s,o="site-nav-active-span",a="site-nav-active-item";for(this.$("."+o).removeClass(o),this.$("."+a).removeClass(a),e=e||"home",s=e.indexOf("?"),-1!==s&&(e=e.substring(0,s)),"/"===e[0]&&(e=e.substring(1)),"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),e=e.replace(/[^_a-zA-Z0-9\-/]/g,""),t=e?e.split("/"):["home"];t.length&&(i=this.$(".site-nav-"+t.join("-")+"-item"),!i.length);)t=t.splice(0,t.length-1);var r=t.join("-");n.trigger("update:navigation",r),i&&i.length&&(this.$(".site-nav-"+r+"-span").addClass(o),i.addClass(a))},setupTransparency:function(){this.siteHeaderInnerWrapBg=this.$siteHeaderInnerWrap.css("background"),this.$siteHeaderInnerWrap.addClass("transparent-transition").css("background",""),this.transparencySetup=!0},destroyTransparency:function(){this.$siteHeaderInnerWrap.removeClass("transparent-transition"),this.$el.removeClass("transparent-header"),this.transparencySetup=!1,this.headerTransparencyTimeout=t.delay(t.bind(function(){this.$siteHeaderInnerWrap.css("background",this.siteHeaderInnerWrapBg)},this),350)},toggleTransparency:function(e){this.transparencySetup||this.setupTransparency(),e?(this.$el.addClass("transparent-header"),this.headerIsTransparent=!0):(this.$el.removeClass("transparent-header"),this.headerIsTransparent=!1)}});return u}),define("api/analytics",["pubsub"],function(e){return{trackEvent:function(t,i){e.trigger("track",{label:t,url:i})},trackPageView:function(t){e.trigger("analytics:pageload",{ssts:t.ssts||"bugpages",cst:t.cst||"undefined",contenttype:t.contentType,pathName:t.pathName})}}}),define("analytics/settealium",["jquery","underscore","pubsub","fwinfo","utils","managers/routemanager","user-manager","managers/abtestmanager","api/analytics"],function(e,t,i,n,s,o,a,r){function l(e,t){u?u.push([e,t]):h(e,t)}function h(e,t){for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var n=""+t[i];"eVar"!==n.substring(0,4)&&(t[i]=n.toLowerCase())}window.utag.track(e,t)}function d(e){if(-1!=e.indexOf("|")){var t="n/a",i=[f.data.contenttype||t,f.data.section||t,e];e=i.join("|"),/[|](\d+|n\/a)$/.test(e)||(e+="|"+t)}return e}var c={},u=[],p=function(){window.tealium_url&&this.initialize(window.tealium_url)};p.prototype={initialize:function(e){this.data={},this.pubSub={"analytics:pageload":this.page_load,heattrack:this.heattrack,abtesttrack:this.abtesttrack,cxresptrack:this.cxresptrack,freetrialtrack:this.freetrialtrack,"page:load":this.page_load,"site:refresh":this.site_refresh,"slide:change":this.slide_change,"user:logout":this.clear_user_data,uotrack:this.uotrack,"video:load":this.video_load,track:this.track,vitrack:this.vitrack,newslettertrack:this.newslettertrack,"userUtil:personal_link":this.user_util_personal_link},i.attach(this.pubSub,this),s.loadScript(e,"utag").done(function(){t.each(u,function(e){h(e[0],e[1])}),u=null}).fail(t.bind(function(){u=null,this.destroy()},this))},ready:function(){},destroy:function(){i.unattach(this.pubSub,this)},relevant_data:function(e,t){var i=e.cst.replace(/\/\/*$/,"").split("/"),s=new Date(18e5*parseInt((new Date).getTime()/18e5,10)),o=s.getHours(),a=location.hash.match(/\bht=([^&]*)/)&&RegExp.$1,l=window.location.search.match(/[?&]csp=([^&]*)/i)&&RegExp.$1,h=e.ssts.split("/");this.clickName=a||n.getandclearsessionvalue("clickName"),this.clickPage=n.getandclearsessionvalue("clickPage");var d=r.getUserActiveTest();return{assetid:e.assetid,atyponuserid:f.data.atypon_id,blogname:e.blogname||"",brandview_sponsor:e.sponsorname||"",byline:e.byline||"",category:i[0],clickName:this.clickName,clickPage:this.clickPage,contenttype:e.contenttype,cst:i.slice(0,3).join(":"),dayofweek:"sunday monday tuesday wednesday thursday friday saturday".split(" ")[(new Date).getDay()],eventtype:t,gcionid:document.cookie.match(/\bGCIONID=([^;]*)/)&&RegExp.$1,halfhour:1+(o+11)%12+":"+function(e){return e.substr(e.length-2)}("0"+s.getMinutes())+(o>11?" pm":" am"),linkTrackVars:"prop1",numPageViewsLeft:e.numPageViewsLeft,pathName:e.pathName||"",prevpath:n.getandclearsessionvalue("prevpath"),priority_asset:e.priority_asset||"",published_date:e.published_date||"",referrerhost:a?document.referrer.split("/")[2]:"",refreshed:n.getandclearsessionvalue("refreshed"),searchkeywords:e.searchkeywords,section:h[0],ssts:h.join(":"),subcategory:i.slice(0,2).join(":"),subsection:h.slice(0,2).join(":"),templatetype:e.templatetype,topic:h.slice(0,3).join(":"),typeofday:((new Date).getDay()+8)%7>1?"weekday":"weekend",user_status:f.data.user_status||"",coreuserid:f.data.core_user_id||"",videoincluded:e.videoincluded||"no",taxonomykeywords:e.taxonomykeywords||"",gallerytitle:e.gallerytitle||"",galleryindex:e.galleryindex||"",queryparamtrack:l||"",viralVideoDomain:"",videoContentProvider:"",videoFulllengthUrl:"",videoName:"",videoPlayerName:"",keywords:"",videoDuration:"",milestonetrack:"",videotranscript:"",noinitialanalytics:e.noinitialanalytics||"",abtestid:d?r.getUserActiveTestId(d):void 0,abtestvariant:d?r.getUserActiveVariantId(d):void 0,abteststring:d?r.getUserActiveTestString(d):void 0,abtestctrlcompgrp:d?r.isUserInActiveCtrlCompareGrp(d):void 0,abtestslot:r.userTestSlot||void 0}},clear_user_data:function(){f.data={}},page_load:function(e){var t;e.noinitialanalytics?"videopage"===e.contenttype&&this.video_asset_load():(c=t=f.relevant_data(e,"page:load"),f.data.contenttype=t.contenttype,f.data.section=t.section,n.setsessionvalue("prevpath",document.location.pathname),"loggingIn"===a.getLoginStatus()||"loggedIn"===a.getLoginStatus()?a.getCoreUserInfo().then(function(e){f.data.atypon_id=t.atyponuserid=e.AtyponId,f.data.core_user_id=t.coreuserid=e.CoreUserId,f.data.user_status=t.user_status=e.UserLicenseType;var i=a.getAccount("firefly");s.getNested(i,"user","hasMarketAccess")&&(f.data.numPageViewsLeft=t.numPageViewsLeft="authorized"),l("view",t)},function(){l("view",t)}):(f.data.user_status=t.user_status="none",l("view",t)))},track:function(e){e=e||{};var t=e.url,i=this._getLabel(e.event,e.label);t&&o.getInfo(t)?this.heattrack(i):i&&this.uotrack(i)},_getLabel:function(t,i){if(t){var n=e(t.currentTarget);return n.data("trackLabel")||n.data("uotrack")||n.data("ht")||i}return i},uotrack:function(e){"string"!=typeof e&&(console.error("uotrack has been given a non-string event argument",e),e=(e||{}).prop41||"somethingbad");var t=e.match(/{% *[a-z0-9_]* *%}/gi);if(t)for(var i=0;i<t.length;i++){var n=t[i],s=n.match(/{% *([a-z0-9_]*) *%}/)&&RegExp.$1;e=e.replace(n,c[s])}e=d(e);var o={clickName:e,clickPage:location.href,eventtype:"uotrack",linkTrackEvents:"None",linkTrackVars:"prop41,prop64"};l("link",o)},vitrack:function(e){"object"!=typeof e&&(console.error("vitrack has been given a non-object event argument",e),e=(e||{}).prop9||"somethingbad");var t={milestonetrack:e.percentage,eventtype:"vitrack",linkTrackEvents:"None",linkTrackVars:"prop9",video_url:e.video_url};l("link",t)},abtesttrack:function(e){var t={ab_test_variant_success:e,eventtype:"abtesttrack",linkTrackEvents:"event76",linkTrackVars:"prop27"};l("link",t)},cxresptrack:function(e){var t={cxense_response:e,eventtype:"cxresptrack",linkTrackEvents:"None",linkTrackVars:"eVar64"};l("link",t)},freetrialtrack:function(e){var t={free_trial:e,eventtype:"freetrial",linkTrackEvents:"event78",linkTrackVars:"None"};l("link",t)},user_util_personal_link:function(e){var t={gup_personal_link:e,eventtype:"gup-personal-link",linkTrackEvents:"None",linkTrackVars:"eVar63"};l("link",t)},newslettertrack:function(e){var t={fbid:e};l("newsltr-signup",t)},site_refresh:function(e){n.setsessionvalue("refreshed",e)},heattrack:function(e){e&&(e=d(e),n.setsessionvalue("clickName",e)),n.setsessionvalue("clickPage",location.href)},slide_change:function(e){var t,i,s=c;try{t=e.cst.split("/"),i=e.ssts.split("/")}catch(o){return void console.error("Invalid page",o.stack||o.stacktrace||o.message)}s.byline="",s.clickName=n.getandclearsessionvalue("clickName"),s.contenttype=e.contenttype,s.videoincluded=e.videoincluded||"no",s.gallerytitle=e.gallery_title,s.galleryindex=e.gallery_index,s.assetid=e.gallery_id,s.eventtype="slide:change",s.templatetype="",s.category=t[0],s.cst=t.slice(0,3).join(":"),s.published_date=e.publishedDate||"",s.refreshed="",s.section=i[0],s.ssts=i.join(":"),s.subcategory=t.slice(0,2).join(":"),s.subsection=i.slice(0,2).join(":"),s.topic=i.slice(0,3).join(":"),s.pathName=e.pathName||"",s.viralVideoDomain="",s.videoContentProvider="",s.videoFulllengthUrl="",s.videoName="",s.videoDuration="",s.videoPlayerName="",s.keywords="",s.milestonetrack="",s.videotranscript="",l("view",s)},video_load:function(e){var t=c,i=location.hash.match(/\bht=([^&]*)/)&&RegExp.$1;t.byline="",t.clickName=i||n.getandclearsessionvalue("clickName"),t.clickPage=n.getandclearsessionvalue("clickPage"),t.category=e.category||"",t.cst=e.cst||"",t.assetid=e.assetid||"",t.published_date=e.publishedDate||"",t.refreshed="",t.section=e.section||"",t.ssts=e.ssts||"",t.subcategory=e.subcategory||"",t.subsection=e.subsection||"",t.topic=e.topic||"",t.videoPlayerName=e.videoplayername||"",t.prevpath=n.getandclearsessionvalue("prevpath"),t.completion=e.completion||"",t.keywords=e.keywords||"",t.taxonomykeywords=e.keywords||"",t.contenttype=e.contenttype||"",t.videoName=e.videoName||"",t.videoDuration=e.videoDuration||"",t.eventtype=e.eventtype||"",t.pathName=e.pathName||"",t.videoContentID=e.contentid||"",t.viralVideoDomain=e.viralVideoDomain||"",t.videoContentProvider=e.videocontentprovider||"",t.templatetype=e.templatetype||"",t.noinitialanalytics=!1,t.videoincluded="yes",t.videoFulllengthUrl=e.videoFulllengthUrl||"",t.milestonetrack=e.milestonetrack||"",t.videotranscript=e.videotranscript||"",l("view",t),n.setsessionvalue("prevpath",document.location.pathname)},video_asset_load:function(){var e=c;e.clickName="videoassetpageprepreroll"+(e.clickName?"|"+e.clickName:""),e.clickPage=n.getsessionvalue("clickPage"),e.eventtype="video-asset-load",e.linkTrackEvents="None",e.linkTrackVars="prop41,prop64,prop52",l("link",e)}};var f=new p;return f}),define("modules/interactive-poll",["jquery","underscore","baseview","pubsub","utils","state","cookie"],function(e,t,i,n,s,o){var a=i.extend({events:{"click .story-poll-choices .story-poll-vote-btn":"registerVote","click .story-poll-results-btn":"revealResults","click .poll-vote-results .story-poll-vote-btn":"revealChoices"},initialize:function(){this.poll_id=this.$el.attr("data-pollid"),this.user_id="unauthenticated",e.cookie(this.poll_id)&&this.revealResults(),i.prototype.initialize.apply(this,arguments)},revealResults:function(i){var n=this.$(".quickpoll-results"),s=this.$(".story-poll-choices"),a=this.$(".story-poll-chart"),r="/polls/get/"+this.poll_id+"/";o.fetchData(r).done(t.bind(function(o){var r=t.pluck(o[0].answer,"count"),l=t.reduce(r,function(e,t){return e+parseFloat(t)},0),h=0===l?!0:!1,d=0;isNaN(i)||(l+=1,e.cookie(this.poll_id,!0)),t.each(o[0].answer,function(e,t){var n;h?n=i==t?100:0:(i==t+1&&(e.count+=1),n=Math.round(parseFloat(e.count)/l*100)),d+=n,e.percent=n,e.percent_width=.8*n});var c=t.template(n.html(),{data:o[0],total:l});s.hide(),a.html(c).fadeIn(),e.cookie(this.poll_id)&&e(".poll-vote-results .story-poll-vote-wrapper").hide(),a.css("height","auto")},this))},registerVote:function(){var e=this.$(".story-poll-answer:checked").val(),i="/polls/save/"+this.poll_id+"/"+this.user_id+"/"+e+"/";return o.fetchData(i,{method:"post"}).done(t.bind(function(t){t&&(n.trigger("uotrack","pollvote"),this.revealResults(e))},this)),!1},revealChoices:function(){var e=this.$(".story-poll-choices"),t=this.$(".story-poll-chart");t.hide(),e.fadeIn()}});return a}),define("user-accounts/base-user-account",["jquery","underscore","pubsub","baseview","managers/cachemanager"],function(e,t,i,n,s){"use strict";var o=n.extend({initialize:function(e){t.bindAll(this,"_handleGetCoreUserInfo","logout"),n.prototype.initialize.call(this,e)},getUserInfo:function(){return this.loginPromise?this.loginPromise.then(t.bind(function(){return this._handleGetUserInfo()},this)):e.Deferred().reject("account not logged in")},_handleGetUserInfo:function(){return console.error("getUserInfo failed: unimplemented function!"),e.Deferred().reject("unimplemented feature")},getCoreUserInfo:function(){return this.loginPromise?this.loginPromise.then(t.bind(function(){return s.getValue("coreuserinfo",this._handleGetCoreUserInfo).done(function(t){e.cookie("atyponid",t.AtyponId,{expires:14,path:"/",domain:window.site_vars.base_url}),e.cookie("sessionKey",t.AtyponSessionKey,{path:"/",domain:window.site_vars.base_url})})},this)):e.Deferred().reject("account not logged in")},_handleGetCoreUserInfo:function(){return e.Deferred(t.bind(function(t){e.ajax("/user-service/getcoreuser/"+this.getUserId()+"/"+this.getName(),{type:"POST",data:{token:this.getUserToken()}}).done(function(e){e&&e.success&&e.success.status?"valid"===e.success.status.state?t.resolve(e.success.response):t.reject(e.success.status.message):t.reject("unable to get core user data, invalid response!")}).fail(function(){t.reject("unable to get core user data!")})},this)).promise()},login:function(e){var i=this.getLoginStatus();return"loggingOut"===i?this.logoutPromise.then(t.bind(function(){return this.login(e)},this),t.bind(function(){return this.login(e)},this)):("loggedIn"!==i&&"loggingIn"!==i&&this._triggerLogin(e),this.loginPromise)},_triggerLogin:function(e){this.loginPromise=this._handleLogin(e),"pending"===this.loginPromise.state()&&this._onLoginStatusChange(),this.loginPromise.always(t.bind(function(){this._onLoginStatusChange.apply(this,arguments)},this))},getLoginStatus:function(){return this.logoutPromise?"loggingOut":this.loginPromise?"rejected"===this.loginPromise.state()?"loginFailed":"pending"===this.loginPromise.state()?"loggingIn":"loggedIn":"loggedOut"},_onLoginStatusChange:function(){i.trigger.apply(i,["user:statuschange",this.getName(),this.getLoginStatus()].concat(Array.prototype.slice.call(arguments,0)))},_handleLogin:function(){return console.error("Login failed: unimplemented function!"),e.Deferred().reject("unimplemented feature")},_flushCaches:function(){s.clearValue("coreuserinfo")},logout:function(){var t=this.getLoginStatus();return"loggingOut"===t?this.logoutPromise:"loggingIn"===t?this.loginPromise.then(this.logout,this.logout):"loggedOut"!==t?this._triggerLogout():e.Deferred().resolve()},_triggerLogout:function(){this._flushCaches(),this.loginPromise=null;var e=this._handleLogout().always(t.bind(function(){this.logoutPromise=null,this._onLoginStatusChange()},this));return"pending"===e.state()&&(this.logoutPromise=e,this._onLoginStatusChange()),e},_handleLogout:function(){return e.Deferred().resolve()},whenLoggedIn:function(){return this.loginPromise?this.loginPromise:e.Deferred().reject()},getUserToken:function(){return""},getUserId:function(){return""},getUserAvatar:function(){return""},getUserFirstName:function(){return""},getUserLastName:function(){return""},getName:function(){throw"No name defined"}});return o}),define("user-accounts/firefly-user-account",["jquery","underscore","pubsub","user-accounts/base-user-account","user-manager","utils","third-party-apis/firefly/firefly","cookie"],function(e,t,i,n,s,o,a){"use strict";var r=n.extend({initialize:function(e){n.prototype.initialize.call(this,e),this.user={},s.registerAccount(this),s.loginUser("firefly")},_handleGetUserInfo:function(){return a.getUserInfo().done(t.bind(function(e){this.user=e},this))},_handleGetCoreUserInfo:function(){return a.getUserInfo().then(t.bind(function(e){for(var t={CoreUserId:o.getNested(e,"userService","coreUserId"),AtyponSessionKey:this.getUserToken(),GooglePlusId:void 0,AtyponId:e.userId,UserLicenseType:e.userLicenseType,FaceBookId:void 0,FileMobileId:void 0},i=o.getNested(e,"userService","identities")||[],n=0;n<i.length;n++){var s=i[n];"Facebook"===s.ProviderName?t.FaceBookId=s.ProviderUserId:"Google"===s.ProviderName?t.GooglePlusId=s.ProviderUserId:"Filemobile"===s.ProviderName&&(t.FileMobileId=s.ProviderUserId)}return t},this))},getUserInfo:function(){return a.getUserInfo()},getUserResponse:function(){return a.getUserResponse()},getViewsCookie:function(){return a.getFireflyViewsCookie()||{}},_handleLogin:function(e){var i;return i=e?"getLoginStatus":"loginUser",a[i]().then(t.bind(function(){return this._handleGetUserInfo()},this),t.bind(function(){this.logout()},this))},_handleLogout:function(){return this.getUserToken()?a.logoutUser(this.sessionToken):e.Deferred().resolve()},getName:function(){return"firefly"},getUserToken:function(){return e.cookie("sessionKey")},getUserId:function(){return this.user.userId},getUserAvatar:function(){return this.user.picture&&this.user.picture.data?this.user.picture.data.url:""},getUserFirstName:function(){return this.user.firstName},getUserLastName:function(){return this.user.lastName},getWelcomeName:function(){return this.user.welcomeName},getUserPhoto:function(){var e=t.find(this.user.attributes,function(e){return"preferredPhoto"===e.attributeName});return e?o.getNested(e,"attributeValues",0,"attributeValue"):void 0}});return new r}),define("modules/global/expired-card",["jquery","underscore","baseview","pubsub","state","utils"],function(e,t,i,n,s,o){var a=i.extend({events:{"click .cc-close_modal_link, .cc-remind-later-link":"close","click .cc-payment-button":"updatePaymentClick"},initialize:function(e){this.licenseId=e.licenseId||"",this.body=o.get("body"),s.registerFullScreenView(this),this.buildModal()},buildModal:function(){var t=this;s.fetchHtml("/services/expired-license/").done(function(i){t.modal_html=i,t.body.append(i),t.m_uiModal=e("#cc_modal"),t.m_uiModalBgrnd=e("#lightbox"),t.m_uiModal.show(),t.m_uiModalBgrnd.fadeIn(300),t.setElement("#cc_modal")})},updatePaymentClick:function(e){e.preventDefault(),o.openPopup(e.currentTarget.href+"?licenseId="+this.licenseId,screen.width,screen.height),this.close()},close:function(){if(this.m_uiModal){this.setLocalTimestamp(),s.clearFullScreenView();var e=this.m_uiModalBgrnd;this.destroy(!0),this.m_uiModalBgrnd.fadeOut(300,function(){e.remove()}),this.m_uiModal=null,this.m_uiModalBgrnd=null,this.modal_html=null}},setLocalTimestamp:function(){var e=new Date;localStorage["expired-credit-card"]=e.getTime()},destroy:function(e){this.modal_html&&this.modal_html.remove(),i.prototype.destroy.call(this,e)}});return a}),define("modules/users/site-nav-firefly-module",["jquery","underscore","modules/header/site-nav-dropdown","pubsub","utils","user-manager","state","user-accounts/firefly-user-account","modules/global/expired-card","admanager"],function(e,t,i,n,s,o,a,r,l,h){"use strict";var d=i.extend({events:{"click .ff-insider":"onClickInsider",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .site-nav-dropdown":"closeDropdown"},initialize:function(e){this.pubSub={"page:load":this.updateRedirectURLs,"user:statuschange":this.showLoggedInStatus},this.$siteNavDropdown=this.$(".site-nav-dropdown"),this.$navSpan=this.$(".site-nav-firefly-span"),this.$name=this.$(".site-nav-firefly-user-display-name"),this.loginData=s.getNested(window.site_vars,"userAuthentication","login"),h.getActiveSlotStatistics().done(t.bind(function(e){if(!this.destroyed&&!e.high_impact&&"loggedIn"==o.getLoginStatus()&&s.getNested(window.site_vars,"flags","expired_credit_card_modal")){var i=o.getAccount("firefly");i&&i.getUserInfo().done(t.bind(function(e){this.destroyed||this.checkCreditCardStatus(e)},this))}},this)),i.prototype.initialize.call(this,e)},updateRedirectURLs:function(){var i=encodeURIComponent(s.getPageUrl()),n=this.loginData.success_qsp,o=this.loginData.cancel_qsp,a="?"+n+"="+i+"&"+o+"="+i;e(".userAuth-redirect").each(function(i,s){var r,l,h="",d=e(s),c=d.attr("href"),u=new RegExp("^"+n+"|^"+o);t.isString(c)&&(r=c.split(/[\?\&]/),l=r.splice(1),l.length>0&&(l=t.filter(l,function(e){return u.test(e)?void 0:e}),h="&"+l.join("&")),d.attr("href",r[0]+a+h))})},showLoggedInStatus:function(e,t,i){"firefly"===e&&(this.$navSpan&&this.$navSpan.addClass("loaded"),"loggedIn"===t?this.showLoggedInUser(i):"loggingIn"!==t&&this.showLoggedOutUser())},checkCreditCardStatus:function(e){if(!e)return!1;var i=new Date;if(i.getTime()<parseInt(localStorage.getItem("expired-credit-card"))+864e5)return!1;var n,o=s.getNested(window.site_vars,"market_id"),a=e.licenses;t.each(a,function(e){e.marketId==o&&(n=e)}),this._verifyExpiredLicense(n)&&this._setupExpiredCardSubview(n.licenseId)},onClickInsider:function(){n.trigger("uotrack","myaccount|insider")},_verifyExpiredLicense:function(e){var t=new Date;return e&&e.creditCardExpirationMonth&&e.creditCardExpirationYear?e.lastPaymentFailed?!0:t.getFullYear()>parseInt(e.creditCardExpirationYear,10)?!0:t.getFullYear()==parseInt(e.creditCardExpirationYear,10)&&t.getMonth()+1>e.creditCardExpirationMonth?!0:t.getFullYear()>=parseInt(e.creditCardExpirationYear,10)&&t.getMonth()+1>=e.creditCardExpirationMonth&&t.getDate()>=15?!0:!1:!1},_setupExpiredCardSubview:function(e){this.subviews.expiredcard=new l({licenseId:e})},showLoggedOutUser:function(){this.$siteNavDropdown.removeClass("authenticated subscribed"),this.$name.html("")},showLoggedInUser:function(e){var t=o.getAccount("firefly");
this.$siteNavDropdown.addClass("authenticated"),e.hasMarketAccess&&this.$siteNavDropdown.addClass("subscribed"),this.$name.html(t.getWelcomeName()),t.getUserPhoto()&&this.$navSpan.css({"background-image":"url("+t.getUserPhoto()+")"}).addClass("no-after")}});return d}),define("modules/home-finder/home-ads",["jquery","underscore","baseview","state","directAdPosition"],function(e,t,i,n,s){var o=i.extend({initialize:function(e){i.prototype.initialize.call(this),this.layoutType=e.layoutType},isSidebarModule:function(){return"sidebar"===this.layoutType},isPrimaryWellModule:function(){return"primary"===this.layoutType},renderedAd:!1,renderAd:function(){this.renderedAd||(this.renderedAd=!0,this.subviews.ads=[],this.$(".mpa-hf-ads").each(t.bind(function(e,t){this.subviews.ads[e]=this.createAdPosition(t)},this)))},destroyAd:function(){t.forEach(this.subviews.ads,function(e){e.destroy()}),this.subviews.ads=[]},createAdPosition:function(t){var i=e(t),n=i.data("adtag"),o=n.search("poster_front")?[300,135]:[300,250];return new s({el:i,adSizes:o,adPlacement:n})},handleCardSizeChange:function(e){if(this.isSidebarModule())e.sidebarAds===!0?this.renderAd():this.destroyAd();else if(this.isPrimaryWellModule()){var t=this.$(".mpa-hf-wrap");e.sidebarOpen===!0?(t.addClass("mpa-closed"),this.destroyAd()):(t.removeClass("mpa-closed"),this.renderAd())}},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)}});return o}),define("modules/partner/leaderboard-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var n=i.extend({initialize:function(t){var n=this.$el;t=e.extend({adType:n.attr("data-ad-type")||"leaderboard",adPlacement:n.attr("data-ad-placement")||"leaderboard_btf",adSizes:n.attr("data-ad-sizes")||"leaderboard"},t),i.prototype.initialize.call(this,t),this._initAds()}});return n}),define("modules/partner/sponsor-logo-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var n=i.extend({initialize:function(t){var n=this.$el;t=e.extend({adType:n.attr("data-ad-type")||"sponsor_logo_module",adPlacement:n.attr("data-ad-placement")||"sponsor_logo_module",adSizes:n.attr("data-ad-sizes")||"sponsor_logo_medium"},t),i.prototype.initialize.call(this,t),this._initAds()}});return n}),define("modules/elections/election-inline",["jquery","underscore","baseview","modules/partner/sponsor-logo-ad"],function(e,t,i,n){"use strict";var s=i.extend({initialize:function(e){this.$bars=this.$(".hor-bar"),i.prototype.initialize.call(this,e),this.barsAnimate(),this.subviews.sponsoredAd=new n({el:".sponsor-image"})},barsAnimate:function(){var i=null;this.$bars.each(t.bind(function(t,n){n=e(n),i=this.animate(n,"width",n.data("percentage")+"%",800,"easeOutExpo")},this))}});return s}),define("modules/topics/topics-videos",["jquery","underscore","baseview","utils"],function(e,t,i,n){var s=i.extend({events:{"click .tpasvm-more-link":"onClickMore"},initialize:function(e){this.$moreLink=this.$(".tpasvm-more-link"),this.$moreWrap=this.$(".tpasvm-items-more"),i.prototype.initialize.call(this,e)},onClickMore:function(){if(this.$moreWrap.is(":visible"))this.$moreWrap.slideUp(),this.$moreLink.text("More Videos");else{this.$moreWrap.slideDown(),this.$moreLink.text("Less Videos");var e=this.$moreWrap.find(".tpavm-image");n.lazyLoadImage(e,"data-src",!0)}}});return s}),define("modules/right-now-weather/right-now-weather",["jquery","underscore","baseview","utils","modules/partner/simple-ad"],function(e,t,i,n,s){"use strict";var o=i.extend({classes:{sponsor:"right-now-weather-sponsorship-ad",poster:"poster-ad-primary"},initialize:function(e){this.$sponsorshipAd=this.$("."+this.classes.sponsor),this.$posterAd=this.$("."+this.classes.poster),this.layoutType=this._getLayoutType(),i.prototype.initialize.call(this,e)},_getLayoutType:function(){var e=null;return this.options.layoutType&&(e="sidebar"===this.options.layoutType?"sidebar":"primary"),e},renderCardInfo:function(e){"primary"===this.layoutType?e.sidebarWidth<340&&(this.show(),this._buildPosterAd(),this._buildSponsorshipAd()):"sidebar"===this.layoutType&&(340===e.sidebarWidth?this._buildSponsorshipAd():this.hide()),this.currentCardInfo=e},_buildSponsorshipAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorshipAd&&(this.subviews.sponsorshipAd=new s({el:this.$sponsorshipAd,adSizes:"sponsor_logo_medium",adPlacement:"sponsor_logo_front",adType:"sponsor_logo"}),this.subviews.sponsorshipAd._initAds())},_buildPosterAd:function(){this.$posterAd.length&&!this.subviews.posterAd&&(this.subviews.posterAd=new s({el:this.$posterAd,adSizes:"mediumrectangle",adPlacement:"poster_front",adType:"poster"}),this.subviews.posterAd._initAds())},onCardWidthChange:function(e){e.sidebarOpen?340===e.sidebarWidth?"primary"===this.layoutType?this.hide():(this.show(),this.subviews.sponsorshipAd||this._buildSponsorshipAd()):"primary"===this.layoutType?(this.show(),this.subviews.posterAd||this._buildPosterAd()):this.hide():"primary"===this.layoutType&&(this.show(),this.subviews.posterAd||this._buildPosterAd())}});return o}),define("modules/fronts/sidebar-poster-ad",["jquery","underscore","baseview","pubsub","state","sharedAdPosition","directAdPosition"],function(e,t,i,n,s,o,a){"use strict";var r=i.extend({initialize:function(n){t.bindAll(this,"onSidebarAdReady");var s=this.$el;this.layoutType=this._getLayoutType(),n=e.extend({adType:s.attr("data-ad-type")||"sidebar",adPlacement:s.attr("data-ad-placement")||"poster_front",adSizes:s.attr("data-ad-sizes")||"mediumrectangle,halfpage"},n),i.prototype.initialize.call(this,n)},_initAds:function(){var e=this.options,t=e.adSizes;t&&(t=t.split(","));var i={el:this.$el,adPlacement:e.adPlacement,pageInfo:s.getActivePageInfo(),adSizes:t,onAdReady:this.onSidebarAdReady,adType:e.adType};this.subviews.sidebarAd||(this.subviews.sidebarAd=new a(i))},_getLayoutType:function(){var e=null;return this.options.layoutType&&(-1!==this.options.layoutType.indexOf("primary")?e="primary":"sidebar"===this.options.layoutType&&(e="sidebar")),e},onSidebarAdReady:function(){this.subviews.sidebarAd.showAd(),this.refreshSidebar()},refreshSidebar:function(){s.getActiveApp().triggerEvent("refreshSidebarScroll")},_onHideSidebarAd:function(){this.subviews.sidebarAd&&"sidebar"===this.layoutType&&(this.hide(),this.$(".sidebar-wrapper").css("top",0),this.refreshSidebar())},showHidePosterAds:function(e){e.belowHeroAd&&"primary"===this.layoutType&&"poster_front"==this.options.adPlacement&&this._initAds(),e.belowTheFoldAd&&"primary"===this.layoutType&&"poster_front_btf"==this.options.adPlacement&&this._initAds(),e.sidebarAds&&"sidebar"===this.layoutType?(this.show(),this._initAds()):this._onHideSidebarAd()},onCardWidthChange:function(e){this.showHidePosterAds(e)},renderCardInfo:function(e){this.showHidePosterAds(e)}});return r}),define("ui/generic-paginator",["jquery","underscore","backbone","baseview"],function(e,t,i,n){var s=n.extend({events:{"click .paginator-indicator-target":"onPaginatorClick"},initialize:function(t){this.$pageElements=this.$(".paginator-indicator-target"),t=e.extend({onBeforePaginator:null,onGoTo:null},t),n.prototype.initialize.call(this,t)},onPaginatorClick:function(t){t&&t.preventDefault();var i=e(t.currentTarget).index();if(this.options.onBeforePaginator){var n=this.options.onBeforePaginator(i,t);if(!n)return!1}this.goToPage(i)},goToPage:function(e){if(0!==this.$pageElements.length){0>e?e=0:e>=this.$pageElements.length&&(e=this.$pageElements.length-1);var t=this.$pageElements.eq(e);this.$(".paginator-indicator-bullet").removeClass("active"),t.find(".paginator-indicator-bullet").addClass("active"),this.options.onGoTo&&this.options.onGoTo(e)}},goToNextPage:function(e){var t=this.$(".paginator-indicator-bullet.active"),i=t.parent().index();i<this.$pageElements.length-1?this.goToPage(i+1):e&&this.goToPage(0)},goToPrevPage:function(e){var t=this.$(".paginator-indicator-bullet.active"),i=t.parent().index();i>0?this.goToPage(i-1):e&&this.goToPage(this.$pageElements.length-1)}});return s}),define("modules/fronts/featured-content",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,n,s){var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(n){t.bindAll(this,"automate","goTo"),n=e.extend({transition:{interval:15e3}},n),this.subviews={},this.moveMe=this.$(".fcpm-items-wrap"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new s({el:this.$(".paginator"),onGoTo:this.goTo}),n.transition&&(this.interval=n.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,n)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e*-1;this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),n.lazyLoadImage(this.moveMe.find("img"))},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return o}),define("modules/fronts/blog-promo",["jquery","underscore","baseview","state","utils","ui/generic-paginator","modules/fronts/featured-content"],function(e,t,i,n,s,o,a){"use strict";var r=i.extend({el:".blog-promo-module",events:{"click .blogs-show-all":"showAll","click .close-all-blogs":"showAll"},initialize:function(t){t=e.extend({transition:{interval:15e3},displayNum:4},t),i.prototype.initialize.call(this,t),this.$numberBlogs=this.$(".blog-promo-content-wrap").length,this.$numberBlogs>0?(this.$seeAllBtnWrap=this.$(".blogs-show-all-wrap"),this.$closeAllBtn=this.$(".promo-button-container"),this.$allBlogsContainer=this.$(".show-all-blogs"),this.$blogChangeContainerHeight=this.$(".inner-show-all-blogs").height()+80,this.subviews.featuredcontent=new a(t)):this.hide()},showAll:function(){0===this.$allBlogsContainer.height()?(this.animate(this.$allBlogsContainer,"height",this.$blogChangeContainerHeight,350,"ease-in-out").done(t.bind(function(){this.$closeAllBtn.show()},this)),this.$seeAllBtnWrap.addClass("active")):(this.$closeAllBtn.hide(),this.animate(this.$allBlogsContainer,"height",0,350,"ease-in-out"),this.$seeAllBtnWrap.removeClass("active"))}});return r}),define("modules/cxense-recommends/cxense-recommends",["jquery","underscore","state","utils","modules/cxense-recommends/cxense-base"],function(e,t,i,n,s){var o=s.extend({initialize:function(e){this.$itemsWrap=this.$(this.selectors.itemsWrap),e.cxenseWidgetId=this.$itemsWrap.data("cxense-widget-id"),e.getRecsOnInit=!1,s.prototype.initialize.call(this,e)},renderCxenseModule:function(){this.setCxenseWidth(this.currentCardInfo),this.$itemsWrap.children("li").length||(this.$itemsWrap.hide(),this.renderRecs(this.options.cxenseWidgetId).done(t.bind(function(){this.$itemsWrap.fadeIn(1e3,this._refreshSidebarScroller)},this)))},additionalFormatItemForTemplate:function(e){return{headline:n.smartTruncate(e.title,70)}},setCxenseWidth:function(e){e.sidebarWidth<340?this.$itemsWrap.removeClass("live-feed-wide"):this.$itemsWrap.addClass("live-feed-wide"),this._refreshSidebarScroller()},renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&this.renderCxenseModule()},onCardWidthChange:function(e){var t=e.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=e,t&&this.setCxenseWidth(e)},_refreshSidebarScroller:function(){i.getActiveApp().triggerEvent("refreshSidebarScroll")},openSideBar:function(){this.renderCxenseModule()}});return o}),define("modules/rentals-apartments-ad",["jquery","baseview","state","directAdPosition","managers/routemanager"],function(e,t,i,n,s){var o=t.extend({events:{"click .js-rad-search-btn":"aptAffWidget"},layoutType:"",renderedAd:!1,createAdPosition:function(t){return new n({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag")})},renderAd:function(){if(!this.renderedAd){this.renderedAd=!0;var e=this.$(".js-rad-google-ad")[0];e&&(this.subviews.adPositionOne=this.createAdPosition(e))}},destroyAd:function(){this.renderedAd&&(this.subviews.adPositionOne.destroy(),this.renderedAd=!1)},initialize:function(e){t.prototype.initialize.call(this),this.layoutType=e.layoutType},isSidebarModule:function(){return"sidebar"===this.layoutType},isPrimaryWellModule:function(){return"primary"===this.layoutType},handleCardSizeChange:function(e){this.isSidebarModule()?e.sidebarAds===!0?(this.$(".js-rad-sidebar-ad").removeClass("rad-hide-ad"),this.renderAd()):(this.$(".js-rad-sidebar-ad").addClass("rad-hide-ad"),this.destroyAd()):this.isPrimaryWellModule()&&(e.sidebarOpen===!0?this.destroyAd():this.renderAd());var t=this.$(".js-rad-wrap");e.sidebarOpen===!0?(t.removeClass("rad-wrap-margin"),"primary"===this.layoutType&&t.addClass("rad-dynamic-height"),this.$(".js-rad-wrap-primary").removeClass("rad-top-border"),this.$(".js-rad-google-ad").removeClass("rad-dynamic-margin")):(t.addClass("rad-wrap-margin"),"primary"===this.layoutType&&t.removeClass("rad-dynamic-height"),this.$(".js-rad-wrap-primary").addClass("rad-top-border"),this.$(".js-rad-google-ad").addClass("rad-dynamic-margin"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)},aptAffWidget:function(){var t,i,n,o,a;return t=this.$(".js-rad-form-city").val(),i=this.$(".js-rad-form-bedrooms").val(),n=this.$(".js-rad-form-bathrooms").val(),o=this.$(".js-rad-form-rent").val(),a="http://www.apartments.com/search/?query="+t,t?(i&&(a+="&bedchkvalue="+i),n&&(a+="&bathchkvalue="+n),o&&(a+="&rentmax="+o),a+="&stype=CityStateOrZip",s.goTo(a)):e(".js-rad-form-city").focus(),!1}});return o}),define("modules/stories/expandable-photo",["jquery","underscore","baseview","utils","modules/myCapture/myCapture"],function(e,t,i,n,s){var o=i.extend({events:{"click .expandable-collapsed":"expandPhoto","click .expandable-open":"collapsePhoto"},sized:!1,parentHeight:!1,expandPhoto:function(){var t=this.$(".single-photo"),i=this.$(".image-credit-wrap"),o=e(".story-highlights");this.parentHeight=this.$el.parent().height(),n.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","ENABLED")&&!this.subviews.mycapture&&(this.subviews.mycapture=new s({el:this.$el})),this.subviews.mycapture&&t.find(".js-mycapture-btn-small").length&&this.subviews.mycapture.switchMyCaptureBtn(this),this.$el.parent().height(this.parentHeight),o.fadeTo(200,0),i.hide(),t.animate({width:"540px"},350,function(){i.fadeIn(250),t.removeClass("expandable-collapsed").addClass("expandable-open")})},collapsePhoto:function(i){if(!e(i.target).is(".js-mycapture-btn")){var n=this.$(".single-photo"),s=this.$(".image-credit-wrap"),o=e(".story-highlights");this.subviews.mycapture&&s.find(".js-mycapture-btn").length&&this.subviews.mycapture.switchMyCaptureBtn(this),s.hide(),n.animate({width:"180px"},350,t.bind(function(){s.fadeIn(),o.fadeTo(500,1),n.removeClass("expandable-open").addClass("expandable-collapsed")},this))}}});return o}),define("modules/home-finder/home-carousel",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,n,s){"use strict";var o=i.extend({events:{"click .mpa-hf-ft-next-btn":"nextHouse","click .mpa-hf-ft-previous-btn":"previousHouse"},initialize:function(n){n=e.extend({auto:!0,time:5e3},n),this.$featuredHouses=this.$(".mpa-hf-wrap"),this.$houses=this.$featuredHouses.find(".mpa-hf-ft-block"),this.totalHouses=this.$houses.length,this.$paginatorBullets=this.$(".paginator-indicator-bullet"),this.$activePaginator=this.$(".paginator-indicator-target"),this.subviews={},this.indexSelector=0,this.homesPerSlide=3,this.carousel={houses:[],width:[0]},t.bindAll(this,"goTo","goToNextHome"),this.subviews.paginator=new s({el:this.$(".paginator"),onGoTo:this.goTo}),this.createCarousel(this.$houses),this.controlsCarousel(),i.prototype.initialize.call(this,n)},nextHouse:function(){this._getSlideIn(),this._fadeInSlide()},previousHouse:function(){this._getSlideOut(),this._fadeInSlide()},createCarousel:function(t){var i=this,n=0;e.each(t,function(t){i.carousel.houses.push(this),n+=i._getWidth(e(this)),(parseInt(t)+1)%i.homesPerSlide===0&&i.carousel.width.push(n)})},resetAutoRotate:function(){clearInterval(this.slideChangeInterval),this.slideChangeInterval=setInterval(this.goToNextHome,this.options.time)},goToNextHome:function(){this.indexSelector++,this.goTo(this.indexSelector)},goTo:function(e){e>=this.totalHouses/this.homesPerSlide?e=0:0>e&&(e=this.totalHouses-1),this.indexSelector=e,this.$paginatorBullets.removeClass("active"),this.$(".paginator-indicator-bullet").eq(this.indexSelector).addClass("active"),this.controlsCarousel(),this.animate(this.$featuredHouses,"right",this.carousel.width[e],200,"ease-in-out")},_fadeInSlide:function(){this.goTo(this.indexSelector)},controlsCarousel:function(){var t=e(".mpa-hf-ft-previous-btn"),i=e(".mpa-hf-ft-next-btn");t.toggleClass("mpa-closed",0===this.indexSelector),i.toggleClass("mpa-closed",this.indexSelector==this.$activePaginator.length-1),this.$houses.length>this.homesPerSlide&&this.resetAutoRotate()},_getSlideIn:function(){this.indexSelector=this.$paginatorBullets.filter(".active").parent().next().index()},_getSlideOut:function(){this.indexSelector=this.$paginatorBullets.filter(".active").parent().prev().index()},_getWidth:function(e){return e.outerWidth()},destroy:function(e){clearInterval(this.slideChangeInterval),i.prototype.destroy.call(this,e)}});return o}),define("ui/tooltip",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({initialize:function(n){n=e.extend({text:this.$el.data("tooltip-text"),customContainerClass:"ui-tooltip",customPanelClass:"",showEvent:"mouseenter",hideEvent:"mouseleave",onShow:null,onHide:null,position:"right"},n),i.prototype.initialize.call(this,n),this._tooltipText=this.options.text,this.$tooltipPanel=this._buildHtml(this.$el),this.$tooltipPanel.addClass("ui-tooltip-panel-"+this.options.position),t.bindAll(this,"show","hide"),this._addTriggerEvent(this.options.showEvent,this.show),this._addTriggerEvent(this.options.hideEvent,this.hide)},_addTriggerEvent:function(e,t){e&&this.$el.on(e+"."+this.cid,t)},_buildHtml:function(t){var i=e('<div class="'+this.options.customContainerClass+'">');t.wrap(i);var n=e('<div class="ui-tooltip-panel '+this.options.customPanelClass+'">'+this.options.text+"</div>");return n.insertAfter(t),n},isPanelShowing:function(){return this._isPanelShowing},show:function(){this.$tooltipPanel.css(this._getPositionCss(this.options.position)),this.$tooltipPanel.stop().fadeIn(400),this._isPanelShowing=!0,this.options.onShow&&this.options.onShow()},hide:function(){this.$tooltipPanel.stop().fadeOut(400),this._isPanelShowing=!1,this.options.onHide&&this.options.onHide()},_getPositionCss:function(e){var t=10,i=this.$tooltipPanel.outerHeight(),n=this.$tooltipPanel.outerWidth(),s=this.$el.outerWidth(),o=this.$el.outerHeight();return"right"===e?{top:-(i/2)+o/2,left:s+t}:"left"===e?{top:-(i/2)+o/2,right:s+t}:"top"===e?{bottom:o+t,left:-(n/2)+s/2}:"bottom"===e?{top:o+t,right:-(n/2)+s/2}:{}},getText:function(){return this._tooltipText},setText:function(e){this.$tooltipPanel.text(e),this._tooltipText=e,this.isPanelShowing()&&this.$tooltipPanel.css(this._getPositionCss(this.options.position))},destroy:function(e){this.$el.off("."+this.cid),this.$el.unwrap(),this.$tooltipPanel.remove(),i.prototype.destroy.call(this,e)}});return n}),define("modules/videos/video-gallery",["jquery","underscore","baseview","pubsub","utils","state","modules/carousel/gallery","modules/videos/brightcove-video","modules/carousel/thumbs","ui/tooltip","modules/stories/taboola-recommendations","modules/scroller/horizontal-scroll","managers/autoplay"],function(e,t,i,n,s,o,a,r,l,h,d,c,u){"use strict";var p=i.extend({events:{"click .carousel-prev":"onClickPrevArrow","click .carousel-next":"onClickNextArrow"},initialize:function(n){n=e.extend({viewportSelector:".gallery-viewport",slidesContainerSelector:".gallery-slides",slidesSelector:".gallery-slide",hoverTransition:0,scrollerColor:"light",thumbsSelector:".vgm-thumbs",tooltipOptions:null},n),t.bindAll(this,"_transitionSlides","_getOnStatusChangeMethod","_getOnClickPlayVideoMethod","goToNextVideo","getIntermediateRecommendation","startAutoPlay"),this.$viewport=this.$(n.viewportSelector),this.$slidesContainer=this.$viewport.find(n.slidesContainerSelector),this.$slides=this.$slidesContainer.find(n.slidesSelector),this.$arrows=this.$(".carousel-prev, .carousel-next"),this.$title=this.$(".video-gallery-page-title"),this.subviewPrefix="galleryItem";var o=e.extend(n,{animations:{useCSSTransitions:!1}});i.prototype.initialize.call(this,o),this.index=this.$(".vgm-thumb-item.active").index(),this.subviews.gallery=new a({el:this.$el,slideTransition:200,ads:!1,index:0,lookAheadAmount:3,transitionSlides:this._transitionSlides}),this._initializeThumbs(n.hoverTransition,n.scrollerColor,n.thumbsSelector),this._initializeTooltips(this.$(".vgm-thumb-box")),this.goTo(this.index).done(t.bind(function(){var e=s.getNested(this.getPlayerSubview(this.index),"player","autoplay");(void 0===e||e)&&u.register("brightcove-video",this.startAutoPlay)},this))},startAutoPlay:function(){return this.startVideo(this.index),n.trigger("uotrack","videoplaylist|nextauto"),!0},_initializeThumbs:function(e,t,i){this.subviews.thumbs=new l({el:i?this.$(i):this.$el,hoverTransition:e,index:this.index,scrollerColor:t,carousel:this})},_initializeTooltips:function(i){t.each(i,function(t,i){this._setupTooltipView(t,e(t).data("duration"),i)},this)},_setupTooltipView:function(t,i,n){var s=e.extend({el:t,text:i,customContainerClass:"vgm-ui-tooltip",position:"bottom"},this.options.tooltipOptions),o=this.subviewPrefix+n;this.subviews[o]||(this.subviews[o]=new h(s))},onVideoStatusChange:function(e,t){if("mediaComplete"===e.type){var i=this.getActiveSlideIndex(),n=i+1,o=this.$slides.length-1;if(s.getNested(this.getPlayerSubview(i),"player","gannett_continuous_endslate")&&!this.subviews["intermediateEndslate"+i])return void this.displayEndslate();o>=n&&this.goToNextVideo()}this.getActiveSlideIndex()===t||"mediaBegin"!==e.type&&"mediaPlay"!==e.type||this.enterBackgroundState(t)},onClickPrevArrow:function(e){e.preventDefault();var i=this.getActiveSlideIndex()-1;this.goTo(i).done(t.bind(function(){this.startVideo(i),this.triggerEvent("goToSlide",i),n.trigger("uotrack","videoplaylist|prev")},this))},onClickNextArrow:function(e){e.preventDefault();var i=this.getActiveSlideIndex()+1;this.goTo(i).done(t.bind(function(){this.startVideo(i),this.triggerEvent("goToSlide",i),n.trigger("uotrack","videoplaylist|next")},this))},switchSlide:function(e){var i=this.getActiveSlideIndex();this.goTo(e).done(t.bind(function(){this.startVideo(e),this.triggerEvent("goToSlide",e),n.trigger("uotrack","videoplaylist"+(e+1)),void 0!==i&&this.enterBackgroundState(i)},this))},startVideo:function(e){var t=this.getPlayerSubview(e);t&&t.playVideo()},enterBackgroundState:function(e){var t=this.getPlayerSubview(e);t&&t.reset()},goTo:function(e){var i=this.getActiveSlideIndex();return this.updateArrows(e),this._activeSlide=e,this.subviews.gallery.goToSlide(e).done(t.bind(function(){var t=this.subviews["video"+e],n=this.$slides.eq(e).find(".ui-video");!t&&void 0!==e&&n.length&&(this.subviews["video"+e]=new r({el:n[0],onStatusChange:this._getOnStatusChangeMethod(e),onClickPlay:this._getOnClickPlayVideoMethod(e),overrideGetRecommendations:this.getIntermediateRecommendation,autoPlay:!1})),void 0!==i&&this.enterBackgroundState(i)},this))},getIntermediateRecommendation:function(){var e=this.getActiveSlideIndex(),t="",i=e+1,n=this.$slides.length-1,s=this.getPlayerSubview(e);n>=i?(t=this.$slides.eq(i).find(".ui-video-data").html(),this.videoresponse=JSON.parse(t)):i>n&&(this.subviews.TaboolaOutbrain||(this.subviews.TaboolaOutbrain=new d,this.subviews.TaboolaOutbrain.renderEndslate(s.video.url,s.video.brightcove_id)))},displayEndslate:function(){var e=this.getActiveSlideIndex(),t=e+1,i=this.$slides.length-1,n=this.getPlayerSubview(e),s=this.$slides.eq(e).find(".video-endslate");i>=t?n.player.gannett_continuous_endslate&&(this.subviews["intermediateEndslate"+e]||(this.subviews["intermediateEndslate"+e]=new d({videoResponse:this.videoresponse,endCountdown:this.goToNextVideo}),this.subviews["intermediateEndslate"+e].populateEndslate(s,n.player.mediatemplate))):t>i&&n.player.gannett_continuous_endslate&&this.subviews.TaboolaOutbrain.populateEndslate(s,n.player.mediatemplate)},goToNextVideo:function(){var e=this.getActiveSlideIndex()+1;this.goTo(e).done(t.bind(function(){this.startVideo(e),this.triggerEvent("goToSlide",e),n.trigger("uotrack","videoplaylist|nextauto")},this))},_transitionSlides:function(e){var t=this.$viewport.outerWidth(),i=t*e*-1,n=this.$slidesContainer;return this.animate(n,"left",i+"px",250,"easeInOutQuad")},getPlayerSubview:function(e){return this.subviews["video"+e]},_getOnClickPlayVideoMethod:function(e){return t.bind(function(t){this.onClickPlayVideo(t,e)},this)},onClickPlayVideo:function(e,t){this.startVideo(t)},_getOnStatusChangeMethod:function(e){return t.bind(function(t){this.onVideoStatusChange(t,e)},this)},getActiveSlideIndex:function(){return this._activeSlide},updateArrows:function(e){var t;this.$slides.length<=1||(this.$arrows.addClass("gallery-nav-active"),0===e?t="prev":e===this.$slides.length-1&&(t="next"),this.$arrows.filter(".carousel-"+t).removeClass("gallery-nav-active"))}});return p}),define("modules/longform/longform-inline-share",["jquery","baseview","pubsub"],function(e,t,i){"use strict";var n=t.extend({events:{"click .lf-share-item":"onSocialButtonClick"},onSocialButtonClick:function(t){e(t.target).hasClass("lf-share-comments")?(i.trigger("onClickShare","comments"),t.preventDefault()):e(t.target).hasClass("lf-share-email")&&(i.trigger("onClickShare","email"),t.preventDefault())}});return n}),define("modules/weather/weather-twentyfour-hour",["jquery","underscore","baseview","state"],function(e,t,i){"use strict";var n=i.extend({el:".weather-twentyfour-hour-wrapper",events:{"click .paginator-indicator-bullet":"toggleTwelve"},initialize:function(e){this.$slide=this.$(".weather-twentyfour-hour-wrapper .slide"),this.$nextTwelve=this.$("#current12"),this.$currentTwelve=this.$("#next12"),i.prototype.initialize.call(this,e)},toggleTwelve:function(t){this.$clicked=e(t.currentTarget).attr("id"),this.$isActive=e(t.currentTarget).hasClass("active"),this.$isActive||"next12"!=this.$clicked?this.$isActive||"current12"!=this.$clicked||(this.$currentTwelve.removeClass("active"),this.$nextTwelve.addClass("active"),this.$slide.animate({left:"0px"},500)):(this.$nextTwelve.removeClass("active"),this.$currentTwelve.addClass("active"),this.$slide.animate({left:"-686px"},500))}});return n}),define("modules/wsi-defcon-map/wsi-defcon-map",["jquery","underscore","baseview","state","utils"],function(e,t,i,n,s){"use strict";var o=i.extend({el:".wsi-defcon-map-module-wrapper",initialize:function(e){i.prototype.initialize.call(this,e),s.requireSingleUseScript("http://tessera.intellicast.com/Client/Javascript/wxmap.loader.min.js")}});return o}),define("ui/loader",["jquery","underscore","baseview","pubsub","utils"],function(e,t,i,n,s){"use strict";var o=i.extend({initialize:function(t){this.options=e.extend({msg:""},t),this.win=s.get("win"),this.body=s.get("body"),this.el=e(this.options.el),this.msg=this.options.msg,this.render()},render:function(){var t=e("<div>").addClass("loading-icon");this.$loader=e("<div>").addClass("ui-loader"),this.$target=this.$el,this.$target.append(this.$loader.append(t).append(e("<span>").html(this.msg))),this.$el=this.$loader},destroy:function(){this.hide(),i.prototype.destroy.apply(this,arguments)},show:function(){this.$loader.addClass("active")},hide:function(){this.$loader.removeClass("active")}});return o}),define("touchswipe",["jquery"],function(e){function t(t){return!t||void 0!==t.allowPageScroll||void 0===t.swipe&&void 0===t.swipeStatus||(t.allowPageScroll=h),t||(t={}),t=e.extend({},e.fn.swipe.defaults,t),this.each(function(){var n=e(this),s=n.data(y);s||(s=new i(this,t),n.data(y,s))})}function i(t,i){function w(t){if(!(O()||e(t.target).closest(i.excludedElements,et).length>0)){t=t.originalEvent;var n,s=b?t.touches[0]:t;return tt=f,b?it=t.touches.length:t.preventDefault(),G=0,Y=null,Q=null,X=0,Z=0,J=0,K=1,nt=j(),!b||it===i.fingers||i.fingers===p||F()?(nt[0].start.x=nt[0].end.x=s.pageX,nt[0].start.y=nt[0].end.y=s.pageY,st=R(),2==it&&(nt[1].start.x=nt[1].end.x=t.touches[1].pageX,nt[1].start.y=nt[1].end.y=t.touches[1].pageY,Z=J=P(nt[0].start,nt[1].start)),(i.swipeStatus||i.pinchStatus)&&(n=S(t,tt))):(x(t),n=!1),n===!1?(tt=v,S(t,tt),n):(z(!0),et.bind(W,_),et.bind(q,C),void 0)}}function _(e){if(e=e.originalEvent,tt!==m&&tt!==v){var t,n=b?e.touches[0]:e;if(nt[0].end.x=b?e.touches[0].pageX:n.pageX,nt[0].end.y=b?e.touches[0].pageY:n.pageY,ot=R(),Y=M(nt[0].start,nt[0].end),b&&(it=e.touches.length),tt=g,2==it&&(0==Z?(nt[1].start.x=e.touches[1].pageX,nt[1].start.y=e.touches[1].pageY,Z=J=P(nt[0].start,nt[1].start)):(nt[1].end.x=e.touches[1].pageX,nt[1].end.y=e.touches[1].pageY,J=P(nt[0].end,nt[1].end),Q=I(nt[0].end,nt[1].end)),K=D(Z,J)),it!==i.fingers&&i.fingers!==p&&b)tt=v,S(e,tt);else if(k(e,Y),G=L(nt[0].start,nt[0].end),X=$(nt[0].start,nt[0].end),(i.swipeStatus||i.pinchStatus)&&(t=S(e,tt)),!i.triggerOnTouchEnd){var s=!A();T()===!0?(tt=m,t=S(e,tt)):s&&(tt=v,S(e,tt))}t===!1&&(tt=v,S(e,tt))}}function C(e){if(e=e.originalEvent,e.touches&&e.touches.length>0)return!0;if(e.preventDefault(),ot=R(),0!=Z&&(J=P(nt[0].end,nt[1].end),K=D(Z,J),Q=I(nt[0].end,nt[1].end)),G=L(nt[0].start,nt[0].end),Y=M(nt[0].start,nt[0].end),X=$(),i.triggerOnTouchEnd||i.triggerOnTouchEnd===!1&&tt===g){tt=m;var t=B()||!F(),n=it===i.fingers||i.fingers===p||!b,s=0!==nt[0].end.x,o=n&&s&&t;if(o){var a=A(),r=T();r!==!0&&null!==r||!a?a&&r!==!1||(tt=v,S(e,tt)):S(e,tt)}else tt=v,S(e,tt)}else tt===g&&(tt=v,S(e,tt));et.unbind(W,_,!1),et.unbind(q,C,!1),z(!1)}function x(){it=0,ot=0,st=0,Z=0,J=0,K=1,z(!1)}function S(e,t){var h=void 0;if(i.swipeStatus&&(h=i.swipeStatus.call(et,e,t,Y||null,G||0,X||0,it)),i.pinchStatus&&B()&&(h=i.pinchStatus.call(et,e,t,Q||null,J||0,X||0,it,K)),t===v&&(!i.click||1!==it&&b||!isNaN(G)&&0!==G||(h=i.click.call(et,e,e.target))),t==m){switch(i.swipe&&(h=i.swipe.call(et,e,Y,G,X,it,i)),Y){case n:i.swipeLeft&&(h=i.swipeLeft.call(et,e,Y,G,X,it,i));break;case s:i.swipeRight&&(h=i.swipeRight.call(et,e,Y,G,X,it,i));break;case o:i.swipeUp&&(h=i.swipeUp.call(et,e,Y,G,X,it,i));break;case a:i.swipeDown&&(h=i.swipeDown.call(et,e,Y,G,X,it,i))}switch(Q){case r:i.pinchIn&&(h=i.pinchIn.call(et,e,Q||null,J||0,X||0,it,K));break;case l:i.pinchOut&&(h=i.pinchOut.call(et,e,Q||null,J||0,X||0,it,K))}}return(t===v||t===m)&&x(e),h}function T(){return null!==i.threshold?G>=i.threshold:null}function A(){var e;return e=i.maxTimeThreshold&&X>=i.maxTimeThreshold?!1:!0}function k(e,t){if(i.allowPageScroll===h||F())e.preventDefault();else{var r=i.allowPageScroll===d;switch(t){case n:(i.swipeLeft&&r||!r&&i.allowPageScroll!=c)&&e.preventDefault();break;case s:(i.swipeRight&&r||!r&&i.allowPageScroll!=c)&&e.preventDefault();break;case o:(i.swipeUp&&r||!r&&i.allowPageScroll!=u)&&e.preventDefault();break;case a:(i.swipeDown&&r||!r&&i.allowPageScroll!=u)&&e.preventDefault()}}}function $(){return ot-st}function P(e,t){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return Math.round(Math.sqrt(i*i+n*n))}function D(e,t){var i=t/e*1;return i.toFixed(2)}function I(){return 1>K?l:r}function L(e,t){return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function E(e,t){var i=e.x-t.x,n=t.y-e.y,s=Math.atan2(n,i),o=Math.round(180*s/Math.PI);return 0>o&&(o=360-Math.abs(o)),o}function M(e,t){var i=E(e,t);return 45>=i&&i>=0?n:360>=i&&i>=315?n:i>=135&&225>=i?s:i>45&&135>i?a:o}function R(){var e=new Date;return e.getTime()}function N(){et.unbind(U,w),et.unbind(V,x),et.unbind(W,_),et.unbind(q,C),z(!1)}function F(){return i.pinchStatus||i.pinchIn||i.pinchOut}function B(){return Q&&F()
}function O(){return et.data(y+"_intouch")===!0?!0:!1}function z(e){e=e===!0?!0:!1,et.data(y+"_intouch",e)}function j(){for(var e=[],t=0;5>=t;t++)e.push({start:{x:0,y:0},end:{x:0,y:0},delta:{x:0,y:0}});return e}var H=b||!i.fallbackToMouseEvents,U=H?"touchstart":"mousedown",W=H?"touchmove":"mousemove",q=H?"touchend":"mouseup",V="touchcancel",G=0,Y=null,X=0,Z=0,J=0,K=1,Q=0,et=e(t),tt="start",it=0,nt=null,st=0,ot=0;try{et.bind(U,w),et.bind(V,x)}catch(at){e.error("events not supported "+U+","+V+" on jQuery.swipe")}this.enable=function(){return et.bind(U,w),et.bind(V,x),et},this.disable=function(){return N(),et},this.destroy=function(){return N(),et.data(y,null),et}}var n="left",s="right",o="up",a="down",r="in",l="out",h="none",d="auto",c="horizontal",u="vertical",p="all",f="start",g="move",m="end",v="cancel",b="ontouchstart"in window,y="TouchSwipe",w={fingers:1,threshold:75,maxTimeThreshold:null,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,triggerOnTouchEnd:!0,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"};e.fn.swipe=function(i){var n=e(this),s=n.data(y);if(s&&"string"==typeof i){if(s[i])return s[i].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+i+" does not exist on jQuery.swipe")}else if(!(s||"object"!=typeof i&&i))return t.apply(this,arguments);return n},e.fn.swipe.defaults=w,e.fn.swipe.phases={PHASE_START:f,PHASE_MOVE:g,PHASE_END:m,PHASE_CANCEL:v},e.fn.swipe.directions={LEFT:n,RIGHT:s,UP:o,DOWN:a,IN:r,OUT:l},e.fn.swipe.pageScroll={NONE:h,HORIZONTAL:c,VERTICAL:u,AUTO:d},e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:p}}),define("modules/interactives/interactive-ads",["jquery","underscore","backbone","pubsub","utils","baseview","directAdPosition"],function(e,t,i,n,s,o,a){var r=o.extend({initialize:function(e){o.prototype.initialize.call(this,e),this.$el.length>0&&this.setupAds()},setupAds:function(){var e=this.$el.data(),t={title:e.seoTitle,series:e.series,sitePage:"usat/"+(e.ssts||"").replace(/\/\/*$/,""),topic:e.topic};this.subviews.sponsorshipAd=new a({el:this.$el,adPlacement:"sponsor_logo/interactive",adSizes:["sponsor_logo"],targeting:t})}});return r}),define("modules/interactives/interactive-templates",["jquery","underscore","state","pubsub","utils","baseview","ui/loader","modules/global/brightcove-video","ui/generic-paginator","touchswipe","meteredAdPosition","adLogger","modules/interactives/interactive-ads"],function(e,t,i,n,s,o,a,r,l,h,d,c,u){var p=o.extend({el:".interactive",events:{"click .slide-nav.prev, .slide-nav.next":"onArrowClick","click .navigation li":"onNavClick"},initialize:function(i){t.bindAll(this,"beforePaginatorClick","goTo"),i=e.extend({ads:!1,adSponsor:!1,adTransition:!1,ignoreFirstNav:!1,interactiveType:"",isFramed:!1,standAlone:!1},i),this.$leftArrow=this.$(".slide-nav.prev"),this.$rightArrow=this.$(".slide-nav.next"),this.$viewport=this.$(".viewport"),this.$slideContainer=this.$viewport.find(".slides"),this.$slides=this.$slideContainer.find(".slide"),this.$navigation=this.$(".navigation"),this.$navigationItems=this.$navigation.find("li"),this.slideNum=this.$slides.length,e(this.$slides[this.$slides.length-1]).hasClass("partner-slide-ad")&&(this.slideNum-=1),this.slideWidth=this.$slides.outerWidth(),this.slideHeight=this.$slides.outerHeight(),this.slideWidthPad="sequencer"===this.options.interactiveType?this.$(".stage").outerWidth()-this.slideWidth:0,this.maxSlides=this.slideNum,this.$slideContainer.width(this.maxSlides*this.slideWidth),this.currentSlideIndex=0,this.subviews={},this.setupSwipes(),this.$viewport.hasClass("slide")&&this.$slides.css({display:"inline-block"}),o.prototype.initialize.call(this,i),this.subviews.video=[],this.subviews.paginator=new l({onBeforePaginator:this.beforePaginatorClick,el:this.$(".paginator"),onGoTo:this.goTo}),this.setupAds()},beforePaginatorClick:function(e){var t=e<this.currentSlideIndex?"left":"right";return!this.showingAd&&this.shouldShowAd()?(this.showAd(t),!1):(this.options.isFramed!==!0&&this.trackPageView(),!0)},goTo:function(e){this._switchSlides(this._getSlideIn(e),this._getSlideOut())},onArrowClick:function(t){var i=e(t.currentTarget).is(this.$leftArrow)?"left":"right";return"chronology"!==this.options.interactiveType&&"beforeandafter"!==this.options.interactiveType||this.options.isFramed===!0||this.trackPageView(),!this.showingAd&&this.shouldShowAd()?(this.showAd(i),!1):this.showingAd&&this.showingAd.index()===this.currentSlideIndex?(this.subviews.paginator.goToPage("left"===i?this.currentSlideIndex-1:this.currentSlideIndex),!1):("left"===i?this.previousSlide():this.nextSlide(),!1)},onNavClick:function(t){var i=e(t.currentTarget),n=i.parent().find("li"),s=n.index(i);return 0===s&&this.options.ignoreFirstNav?!1:(this.options.ignoreFirstNav&&s--,this.goTo(s),!1)},onSwipeSlide:function(e,t,i,n,s,o){"right"===t||"down"===t?o.self.previousSlide():o.self.nextSlide()},previousSlide:function(){if(this.subviews.paginator.$el.length<1){var e=this.currentSlideIndex>0?this.currentSlideIndex-1:this.slideNum-1;this.goTo(e)}else this.subviews.paginator.goToPrevPage(this.currentSlideIndex)},nextSlide:function(){if(this.subviews.paginator.$el.length<1){var e=this.currentSlideIndex<this.slideNum-1?this.currentSlideIndex+1:0;this.goTo(e)}else this.subviews.paginator.goToNextPage(this.currentSlideIndex)},setupAds:function(){if(this.options.ads){this.subviews.interactiveAds=new u({el:this.$(".interactive-sponsor")});var e=this.$el.data(),t={title:e.seoTitle,series:e.series,sitePage:"usat/"+(e.ssts||"").replace(/\/\/*$/,""),topic:e.topic},i=this.$viewport.width(),n=this.$viewport.height();450>n||600>i?c.logWarn("Advertisement viewport is too small: "+i+"x"+n):(this.$adSlide=this.$(".partner-slide-ad"),this.$adSlide.length>0&&(this.options.adTransition=!0,this.$adContents=this.$adSlide.find(".interactive-ad"),this.subviews.ad=new d({el:this.$adContents,adPlacement:"transition_interactive/"+e.cst,adSizes:["elastic"],meterThreshold:"transition_interactive",rateMeterId:"asset_"+e.interactiveId,targeting:t})))}},setupSwipes:function(){if(Modernizr.touch&&"beforeandafter"!==this.options.interactiveType&&"timeline"!==this.options.interactiveType){var e=this;this.$slideContainer.swipe({self:e,swipe:e.onSwipeSlide})}},shouldShowAd:function(){return!this.showingAd&&this.options.ads&&this.subviews.ad&&this.subviews.ad.shouldShowAd()?!0:!1},showAd:function(e){var i=this._getSlideOut();if(this.showingAd=this.$adSlide,this.$adContents.show(),i[0]!==this.showingAd[0]){var n=this.showingAd.detach();"left"===e?n.insertBefore(i):"right"===e&&n.insertAfter(i),this.$slides=this.$slideContainer.find(".slide"),this._switchSlides(this.showingAd,i,e).done(t.bind(function(){this.$slides.removeClass("active"),this.subviews.ad.playAd()},this))}},trackClick:function(e){this.trackFirstClick(),n.trigger("uotrack",e)},trackFirstClick:function(){this.firstClick||(n.trigger("uotrack",this.options.interactiveType+"firstclick"),this.firstClick=!0)},trackPageView:function(){this.trackFirstClick();var t={contenttype:this.$el.data("contenttype"),pathName:this.trackPathName("")},s=i.getActivePageInfo();t=e.extend(s,t),n.trigger("analytics:pageload",t)},trackPathName:function(e){var t;return t=this.options.standAlone===!0?document.location.pathname:"/interactive/"+this.$el.data("interactive-id")+"/",t=this.options.interactiveType+t+this.$el.data("seoTitle")+"/"+e},_getSlideOut:function(){var e;return e=this.showingAd&&this.showingAd.length>0?this.showingAd:this.$slides.eq(this.currentSlideIndex)},_getSlideIn:function(e){this.options.adTransition&&this.$adSlide.index()<=e&&(e+=1);var t=this.$slides.eq(e);return t},_switchSlides:function(i,n){var s,o=n.index(),a=i.index(),l=this.slideWidth*a,h=this.slideHeight*a,d=this.options.adTransition&&this.$adSlide.index()<this.maxSlides?!0:!1;n===this.showingAd&&this.subviews.ad.stopAd(),0===a?(this.$leftArrow.addClass("invisible"),this.$rightArrow.removeClass("invisible")):a===this.maxSlides-1&&!d||a===this.maxSlides&&d?(this.$leftArrow.removeClass("invisible"),this.$rightArrow.addClass("invisible")):(this.$leftArrow.removeClass("invisible"),this.$rightArrow.removeClass("invisible")),t.each(this.subviews.video,function(e){e.destroy(!1,!0)}),this.subviews.video=[];var c=a;if(this.options.ignoreFirstNav&&c++,this.$navigationItems.removeClass("active").eq(c).addClass("active"),this.$viewport.hasClass("slide")||this.$viewport.hasClass("slide-transition"))s=this.animate(this.$slideContainer,"left",-1*l+this.slideWidthPad+"px",400,"ease-in-out",0).done(t.bind(function(){this.showingAd&&n[0]===this.showingAd[0]&&(this.subviews.ad.refreshPosition(),"none"!==this.$adContents.css("display")&&this.$adContents.hide(),this.showingAd=null)},this));else if(this.$viewport.hasClass("vslide-transition"))s=this.animate(this.$slideContainer,"top",-1*h+"px",400,"ease-in-out",0).done(t.bind(function(){this.showingAd&&n[0]===this.showingAd[0]&&(this.subviews.ad.refreshPosition(),"none"!==this.$adContents.css("display")&&this.$adContents.hide(),this.showingAd=null)},this));else if(this.$viewport.hasClass("fade")||this.$viewport.hasClass("fade-transition")){var u=this.$slides.eq(a),p=this.$slides.eq(o);a!==o?(p.css({"z-index":1}),u.css({"z-index":2,opacity:0,display:"block"}),s=this.animate(u,"opacity",1,400,"linear").done(function(){p.css({opacity:0,display:"none"})})):(u.css({opacity:0,display:"block"}),s=this.animate(u,"opacity",1,400,"linear"))}this.$slides.removeClass("active").eq(a).addClass("active");var f=this;return e.each(this.$slides.eq(a).find(".video"),function(){var t=new r({el:e(this).get(0),autostart:!0});f.subviews.video.push(t)}),this.currentSlideIndex=a,s}});return p}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/core",["jquery"],e):e(jQuery)}(function(e){function t(t,n){var s,o,a,r=t.nodeName.toLowerCase();return"area"===r?(s=t.parentNode,o=s.name,t.href&&o&&"map"===s.nodeName.toLowerCase()?(a=e("img[usemap='#"+o+"']")[0],!!a&&i(a)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),n="absolute"===i,s=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=e(this);return n&&"static"===t.css("position")?!1:s.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var n=e.attr(i,"tabindex"),s=isNaN(n);return(s||n>=0)&&t(i,!s)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function n(t,i,n,o){return e.each(s,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var s="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?a["inner"+i].call(this):this.each(function(){e(this).css(o,n(this,t)+"px")})},e.fn["outer"+i]=function(t,s){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){e(this).css(o,n(this,t,!0,s)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,n,s=e(this[0]);s.length&&s[0]!==document;){if(i=s.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(n=parseInt(s.css("zIndex"),10),!isNaN(n)&&0!==n))return n;s=s.parent()}return 0}}),e.ui.plugin={add:function(t,i,n){var s,o=e.ui[t].prototype;for(s in n)o.plugins[s]=o.plugins[s]||[],o.plugins[s].push([i,n[s]])},call:function(e,t,i,n){var s,o=e.plugins[t];if(o&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(s=0;s<o.length;s++)e.options[o[s][0]]&&o[s][1].apply(e.element,i)}}}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/widget",["jquery"],e):e(jQuery)}(function(e){var t=0,i=Array.prototype.slice;return e.cleanData=function(t){return function(i){var n,s,o;for(o=0;null!=(s=i[o]);o++)try{n=e._data(s,"events"),n&&n.remove&&e(s).triggerHandler("remove")}catch(a){}t(i)}}(e.cleanData),e.widget=function(t,i,n){var s,o,a,r,l={},h=t.split(".")[0];return t=t.split(".")[1],s=h+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[h]=e[h]||{},o=e[h][t],a=e[h][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,o,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(n,function(t,n){return e.isFunction(n)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},s=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=s,t=n.apply(this,arguments),this._super=i,this._superApply=o,t}}()):void(l[t]=n)}),a.prototype=e.widget.extend(r,{widgetEventPrefix:o?r.widgetEventPrefix||t:t},l,{constructor:a,namespace:h,widgetName:t,widgetFullName:s}),o?(e.each(o._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete o._childConstructors):i._childConstructors.push(a),e.widget.bridge(t,a),a},e.widget.extend=function(t){for(var n,s,o=i.call(arguments,1),a=0,r=o.length;r>a;a++)for(n in o[a])s=o[a][n],o[a].hasOwnProperty(n)&&void 0!==s&&(t[n]=e.isPlainObject(s)?e.isPlainObject(t[n])?e.widget.extend({},t[n],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,n){var s=n.prototype.widgetFullName||t;e.fn[t]=function(o){var a="string"==typeof o,r=i.call(arguments,1),l=this;return o=!a&&r.length?e.widget.extend.apply(null,[o].concat(r)):o,this.each(a?function(){var i,n=e.data(this,s);return"instance"===o?(l=n,!1):n?e.isFunction(n[o])&&"_"!==o.charAt(0)?(i=n[o].apply(n,r),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}:function(){var t=e.data(this,s);t?(t.option(o||{}),t._init&&t._init()):e.data(this,s,new n(o,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,s,o,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},n=t.split("."),t=n.shift(),n.length){for(s=a[t]=e.widget.extend({},this.options[t]),o=0;o<n.length-1;o++)s[n[o]]=s[n[o]]||{},s=s[n[o]];if(t=n.pop(),1===arguments.length)return void 0===s[t]?null:s[t];s[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,n){var s,o=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=s=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),e.each(n,function(n,a){function r(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,d=l[2];d?s.delegate(d,h,r):i.bind(h,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var s,o,a=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(s in o)s in i||(i[s]=o[s]);return this.element.trigger(i,n),!(e.isFunction(a)&&a.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,s,o){"string"==typeof s&&(s={effect:s});var a,r=s?s===!0||"number"==typeof s?i:s.effect||i:t;s=s||{},"number"==typeof s&&(s={duration:s}),a=!e.isEmptyObject(s),s.complete=o,s.delay&&n.delay(s.delay),a&&e.effects&&e.effects.effect[r]?n[t](s):r!==t&&n[r]?n[r](s.duration,s.easing,o):n.queue(function(i){e(this)[t](),o&&o.call(n[0]),i()})}}),e.widget}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/mouse",["jquery","./widget"],e):e(jQuery)}(function(e){var t=!1;return e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.11.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,s=1===i.which,o="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return s&&!o&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(i){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&e.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),t=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/draggable",["jquery","./core","./mouse","./widget"],e):e(jQuery)}(function(e){return e.widget("ui.draggable",e.ui.mouse,{version:"1.11.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var i=this.document[0],n=this.options;try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",t,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,n=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,s=this.options,o=this.document[0];return this.relativeContainer=null,s.containment?"window"===s.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===s.containment?void(this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):s.containment.constructor===Array?void(this.containment=s.containment):("parent"===s.containment&&(s.containment=this.helper[0].parentNode),i=e(s.containment),n=i[0],void(n&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,s,o,a=this.options,r=this._isRootNode(this.scrollParent[0]),l=e.pageX,h=e.pageY;
return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),a.grid&&(s=a.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,h=i?s-this.offset.click.top>=i[1]||s-this.offset.click.top>i[3]?s:s-this.offset.click.top>=i[1]?s-a.grid[1]:s+a.grid[1]:s,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,i,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[i,n,this],!0),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,n){var s=n.options,o=e.extend({},i,{item:n.element});n.sortables=[],e(s.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,o))})},stop:function(t,i,n){var s=e.extend({},i,{item:n.element});e.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,s))})},drag:function(t,i,n){var s=this;e.each(n.sortables,function(){var o=!1,a=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(a.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(s).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",t),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",t),n.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,n){var s=e("body"),o=n.options;s.css("cursor")&&(o._cursor=s.css("cursor")),s.css("cursor",o.cursor)},stop:function(t,i,n){var s=n.options;s._cursor&&e("body").css("cursor",s._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,n){var s=e(i.helper),o=n.options;s.css("opacity")&&(o._opacity=s.css("opacity")),s.css("opacity",o.opacity)},stop:function(t,i,n){var s=n.options;s._opacity&&e(i.helper).css("opacity",s._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,n){var s=n.options,o=!1,a=n.scrollParentNotHidden[0],r=n.document[0];a!==r&&"HTML"!==a.tagName?(s.axis&&"x"===s.axis||(n.overflowOffset.top+a.offsetHeight-t.pageY<s.scrollSensitivity?a.scrollTop=o=a.scrollTop+s.scrollSpeed:t.pageY-n.overflowOffset.top<s.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-s.scrollSpeed)),s.axis&&"y"===s.axis||(n.overflowOffset.left+a.offsetWidth-t.pageX<s.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+s.scrollSpeed:t.pageX-n.overflowOffset.left<s.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-s.scrollSpeed))):(s.axis&&"x"===s.axis||(t.pageY-e(r).scrollTop()<s.scrollSensitivity?o=e(r).scrollTop(e(r).scrollTop()-s.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<s.scrollSensitivity&&(o=e(r).scrollTop(e(r).scrollTop()+s.scrollSpeed))),s.axis&&"y"===s.axis||(t.pageX-e(r).scrollLeft()<s.scrollSensitivity?o=e(r).scrollLeft(e(r).scrollLeft()-s.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<s.scrollSensitivity&&(o=e(r).scrollLeft(e(r).scrollLeft()+s.scrollSpeed)))),o!==!1&&e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,n){var s=n.options;n.snapElements=[],e(s.snap.constructor!==String?s.snap.items||":data(ui-draggable)":s.snap).each(function(){var t=e(this),i=t.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,n){var s,o,a,r,l,h,d,c,u,p,f=n.options,g=f.snapTolerance,m=i.offset.left,v=m+n.helperProportions.width,b=i.offset.top,y=b+n.helperProportions.height;for(u=n.snapElements.length-1;u>=0;u--)l=n.snapElements[u].left,h=l+n.snapElements[u].width,d=n.snapElements[u].top,c=d+n.snapElements[u].height,l-g>v||m>h+g||d-g>y||b>c+g||!e.contains(n.snapElements[u].item.ownerDocument,n.snapElements[u].item)?(n.snapElements[u].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[u].item})),n.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(s=Math.abs(d-y)<=g,o=Math.abs(c-b)<=g,a=Math.abs(l-v)<=g,r=Math.abs(h-m)<=g,s&&(i.position.top=n._convertPositionTo("relative",{top:d-n.helperProportions.height,left:0}).top-n.margins.top),o&&(i.position.top=n._convertPositionTo("relative",{top:c,left:0}).top-n.margins.top),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left-n.margins.left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left)),p=s||o||a||r,"outer"!==f.snapMode&&(s=Math.abs(d-b)<=g,o=Math.abs(c-y)<=g,a=Math.abs(l-m)<=g,r=Math.abs(h-v)<=g,s&&(i.position.top=n._convertPositionTo("relative",{top:d,left:0}).top-n.margins.top),o&&(i.position.top=n._convertPositionTo("relative",{top:c-n.helperProportions.height,left:0}).top-n.margins.top),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left-n.margins.left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[u].snapping&&(s||o||a||r||p)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[u].item})),n.snapElements[u].snapping=s||o||a||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,n){var s,o=n.options,a=e.makeArray(e(o.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});a.length&&(s=parseInt(e(a[0]).css("zIndex"),10)||0,e(a).each(function(t){e(this).css("zIndex",s+t)}),this.css("zIndex",s+a.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,n){var s=e(i.helper),o=n.options;s.css("zIndex")&&(o._zIndex=s.css("zIndex")),s.css("zIndex",o.zIndex)},stop:function(t,i,n){var s=n.options;s._zIndex&&e(i.helper).css("zIndex",s._zIndex)}}),e.ui.draggable}),define("modules/interactives/before-after",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","libs/jqueryui/draggable"],function(e,t,i,n,s,o){var a=s.extend({events:function(){var e={"click .image-container":"handleClick"};return e[(Modernizr.touch?"touchstart":"click")+" .before-after-caption-toggle"]="toggleCaption",e},initialize:function(i){i=e.extend({animateIntro:!0,introDelay:1e3,introDuration:1500,introPosition:.5,cursor:"e-resize"},i),s.prototype.initialize.call(this,i),this.$el.length&&(this.subviews.template=new o({el:this.$el,interactiveType:"beforeandafter",isFramed:i.isFramed,standAlone:i.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex),Modernizr.touch?require(["touchpunch"],t.bind(this._setup,this)):this._setup())},destroy:function(){this.$(".before-after-drag-handle").draggable("destroy"),s.prototype.destroy.apply(this,arguments)},_setup:function(){this.destroyed||t.each(this.$(".image-container"),function(t,i){this._setupBeforeAfter(e(t),i)},this)},toggleCaption:function(t){var i=e(t.currentTarget),n=i.closest(".slide").find(".meta"),s=n.is(":visible");n.fadeToggle(function(){i.text(s?"Show Caption":"Hide Caption")}),this.options.isFramed||this.subviews.template.trackClick(s?"beforeandafter_caption_off":"beforeandafter_caption_on")},handleClick:function(t){var i=e(t.currentTarget),n=e(".before-after-drag-handle",i),s=n.width()/2;this.subviews.template.trackFirstClick();var o=t.pageX-i.offset().left;e(".before-after-drag-handle",i).stop().css("left",o-s+"px"),e(".before-after-before-wrapper",i).stop().width(o+"px")},_setupBeforeAfter:function(t,i){function n(){h.width(parseInt(e(this).css("left"),10)+r/2)}var s=t,o=this.options,a=e(".before-after-draw-handle-image",s),r=a.width(),l=e(".before-after-drag-handle",s),h=e(".before-after-before-wrapper",s),d=h.width(),c=h.height(),u=d*o.introPosition;a.css({cursor:o.cursor,top:c/2-a.height()/2+"px"}),l.draggable({containment:s,drag:n,stop:n,axis:"x"}),o.animateIntro&&0===i?this.animateIntro(h,l,d,u):(l.css({left:u-r/2+"px"}),h.width(u))},animateIntro:function(e,t,i,n){var s=this.options,o=t.width()/2;t.css("left",i-o+"px"),setTimeout(function(){t.animate({left:n-o+"px"},s.introDuration),e.animate({width:n+"px"},s.introDuration)},s.introDelay)}});return a}),define("modules/fronts/assigned-content-nav",["jquery","underscore","baseview","ui/generic-paginator"],function(e,t,i,n){var s=i.extend({events:{"click .acnpm-filter":"filterItems"},initialize:function(e){t.bindAll(this,"goTo"),this.subviews={},this.$itemsContainer=this.$(".acnpm-items-container"),this.$items=this.$(".acnpm-item"),this.itemsPerRow=this.$el.hasClass("six-across")?6:8,this.$pageElements=this.$(".paginator-indicator-target"),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),i.prototype.initialize.call(this,e)},filterItems:function(e){e.preventDefault();var t,i,n=e.currentTarget.id;this.$(".acnpm-filter").removeClass("selected").filter(e.currentTarget).addClass("selected"),this.$pageElements.eq(0).trigger("click"),this.$items.show(),"all"!=n&&this.$items.not("."+n).hide(),t=this.$items.filter(":visible").length,i=Math.floor(t/this.itemsPerRow),0===i?this.$(".acnpm-container").addClass("nopagination"):(this.$(".acnpm-container").removeClass("nopagination"),this.$pageElements.show().filter(":gt("+i+")").hide())},goTo:function(e){this.animate(this.$itemsContainer,"left",696*-e+"px",450,"ease-in-out")}});return s}),define("modules/weather/weather-interactive-map",["jquery","underscore","baseview","state","utils"],function(e,t,i,n,s){"use strict";var o=i.extend({el:".weather-interactive-map-module-wrapper",initialize:function(e){i.prototype.initialize.call(this,e),s.requireSingleUseScript("http://tessera.intellicast.com/Client/Javascript/wxmap.loader.min.js")}});return o}),define("modules/stories/utility-bar-flyout",["jquery","underscore","backbone","baseview","pubsub","utils","managers/routemanager","site-manager","modules/scroller/vertical-scroll"],function(e,t,i,n,s,o,a,r,l){var h=n.extend({events:{"click .util-bar-flyout-close-ribbon":"close",click:"onClickFlyout"},initialize:function(e){t.bindAll(this,"onBodyClick","onWindowResize"),this.$body=o.get("body"),this.$win=o.get("win"),this.$flyout=this.$(".util-bar-flyout"),this.pubSub=this.pubSub||{},this.pubSub["breakingbar:after:open"]=this.onWindowResize,n.prototype.initialize.call(this,e)},onWindowResize:function(){var e=this.getAvailableVerticalSpace();this.updateFlyoutHeight(e),this.options.noFlyoutScroll||this.updateFlyoutScroller()},getAvailableVerticalSpace:function(){var e=r.getHeader(),t=0;return e&&e.isFixed()===!0?t=e.getCollapsedHeight():e&&e.isFixed()===!1&&(t=e.getCurrentHeight()),this.$win.height()-t},getContentHeight:function(){return this.$scrollableContent.outerHeight()},updateFlyoutHeight:function(e){this.$flyout.css("height",e)},updateFlyoutScroller:function(){this.subviews.vscroll?this.subviews.vscroll.refresh():this.subviews.vscroll=new l({el:this.$flyout})},open:function(e){this.$scrollableContent=this.$(".scrollable-content").eq(0),this.$(".util-bar-btn").removeClass("active"),this.$btn=this.$(e?".util-bar-btn-"+e:".util-bar-btn"),this.$btn.addClass("active"),this.$body.on("click."+this.cid,this.onBodyClick),this.$win.on("resize."+this.cid,t.throttle(this.onWindowResize,50)),this.$flyout.css({visibility:"visible"}).addClass("open"),e&&this.showSection("share"==e?"facebook":e),this.onWindowResize(),e&&s.trigger("uotrack","utilitybar"+e+"open")},close:function(){this.destroy()},onBodyClick:function(t){var i=e(t.target);i.hasClass("util-bar-noclose")||(!t.isDefaultPrevented()||a.isAjax(i.attr("href")))&&this.close()},onClickFlyout:function(t){var i=e(t.target);i.hasClass("util-bar-noclose")||i.closest("a").attr("href")||t.preventDefault()},destroy:function(e){this.$body.off("."+this.cid),this.$win.off("."+this.cid),this.$btn&&this.$btn.removeClass("active"),this.$flyout.css({visibility:"hidden"}).removeClass("open"),n.prototype.destroy.call(this,e),this.options.onDestroy&&this.options.onDestroy(this)}});return h}),define("modules/stories/utility-bar-module-firefly",["jquery","underscore","backbone","pubsub","third-party-apis/firefly/firefly","modules/stories/utility-bar-flyout","directAdPosition","state","utils","user-manager"],function(e,t,i,n,s,o,a,r,l,h){"use strict";var d=o.extend({initialize:function(i){i=e.extend({noFlyoutScroll:!0},i),t.bindAll(this,"fireflyFlyoutAdReady"),this.events=t.extend({},o.prototype.events,this.events),this.$title=this.$(".util-bar-flyout-firefly-title"),this.$subBtn=this.$(".util-bar-flyout-firefly-subscribe-btn"),this.$fireflyFlyoutAd=this.$(".util-bar-flyout-firefly-ad"),this.messaging=l.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","flyoutMessageOverrides"),this.gps_tracking=l.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","gps"),this.viewsCookie=s.getFireflyViewsCookie(),o.prototype.initialize.call(this,i),this._buildSpecialOffersFireflyFlyoutAd()},_buildSpecialOffersFireflyFlyoutAd:function(){var e=h.getAccount("firefly");this.subviews.fireflyFlyoutAd||(e?e.getUserInfo().done(t.bind(function(e){e.hasMarketAccess||this._applySpecialOffersDirectPositionAd()},this)).fail(t.bind(function(){this._applySpecialOffersDirectPositionAd()},this)):this._applySpecialOffersDirectPositionAd())},_applySpecialOffersDirectPositionAd:function(){this.subviews.fireflyFlyoutAd=new a({el:this.$fireflyFlyoutAd,targeting:{pwvr:this.viewsCookie?this.viewsCookie.viewsRemaining.toString():"0"},adSizes:[264,200],adPlacement:"consumer_sales-flyout",onAdReady:this.fireflyFlyoutAdReady})},fireflyFlyoutAdReady:function(){this.$subBtn.addClass("hidden"),this.$fireflyFlyoutAd.removeClass("hidden"),this.subviews.fireflyFlyoutAd.showAd()},setTitle:function(e,t){this.$title.text(e),t?this.$title.addClass("util-bar-flyout-firefly-title-large"):this.$title.removeClass("util-bar-flyout-firefly-title-large")},setGPS:function(e){var t=this.$subBtn.attr("href");t=t.replace(/(gps-source)=.*/,"$1="+e),this.$subBtn.attr("href",t)},open:function(){if(n.trigger("uotrack","UtilityBarFireflyOpen"),this.viewsCookie)if(1===this.viewsCookie.viewCount)this.setTitle(this.messaging.first),this.setGPS(this.gps_tracking.first);else if(0===this.viewsCookie.viewsRemaining)this.setTitle(this.messaging.last),this.setGPS(this.gps_tracking.last);else{var e,i,s=this.viewsCookie.viewsRemaining,a=!1;a=t.find(l.getNested(this.messaging,"extra_overrides"),function(e){return e.view_remaining===s}),a?(e=a.message,i=this.gps_tracking.custom):(e=this.viewsCookie.viewsRemaining>1?this.viewsCookie.viewsRemaining+this.messaging.tweener:this.viewsCookie.viewsRemaining+this.messaging.tweener_singular,i=this.viewsCookie.viewsRemaining>1?this.gps_tracking.tweener:this.gps_tracking.tweener_singular),this.setTitle(e,!0),this.setGPS(i)}o.prototype.open.call(this)},close:function(){n.trigger("uotrack","UtilityBarFireflyClose"),this.destroy()}});return d}),define("form/base-form-element",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({getFormElement:function(){return this.$el},getUIElement:function(){return this.$el},getType:function(){return""},reset:function(){},isRequired:function(){var e=this.getFormElement().attr("required");return"required"===e||e}});return n}),define("form/dropdown",["jquery","underscore","form/base-form-element","ui/dropdown"],function(e,t,i,n){"use strict";var s=i.extend({events:{change:"onChange"},initialize:function(s){s=e.extend({onSelect:null,dropdownContentClass:null},s),t.bindAll(this,"refresh","onDivDropdownSelect"),this.$el.hide(),this.selectOptionItems=this.$("option"),this.dropdownDiv=this._buildDropdownHtml(this.selectOptionItems),this.$el.attr("tabindex","-1"),this.dropdownDiv.insertAfter(this.$el),i.prototype.initialize.call(this,s),this.subviews.dropdown=new n({el:this.dropdownDiv,onSelect:this.onDivDropdownSelect})},_buildDropdownHtml:function(t){var i=e('<div class="'+this.$el.attr("class")+'"></div>');this.options.dropdownContentClass&&i.addClass(this.options.dropdownContentClass);var n=e('<div class="ui-dropdown-value ui-btn"></div>'),s=e('<div class="ui-dropdown-content"></div>'),o=this._buildDropdownHtmlItems(t);return i.attr("class",this.$el.attr("class")),i.attr("tabindex",this.$el.attr("tabindex")||0),i.append(n).append(s),s.append(o),i},_buildDropdownHtmlItems:function(i){var n=e('<ul class="ui-dropdown-items-container"></ul>');return i.each(t.bind(function(t,i){var s=e(i),o=s.val(),a=s.html(),r=e('<li class="ui-dropdown-item" data-value="'+o+'">'+a+"</li>");s.is(":selected")&&r.attr("data-selected","selected"),n.append(r)},this)),n},refresh:function(t){var i=this._buildDropdownHtmlItems(e(t));this.subviews.dropdown.refresh(i.html()),this.$el.html(t)},getUIElement:function(){return this.dropdownDiv},getType:function(){return"dropdown"},reset:function(){this.subviews.dropdown.reset(),this.$el.val("")},onDivDropdownSelect:function(e,t,i){this.$el.val(e),this.options.onSelect&&this.options.onSelect(e,t,i)},onChange:function(){this.subviews.dropdown.setValue(this.$el.val())},destroy:function(e){this.dropdownDiv.remove(),i.prototype.destroy.call(this,e)}});return s}),define("modules/stories/assigned-content",["jquery","underscore","baseview","form/dropdown","ui/generic-paginator"],function(e,t,i,n,s){var o=i.extend({initialize:function(e){t.bindAll(this,"goTo","onFilterDropdownSelect"),this.subviews={},this.$itemsContainer=this.$(".acnsb-items-container"),this.$items=this.$(".acnsb-item"),this.$pageElements=this.$(".paginator-indicator-target"),this.subviews.dropdown=new n({el:this.$(".acnsb-dropdown"),onSelect:this.onFilterDropdownSelect}),this.subviews.paginator=new s({el:this.$(".paginator"),onGoTo:this.goTo}),i.prototype.initialize.call(this,e)},onFilterDropdownSelect:function(e){var t,i;this.$pageElements.eq(0).trigger("click"),this.$items.show(),"all"!=e&&this.$items.not("."+e).hide(),t=this.$items.filter(":visible").length,8>=t?this.$(".acnsb-container").addClass("nopagination"):(this.$(".acnsb-container").removeClass("nopagination"),i=Math.floor(t/8),this.$pageElements.show().filter(":gt("+i+")").hide())},goTo:function(e){this.animate(this.$itemsContainer,"top",270*-e+"px",450,"ease-in-out")}});return o}),define("modules/rentalslite-search",["jquery","baseview","state","managers/routemanager"],function(e,t,i,n){var s=t.extend({events:{"click .js-rls-search-btn":"aptAffWidget","submit .js-rls-form":"aptAffWidget"},urlForBedsBaths:function(e,t,i){return isNaN(t)||(e+=0===t?"studio-beds":t+"-beds"),isNaN(t)||isNaN(i)?isNaN(i)||(e+=i+"-baths"):e+="-"+i+"-baths",e},urlForRent:function(e,t,i){return isNaN(t)||isNaN(i)?isNaN(t)?isNaN(i)||(e+="-under-"+i):e+="-over-"+t:e+="-"+t+"-to-"+i,e},urlForPets:function(e,t){return"pets"!==t&&(e+="all"!==t?"-pet-friendly-"+t:"-pet-friendly"),e},aptAffWidget:function(){var t=this.$(".js-rls-form-city").val(),i=this.$(".js-rls-form-state").val(),s="http://www.apartments.com/";return t?"0"===i?e(".js-rls-form-state").focus():(s+=t+"-"+i+"/",s=this.urlForBedsBaths(s,parseInt(this.$(".js-rls-form-bedrooms").val()),parseInt(this.$(".js-rls-form-bathrooms").val())),s=this.urlForRent(s,parseInt(this.$(".js-rls-form-minrent").val()),parseInt(this.$(".js-rls-form-maxrent").val())),s=this.urlForPets(s,this.$(".js-rls-form-pets").val()),n.goTo(s)):e(".js-rls-form-city").focus(),!1}});return s}),define("modules/datasphere-community/datasphere-community",["jquery","underscore","baseview","utils","state","admanager"],function(e,t,i,n,s,o){"use strict";var a=i.extend({events:{"click .datasphere-community-link":"select"},classNames:{show:"show",selected:"selected",list:"clst-unordered-items"},initialize:function(o){t.bindAll(this,"widgetLoaded");var r=n.getNested(window.site_vars,"DATASPHERE")||{};if(!r.SWITCH)return!1;if(this.contentType=this._getContentType(),this.contentType){if(this.options=e.extend({apiBase:"http://content.secondspace.com/widget/",site:r.SITE,type:r.TYPE,preview:n.getUrlParam("preview")?"-preview":""},o),this.templateInfo={tabs:{news:{title:"News",url:r.SITE,id:"news"},events:{title:"Events",url:"events."+r.SITE,id:"events"}},template:'<li class="datasphere-community-item<%= selected %>"><a class="datasphere-community-link" data-id="datasphere-community-<%= id %>"href="<%= url %>.com"data-ht="datasphere-community-<%= id %>" data-vr-contentbox="datasphere-community-<%= id %>"><%= title %></a></li>'},window.__dsWidget__||(window.__dsWidget__={dsWidgetLoaded:this.widgetLoaded}),!a.prototype.DSisLoaded&&r.TYPE&&r.SITE){var l=this.options.apiBase+this.options.type+"/"+this.options.site+this.options.preview+".js",h=t.bind(this._JSloaded,this);s.fetchData(l,{cache:!0,dataType:"script",success:h})}else{if(!r.TYPE||!r.SITE)return;this._callDSapi()}"homepage"===this.contentType&&(this.$galleries=this.$(".datasphere-community-section")),i.prototype.initialize.call(this,this.options)}},_getContentType:function(){var e=!1,t=s.getActivePageInfo()||{},i=t.contenttype||"",n=t.section_name||"";return"home"===n?e="homepage":-1!==i.indexOf("front")?e="adfront":-1!==i.indexOf("story")&&(e="story"),e},_JSloaded:function(){a.prototype.DSisLoaded=!0,this._callDSapi()},_callDSapi:function(){window.dsapi&&(window.dsapi.pageLoad&&window.dsapi.pageLoad(this.contentType),window.dsapi.allowModal&&e.when(this._allowModal()).then(function(e){window.dsapi.allowModal(e)},function(e){window.dsapi.allowModal(e)}))},_allowModal:function(){var t=!1,i=new e.Deferred,n=0,s=this;return"homepage"===this.contentType&&o.activeSlotStatistics&&(o.activeSlotStatistics.unknown?this.timer=setInterval(function(){o.activeSlotStatistics.unknown?11>n?n++:(window.clearInterval(this.timer),i.reject(t)):(window.clearInterval(this.timer),i.resolve(s._determineIfHighImpact()))},500):i.resolve(this._determineIfHighImpact())),i.promise()},_determineIfHighImpact:function(){var e=!0;return o.activeSlotStatistics.high_impact&&(e=!1),e},destroy:function(e){if(window.__dsWidget__){window.__dsWidget__=void 0;try{delete window.__dsWidget__}catch(t){}}window.dsapi&&window.dsapi.pageUnload&&window.dsapi.pageUnload(this.contentType),this.timer&&window.clearInterval(this.timer),i.prototype.destroy.call(this,e)},widgetLoaded:function(i,n){if(i.events||i.news){var s="homepage"===this.contentType;if(s&&n){var o=this.$("."+this.classNames.list),a=0,r={},l=this.templateInfo;e.each(i,function(e,i){i&&(r=l.tabs[e],r.selected=0===a?" selected":"",o.append(t.template(l.template,r)),a++)})}this.$navItems=this.$(".datasphere-community-item"),this.$el.addClass(this.classNames.show),s&&this.refreshSidebar()}},refreshSidebar:function(){s.getActiveApp().triggerEvent("refreshSidebarScroll")},select:function(t){if(t&&t.preventDefault(),1!==this.$navItems.length){var i=e(t.currentTarget),n=i.parent();window.dsapi&&window.dsapi.toggleContent&&window.dsapi.toggleContent(i.text().toLowerCase()),this.$navItems.removeClass(this.classNames.selected),n.addClass(this.classNames.selected)}}});return a}),define("modules/twitter",["jquery","underscore","state","baseview","modules/scroller/sidebar-scroll"],function(e,t,i,n,s){"use strict";var o=n.extend({initialize:function(t){t=e.extend({layoutType:null},t),this.$twitterEl=this.$(".twm-wrapper"),this.isFixed=this.$el.closest(".sidebar-fixed-content").length,n.prototype.initialize.call(this,t)},renderCardInfo:function(e){"sidebar"===this.options.layoutType&&e.sidebarOpen&&this.addScrollbar()},openSideBar:function(){this.renderCardInfo({sidebarOpen:!0})},destroy:function(e){e&&this.$twitterEl.empty(),n.prototype.destroy.call(this,!1)},onSidebarScrollableHeightChange:function(i,n){if("sidebar"===this.options.layoutType){var s=t.reduce(this.$el.siblings(".card-sidebar"),function(t,i){return t+e(i).outerHeight()},0);this.$el.css("height",(this.isFixed?i:n)-s),this.refreshScrollbar()}},refreshScrollbar:function(){this.subviews&&this.subviews.scrollbar&&this.subviews.scrollbar.refresh(),"sidebar"!==this.options.layoutType||this.isFixed||i.getActiveApp().triggerEvent("refreshSidebarScroll")},addScrollbar:function(){this.subviews.scrollbar=new s({el:this.$(".twitter-sidebar-content"),color:"light",lockPageScroll:!0,fadeout:!0})}});return o}),define("modules/weather/weather-twitter",["jquery","underscore","state","baseview","modules/twitter"],function(e,t,i,n,s){"use strict";var o=s.extend({el:".card-primary-wrapper",initialize:function(t){t=e.extend({num_tweets:null,twitter_id:null,layoutType:null},t),this.twitter_el=this.$(".tweet-list"),this.row_size=this.twitter_el.attr("data-row-size")||1,t.num_tweets=this.options.num_tweets||this.twitter_el.attr("data-num-tweets"),this.twitterID=t.twitter_id||this.twitter_el.attr("data-twitter-id"),s.prototype.initialize.call(this,t),this.createWeatherTweetsHTML()},createWeatherTweetsHTML:function(){this.$cardHeight=e(".card-primary-wrapper").height(),this.$(".twitter-scroll-content").height(this.$cardHeight-40),e(".sidebar").append(this.$("#footHide").html())}});return o}),define("modules/ggm-jobs-search/ggm-jobs-search",["jquery","underscore","baseview","form/dropdown"],function(e,t,i,n){"use strict";var s=i.extend({events:{submit:"onFormSubmit"},initialize:function(e){i.prototype.initialize.call(this,e),this._setupForm()},_setupForm:function(){this.subviews.dropdownProduct=new n({el:this.$(".ggmmtjm-select")})}});return s}),define("modules/broadcast-video-carousel-player/broadcast-video-carousel-player",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({el:".broadcast_video_carousel_player",initialize:function(e){i.prototype.initialize.call(this,e)}});return n}),define("modules/stories/sponsored-series-topbar",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({animationTime:200,events:{"click .close-drawer":"closeDrawer","click nav ul li a":"toggleDrawer"},closeDrawer:function(){return this.$navAnchors.removeClass("open"),this.$drawer.slideUp(this.animationTime,t.bind(function(){this.$drawer.removeClass("open").removeAttr("style"),this.$openSection.removeClass("open").removeAttr("style"),this.$openSection=null},this)),!1},initialize:function(t){this.options=e.extend({},t),this.$navAnchors=this.$("nav ul li a"),this.$drawer=this.$(".drawer"),this.$sectionAbout=e(".sponsor-about",this.$drawer),this.$sectionResources=e(".sponsor-resources",this.$drawer),this.$sectionVideos=e(".sponsor-videos",this.$drawer)},toggleDrawer:function(i){var n=e(i.target);if(n.hasClass("open"))this.closeDrawer();else{this.$navAnchors.removeClass("open"),n.addClass("open");var s=null;switch(n.attr("href")){case"#sponsor-about":s=this.$sectionAbout;break;case"#sponsor-resources":s=this.$sectionResources;break;case"#sponsor-videos":s=this.$sectionVideos}this.$openSection?this.$openSection.slideUp(this.animationTime,t.bind(function(){this.$openSection.removeClass("open").removeAttr("style"),s.slideDown(this.animationTime,t.bind(function(){s.addClass("open").removeAttr("style")},this))},this)):(s.addClass("open").removeAttr("style"),this.$drawer.slideDown(this.animationTime,t.bind(function(){this.$drawer.addClass("open").removeAttr("style")},this))),this.$openSection=s}return!1}});return n}),define("modules/fronts/headline-list-blog",["jquery","underscore","backbone","baseview","state","pubsub","utils"],function(e,t,i,n,s,o,a){"use strict";var r=n.extend({events:{"click .button-add-content":"showMore"},initialize:function(){this.$button=this.$(".button-add-content"),this.$(".headline-page.active").hasClass("placeholder")&&(this.load(),this.$(".headline-page").length<2&&this.$button.addClass("inactive"))},showMore:function(t){if(e(t.target).hasClass("inactive"))return!1;this.$button.addClass("loading").text(this.$button.attr("data-loading"));var i=this.$(".headline-page.active:last").next(),n=i.attr("data-itemnum"),s=i.attr("data-items-per-page"),r=Math.round(n/s);this.load(),o.trigger("uotrack",a.getSectionPath(window.location.pathname)+"morestories"+r),this.transitionMore(i),t.preventDefault()},transitionMore:function(t){Modernizr.csstransitions?t.removeClass("inactive").addClass("active"):t.animate({"max-height":"5000px"},200,function(){e(this).removeClass("inactive").addClass("active").css("max-height","")}),this.$(".headline-page.inactive").length<=0&&this.$button.addClass("inactive"),this.load(),this.$button.removeClass("loading").text(this.$button.attr("data-default")),o.trigger("showmore:headlines")},load:function(){var e=this.$(".headline-page.active");a.lazyLoadImage(e.find("img"),"data-src",!1),e.removeClass("placeholder")}});return r}),define("modules/weather/weather-current",["jquery","underscore","baseview","modules/partner/simple-ad"],function(e,t,i,n){"use strict";
var s=i.extend({classes:{poster:"poster-ad-primary"},initialize:function(e){this.$posterAd=this.$("."+this.classes.poster),i.prototype.initialize.call(this,e)},renderCardInfo:function(e){e.sidebarOpen||(this.show(),this._buildPosterAd()),this.currentCardInfo=e},_buildPosterAd:function(){this.$posterAd.length&&!this.subviews.posterAd&&(this.subviews.posterAd=new n({el:this.$posterAd,adSizes:"mediumrectangle",adPlacement:"poster_front",adType:"poster"}),this.subviews.posterAd._initAds())},onCardWidthChange:function(e){e.sidebarOpen!==this.currentCardInfo.sidebarOpen&&(this.currentCardInfo=e,e.sidebarOpen?this.subviews.posterAd&&this.subviews.posterAd.hide():this.subviews.posterAd?this.subviews.posterAd.show():this._buildPosterAd())}});return s}),define("modules/stories/inline-share-tools",["jquery","baseview","pubsub","state"],function(e,t,i,n){var s=t.extend({events:{"click .inline-share-btn":"onClickInlineShareBtn"},onClickInlineShareBtn:function(t){var i=e(t.currentTarget);if("A"!==i.prop("tagName")){t.preventDefault();var s=e(t.currentTarget).data("share-method");n.getActiveApp().$(".util-bar-btn-"+s).trigger("click")}}});return s}),document.createElement("canvas").getContext||!function(){function e(){return this.context_||(this.context_=new w(this))}function t(e,t){var i=z.call(arguments,2);return function(){return e.apply(t,i.concat(z.call(arguments)))}}function i(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function n(e,t,i){e.namespaces[t]||e.namespaces.add(t,i,"#default#VML")}function s(e){if(n(e,"g_vml_","urn:schemas-microsoft-com:vml"),n(e,"g_o_","urn:schemas-microsoft-com:office:office"),!e.styleSheets.ex_canvas_){var t=e.createStyleSheet();t.owningElement.id="ex_canvas_",t.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}function o(e){var t=e.srcElement;switch(e.propertyName){case"width":t.getContext().clearRect(),t.style.width=t.attributes.width.nodeValue+"px",t.firstChild.style.width=t.clientWidth+"px";break;case"height":t.getContext().clearRect(),t.style.height=t.attributes.height.nodeValue+"px",t.firstChild.style.height=t.clientHeight+"px"}}function a(e){var t=e.srcElement;t.firstChild&&(t.firstChild.style.width=t.clientWidth+"px",t.firstChild.style.height=t.clientHeight+"px")}function r(){return[[1,0,0],[0,1,0],[0,0,1]]}function l(e,t){for(var i=r(),n=0;3>n;n++)for(var s=0;3>s;s++){for(var o=0,a=0;3>a;a++)o+=e[n][a]*t[a][s];i[n][s]=o}return i}function h(e,t){t.fillStyle=e.fillStyle,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY,t.strokeStyle=e.strokeStyle,t.globalAlpha=e.globalAlpha,t.font=e.font,t.textAlign=e.textAlign,t.textBaseline=e.textBaseline,t.arcScaleX_=e.arcScaleX_,t.arcScaleY_=e.arcScaleY_,t.lineScale_=e.lineScale_}function d(e){var t=e.indexOf("(",3),i=e.indexOf(")",t+1),n=e.substring(t+1,i).split(",");return(4!=n.length||"a"!=e.charAt(3))&&(n[3]=1),n}function c(e){return parseFloat(e)/100}function u(e,t,i){return Math.min(i,Math.max(t,e))}function p(e){var t,i,n,s,o,a;if(s=parseFloat(e[0])/360%360,0>s&&s++,o=u(c(e[1]),0,1),a=u(c(e[2]),0,1),0==o)t=i=n=a;else{var r=.5>a?a*(1+o):a+o-a*o,l=2*a-r;t=f(l,r,s+1/3),i=f(l,r,s),n=f(l,r,s-1/3)}return"#"+H[Math.floor(255*t)]+H[Math.floor(255*i)]+H[Math.floor(255*n)]}function f(e,t,i){return 0>i&&i++,i>1&&i--,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+(t-e)*(2/3-i)*6:e}function g(e){if(e in V)return V[e];var t,i=1;if(e=String(e),"#"==e.charAt(0))t=e;else if(/^rgb/.test(e)){for(var n,s=d(e),t="#",o=0;3>o;o++)n=-1!=s[o].indexOf("%")?Math.floor(255*c(s[o])):+s[o],t+=H[u(n,0,255)];i=+s[3]}else if(/^hsl/.test(e)){var s=d(e);t=p(s),i=s[3]}else t=q[e]||e;return V[e]={color:t,alpha:i}}function m(e){if(Y[e])return Y[e];var t=document.createElement("div"),i=t.style;try{i.font=e}catch(n){}return Y[e]={style:i.fontStyle||G.style,variant:i.fontVariant||G.variant,weight:i.fontWeight||G.weight,size:i.fontSize||G.size,family:i.fontFamily||G.family}}function v(e,t){var i={};for(var n in e)i[n]=e[n];var s=parseFloat(t.currentStyle.fontSize),o=parseFloat(e.size);return i.size="number"==typeof e.size?e.size:-1!=e.size.indexOf("px")?o:-1!=e.size.indexOf("em")?s*o:-1!=e.size.indexOf("%")?s/100*o:-1!=e.size.indexOf("pt")?o/.75:s,i.size*=.981,i}function b(e){return e.style+" "+e.variant+" "+e.weight+" "+e.size+"px "+e.family}function y(e){return X[e]||"square"}function w(e){this.m_=r(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*B,this.globalAlpha=1,this.font="10px sans-serif",this.textAlign="left",this.textBaseline="alphabetic",this.canvas=e;var t="width:"+e.clientWidth+"px;height:"+e.clientHeight+"px;overflow:hidden;position:absolute",i=e.ownerDocument.createElement("div");i.style.cssText=t,e.appendChild(i);var n=i.cloneNode(!1);n.style.backgroundColor="red",n.style.filter="alpha(opacity=0)",e.appendChild(n),this.element_=i,this.arcScaleX_=1,this.arcScaleY_=1,this.lineScale_=1}function _(e,t,i,n){e.currentPath_.push({type:"bezierCurveTo",cp1x:t.x,cp1y:t.y,cp2x:i.x,cp2y:i.y,x:n.x,y:n.y}),e.currentX_=n.x,e.currentY_=n.y}function C(e,t){var i=g(e.strokeStyle),n=i.color,s=i.alpha*e.globalAlpha,o=e.lineScale_*e.lineWidth;1>o&&(s*=o),t.push("<g_vml_:stroke",' opacity="',s,'"',' joinstyle="',e.lineJoin,'"',' miterlimit="',e.miterLimit,'"',' endcap="',y(e.lineCap),'"',' weight="',o,'px"',' color="',n,'" />')}function x(e,t,i,n){var s=e.fillStyle,o=e.arcScaleX_,a=e.arcScaleY_,r=n.x-i.x,l=n.y-i.y;if(s instanceof k){var h=0,d={x:0,y:0},c=0,u=1;if("gradient"==s.type_){var p=s.x0_/o,f=s.y0_/a,m=s.x1_/o,v=s.y1_/a,b=S(e,p,f),y=S(e,m,v),w=y.x-b.x,_=y.y-b.y;h=180*Math.atan2(w,_)/Math.PI,0>h&&(h+=360),1e-6>h&&(h=0)}else{var b=S(e,s.x0_,s.y0_);d={x:(b.x-i.x)/r,y:(b.y-i.y)/l},r/=o*B,l/=a*B;var C=L.max(r,l);c=2*s.r0_/C,u=2*s.r1_/C-c}var x=s.colors_;x.sort(function(e,t){return e.offset-t.offset});for(var T=x.length,A=x[0].color,P=x[T-1].color,D=x[0].alpha*e.globalAlpha,I=x[T-1].alpha*e.globalAlpha,E=[],M=0;T>M;M++){var R=x[M];E.push(R.offset*u+c+" "+R.color)}t.push('<g_vml_:fill type="',s.type_,'"',' method="none" focus="100%"',' color="',A,'"',' color2="',P,'"',' colors="',E.join(","),'"',' opacity="',I,'"',' g_o_:opacity2="',D,'"',' angle="',h,'"',' focusposition="',d.x,",",d.y,'" />')}else if(s instanceof $){if(r&&l){var N=-i.x,F=-i.y;t.push("<g_vml_:fill",' position="',N/r*o*o,",",F/l*a*a,'"',' type="tile"',' src="',s.src_,'" />')}}else{var O=g(e.fillStyle),z=O.color,j=O.alpha*e.globalAlpha;t.push('<g_vml_:fill color="',z,'" opacity="',j,'" />')}}function S(e,t,i){var n=e.m_;return{x:B*(t*n[0][0]+i*n[1][0]+n[2][0])-O,y:B*(t*n[0][1]+i*n[1][1]+n[2][1])-O}}function T(e){return isFinite(e[0][0])&&isFinite(e[0][1])&&isFinite(e[1][0])&&isFinite(e[1][1])&&isFinite(e[2][0])&&isFinite(e[2][1])}function A(e,t,i){if(T(t)&&(e.m_=t,i)){var n=t[0][0]*t[1][1]-t[0][1]*t[1][0];e.lineScale_=F(N(n))}}function k(e){this.type_=e,this.x0_=0,this.y0_=0,this.r0_=0,this.x1_=0,this.y1_=0,this.r1_=0,this.colors_=[]}function $(e,t){switch(D(e),t){case"repeat":case null:case"":this.repetition_="repeat";break;case"repeat-x":case"repeat-y":case"no-repeat":this.repetition_=t;break;default:P("SYNTAX_ERR")}this.src_=e.src,this.width_=e.width,this.height_=e.height}function P(e){throw new I(e)}function D(e){e&&1==e.nodeType&&"IMG"==e.tagName||P("TYPE_MISMATCH_ERR"),"complete"!=e.readyState&&P("INVALID_STATE_ERR")}function I(e){this.code=this[e],this.message=e+": DOM Exception "+this.code}var L=Math,E=L.round,M=L.sin,R=L.cos,N=L.abs,F=L.sqrt,B=10,O=B/2,z=(+navigator.userAgent.match(/MSIE ([\d.]+)?/)[1],Array.prototype.slice);s(document);var j={init:function(e){var i=e||document;i.createElement("canvas"),i.attachEvent("onreadystatechange",t(this.init_,this,i))},init_:function(e){for(var t=e.getElementsByTagName("canvas"),i=0;i<t.length;i++)this.initElement(t[i])},initElement:function(t){if(!t.getContext){t.getContext=e,s(t.ownerDocument),t.innerHTML="",t.attachEvent("onpropertychange",o),t.attachEvent("onresize",a);var i=t.attributes;i.width&&i.width.specified?t.style.width=i.width.nodeValue+"px":t.width=t.clientWidth,i.height&&i.height.specified?t.style.height=i.height.nodeValue+"px":t.height=t.clientHeight}return t}};j.init();for(var H=[],U=0;16>U;U++)for(var W=0;16>W;W++)H[16*U+W]=U.toString(16)+W.toString(16);var q={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},V={},G={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"},Y={},X={butt:"flat",round:"round"},Z=w.prototype;Z.clearRect=function(){this.textMeasureEl_&&(this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null),this.element_.innerHTML=""},Z.beginPath=function(){this.currentPath_=[]},Z.moveTo=function(e,t){var i=S(this,e,t);this.currentPath_.push({type:"moveTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},Z.lineTo=function(e,t){var i=S(this,e,t);this.currentPath_.push({type:"lineTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},Z.bezierCurveTo=function(e,t,i,n,s,o){var a=S(this,s,o),r=S(this,e,t),l=S(this,i,n);_(this,r,l,a)},Z.quadraticCurveTo=function(e,t,i,n){var s=S(this,e,t),o=S(this,i,n),a={x:this.currentX_+2/3*(s.x-this.currentX_),y:this.currentY_+2/3*(s.y-this.currentY_)},r={x:a.x+(o.x-this.currentX_)/3,y:a.y+(o.y-this.currentY_)/3};_(this,a,r,o)},Z.arc=function(e,t,i,n,s,o){i*=B;var a=o?"at":"wa",r=e+R(n)*i-O,l=t+M(n)*i-O,h=e+R(s)*i-O,d=t+M(s)*i-O;r!=h||o||(r+=.125);var c=S(this,e,t),u=S(this,r,l),p=S(this,h,d);this.currentPath_.push({type:a,x:c.x,y:c.y,radius:i,xStart:u.x,yStart:u.y,xEnd:p.x,yEnd:p.y})},Z.rect=function(e,t,i,n){this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+n),this.lineTo(e,t+n),this.closePath()},Z.strokeRect=function(e,t,i,n){var s=this.currentPath_;this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+n),this.lineTo(e,t+n),this.closePath(),this.stroke(),this.currentPath_=s},Z.fillRect=function(e,t,i,n){var s=this.currentPath_;this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+n),this.lineTo(e,t+n),this.closePath(),this.fill(),this.currentPath_=s},Z.createLinearGradient=function(e,t,i,n){var s=new k("gradient");return s.x0_=e,s.y0_=t,s.x1_=i,s.y1_=n,s},Z.createRadialGradient=function(e,t,i,n,s,o){var a=new k("gradientradial");return a.x0_=e,a.y0_=t,a.r0_=i,a.x1_=n,a.y1_=s,a.r1_=o,a},Z.drawImage=function(e){var t,i,n,s,o,a,r,l,h=e.runtimeStyle.width,d=e.runtimeStyle.height;e.runtimeStyle.width="auto",e.runtimeStyle.height="auto";var c=e.width,u=e.height;if(e.runtimeStyle.width=h,e.runtimeStyle.height=d,3==arguments.length)t=arguments[1],i=arguments[2],o=a=0,r=n=c,l=s=u;else if(5==arguments.length)t=arguments[1],i=arguments[2],n=arguments[3],s=arguments[4],o=a=0,r=c,l=u;else{if(9!=arguments.length)throw Error("Invalid number of arguments");o=arguments[1],a=arguments[2],r=arguments[3],l=arguments[4],t=arguments[5],i=arguments[6],n=arguments[7],s=arguments[8]}var p=S(this,t,i),f=[],g=10,m=10;if(f.push(" <g_vml_:group",' coordsize="',B*g,",",B*m,'"',' coordorigin="0,0"',' style="width:',g,"px;height:",m,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]||1!=this.m_[1][1]||this.m_[1][0]){var v=[];v.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",E(p.x/B),",","Dy=",E(p.y/B),"");var b=p,y=S(this,t+n,i),w=S(this,t,i+s),_=S(this,t+n,i+s);b.x=L.max(b.x,y.x,w.x,_.x),b.y=L.max(b.y,y.y,w.y,_.y),f.push("padding:0 ",E(b.x/B),"px ",E(b.y/B),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",v.join(""),", sizingmethod='clip');")}else f.push("top:",E(p.y/B),"px;left:",E(p.x/B),"px;");f.push(' ">','<g_vml_:image src="',e.src,'"',' style="width:',B*n,"px;"," height:",B*s,'px"',' cropleft="',o/c,'"',' croptop="',a/u,'"',' cropright="',(c-o-r)/c,'"',' cropbottom="',(u-a-l)/u,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",f.join(""))},Z.stroke=function(e){for(var t=10,i=10,n=5e3,s={x:null,y:null},o={x:null,y:null},a=0;a<this.currentPath_.length;a+=n){var r=[];r.push("<g_vml_:shape",' filled="',!!e,'"',' style="position:absolute;width:',t,"px;height:",i,'px;"',' coordorigin="0,0"',' coordsize="',B*t,",",B*i,'"',' stroked="',!e,'"',' path="');for(var l=a;l<Math.min(a+n,this.currentPath_.length);l++){l%n==0&&l>0&&r.push(" m ",E(this.currentPath_[l-1].x),",",E(this.currentPath_[l-1].y));var h,d=this.currentPath_[l];switch(d.type){case"moveTo":h=d,r.push(" m ",E(d.x),",",E(d.y));break;case"lineTo":r.push(" l ",E(d.x),",",E(d.y));break;case"close":r.push(" x "),d=null;break;case"bezierCurveTo":r.push(" c ",E(d.cp1x),",",E(d.cp1y),",",E(d.cp2x),",",E(d.cp2y),",",E(d.x),",",E(d.y));break;case"at":case"wa":r.push(" ",d.type," ",E(d.x-this.arcScaleX_*d.radius),",",E(d.y-this.arcScaleY_*d.radius)," ",E(d.x+this.arcScaleX_*d.radius),",",E(d.y+this.arcScaleY_*d.radius)," ",E(d.xStart),",",E(d.yStart)," ",E(d.xEnd),",",E(d.yEnd))}d&&((null==s.x||d.x<s.x)&&(s.x=d.x),(null==o.x||d.x>o.x)&&(o.x=d.x),(null==s.y||d.y<s.y)&&(s.y=d.y),(null==o.y||d.y>o.y)&&(o.y=d.y))}r.push(' ">'),e?x(this,r,s,o):C(this,r),r.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",r.join(""))}},Z.fill=function(){this.stroke(!0)},Z.closePath=function(){this.currentPath_.push({type:"close"})},Z.save=function(){var e={};h(this,e),this.aStack_.push(e),this.mStack_.push(this.m_),this.m_=l(r(),this.m_)},Z.restore=function(){this.aStack_.length&&(h(this.aStack_.pop(),this),this.m_=this.mStack_.pop())},Z.translate=function(e,t){var i=[[1,0,0],[0,1,0],[e,t,1]];A(this,l(i,this.m_),!1)},Z.rotate=function(e){var t=R(e),i=M(e),n=[[t,i,0],[-i,t,0],[0,0,1]];A(this,l(n,this.m_),!1)},Z.scale=function(e,t){this.arcScaleX_*=e,this.arcScaleY_*=t;var i=[[e,0,0],[0,t,0],[0,0,1]];A(this,l(i,this.m_),!0)},Z.transform=function(e,t,i,n,s,o){var a=[[e,t,0],[i,n,0],[s,o,1]];A(this,l(a,this.m_),!0)},Z.setTransform=function(e,t,i,n,s,o){var a=[[e,t,0],[i,n,0],[s,o,1]];A(this,a,!0)},Z.drawText_=function(e,t,n,s,o){var a=this.m_,r=1e3,l=0,h=r,d={x:0,y:0},c=[],u=v(m(this.font),this.element_),p=b(u),f=this.element_.currentStyle,g=this.textAlign.toLowerCase();switch(g){case"left":case"center":case"right":break;case"end":g="ltr"==f.direction?"right":"left";break;case"start":g="rtl"==f.direction?"right":"left";break;default:g="left"}switch(this.textBaseline){case"hanging":case"top":d.y=u.size/1.75;break;case"middle":break;default:case null:case"alphabetic":case"ideographic":case"bottom":d.y=-u.size/2.25}switch(g){case"right":l=r,h=.05;break;case"center":l=h=r/2}var y=S(this,t+d.x,n+d.y);c.push('<g_vml_:line from="',-l,' 0" to="',h,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!o,'" stroked="',!!o,'" style="position:absolute;width:1px;height:1px;">'),o?C(this,c):x(this,c,{x:-l,y:0},{x:h,y:u.size});var w=a[0][0].toFixed(3)+","+a[1][0].toFixed(3)+","+a[0][1].toFixed(3)+","+a[1][1].toFixed(3)+",0,0",_=E(y.x/B)+","+E(y.y/B);c.push('<g_vml_:skew on="t" matrix="',w,'" ',' offset="',_,'" origin="',l,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',i(e),'" style="v-text-align:',g,";font:",i(p),'" /></g_vml_:line>'),this.element_.insertAdjacentHTML("beforeEnd",c.join(""))},Z.fillText=function(e,t,i,n){this.drawText_(e,t,i,n,!1)},Z.strokeText=function(e,t,i,n){this.drawText_(e,t,i,n,!0)},Z.measureText=function(e){if(!this.textMeasureEl_){var t='<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>';this.element_.insertAdjacentHTML("beforeEnd",t),this.textMeasureEl_=this.element_.lastChild}var i=this.element_.ownerDocument;return this.textMeasureEl_.innerHTML="",this.textMeasureEl_.style.font=this.font,this.textMeasureEl_.appendChild(i.createTextNode(e)),{width:this.textMeasureEl_.offsetWidth}},Z.clip=function(){},Z.arcTo=function(){},Z.createPattern=function(e,t){return new $(e,t)},k.prototype.addColorStop=function(e,t){t=g(t),this.colors_.push({offset:e,color:t.color,alpha:t.alpha})};var J=I.prototype=new Error;J.INDEX_SIZE_ERR=1,J.DOMSTRING_SIZE_ERR=2,J.HIERARCHY_REQUEST_ERR=3,J.WRONG_DOCUMENT_ERR=4,J.INVALID_CHARACTER_ERR=5,J.NO_DATA_ALLOWED_ERR=6,J.NO_MODIFICATION_ALLOWED_ERR=7,J.NOT_FOUND_ERR=8,J.NOT_SUPPORTED_ERR=9,J.INUSE_ATTRIBUTE_ERR=10,J.INVALID_STATE_ERR=11,J.SYNTAX_ERR=12,J.INVALID_MODIFICATION_ERR=13,J.NAMESPACE_ERR=14,J.INVALID_ACCESS_ERR=15,J.VALIDATION_ERR=16,J.TYPE_MISMATCH_ERR=17,G_vmlCanvasManager=j,CanvasRenderingContext2D=w,CanvasGradient=k,CanvasPattern=$,DOMException=I}(),define("libs/flot/excanvas",function(){}),function(e){e.color={},e.color.make=function(t,i,n,s){var o={};return o.r=t||0,o.g=i||0,o.b=n||0,o.a=null!=s?s:1,o.add=function(e,t){for(var i=0;i<e.length;++i)o[e.charAt(i)]+=t;return o.normalize()},o.scale=function(e,t){for(var i=0;i<e.length;++i)o[e.charAt(i)]*=t;return o.normalize()},o.toString=function(){return o.a>=1?"rgb("+[o.r,o.g,o.b].join(",")+")":"rgba("+[o.r,o.g,o.b,o.a].join(",")+")"},o.normalize=function(){function e(e,t,i){return e>t?e:t>i?i:t}return o.r=e(0,parseInt(o.r),255),o.g=e(0,parseInt(o.g),255),o.b=e(0,parseInt(o.b),255),o.a=e(0,o.a,1),o},o.clone=function(){return e.color.make(o.r,o.b,o.g,o.a)},o.normalize()},e.color.extract=function(t,i){var n;do{if(n=t.css(i).toLowerCase(),""!=n&&"transparent"!=n)break;t=t.parent()}while(!e.nodeName(t.get(0),"body"));return"rgba(0, 0, 0, 0)"==n&&(n="transparent"),e.color.parse(n)},e.color.parse=function(i){var n,s=e.color.make;if(n=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(i))return s(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10));if(n=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return s(parseInt(n[1],10),parseInt(n[2],10),parseInt(n[3],10),parseFloat(n[4]));if(n=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(i))return s(2.55*parseFloat(n[1]),2.55*parseFloat(n[2]),2.55*parseFloat(n[3]));if(n=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return s(2.55*parseFloat(n[1]),2.55*parseFloat(n[2]),2.55*parseFloat(n[3]),parseFloat(n[4]));if(n=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(i))return s(parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16));if(n=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(i))return s(parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16));var o=e.trim(i).toLowerCase();return"transparent"==o?s(255,255,255,0):(n=t[o]||[0,0,0],s(n[0],n[1],n[2]))};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(e){function t(t,i){var n=i.children("."+t)[0];if(null==n&&(n=document.createElement("canvas"),n.className=t,e(n).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(i),!n.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");n=window.G_vmlCanvasManager.initElement(n)}this.element=n;var s=this.context=n.getContext("2d"),o=window.devicePixelRatio||1,a=s.webkitBackingStorePixelRatio||s.mozBackingStorePixelRatio||s.msBackingStorePixelRatio||s.oBackingStorePixelRatio||s.backingStorePixelRatio||1;this.pixelRatio=o/a,this.resize(i.width(),i.height()),this.textContainer=null,this.text={},this._textCache={}}function i(i,s,o,a){function r(e,t){t=[mt].concat(t);for(var i=0;i<e.length;++i)e[i].apply(this,t)}function l(){for(var i={Canvas:t},n=0;n<a.length;++n){var s=a[n];s.init(mt,i),s.options&&e.extend(!0,st,s.options)}}function h(t){e.extend(!0,st,t),t&&t.colors&&(st.colors=t.colors),null==st.xaxis.color&&(st.xaxis.color=e.color.parse(st.grid.color).scale("a",.22).toString()),null==st.yaxis.color&&(st.yaxis.color=e.color.parse(st.grid.color).scale("a",.22).toString()),null==st.xaxis.tickColor&&(st.xaxis.tickColor=st.grid.tickColor||st.xaxis.color),null==st.yaxis.tickColor&&(st.yaxis.tickColor=st.grid.tickColor||st.yaxis.color),null==st.grid.borderColor&&(st.grid.borderColor=st.grid.color),null==st.grid.tickColor&&(st.grid.tickColor=e.color.parse(st.grid.color).scale("a",.22).toString());var n,s,o,a={style:i.css("font-style"),size:Math.round(.8*(+i.css("font-size").replace("px","")||13)),variant:i.css("font-variant"),weight:i.css("font-weight"),family:i.css("font-family")};for(a.lineHeight=1.15*a.size,o=st.xaxes.length||1,n=0;o>n;++n)s=st.xaxes[n],s&&!s.tickColor&&(s.tickColor=s.color),s=e.extend(!0,{},st.xaxis,s),st.xaxes[n]=s,s.font&&(s.font=e.extend({},a,s.font),s.font.color||(s.font.color=s.color));for(o=st.yaxes.length||1,n=0;o>n;++n)s=st.yaxes[n],s&&!s.tickColor&&(s.tickColor=s.color),s=e.extend(!0,{},st.yaxis,s),st.yaxes[n]=s,s.font&&(s.font=e.extend({},a,s.font),s.font.color||(s.font.color=s.color));for(st.xaxis.noTicks&&null==st.xaxis.ticks&&(st.xaxis.ticks=st.xaxis.noTicks),st.yaxis.noTicks&&null==st.yaxis.ticks&&(st.yaxis.ticks=st.yaxis.noTicks),st.x2axis&&(st.xaxes[1]=e.extend(!0,{},st.xaxis,st.x2axis),st.xaxes[1].position="top"),st.y2axis&&(st.yaxes[1]=e.extend(!0,{},st.yaxis,st.y2axis),st.yaxes[1].position="right"),st.grid.coloredAreas&&(st.grid.markings=st.grid.coloredAreas),st.grid.coloredAreasColor&&(st.grid.markingsColor=st.grid.coloredAreasColor),st.lines&&e.extend(!0,st.series.lines,st.lines),st.points&&e.extend(!0,st.series.points,st.points),st.bars&&e.extend(!0,st.series.bars,st.bars),null!=st.shadowSize&&(st.series.shadowSize=st.shadowSize),null!=st.highlightColor&&(st.series.highlightColor=st.highlightColor),n=0;n<st.xaxes.length;++n)m(dt,n+1).options=st.xaxes[n];for(n=0;n<st.yaxes.length;++n)m(ct,n+1).options=st.yaxes[n];for(var l in gt)st.hooks[l]&&st.hooks[l].length&&(gt[l]=gt[l].concat(st.hooks[l]));r(gt.processOptions,[st])}function d(e){nt=c(e),v(),b()}function c(t){for(var i=[],n=0;n<t.length;++n){var s=e.extend(!0,{},st.series);null!=t[n].data?(s.data=t[n].data,delete t[n].data,e.extend(!0,s,t[n]),t[n].data=s.data):s.data=t[n],i.push(s)}return i}function u(e,t){var i=e[t+"axis"];return"object"==typeof i&&(i=i.n),"number"!=typeof i&&(i=1),i}function p(){return e.grep(dt.concat(ct),function(e){return e})}function f(e){var t,i,n={};for(t=0;t<dt.length;++t)i=dt[t],i&&i.used&&(n["x"+i.n]=i.c2p(e.left));for(t=0;t<ct.length;++t)i=ct[t],i&&i.used&&(n["y"+i.n]=i.c2p(e.top));return void 0!==n.x1&&(n.x=n.x1),void 0!==n.y1&&(n.y=n.y1),n}function g(e){var t,i,n,s={};for(t=0;t<dt.length;++t)if(i=dt[t],i&&i.used&&(n="x"+i.n,null==e[n]&&1==i.n&&(n="x"),null!=e[n])){s.left=i.p2c(e[n]);break}for(t=0;t<ct.length;++t)if(i=ct[t],i&&i.used&&(n="y"+i.n,null==e[n]&&1==i.n&&(n="y"),null!=e[n])){s.top=i.p2c(e[n]);break}return s}function m(t,i){return t[i-1]||(t[i-1]={n:i,direction:t==dt?"x":"y",options:e.extend(!0,{},t==dt?st.xaxis:st.yaxis)}),t[i-1]}function v(){var t,i=nt.length,n=-1;for(t=0;t<nt.length;++t){var s=nt[t].color;null!=s&&(i--,"number"==typeof s&&s>n&&(n=s))}n>=i&&(i=n+1);var o,a=[],r=st.colors,l=r.length,h=0;for(t=0;i>t;t++)o=e.color.parse(r[t%l]||"#666"),t%l==0&&t&&(h=h>=0?.5>h?-h-.2:0:-h),a[t]=o.scale("rgb",1+h);var d,c=0;for(t=0;t<nt.length;++t){if(d=nt[t],null==d.color?(d.color=a[c].toString(),++c):"number"==typeof d.color&&(d.color=a[d.color].toString()),null==d.lines.show){var p,f=!0;for(p in d)if(d[p]&&d[p].show){f=!1;break}f&&(d.lines.show=!0)}null==d.lines.zero&&(d.lines.zero=!!d.lines.fill),d.xaxis=m(dt,u(d,"x")),d.yaxis=m(ct,u(d,"y"))}}function b(){function t(e,t,i){t<e.datamin&&t!=-b&&(e.datamin=t),i>e.datamax&&i!=b&&(e.datamax=i)}var i,n,s,o,a,l,h,d,c,u,f,g,m=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,b=Number.MAX_VALUE;for(e.each(p(),function(e,t){t.datamin=m,t.datamax=v,t.used=!1}),i=0;i<nt.length;++i)a=nt[i],a.datapoints={points:[]},r(gt.processRawData,[a,a.data,a.datapoints]);for(i=0;i<nt.length;++i){if(a=nt[i],f=a.data,g=a.datapoints.format,!g){if(g=[],g.push({x:!0,number:!0,required:!0}),g.push({y:!0,number:!0,required:!0}),a.bars.show||a.lines.show&&a.lines.fill){var y=!!(a.bars.show&&a.bars.zero||a.lines.show&&a.lines.zero);g.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:y}),a.bars.horizontal&&(delete g[g.length-1].y,g[g.length-1].x=!0)}a.datapoints.format=g}if(null==a.datapoints.pointsize){a.datapoints.pointsize=g.length,h=a.datapoints.pointsize,l=a.datapoints.points;var w=a.lines.show&&a.lines.steps;for(a.xaxis.used=a.yaxis.used=!0,n=s=0;n<f.length;++n,s+=h){u=f[n];var _=null==u;if(!_)for(o=0;h>o;++o)d=u[o],c=g[o],c&&(c.number&&null!=d&&(d=+d,isNaN(d)?d=null:1/0==d?d=b:d==-1/0&&(d=-b)),null==d&&(c.required&&(_=!0),null!=c.defaultValue&&(d=c.defaultValue))),l[s+o]=d;if(_)for(o=0;h>o;++o)d=l[s+o],null!=d&&(c=g[o],c.autoscale&&(c.x&&t(a.xaxis,d,d),c.y&&t(a.yaxis,d,d))),l[s+o]=null;else if(w&&s>0&&null!=l[s-h]&&l[s-h]!=l[s]&&l[s-h+1]!=l[s+1]){for(o=0;h>o;++o)l[s+h+o]=l[s+o];l[s+1]=l[s-h+1],s+=h}}}}for(i=0;i<nt.length;++i)a=nt[i],r(gt.processDatapoints,[a,a.datapoints]);for(i=0;i<nt.length;++i){a=nt[i],l=a.datapoints.points,h=a.datapoints.pointsize,g=a.datapoints.format;var C=m,x=m,S=v,T=v;for(n=0;n<l.length;n+=h)if(null!=l[n])for(o=0;h>o;++o)d=l[n+o],c=g[o],c&&c.autoscale!==!1&&d!=b&&d!=-b&&(c.x&&(C>d&&(C=d),d>S&&(S=d)),c.y&&(x>d&&(x=d),d>T&&(T=d)));if(a.bars.show){var A;switch(a.bars.align){case"left":A=0;break;case"right":A=-a.bars.barWidth;break;case"center":A=-a.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+a.bars.align)}a.bars.horizontal?(x+=A,T+=A+a.bars.barWidth):(C+=A,S+=A+a.bars.barWidth)}t(a.xaxis,C,S),t(a.yaxis,x,T)}e.each(p(),function(e,t){t.datamin==m&&(t.datamin=null),t.datamax==v&&(t.datamax=null)})}function y(){i.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove(),"static"==i.css("position")&&i.css("position","relative"),ot=new t("flot-base",i),at=new t("flot-overlay",i),lt=ot.context,ht=at.context,rt=e(at.element).unbind();var n=i.data("plot");n&&(n.shutdown(),at.clear()),i.data("plot",mt)}function w(){st.grid.hoverable&&(rt.mousemove(q),rt.bind("mouseleave",V)),st.grid.clickable&&rt.click(G),r(gt.bindEvents,[rt])}function _(){bt&&clearTimeout(bt),rt.unbind("mousemove",q),rt.unbind("mouseleave",V),rt.unbind("click",G),r(gt.shutdown,[rt])}function C(e){function t(e){return e}var i,n,s=e.options.transform||t,o=e.options.inverseTransform;"x"==e.direction?(i=e.scale=pt/Math.abs(s(e.max)-s(e.min)),n=Math.min(s(e.max),s(e.min))):(i=e.scale=ft/Math.abs(s(e.max)-s(e.min)),i=-i,n=Math.max(s(e.max),s(e.min))),e.p2c=s==t?function(e){return(e-n)*i}:function(e){return(s(e)-n)*i},e.c2p=o?function(e){return o(n+e/i)}:function(e){return n+e/i}}function x(e){var t=e.options,i=e.ticks||[],n=t.labelWidth||0,s=t.labelHeight||0,o=n||"x"==e.direction?Math.floor(ot.width/(i.length||1)):null;legacyStyles=e.direction+"Axis "+e.direction+e.n+"Axis",layer="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+legacyStyles,font=t.font||"flot-tick-label tickLabel";for(var a=0;a<i.length;++a){var r=i[a];if(r.label){var l=ot.getTextInfo(layer,r.label,font,null,o);n=Math.max(n,l.width),s=Math.max(s,l.height)}}e.labelWidth=t.labelWidth||n,e.labelHeight=t.labelHeight||s}function S(t){var i,n=t.labelWidth,s=t.labelHeight,o=t.options.position,a=t.options.tickLength,r=st.grid.axisMargin,l=st.grid.labelMargin,h="x"==t.direction?dt:ct,d=e.grep(h,function(e){return e&&e.options.position==o&&e.reserveSpace});if(e.inArray(t,d)==d.length-1&&(r=0),null==a){var c=e.grep(h,function(e){return e&&e.reserveSpace});i=0==e.inArray(t,c),a=i?"full":5}isNaN(+a)||(l+=+a),"x"==t.direction?(s+=l,"bottom"==o?(ut.bottom+=s+r,t.box={top:ot.height-ut.bottom,height:s}):(t.box={top:ut.top+r,height:s},ut.top+=s+r)):(n+=l,"left"==o?(t.box={left:ut.left+r,width:n},ut.left+=n+r):(ut.right+=n+r,t.box={left:ot.width-ut.right,width:n})),t.position=o,t.tickLength=a,t.box.padding=l,t.innermost=i}function T(e){"x"==e.direction?(e.box.left=ut.left-e.labelWidth/2,e.box.width=ot.width-ut.left-ut.right+e.labelWidth):(e.box.top=ut.top-e.labelHeight/2,e.box.height=ot.height-ut.bottom-ut.top+e.labelHeight)}function A(){var t,i=st.grid.minBorderMargin,n={x:0,y:0};if(null==i)for(i=0,t=0;t<nt.length;++t)i=Math.max(i,2*(nt[t].points.radius+nt[t].points.lineWidth/2));n.x=n.y=Math.ceil(i),e.each(p(),function(e,t){var i=t.direction;t.reserveSpace&&(n[i]=Math.ceil(Math.max(n[i],("x"==i?t.labelWidth:t.labelHeight)/2)))}),ut.left=Math.max(n.x,ut.left),ut.right=Math.max(n.x,ut.right),ut.top=Math.max(n.y,ut.top),ut.bottom=Math.max(n.y,ut.bottom)
}function k(){var t,i=p(),n=st.grid.show;for(var s in ut){var o=st.grid.margin||0;ut[s]="number"==typeof o?o:o[s]||0}r(gt.processOffset,[ut]);for(var s in ut)ut[s]+="object"==typeof st.grid.borderWidth?n?st.grid.borderWidth[s]:0:n?st.grid.borderWidth:0;if(e.each(i,function(e,t){t.show=t.options.show,null==t.show&&(t.show=t.used),t.reserveSpace=t.show||t.options.reserveSpace,$(t)}),n){var a=e.grep(i,function(e){return e.reserveSpace});for(e.each(a,function(e,t){P(t),D(t),I(t,t.ticks),x(t)}),t=a.length-1;t>=0;--t)S(a[t]);A(),e.each(a,function(e,t){T(t)})}pt=ot.width-ut.left-ut.right,ft=ot.height-ut.bottom-ut.top,e.each(i,function(e,t){C(t)}),n&&N(),U()}function $(e){var t=e.options,i=+(null!=t.min?t.min:e.datamin),n=+(null!=t.max?t.max:e.datamax),s=n-i;if(0==s){var o=0==n?1:.01;null==t.min&&(i-=o),(null==t.max||null!=t.min)&&(n+=o)}else{var a=t.autoscaleMargin;null!=a&&(null==t.min&&(i-=s*a,0>i&&null!=e.datamin&&e.datamin>=0&&(i=0)),null==t.max&&(n+=s*a,n>0&&null!=e.datamax&&e.datamax<=0&&(n=0)))}e.min=i,e.max=n}function P(t){var i,s=t.options;i="number"==typeof s.ticks&&s.ticks>0?s.ticks:.3*Math.sqrt("x"==t.direction?ot.width:ot.height);var o=(t.max-t.min)/i,a=-Math.floor(Math.log(o)/Math.LN10),r=s.tickDecimals;null!=r&&a>r&&(a=r);var l,h=Math.pow(10,-a),d=o/h;if(1.5>d?l=1:3>d?(l=2,d>2.25&&(null==r||r>=a+1)&&(l=2.5,++a)):l=7.5>d?5:10,l*=h,null!=s.minTickSize&&l<s.minTickSize&&(l=s.minTickSize),t.delta=o,t.tickDecimals=Math.max(0,null!=r?r:a),t.tickSize=s.tickSize||l,"time"==s.mode&&!t.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(t.tickGenerator||(t.tickGenerator=function(e){var t,i=[],s=n(e.min,e.tickSize),o=0,a=Number.NaN;do t=a,a=s+o*e.tickSize,i.push(a),++o;while(a<e.max&&a!=t);return i},t.tickFormatter=function(e,t){var i=t.tickDecimals?Math.pow(10,t.tickDecimals):1,n=""+Math.round(e*i)/i;if(null!=t.tickDecimals){var s=n.indexOf("."),o=-1==s?0:n.length-s-1;if(o<t.tickDecimals)return(o?n:n+".")+(""+i).substr(1,t.tickDecimals-o)}return n}),e.isFunction(s.tickFormatter)&&(t.tickFormatter=function(e,t){return""+s.tickFormatter(e,t)}),null!=s.alignTicksWithAxis){var c=("x"==t.direction?dt:ct)[s.alignTicksWithAxis-1];if(c&&c.used&&c!=t){var u=t.tickGenerator(t);if(u.length>0&&(null==s.min&&(t.min=Math.min(t.min,u[0])),null==s.max&&u.length>1&&(t.max=Math.max(t.max,u[u.length-1]))),t.tickGenerator=function(e){var t,i,n=[];for(i=0;i<c.ticks.length;++i)t=(c.ticks[i].v-c.min)/(c.max-c.min),t=e.min+t*(e.max-e.min),n.push(t);return n},!t.mode&&null==s.tickDecimals){var p=Math.max(0,-Math.floor(Math.log(t.delta)/Math.LN10)+1),f=t.tickGenerator(t);f.length>1&&/\..*0$/.test((f[1]-f[0]).toFixed(p))||(t.tickDecimals=p)}}}}function D(t){var i=t.options.ticks,n=[];null==i||"number"==typeof i&&i>0?n=t.tickGenerator(t):i&&(n=e.isFunction(i)?i(t):i);var s,o;for(t.ticks=[],s=0;s<n.length;++s){var a=null,r=n[s];"object"==typeof r?(o=+r[0],r.length>1&&(a=r[1])):o=+r,null==a&&(a=t.tickFormatter(o,t)),isNaN(o)||t.ticks.push({v:o,label:a})}}function I(e,t){e.options.autoscaleMargin&&t.length>0&&(null==e.options.min&&(e.min=Math.min(e.min,t[0].v)),null==e.options.max&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)))}function L(){ot.clear(),r(gt.drawBackground,[lt]);var e=st.grid;e.show&&e.backgroundColor&&M(),e.show&&!e.aboveData&&R();for(var t=0;t<nt.length;++t)r(gt.drawSeries,[lt,nt[t]]),F(nt[t]);r(gt.draw,[lt]),e.show&&e.aboveData&&R(),ot.render(),X()}function E(e,t){for(var i,n,s,o,a=p(),r=0;r<a.length;++r)if(i=a[r],i.direction==t&&(o=t+i.n+"axis",e[o]||1!=i.n||(o=t+"axis"),e[o])){n=e[o].from,s=e[o].to;break}if(e[o]||(i="x"==t?dt[0]:ct[0],n=e[t+"1"],s=e[t+"2"]),null!=n&&null!=s&&n>s){var l=n;n=s,s=l}return{from:n,to:s,axis:i}}function M(){lt.save(),lt.translate(ut.left,ut.top),lt.fillStyle=it(st.grid.backgroundColor,ft,0,"rgba(255, 255, 255, 0)"),lt.fillRect(0,0,pt,ft),lt.restore()}function R(){var t,i,n,s;lt.save(),lt.translate(ut.left,ut.top);var o=st.grid.markings;if(o)for(e.isFunction(o)&&(i=mt.getAxes(),i.xmin=i.xaxis.min,i.xmax=i.xaxis.max,i.ymin=i.yaxis.min,i.ymax=i.yaxis.max,o=o(i)),t=0;t<o.length;++t){var a=o[t],r=E(a,"x"),l=E(a,"y");null==r.from&&(r.from=r.axis.min),null==r.to&&(r.to=r.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),r.to<r.axis.min||r.from>r.axis.max||l.to<l.axis.min||l.from>l.axis.max||(r.from=Math.max(r.from,r.axis.min),r.to=Math.min(r.to,r.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max),(r.from!=r.to||l.from!=l.to)&&(r.from=r.axis.p2c(r.from),r.to=r.axis.p2c(r.to),l.from=l.axis.p2c(l.from),l.to=l.axis.p2c(l.to),r.from==r.to||l.from==l.to?(lt.beginPath(),lt.strokeStyle=a.color||st.grid.markingsColor,lt.lineWidth=a.lineWidth||st.grid.markingsLineWidth,lt.moveTo(r.from,l.from),lt.lineTo(r.to,l.to),lt.stroke()):(lt.fillStyle=a.color||st.grid.markingsColor,lt.fillRect(r.from,l.to,r.to-r.from,l.from-l.to))))}i=p(),n=st.grid.borderWidth;for(var h=0;h<i.length;++h){var d,c,u,f,g=i[h],m=g.box,v=g.tickLength;if(g.show&&0!=g.ticks.length){for(lt.lineWidth=1,"x"==g.direction?(d=0,c="full"==v?"top"==g.position?0:ft:m.top-ut.top+("top"==g.position?m.height:0)):(c=0,d="full"==v?"left"==g.position?0:pt:m.left-ut.left+("left"==g.position?m.width:0)),g.innermost||(lt.strokeStyle=g.options.color,lt.beginPath(),u=f=0,"x"==g.direction?u=pt+1:f=ft+1,1==lt.lineWidth&&("x"==g.direction?c=Math.floor(c)+.5:d=Math.floor(d)+.5),lt.moveTo(d,c),lt.lineTo(d+u,c+f),lt.stroke()),lt.strokeStyle=g.options.tickColor,lt.beginPath(),t=0;t<g.ticks.length;++t){var b=g.ticks[t].v;u=f=0,isNaN(b)||b<g.min||b>g.max||"full"==v&&("object"==typeof n&&n[g.position]>0||n>0)&&(b==g.min||b==g.max)||("x"==g.direction?(d=g.p2c(b),f="full"==v?-ft:v,"top"==g.position&&(f=-f)):(c=g.p2c(b),u="full"==v?-pt:v,"left"==g.position&&(u=-u)),1==lt.lineWidth&&("x"==g.direction?d=Math.floor(d)+.5:c=Math.floor(c)+.5),lt.moveTo(d,c),lt.lineTo(d+u,c+f))}lt.stroke()}}n&&(s=st.grid.borderColor,"object"==typeof n||"object"==typeof s?("object"!=typeof n&&(n={top:n,right:n,bottom:n,left:n}),"object"!=typeof s&&(s={top:s,right:s,bottom:s,left:s}),n.top>0&&(lt.strokeStyle=s.top,lt.lineWidth=n.top,lt.beginPath(),lt.moveTo(0-n.left,0-n.top/2),lt.lineTo(pt,0-n.top/2),lt.stroke()),n.right>0&&(lt.strokeStyle=s.right,lt.lineWidth=n.right,lt.beginPath(),lt.moveTo(pt+n.right/2,0-n.top),lt.lineTo(pt+n.right/2,ft),lt.stroke()),n.bottom>0&&(lt.strokeStyle=s.bottom,lt.lineWidth=n.bottom,lt.beginPath(),lt.moveTo(pt+n.right,ft+n.bottom/2),lt.lineTo(0,ft+n.bottom/2),lt.stroke()),n.left>0&&(lt.strokeStyle=s.left,lt.lineWidth=n.left,lt.beginPath(),lt.moveTo(0-n.left/2,ft+n.bottom),lt.lineTo(0-n.left/2,0),lt.stroke())):(lt.lineWidth=n,lt.strokeStyle=st.grid.borderColor,lt.strokeRect(-n/2,-n/2,pt+n,ft+n))),lt.restore()}function N(){e.each(p(),function(e,t){if(t.show&&0!=t.ticks.length){var i,n,s,o,a,r=t.box,l=t.direction+"Axis "+t.direction+t.n+"Axis",h="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+l,d=t.options.font||"flot-tick-label tickLabel";ot.removeText(h);for(var c=0;c<t.ticks.length;++c)i=t.ticks[c],!i.label||i.v<t.min||i.v>t.max||("x"==t.direction?(o="center",n=ut.left+t.p2c(i.v),"bottom"==t.position?s=r.top+r.padding:(s=r.top+r.height-r.padding,a="bottom")):(a="middle",s=ut.top+t.p2c(i.v),"left"==t.position?(n=r.left+r.width-r.padding,o="right"):n=r.left+r.padding),ot.addText(h,n,s,i.label,d,null,null,o,a))}})}function F(e){e.lines.show&&B(e),e.bars.show&&j(e),e.points.show&&O(e)}function B(e){function t(e,t,i,n,s){var o=e.points,a=e.pointsize,r=null,l=null;lt.beginPath();for(var h=a;h<o.length;h+=a){var d=o[h-a],c=o[h-a+1],u=o[h],p=o[h+1];if(null!=d&&null!=u){if(p>=c&&c<s.min){if(p<s.min)continue;d=(s.min-c)/(p-c)*(u-d)+d,c=s.min}else if(c>=p&&p<s.min){if(c<s.min)continue;u=(s.min-c)/(p-c)*(u-d)+d,p=s.min}if(c>=p&&c>s.max){if(p>s.max)continue;d=(s.max-c)/(p-c)*(u-d)+d,c=s.max}else if(p>=c&&p>s.max){if(c>s.max)continue;u=(s.max-c)/(p-c)*(u-d)+d,p=s.max}if(u>=d&&d<n.min){if(u<n.min)continue;c=(n.min-d)/(u-d)*(p-c)+c,d=n.min}else if(d>=u&&u<n.min){if(d<n.min)continue;p=(n.min-d)/(u-d)*(p-c)+c,u=n.min}if(d>=u&&d>n.max){if(u>n.max)continue;c=(n.max-d)/(u-d)*(p-c)+c,d=n.max}else if(u>=d&&u>n.max){if(d>n.max)continue;p=(n.max-d)/(u-d)*(p-c)+c,u=n.max}(d!=r||c!=l)&&lt.moveTo(n.p2c(d)+t,s.p2c(c)+i),r=u,l=p,lt.lineTo(n.p2c(u)+t,s.p2c(p)+i)}}lt.stroke()}function i(e,t,i){for(var n=e.points,s=e.pointsize,o=Math.min(Math.max(0,i.min),i.max),a=0,r=!1,l=1,h=0,d=0;;){if(s>0&&a>n.length+s)break;a+=s;var c=n[a-s],u=n[a-s+l],p=n[a],f=n[a+l];if(r){if(s>0&&null!=c&&null==p){d=a,s=-s,l=2;continue}if(0>s&&a==h+s){lt.fill(),r=!1,s=-s,l=1,a=h=d+s;continue}}if(null!=c&&null!=p){if(p>=c&&c<t.min){if(p<t.min)continue;u=(t.min-c)/(p-c)*(f-u)+u,c=t.min}else if(c>=p&&p<t.min){if(c<t.min)continue;f=(t.min-c)/(p-c)*(f-u)+u,p=t.min}if(c>=p&&c>t.max){if(p>t.max)continue;u=(t.max-c)/(p-c)*(f-u)+u,c=t.max}else if(p>=c&&p>t.max){if(c>t.max)continue;f=(t.max-c)/(p-c)*(f-u)+u,p=t.max}if(r||(lt.beginPath(),lt.moveTo(t.p2c(c),i.p2c(o)),r=!0),u>=i.max&&f>=i.max)lt.lineTo(t.p2c(c),i.p2c(i.max)),lt.lineTo(t.p2c(p),i.p2c(i.max));else if(u<=i.min&&f<=i.min)lt.lineTo(t.p2c(c),i.p2c(i.min)),lt.lineTo(t.p2c(p),i.p2c(i.min));else{var g=c,m=p;f>=u&&u<i.min&&f>=i.min?(c=(i.min-u)/(f-u)*(p-c)+c,u=i.min):u>=f&&f<i.min&&u>=i.min&&(p=(i.min-u)/(f-u)*(p-c)+c,f=i.min),u>=f&&u>i.max&&f<=i.max?(c=(i.max-u)/(f-u)*(p-c)+c,u=i.max):f>=u&&f>i.max&&u<=i.max&&(p=(i.max-u)/(f-u)*(p-c)+c,f=i.max),c!=g&&lt.lineTo(t.p2c(g),i.p2c(u)),lt.lineTo(t.p2c(c),i.p2c(u)),lt.lineTo(t.p2c(p),i.p2c(f)),p!=m&&(lt.lineTo(t.p2c(p),i.p2c(f)),lt.lineTo(t.p2c(m),i.p2c(f)))}}}}lt.save(),lt.translate(ut.left,ut.top),lt.lineJoin="round";var n=e.lines.lineWidth,s=e.shadowSize;if(n>0&&s>0){lt.lineWidth=s,lt.strokeStyle="rgba(0,0,0,0.1)";var o=Math.PI/18;t(e.datapoints,Math.sin(o)*(n/2+s/2),Math.cos(o)*(n/2+s/2),e.xaxis,e.yaxis),lt.lineWidth=s/2,t(e.datapoints,Math.sin(o)*(n/2+s/4),Math.cos(o)*(n/2+s/4),e.xaxis,e.yaxis)}lt.lineWidth=n,lt.strokeStyle=e.color;var a=H(e.lines,e.color,0,ft);a&&(lt.fillStyle=a,i(e.datapoints,e.xaxis,e.yaxis)),n>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis),lt.restore()}function O(e){function t(e,t,i,n,s,o,a,r){for(var l=e.points,h=e.pointsize,d=0;d<l.length;d+=h){var c=l[d],u=l[d+1];null==c||c<o.min||c>o.max||u<a.min||u>a.max||(lt.beginPath(),c=o.p2c(c),u=a.p2c(u)+n,"circle"==r?lt.arc(c,u,t,0,s?Math.PI:2*Math.PI,!1):r(lt,c,u,t,s),lt.closePath(),i&&(lt.fillStyle=i,lt.fill()),lt.stroke())}}lt.save(),lt.translate(ut.left,ut.top);var i=e.points.lineWidth,n=e.shadowSize,s=e.points.radius,o=e.points.symbol;if(0==i&&(i=1e-4),i>0&&n>0){var a=n/2;lt.lineWidth=a,lt.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,s,null,a+a/2,!0,e.xaxis,e.yaxis,o),lt.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,s,null,a/2,!0,e.xaxis,e.yaxis,o)}lt.lineWidth=i,lt.strokeStyle=e.color,t(e.datapoints,s,H(e.points,e.color),0,!1,e.xaxis,e.yaxis,o),lt.restore()}function z(e,t,i,n,s,o,a,r,l,h,d,c){var u,p,f,g,m,v,b,y,w;d?(y=v=b=!0,m=!1,u=i,p=e,g=t+n,f=t+s,u>p&&(w=p,p=u,u=w,m=!0,v=!1)):(m=v=b=!0,y=!1,u=e+n,p=e+s,f=i,g=t,f>g&&(w=g,g=f,f=w,y=!0,b=!1)),p<r.min||u>r.max||g<l.min||f>l.max||(u<r.min&&(u=r.min,m=!1),p>r.max&&(p=r.max,v=!1),f<l.min&&(f=l.min,y=!1),g>l.max&&(g=l.max,b=!1),u=r.p2c(u),f=l.p2c(f),p=r.p2c(p),g=l.p2c(g),a&&(h.beginPath(),h.moveTo(u,f),h.lineTo(u,g),h.lineTo(p,g),h.lineTo(p,f),h.fillStyle=a(f,g),h.fill()),c>0&&(m||v||b||y)&&(h.beginPath(),h.moveTo(u,f+o),m?h.lineTo(u,g+o):h.moveTo(u,g+o),b?h.lineTo(p,g+o):h.moveTo(p,g+o),v?h.lineTo(p,f+o):h.moveTo(p,f+o),y?h.lineTo(u,f+o):h.moveTo(u,f+o),h.stroke()))}function j(e){function t(t,i,n,s,o,a,r){for(var l=t.points,h=t.pointsize,d=0;d<l.length;d+=h)null!=l[d]&&z(l[d],l[d+1],l[d+2],i,n,s,o,a,r,lt,e.bars.horizontal,e.bars.lineWidth)}lt.save(),lt.translate(ut.left,ut.top),lt.lineWidth=e.bars.lineWidth,lt.strokeStyle=e.color;var i;switch(e.bars.align){case"left":i=0;break;case"right":i=-e.bars.barWidth;break;case"center":i=-e.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+e.bars.align)}var n=e.bars.fill?function(t,i){return H(e.bars,e.color,t,i)}:null;t(e.datapoints,i,i+e.bars.barWidth,0,n,e.xaxis,e.yaxis),lt.restore()}function H(t,i,n,s){var o=t.fill;if(!o)return null;if(t.fillColor)return it(t.fillColor,n,s,i);var a=e.color.parse(i);return a.a="number"==typeof o?o:.4,a.normalize(),a.toString()}function U(){if(i.find(".legend").remove(),st.legend.show){for(var t,n,s=[],o=[],a=!1,r=st.legend.labelFormatter,l=0;l<nt.length;++l)t=nt[l],t.label&&(n=r?r(t.label,t):t.label,n&&o.push({label:n,color:t.color}));if(st.legend.sorted)if(e.isFunction(st.legend.sorted))o.sort(st.legend.sorted);else if("reverse"==st.legend.sorted)o.reverse();else{var h="descending"!=st.legend.sorted;o.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=h?1:-1})}for(var l=0;l<o.length;++l){var d=o[l];l%st.legend.noColumns==0&&(a&&s.push("</tr>"),s.push("<tr>"),a=!0),s.push('<td class="legendColorBox"><div style="border:1px solid '+st.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+d.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+d.label+"</td>")}if(a&&s.push("</tr>"),0!=s.length){var c='<table style="font-size:smaller;color:'+st.grid.color+'">'+s.join("")+"</table>";if(null!=st.legend.container)e(st.legend.container).html(c);else{var u="",p=st.legend.position,f=st.legend.margin;null==f[0]&&(f=[f,f]),"n"==p.charAt(0)?u+="top:"+(f[1]+ut.top)+"px;":"s"==p.charAt(0)&&(u+="bottom:"+(f[1]+ut.bottom)+"px;"),"e"==p.charAt(1)?u+="right:"+(f[0]+ut.right)+"px;":"w"==p.charAt(1)&&(u+="left:"+(f[0]+ut.left)+"px;");var g=e('<div class="legend">'+c.replace('style="','style="position:absolute;'+u+";")+"</div>").appendTo(i);if(0!=st.legend.backgroundOpacity){var m=st.legend.backgroundColor;null==m&&(m=st.grid.backgroundColor,m=m&&"string"==typeof m?e.color.parse(m):e.color.extract(g,"background-color"),m.a=1,m=m.toString());var v=g.children();e('<div style="position:absolute;width:'+v.width()+"px;height:"+v.height()+"px;"+u+"background-color:"+m+';"> </div>').prependTo(g).css("opacity",st.legend.backgroundOpacity)}}}}}function W(e,t,i){var n,s,o,a=st.grid.mouseActiveRadius,r=a*a+1,l=null;for(n=nt.length-1;n>=0;--n)if(i(nt[n])){var h=nt[n],d=h.xaxis,c=h.yaxis,u=h.datapoints.points,p=d.c2p(e),f=c.c2p(t),g=a/d.scale,m=a/c.scale;if(o=h.datapoints.pointsize,d.options.inverseTransform&&(g=Number.MAX_VALUE),c.options.inverseTransform&&(m=Number.MAX_VALUE),h.lines.show||h.points.show)for(s=0;s<u.length;s+=o){var v=u[s],b=u[s+1];if(null!=v&&!(v-p>g||-g>v-p||b-f>m||-m>b-f)){var y=Math.abs(d.p2c(v)-e),w=Math.abs(c.p2c(b)-t),_=y*y+w*w;r>_&&(r=_,l=[n,s/o])}}if(h.bars.show&&!l){var C="left"==h.bars.align?0:-h.bars.barWidth/2,x=C+h.bars.barWidth;for(s=0;s<u.length;s+=o){var v=u[s],b=u[s+1],S=u[s+2];null!=v&&(nt[n].bars.horizontal?p<=Math.max(S,v)&&p>=Math.min(S,v)&&f>=b+C&&b+x>=f:p>=v+C&&v+x>=p&&f>=Math.min(S,b)&&f<=Math.max(S,b))&&(l=[n,s/o])}}}return l?(n=l[0],s=l[1],o=nt[n].datapoints.pointsize,{datapoint:nt[n].datapoints.points.slice(s*o,(s+1)*o),dataIndex:s,series:nt[n],seriesIndex:n}):null}function q(e){st.grid.hoverable&&Y("plothover",e,function(e){return 0!=e.hoverable})}function V(e){st.grid.hoverable&&Y("plothover",e,function(){return!1})}function G(e){Y("plotclick",e,function(e){return 0!=e.clickable})}function Y(e,t,n){var s=rt.offset(),o=t.pageX-s.left-ut.left,a=t.pageY-s.top-ut.top,r=f({left:o,top:a});r.pageX=t.pageX,r.pageY=t.pageY;var l=W(o,a,n);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+s.left+ut.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+s.top+ut.top,10)),st.grid.autoHighlight){for(var h=0;h<vt.length;++h){var d=vt[h];d.auto!=e||l&&d.series==l.series&&d.point[0]==l.datapoint[0]&&d.point[1]==l.datapoint[1]||K(d.series,d.point)}l&&J(l.series,l.datapoint,e)}i.trigger(e,[r,l])}function X(){var e=st.interaction.redrawOverlayInterval;return-1==e?void Z():void(bt||(bt=setTimeout(Z,e)))}function Z(){bt=null,ht.save(),at.clear(),ht.translate(ut.left,ut.top);var e,t;for(e=0;e<vt.length;++e)t=vt[e],t.series.bars.show?tt(t.series,t.point):et(t.series,t.point);ht.restore(),r(gt.drawOverlay,[ht])}function J(e,t,i){if("number"==typeof e&&(e=nt[e]),"number"==typeof t){var n=e.datapoints.pointsize;t=e.datapoints.points.slice(n*t,n*(t+1))}var s=Q(e,t);-1==s?(vt.push({series:e,point:t,auto:i}),X()):i||(vt[s].auto=!1)}function K(e,t){if(null==e&&null==t)return vt=[],void X();if("number"==typeof e&&(e=nt[e]),"number"==typeof t){var i=e.datapoints.pointsize;t=e.datapoints.points.slice(i*t,i*(t+1))}var n=Q(e,t);-1!=n&&(vt.splice(n,1),X())}function Q(e,t){for(var i=0;i<vt.length;++i){var n=vt[i];if(n.series==e&&n.point[0]==t[0]&&n.point[1]==t[1])return i}return-1}function et(t,i){var n=i[0],s=i[1],o=t.xaxis,a=t.yaxis,r="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString();if(!(n<o.min||n>o.max||s<a.min||s>a.max)){var l=t.points.radius+t.points.lineWidth/2;ht.lineWidth=l,ht.strokeStyle=r;var h=1.5*l;n=o.p2c(n),s=a.p2c(s),ht.beginPath(),"circle"==t.points.symbol?ht.arc(n,s,h,0,2*Math.PI,!1):t.points.symbol(ht,n,s,h,!1),ht.closePath(),ht.stroke()}}function tt(t,i){var n="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString(),s=n,o="left"==t.bars.align?0:-t.bars.barWidth/2;ht.lineWidth=t.bars.lineWidth,ht.strokeStyle=n,z(i[0],i[1],i[2]||0,o,o+t.bars.barWidth,0,function(){return s},t.xaxis,t.yaxis,ht,t.bars.horizontal,t.bars.lineWidth)}function it(t,i,n,s){if("string"==typeof t)return t;for(var o=lt.createLinearGradient(0,n,0,i),a=0,r=t.colors.length;r>a;++a){var l=t.colors[a];if("string"!=typeof l){var h=e.color.parse(s);null!=l.brightness&&(h=h.scale("rgb",l.brightness)),null!=l.opacity&&(h.a*=l.opacity),l=h.toString()}o.addColorStop(a/(r-1),l)}return o}var nt=[],st={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},ot=null,at=null,rt=null,lt=null,ht=null,dt=[],ct=[],ut={left:0,right:0,top:0,bottom:0},pt=0,ft=0,gt={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},mt=this;mt.setData=d,mt.setupGrid=k,mt.draw=L,mt.getPlaceholder=function(){return i},mt.getCanvas=function(){return ot.element},mt.getPlotOffset=function(){return ut},mt.width=function(){return pt},mt.height=function(){return ft},mt.offset=function(){var e=rt.offset();return e.left+=ut.left,e.top+=ut.top,e},mt.getData=function(){return nt},mt.getAxes=function(){var t={};return e.each(dt.concat(ct),function(e,i){i&&(t[i.direction+(1!=i.n?i.n:"")+"axis"]=i)}),t},mt.getXAxes=function(){return dt},mt.getYAxes=function(){return ct},mt.c2p=f,mt.p2c=g,mt.getOptions=function(){return st},mt.highlight=J,mt.unhighlight=K,mt.triggerRedrawOverlay=X,mt.pointOffset=function(e){return{left:parseInt(dt[u(e,"x")-1].p2c(+e.x)+ut.left,10),top:parseInt(ct[u(e,"y")-1].p2c(+e.y)+ut.top,10)}},mt.shutdown=_,mt.resize=function(){var e=i.width(),t=i.height();ot.resize(e,t),at.resize(e,t)},mt.hooks=gt,l(mt),h(o),y(),d(s),k(),L(),w();var vt=[],bt=null}function n(e,t){return t*Math.floor(e/t)}var s=Object.prototype.hasOwnProperty;t.prototype.resize=function(e,t){if(0>=e||0>=t)throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t);var i=this.element,n=this.context,s=this.pixelRatio;this.width!=e&&(i.width=e*s,i.style.width=e+"px",this.width=e),this.height!=t&&(i.height=t*s,i.style.height=t+"px",this.height=t),n.restore(),n.save(),n.scale(s,s)},t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t.prototype.render=function(){var e=this._textCache;for(var t in e)if(s.call(e,t)){var i=this.getTextLayer(t),n=e[t];i.hide();for(var o in n)if(s.call(n,o)){var a=n[o];for(var r in a)if(s.call(a,r)){for(var l,h=a[r].positions,d=0;l=h[d];d++)l.active?l.rendered||(i.append(l.element),l.rendered=!0):(h.splice(d--,1),l.rendered&&l.element.detach());0==h.length&&delete a[r]}}i.show()}},t.prototype.getTextLayer=function(t){var i=this.text[t];return null==i&&(null==this.textContainer&&(this.textContainer=e("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),i=this.text[t]=e("<div></div>").addClass(t).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),i},t.prototype.getTextInfo=function(t,i,n,s,o){var a,r,l,h;if(i=""+i,a="object"==typeof n?n.style+" "+n.variant+" "+n.weight+" "+n.size+"px/"+n.lineHeight+"px "+n.family:n,r=this._textCache[t],null==r&&(r=this._textCache[t]={}),l=r[a],null==l&&(l=r[a]={}),h=l[i],null==h){var d=e("<div></div>").html(i).css({position:"absolute","max-width":o,top:-9999}).appendTo(this.getTextLayer(t));"object"==typeof n?d.css({font:a,color:n.color}):"string"==typeof n&&d.addClass(n),h=l[i]={width:d.outerWidth(!0),height:d.outerHeight(!0),element:d,positions:[]},d.detach()}return h},t.prototype.addText=function(e,t,i,n,s,o,a,r,l){var h=this.getTextInfo(e,n,s,o,a),d=h.positions;"center"==r?t-=h.width/2:"right"==r&&(t-=h.width),"middle"==l?i-=h.height/2:"bottom"==l&&(i-=h.height);for(var c,u=0;c=d[u];u++)if(c.x==t&&c.y==i)return void(c.active=!0);c={active:!0,rendered:!1,element:d.length?h.element.clone():h.element,x:t,y:i},d.push(c),c.element.css({top:Math.round(i),left:Math.round(t),"text-align":r})},t.prototype.removeText=function(e,t,i,n,o,a){if(null==n){var r=this._textCache[e];if(null!=r)for(var l in r)if(s.call(r,l)){var h=r[l];for(var d in h)if(s.call(h,d))for(var c,u=h[d].positions,p=0;c=u[p];p++)c.active=!1}}else for(var c,u=this.getTextInfo(e,n,o,a).positions,p=0;c=u[p];p++)c.x==t&&c.y==i&&(c.active=!1)},e.plot=function(t,n,s){var o=new i(e(t),n,s,e.plot.plugins);return o},e.plot.version="0.8.1",e.plot.plugins=[],e.fn.plot=function(t,i){return this.each(function(){e.plot(this,t,i)})}}(jQuery),define("libs/flot/jquery.flot",function(){}),define("modules/interactives/interactive-base",["jquery","underscore","baseview","utils","modules/interactives/interactive-ads","libs/flot/jquery.flot"],function(e,t,i,n,s){"use strict";var o=i.extend({events:{"plothover .chart-area":"lazyHover"},initialize:function(e){var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),i.prototype.initialize.call(this,e),this.initializeDom(),this.flotData=this.getFlotData(this.datasetItems),this.graph.length&&null!==this.flotData&&void 0!==this.flotData&&(t&&(this.subviews.interactiveAds=new s({el:this.$(".interactive-sponsor")})),this.redraw(),this.$chartHover.css("color",this.mainColor))},redraw:function(){e.plot(this.graph,this.flotData,this.getFlotOptions()),this.calculateBoundVal()},initializeDom:function(){this.chartData=JSON.parse(this.$(".chartData").html()||"{}"),this.datasetItems=n.getNested(this.chartData,"datasets","item")||[],this.chartColors=this.getChartColors(),this.$chartHover=this.$(".chart-hover"),this.$chartArea=this.$(".chart-area"),this.graph=this.$(".graph"),this.colorsArray=(this.$el.data("colors")||"").split("|"),this.colorsArray.length>=6?this.mainColor=this.colorsArray[2]:1==this.colorsArray.length&&(this.mainColor=this.colorsArray[0])},getChartColors:function(){return(this.$el.data("colors")||"rgb(100,100,100)").split("|")},numberWithCommas:function(e){return e.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")},_createTicks:function(e){return t.map(e.split("|"),function(e,t){return[t,e]})},calculateBoundVal:function(){this.hoverLeftBoundVal=this.hoverLeftBound(),this.hoverRightBoundVal=this.hoverRightBound(),this.hoverTopBoundVal=this.hoverTopBound(),this.hoverBottomBoundVal=this.hoverBottomBound()},hoverLeftBound:function(){return this.$el.width()/2},hoverRightBound:function(){return this.$el.width()/2},hoverTopBound:function(){return this.$el.height()/5},hoverBottomBound:function(){return this.$el.height()/5},getHoverPrefix:function(){return this.chartData.beforelabel||""},getHoverSuffix:function(){return this.chartData.afterlabel||""},_getHoverClass:function(e){return e.pageX>this.hoverRightBoundVal/2&&e.pageX<this.hoverLeftBoundVal/2?e.pageY<this.hoverTopBoundVal?"top":e.pageY>this.hoverBottomBoundVal?"bottom":void 0:e.pageX<this.hoverLeftBoundVal?"middleleft":e.pageX>this.hoverRightBoundVal?"middleright":""},_getHoverPosition:function(e,t){return t.pageX>this.hoverRightBoundVal/2&&t.pageX<this.hoverLeftBoundVal/2?t.pageY<this.hoverTopBoundVal?{top:e.pageY,left:e.pageX-this.$chartHover.outerWidth(!0)/2}:t.pageY>this.hoverBottomBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0),left:e.pageX-this.$chartHover.outerWidth(!0)/2}:void 0:t.pageX<this.hoverLeftBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0)/2,left:e.pageX}:t.pageX>this.hoverRightBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0)/2,left:e.pageX-this.$chartHover.outerWidth(!0)}:null},lazyHover:function(){this.lazyDebounce||(this.lazyDebounce=t.throttle(this._hover,20)),this.lazyDebounce.apply(this,arguments)},_hover:function(e,t,i){if(i&&t&&e&&i.series){var n={pageY:t.pageY-this.$el.offset().top,pageX:t.pageX-this.$el.offset().left},s={pageY:t.pageY-this.$chartArea.offset().top,pageX:t.pageX-this.$chartArea.offset().left},o=this._getHoverClass(n),a="pointer-"+o.replace("middle",""),r=""!==this._getHoverLabel(i)?"<h3>"+this._getHoverLabel(i)+"</h3>":"",l='<div class="'+a+'"></div>'+r+"<h4>"+this._getHoverBody(i)+"</h4>",h=this._getHoverPosition(s,n);this.$chartHover.show(),this.$chartHover.html(l),h&&o?this.$chartHover.css(h).attr("class",o+"-hover chart-hover"):this.$chartHover.hide()}else this.$chartHover.hide()},_getHoverBody:function(e){var t=n.addCommas(""+parseFloat(n.getNested(e,"series","percent")||0).toFixed(0));return t+"%"},_getHoverLabel:function(e){return e.series.label},getFlotOptions:function(){return{series:{},grid:{hoverable:!0,clickable:!0},legend:{show:!1}}},getFlotData:function(e){return t.map(e,function(e,t,i){var s=this.mainColor;return i.length>1&&(s=this.chartColors[t%this.chartColors.length]),{label:n.getNested(e,"label")||"",data:parseFloat(e.value),color:s}},this)},destroy:function(e,t){var n=(this.graph.data()||{}).plot;n&&n.shutdown&&n.shutdown(),i.prototype.destroy.call(this,e,t)}});return o}),function(e){function t(t){function s(e,t){t.series.pie.show&&(t.grid.show=!1,"auto"==t.series.pie.label.show&&(t.series.pie.label.show=t.legend.show?!1:!0),"auto"==t.series.pie.radius&&(t.series.pie.radius=t.series.pie.label.show?.75:1),t.series.pie.tilt>1&&(t.series.pie.tilt=1),t.series.pie.tilt<0&&(t.series.pie.tilt=0),e.hooks.processDatapoints.push(r),e.hooks.drawOverlay.push(C),e.hooks.draw.push(c))}function o(e,t){var i=e.getOptions();i.series.pie.show&&i.grid.hoverable&&t.unbind("mousemove").mousemove(g),i.series.pie.show&&i.grid.clickable&&t.unbind("click").click(m)}function a(e){for(var t=0;t<e.length;++t){var i=parseFloat(e[t].data[0][1]);i&&(P+=i)}}function r(t){M||(M=!0,S=t.getCanvas(),T=e(S).parent(),n=t.getOptions(),t.setData(d(t.getData())))}function l(){E=T.children().filter(".legend").children().width(),A=Math.min(S.width,S.height/n.series.pie.tilt)/2,$=S.height/2+n.series.pie.offset.top,k=S.width/2,"auto"==n.series.pie.offset.left?n.legend.position.match("w")?k+=E/2:k-=E/2:k+=n.series.pie.offset.left,A>k?k=A:k>S.width-A&&(k=S.width-A)}function h(e){for(var t=0;t<e.length;++t)"number"==typeof e[t].data?e[t].data=[[1,e[t].data]]:("undefined"==typeof e[t].data||"undefined"==typeof e[t].data[0])&&("undefined"!=typeof e[t].data&&"undefined"!=typeof e[t].data.label&&(e[t].label=e[t].data.label),e[t].data=[[1,0]]);return e}function d(e){e=h(e),a(e);for(var t=0,i=0,s=n.series.pie.combine.color,o=[],r=0;r<e.length;++r)e[r].data[0][1]=parseFloat(e[r].data[0][1]),e[r].data[0][1]||(e[r].data[0][1]=0),e[r].data[0][1]/P<=n.series.pie.combine.threshold?(t+=e[r].data[0][1],i++,s||(s=e[r].color)):o.push({data:[[1,e[r].data[0][1]]],color:e[r].color,label:e[r].label,angle:2*e[r].data[0][1]*Math.PI/P,percent:e[r].data[0][1]/P*100});return i>0&&o.push({data:[[1,t]],color:s,label:n.series.pie.combine.label,angle:2*t*Math.PI/P,percent:t/P*100}),o}function c(t,i){function s(e){ctx.save(),ctx.translate(k,$),ctx.beginPath(),ctx.arc(0,0,e+4,90,2*Math.PI,!0),ctx.lineWidth=1,ctx.strokeStyle=R,ctx.stroke(),ctx.restore()}function o(){ctx.clearRect(0,0,S.width,S.height),T.children().filter(".pieLabel, .pieLabelBackground").remove()}function a(){var e=5,t=15,i=10,s=.02;if(n.series.pie.radius>1)var o=n.series.pie.radius;else var o=A*n.series.pie.radius;if(!(o>=S.width/2-e||o*n.series.pie.tilt>=S.height/2-t||i>=o)){ctx.save(),ctx.translate(e,t),ctx.globalAlpha=s,ctx.fillStyle="#000",ctx.translate(k,$),ctx.scale(1,n.series.pie.tilt);for(var a=1;i>=a;a++)ctx.beginPath(),ctx.arc(0,0,o,0,2*Math.PI,!1),ctx.fill(),o-=a;ctx.restore()}}function r(){function t(e,t,i){0>=e||(i?ctx.fillStyle=t:(ctx.strokeStyle=t,ctx.lineJoin="miter"),ctx.beginPath(),Math.abs(e-2*Math.PI)>1e-9&&ctx.moveTo(0,0),ctx.arc(0,0,o,a,a+e,!1),ctx.closePath(),a+=e,i?ctx.fill():ctx.stroke())}function i(){function t(t,i,o){if(0!=t.data[0][1]){var a,r=n.legend.labelFormatter,l=n.series.pie.label.formatter;a=r?r(t.label,t):t.label,l&&(a=l(a,t));var h=(i+t.angle+i)/2,d=k+Math.round(Math.cos(h)*s),c=$+Math.round(Math.sin(h)*s)*n.series.pie.tilt,u='<span class="pieLabel" id="pieLabel'+o+'" style="position:absolute;top:'+c+"px;left:"+d+'px;">'+a+"</span>";T.append(u);var p=T.children("#pieLabel"+o),f=c-p.height()/2,g=d-p.width()/2;if(p.css("top",f),p.css("left",g),(0-f>0||0-g>0||S.height-(f+p.height())<0||S.width-(g+p.width())<0)&&(D=!0),0!=n.series.pie.label.background.opacity){var m=n.series.pie.label.background.color;null==m&&(m=t.color);var v="top:"+f+"px;left:"+g+"px;";e('<div class="pieLabelBackground" style="position:absolute;width:'+p.width()+"px;height:"+p.height()+"px;"+v+"background-color:"+m+';"> </div>').insertBefore(p).css("opacity",n.series.pie.label.background.opacity)}}}var i=startAngle;if(n.series.pie.label.radius>1)var s=n.series.pie.label.radius;else var s=A*n.series.pie.label.radius;for(var o=0;o<h.length;++o)h[o].percent>=100*n.series.pie.label.threshold&&t(h[o],i,o),i+=h[o].angle}if(startAngle=Math.PI*n.series.pie.startAngle,n.series.pie.radius>1)var o=n.series.pie.radius;else var o=A*n.series.pie.radius;ctx.save(),ctx.translate(k,$),ctx.scale(1,n.series.pie.tilt),ctx.save();for(var a=startAngle,r=0;r<h.length;++r)h[r].startAngle=a,t(h[r].angle,h[r].color,!0);ctx.restore(),ctx.save(),ctx.lineWidth=n.series.pie.stroke.width,a=startAngle;for(var r=0;r<h.length;++r)t(h[r].angle,n.series.pie.stroke.color,!1);ctx.restore(),u(ctx),n.series.pie.label.show&&i(),ctx.restore(),s(o)}if(T){ctx=i,l();for(var h=t.getData(),d=0;D&&I>d;)D=!1,d>0&&(A*=L),d+=1,o(),n.series.pie.tilt<=.8&&a(),r();d>=I&&(o(),T.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>')),t.setSeries&&t.insertLegend&&(t.setSeries(h),t.insertLegend())
}}function u(e){n.series.pie.innerRadius>0&&(e.save(),innerRadius=n.series.pie.innerRadius>1?n.series.pie.innerRadius:A*n.series.pie.innerRadius,e.globalCompositeOperation="destination-out",e.beginPath(),e.fillStyle=n.series.pie.stroke.color,e.arc(0,0,innerRadius,0,2*Math.PI,!1),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.strokeStyle=n.series.pie.stroke.color,e.arc(0,0,innerRadius,0,2*Math.PI,!1),e.stroke(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.arc(0,0,innerRadius/1.2,90,2*Math.PI,!1),e.lineWidth=1,e.strokeStyle=R,e.stroke(),e.restore())}function p(e,t){for(var i=!1,n=-1,s=e.length,o=s-1;++n<s;o=n)(e[n][1]<=t[1]&&t[1]<e[o][1]||e[o][1]<=t[1]&&t[1]<e[n][1])&&t[0]<(e[o][0]-e[n][0])*(t[1]-e[n][1])/(e[o][1]-e[n][1])+e[n][0]&&(i=!i);return i}function f(e,i){for(var n=t.getData(),s=t.getOptions(),o=s.series.pie.radius>1?s.series.pie.radius:A*s.series.pie.radius,a=0;a<n.length;++a){var r=n[a];if(r.pie.show){if(ctx.save(),ctx.beginPath(),ctx.moveTo(0,0),ctx.arc(0,0,o,r.startAngle,r.startAngle+r.angle,!1),ctx.closePath(),x=e-k,y=i-$,ctx.isPointInPath){if(ctx.isPointInPath(e-k,i-$))return ctx.restore(),{datapoint:[r.percent,r.data],dataIndex:0,series:r,seriesIndex:a}}else if(p1X=o*Math.cos(r.startAngle),p1Y=o*Math.sin(r.startAngle),p2X=o*Math.cos(r.startAngle+r.angle/4),p2Y=o*Math.sin(r.startAngle+r.angle/4),p3X=o*Math.cos(r.startAngle+r.angle/2),p3Y=o*Math.sin(r.startAngle+r.angle/2),p4X=o*Math.cos(r.startAngle+r.angle/1.5),p4Y=o*Math.sin(r.startAngle+r.angle/1.5),p5X=o*Math.cos(r.startAngle+r.angle),p5Y=o*Math.sin(r.startAngle+r.angle),arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]],arrPoint=[x,y],p(arrPoly,arrPoint))return ctx.restore(),{datapoint:[r.percent,r.data],dataIndex:0,series:r,seriesIndex:a};ctx.restore()}}return null}function g(e){v("plothover",e)}function m(e){v("plotclick",e)}function v(e,i){var s=t.offset(),o=parseInt(i.pageX-s.left),a=parseInt(i.pageY-s.top),r=f(o,a);if(n.grid.autoHighlight)for(var l=0;l<N.length;++l){var h=N[l];h.auto!=e||r&&h.series==r.series||w(h.series)}r&&b(r.series,e);var d={pageX:i.pageX,pageY:i.pageY};T.trigger(e,[d,r])}function b(e,i){"number"==typeof e&&(e=series[e]);var n=_(e);-1==n?(N.push({series:e,auto:i}),t.triggerRedrawOverlay()):i||(N[n].auto=!1)}function w(e){null==e&&(N=[],t.triggerRedrawOverlay()),"number"==typeof e&&(e=series[e]);var i=_(e);-1!=i&&(N.splice(i,1),t.triggerRedrawOverlay())}function _(e){for(var t=0;t<N.length;++t){var i=N[t];if(i.series==e)return t}return-1}function C(e,t){function n(e){e.angle<0||(t.fillStyle="rgba(255, 255, 255, "+s.series.pie.highlight.opacity+")",t.beginPath(),Math.abs(e.angle-2*Math.PI)>1e-9&&t.moveTo(0,0),t.arc(0,0,o,e.startAngle,e.startAngle+e.angle,!1),t.closePath(),t.fill())}var s=e.getOptions(),o=s.series.pie.radius>1?s.series.pie.radius:A*s.series.pie.radius;for(t.save(),t.translate(k,$),t.scale(1,s.series.pie.tilt),i=0;i<N.length;++i)n(N[i].series);u(t),t.restore()}var S=null,T=null,A=null,k=null,$=null,P=0,D=!0,I=10,L=.95,E=0,M=!1,R="#ebebeb",N=[];t.hooks.processOptions.push(s),t.hooks.bindEvents.push(o)}var n={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,offset:{top:0,left:"auto"},stroke:{color:"#FFF",width:1},label:{show:"auto",formatter:function(e,t){return'<div style="font-size:x-small;text-align:center;padding:2px;color:'+t.color+';">'+e+"<br/>"+Math.round(t.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}},pattern:null}};e.plot.plugins.push({init:t,options:n,name:"pie",version:"1.0"})}(jQuery),define("libs/flot/jquery.flot.usat.pie",function(){}),define("modules/interactives/pie-chart",["jquery","underscore","utils","modules/interactives/interactive-base","libs/flot/jquery.flot.usat.pie"],function(e,t,i,n){"use strict";var s=n.extend({isDonut:function(){return"true"===this.chartData.donutPresent},_getHoverBody:function(e){return this.isDonut()?[this.getHoverPrefix(),i.addCommas(i.getNested(e,"datapoint",1,0,1)),this.getHoverSuffix()].join(" "):n.prototype._getHoverBody.apply(this,arguments)},getFlotOptions:function(){var e=n.prototype.getFlotOptions.apply(this,arguments);return e.series.pie={show:!0,stroke:{color:"#fff",width:2},innerRadius:0,radius:1},this.isDonut()&&(e.series.pie.innerRadius=.48),e},hoverLeftBound:function(){return this.isDonut()?this.graph.width()/3:this.graph.width()/2},hoverRightBound:function(){return this.isDonut()?this.graph.width()/3*2:this.graph.width()/2}});return s}),define("modules/most-popular-articles/most-popular-articles",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({el:".mpasm-wrap",initialize:function(e){i.prototype.initialize.call(this,e)}});return n}),define("modules/fronts/front-galleries",["jquery","underscore","backbone","pubsub","baseview","utils","modules/carousel/carousel","ui/loader","state"],function(e,t,i,n,s,o,a,r,l){"use strict";var h=s.extend({empty:!0,events:{"click .js-fg-link":"select"},initialize:function(){this.$galleries=this.$(".front-gallery"),this.$navItems=this.$(".js-fgs-item"),this.overrideTaboola=this.$(".js-fg-nav-list").data("taboolaOverride")?!0:!1,this.currentGallery=this.$(".fgpfm-gallery.front-gallery.selected").attr("id");var i=[],n=this.currentGallery;if(this.$(".fgpfm-nav-link").each(function(){var t=e(this).data("id");t&&n!=t&&i.push(t)}),this.endslateGalleries=i,t.bindAll(this,"switchGallery"),s.prototype.initialize.call(this,{}),this.subviews.loader=new r({el:this.$galleries.parent()}),this.$galleries.find(".slide.active").length){var o=this.$(".front-gallery.selected");this._initializeCarousel(o,o.index(),this.$navItems.filter(".selected").find("a").attr("href")),this.empty=!1}else{var a=this.$navItems.first().find("a").attr("href");"undefined"!=typeof a&&a.length>1&&this.fetchData(a,0,this.switchGallery)}},_initializeCarousel:function(e,t,i){var n=new a({ads:!0,linkPath:i,el:e.find(".galleries"),fullScreen:!0,endslateOptions:{overrideTaboola:this.overrideTaboola,endslateGalleries:this.endslateGalleries,currentGallery:this.currentGallery}});return this.subviews["gallery"+t]=n,n},onCardWidthChange:function(e){this.currentCardInfo&&this.currentCardInfo.primaryFlexWidth===e.primaryFlexWidth||this.triggerEvent("viewportResize"),this.currentCardInfo=e},fetchData:function(e,t,i){var n=this,s=!0,o=this.$el.data("layout-type"),a=this.$(".front-gallery.selected");a.length&&(a.css({opacity:1}),this.animate(a,"opacity",0,200).done(function(){s&&n.loading(!0)})),o&&(e="/"+o+e),l.fetchHtml("/front-gallery"+e).done(function(n){i(n,t,e)}).always(function(){s=!1,n.loading(!1)})},loading:function(e){e?this.subviews.loader.show():this.subviews.loader.hide()},select:function(t){var i=e(t.currentTarget),n=i.attr("href"),s=i.parent(),o=s.index(),a=this.$galleries.eq(o);-1===n.indexOf("://")&&(a.find(".galleries").length>0?this.switchGallery(null,o,n):this.fetchData(n,o,this.switchGallery),t&&t.preventDefault());var r=this.$navItems.filter(".selected"),l=r.attr("data-theme")||"",h=s.attr("data-theme")||"";r.removeClass(l+" selected"),s.addClass(h+" selected")},switchGallery:function(e,t,i){var n=this.$galleries.eq(t);if(this.$galleries.removeClass("selected"),n.addClass("selected"),e&&n.html(e),this.subviews["gallery"+t])this.trackGalleryChange(this.subviews["gallery"+t]);else{var s=this._initializeCarousel(n,t,i);this.empty||this.trackGalleryChange(s)}n.css({opacity:0}),this.animate(n,"opacity",1,200)},trackGalleryChange:function(e){e._trackSlideChange()}});return h}),define("modules/featured-events/featured-events",["jquery","underscore","state","baseview","utils","ui/generic-paginator"],function(e,t,i,n,s,o){var a=n.extend({events:{"click .js-pfem-carousel-prev":"onPrevPage","click .js-pfem-carousel-next":"onNextPage","click .js-pfem-ui-dropdown":"toggleDropdown","click .js-pfem-cat-ddl .ui-dropdown-item":"onCategoryDropdownItemSelect","click .js-pfem-when-ddl .ui-dropdown-item":"onWhenDropdownItemSelect"},initialize:function(e){n.prototype.initialize.call(this,e),this.moveMe=this.$(".pfem-items"),this.viewport=this.moveMe.parent(),this.pageIndex=0,this.maxIndex=Math.ceil(this.moveMe.children().length/3),this.prevCarousel=this.$(".pfem-carousel-prev"),this.nextCarousel=this.$(".pfem-carousel-next"),t.bindAll(this,"goTo"),this.subviews.paginator=new o({el:this.$(".paginator"),onGoTo:this.goTo}),this.pageLastIndex=this.subviews.paginator.$pageElements.length-1,1===this.maxIndex&&this.nextCarousel.removeClass("pfem-hidden")},onPrevPage:function(){var e=this.pageIndex-1;e>=0&&this.subviews.paginator.goToPage(e)},onNextPage:function(){var e=this.pageIndex+1;e<=this.pageLastIndex&&this.subviews.paginator.goToPage(e)},toggleDropdown:function(e){this.$(e.currentTarget).toggleClass("expanded")},onCategoryDropdownItemSelect:function(e){var t=this.$(e.currentTarget);this.$("#pfem-cat-display").html(t.html()),this.$("#pfem-cat").val(t.data().value)},onWhenDropdownItemSelect:function(e){var t=this.$(e.currentTarget).html();this.$("#pfem-when-display").html(t),this.$("#pfem-when").val(t)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e*-1;this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),e>0?this.prevCarousel.removeClass("pfem-hidden"):this.prevCarousel.addClass("pfem-hidden"),e<this.pageLastIndex?this.nextCarousel.removeClass("pfem-hidden"):this.nextCarousel.addClass("pfem-hidden"),this.pageIndex=e}});return a}),define("modules/rentals-local-rentals",["jquery","baseview","state","directAdPosition"],function(e,t,i,n){var s=t.extend({layoutType:"",renderedAd:!1,renderAd:function(){if(!this.renderedAd){this.renderedAd=!0;var e=this.$(".js-rlr-google-ad")[0];e&&(this.subviews.adPositionOne=this.createAdPosition(e))}},destroyAd:function(){this.renderedAd&&(this.subviews.adPositionOne.destroy(),this.renderedAd=!1)},isSidebarModule:function(){return"sidebar"===this.layoutType},isPrimaryWellModule:function(){return"primary"===this.layoutType},createAdPosition:function(t){return new n({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag")})},initialize:function(e){t.prototype.initialize.call(this),this.layoutType=e.layoutType},handleCardSizeChange:function(e){this.isSidebarModule()?e.sidebarAds===!0?(this.$(".js-rentals-sidebar-ad").removeClass("rlr-hide-ad"),this.renderAd()):(this.$(".js-rentals-sidebar-ad").addClass("rlr-hide-ad"),this.destroyAd()):this.isPrimaryWellModule()&&(e.sidebarOpen===!0?this.destroyAd():this.renderAd()),e.sidebarOpen===!0?("primary"===this.layoutType&&this.$(".js-rlr-wrap").addClass("rlr-dynamic-height"),this.$(".js-rlr-locals-wrap").removeClass("rlr-dynamic-margin").addClass("rlr-dynamic-border"),this.$(".js-rlr-wrap-primary").removeClass("rlr-top-border")):("primary"===this.layoutType&&this.$(".js-rlr-wrap").removeClass("rlr-dynamic-height"),this.$(".js-rlr-locals-wrap").addClass("rlr-dynamic-margin").removeClass("rlr-dynamic-border"),this.$(".js-rlr-wrap-primary").addClass("rlr-top-border"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)}});return s}),define("modules/longform/longform-series-bottom",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({el:".longform-bottom-series",events:{"click .series-bucket-prev":"doPrevTransition","click .series-bucket-next":"doNextTransition"},initialize:function(){this.$seriesBucketSet=this.$(".series-bucket-item-set"),this.$seriesBucketItem=this.$("div.series-bucket-item"),this.$seriesBucketNext=this.$(".series-bucket-next"),this.$seriesBucketPrev=this.$(".series-bucket-prev"),this.$seriesBucketPrev.addClass("inactive-item"),this.$bucketItemPadding=10*this.$seriesBucketItem.length,this.$widthOfBucket=this.$seriesBucketItem.width()*this.$seriesBucketItem.length+this.$bucketItemPadding},doNextTransition:function(){this.$seriesBucketNext.addClass("inactive-item"),this.$seriesBucketPrev.addClass("inactive-item");var e=this,t=parseInt(this.$seriesBucketSet.css("left"),10)-200;this.$widthOfBucket-(600-this.$bucketItemPadding)===Math.abs(t)?this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketPrev.removeClass("inactive-item")}):this.$widthOfBucket-400>Math.abs(t)&&this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketNext.removeClass("inactive-item"),e.$seriesBucketPrev.removeClass("inactive-item")})},doPrevTransition:function(){this.$seriesBucketNext.addClass("inactive-item"),this.$seriesBucketPrev.addClass("inactive-item");var e=this,t=parseInt(this.$seriesBucketSet.css("left"),10)+200;0===t?this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketNext.removeClass("inactive-item")}):200!==t&&this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketPrev.removeClass("inactive-item"),e.$seriesBucketNext.removeClass("inactive-item")})}});return n}),define("modules/elections/election-race-selection",["jquery","underscore","baseview","ui/dropdown"],function(e,t,i,n){"use strict";var s=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.$(".elections-results-dropdown").length>0&&(this.selectDropdown=new n({el:".elections-results-dropdown"}))}});return s}),define("modules/header/site-nav-social-module",["jquery","underscore","modules/header/site-nav-dropdown","utils"],function(e,t,i,n){"use strict";var s=i.extend({initialize:function(){this.initSocialShareButtons(),i.prototype.initialize.apply(this)},initSocialShareButtons:function(){this._loadGooglePlus()},_loadGooglePlus:function(){n.loadScript("https://apis.google.com/js/plusone.js","gapi")}});return s}),define("modules/fronts/primary-poster-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var n=i.extend({initialize:function(t){var n=this.$el;t=e.extend({adType:n.attr("data-ad-type")||"poster",adPlacement:n.attr("data-ad-placement")||"poster_front",adSizes:n.attr("data-ad-sizes")||"mediumrectangle"},t),i.prototype.initialize.call(this,t),this._initAds()}});return n}),define("uiFlip",["jquery","transformSupport"],function(e){"use strict";var t="uiPageFlip",i={useTransforms:!!e.support.css.transform,transitionTiming:"linear",flipDuration:300,flipFrontSelector:".ui-flip-panel",flipBackSelector:".ui-flip-panel",activePanelClass:"active",perspective:"900px",fadeDuration:200,onFlip:function(){}},n={init:function(n){return this.each(function(){var s=e(this),o=e.extend({},i,n);s.data(t,{busy:!1,settings:o})})},option:function(e,i){var n=this.data(t);if(n&&e){if(!i)return n[e];("function"==typeof i||"onFlip"!==e)&&(n[e]=i)}},flipForward:function(e){var i=this.data(t),n=i.settings,o=this.find(n.flipFrontSelector);return s.transition(this,o.filter(".active"),o.filter(":not(.active)"),!0,n,i,e)},flipBackward:function(e){var i=this.data(t),n=i.settings,o=this.find(n.flipFrontSelector);return s.transition(this,o.filter(".active"),o.filter(":not(.active)"),!1,n,i,e)}},s={transition:function(t,i,n,o,a,r,l){var h;return r.busy?e.Deferred().reject():l?(a.onFlip(n),n.addClass("active"),i.removeClass("active"),e.Deferred().resolve()):(r.busy=!0,n.addClass("active"),h=a.useTransforms?s.flipTransform(t[0],i[0],n[0],o,a):s.fadeTransition(i,n,a),h.done(function(){a.onFlip(n),r.busy=!1,i.removeClass("active")}),h)},flipTransform:function(t,i,n,o,a){s.setupTransition(t,i,n,o,a);var r=e.Deferred();return e.support.css.transition.registerTransitionEndListener(i,r).done(function(){i.style[e.support.css.transform.backfaceVisibilityCssName]="",i.style[e.support.css.transform.styleCssName]="",i.style[e.support.css.transition.cssName]="",i.style[e.support.css.transform.cssName]="",n.style[e.support.css.transform.backfaceVisibilityCssName]="",n.style[e.support.css.transform.styleCssName]="",n.style[e.support.css.transition.cssName]="",n.style[e.support.css.transform.cssName]="",t.style[e.support.css.transform.perspectiveCssName]="",t.style[e.support.css.transform.styleCssName]=""}),setTimeout(function(){var t="rotateX("+(o?"":"-")+"180deg)";i.style[e.support.css.transform.cssName]=t,n.style[e.support.css.transition.cssName]=s.getTransitionStyle(e.support.css.transform.cssHyphenName,a.flipDuration,a.transitionTiming),n.style[e.support.css.transform.cssName]="rotateX(0deg)"},20),r.promise()},fadeTransition:function(e,t,i){e.css({opacity:1,"z-index":11}).show(),t.css({opacity:1,"z-index":10}).show();var n=e.fadeOut(i.fadeDuration).promise();return n.done(function(){e.css({"z-index":""}),t.css({"z-index":""})}),n},getTransitionStyle:function(e,t,i,n){var s=e+" "+t+"ms "+i;return n&&(s+=" "+n+"ms"),s},setupTransition:function(t,i,n,o,a){var r="rotateX("+(o?"-":"")+"180deg)";t.style[e.support.css.transform.perspectiveCssName]=a.perspective,t.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",i.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transition.cssName]=s.getTransitionStyle(e.support.css.transform.cssHyphenName,a.flipDuration,a.transitionTiming),i.style[e.support.css.transform.cssName]="rotateX(0deg)",n.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",n.style[e.support.css.transform.styleCssName]="preserve-3d",n.style[e.support.css.transform.cssName]=r}};e.fn.uiFlip=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.uiPageTurn"):n.init.apply(this,arguments)}}),define("modules/fronts/hero",["jquery","underscore","backbone","baseview","pubsub","utils","state","modules/videos/brightcove-video","modules/carousel/carousel","sharedAdPosition","directAdPosition","partner/leavebehind","modules/fronts/primary-poster-ad","uiPageTurn","uiFlip"],function(e,t,i,n,s,o,a,r,l,h,d,c,u){var p=n.extend({events:{"click .slide, .hero-asset-open":"open","click .carousel-thumbs > li":"openTile","click .hero-turn-trigger, .hero-popular .hero-page-trigger":"toggleFrontBack","click .partner-close":"closeAdClick","click .hero-headline-video-close":"toggleFrontVideo","click .js-vid-play-link":"onClickPlay"},destroy:function(e){var t=a.getActiveApp().$(".partner-billboard-ad");t&&t.removeClass("show-slot"),this.adShowing&&this.closeAd(!0),n.prototype.destroy.call(this,e)},initialize:function(i){i=e.extend(!0,{animate:{duration:200},popularCount:this.$el.data("popular-count")||6,shadow:{opacity:".4",duration:200,delay:0}},i),n.prototype.initialize.call(this,i),t.bindAll(this,"onVideoShow","onVideoHide","onAdReady","showHeroAd","beforeAdRender","belowHeroAdReady","onVideoStatusChange","onClickPlay"),this.visibleFace="front",this.$openSidebar=e(".open-sidebar"),this.mostPopularLoaded=!1,this.isPageTurn=this.$el.hasClass("hero-page-turn"),this.isPageTurn?(this.pageTurn={frontIndex:this.$(".hero-page-front").index(),backIndex:this.$(".hero-page-back").index(),adIndex:this.$(".hero-page-ad").index(),videoIndex:this.$(".hero-page-video").index()},this.$el.uiPageTurn({perspective:"1400px"})):this.$el.uiFlip({perspective:"1400px"}),this.adShowing=!1,this.intervalSpeed=this.$el.data("interval"),this.$el.hasClass("carousel")&&(this.subviews.heroCarousel=new l({el:this.$el,ads:!1,hoverTransition:200,thumbsSelector:".carousel-thumbs",rotate:!0,rotateInterval:this.intervalSpeed,autostart:!0})),this.subviews.video=[],this.$(".ui-video").each(t.bind(function(t,i){var n=e(i),s=new r({el:n.parent(),onVideoShow:this.onVideoShow,onVideoHide:this.onVideoHide,onStatusChange:this.onVideoStatusChange,onClickPlay:this.onClickPlay});n.closest(".hero-page-video").length?this.subviews.heroVideo=s:this.subviews.video.push(s)},this));var s=this.$(".poster-ad-primary");if(s.length>0&&(this.subviews.posterAdPrimary=new u({el:s})),this.$(".partner-heroflip-ad").each(t.bind(function(e,t){return e>0?void console.error("why are there multiple ad placements for this hero?"):void(this.subviews.ad=new h({el:t,adSizes:["heroflip"],adPlacement:"high_impact",adType:"heroflip",beforeAdRender:this.beforeAdRender,onAdReady:this.onAdReady}))},this)),this.$(".popular").length){var d="/services/most-popular/hero/"+o.getSectionPath(window.location.pathname)+"/"+this.options.popularCount+"/";a.fetchHtml(d).done(t.bind(function(e){this.$(".popular .ui-placer").html(e),this.$(".hero-turn-trigger").fadeIn(500).addClass("ready"),this.mostPopularLoaded=!0},this))}},renderCardInfo:function(e){if(this.updateTrackingLabels(e),this.belowHeroModule=this.$el.next(".below-hero-ad-module"),this.belowHeroModule.length)if(e.belowHeroAd){var t={el:this.belowHeroModule.find(".below-hero-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"below_hero",onAdReady:this.belowHeroAdReady};this.subviews.belowHeroAd=new d(t)}else this.belowHeroModule.hide()},belowHeroAdReady:function(){var e="/services/most-popular/headline-ad/"+o.getSectionPath(window.location.pathname)+"/2/";a.fetchHtml(e).done(t.bind(function(e){this.belowHeroModule.find(".below-hero-popular").html(e),this.belowHeroModule.show(),this.subviews.belowHeroAd.playAd()},this))},beforeAdRender:function(){var e=this.subviews.ad.$el,t=e.height(),i=e.width();this.subviews.ad.setInitialDimensions(i,t)},onAdReady:function(e){var t=a.getActiveApp().$(".partner-billboard-ad");t&&t.addClass("show-slot"),(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText?this.createAdLeaveBehind(this.subviews.ad,e):this.showHeroAd()},createAdLeaveBehind:function(e,t){var i=a.getActiveApp();this.subviews.adLeaveBehind=new c({el:a.getActiveApp().$(".partner-leavebehind"),onShowAd:this.showHeroAd,cards:this.$el.closest(".card-wrap"),isCompact:i.isCurrentCardBumped&&i.isCurrentCardBumped(),maxDisplayed:parseInt(t.maxDisplayed,10),behavior:{clearBgColor:!1,hideframe:!1,hidebrand:!0,initShow:!0}}),this.subviews.adLeaveBehind.render(e,t)},showHeroAd:function(){return this.adShowing=!0,a.getActiveApp().triggerEvent("onHeroAdOpen"),this.subviews.ad.show(),this.triggerAnimation(t.bind(function(){var e;return e=this.isPageTurn?this.$el.uiPageTurn("goToPage",this.pageTurn.adIndex,!1,this.$(".partner-placement iframe").length):this.$el.uiFlip("flipForward"),e.done(t.bind(function(){this.subviews.ad.playAd()},this)),e},this))},closeAdClick:function(e){e.preventDefault(),this.closeAd()},closeAd:function(e){return this.adShowing=!1,this.subviews.ad.stopAd(),this.triggerAnimation(t.bind(function(){var t;return t=this.isPageTurn?"back"===this.visibleFace?this.$el.uiPageTurn("goToPage",this.pageTurn.backIndex,e,this.$(".partner-placement iframe").length):this.$el.uiPageTurn("goToPage",this.pageTurn.frontIndex,e,this.$(".partner-placement iframe").length):this.$el.uiFlip("flipBackward",e)},this)).done(t.bind(function(){a.getActiveApp().triggerEvent("onHeroAdClose"),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show()},this)),!1},triggerAnimation:function(e){return a.registerAnimation(e())},onVideoShow:function(){this.$openSidebar.addClass("hidden"),this.$(".hero-turn-trigger").hide()},onVideoHide:function(){this.$openSidebar.removeClass("hidden"),this.mostPopularLoaded&&this.$(".hero-turn-trigger").show()},onVideoStatusChange:function(e){if("mediaComplete"===e.type)this.resetVideo();else if("mediaPlay"===e.type){var t=this.$(".js-live-video-label");t&&t.show()}},onClickPlay:function(){var e=this.$(".js-live-video-label");e&&e.hide(),this.$(".js-hide-during-vid-play").hide(),this.subviews.video[0].playVideo()},resetVideo:function(){var e=this.subviews.video[0];e.showStill(),this.$(".js-hide-during-vid-play").show()},open:function(t){var i=e(t.target),n=e(t.currentTarget),s=n.data("content-type")||"";this.subviews.heroVideo&&(i.hasClass("videoStillPlay")||"video"===s)?(this.toggleFrontVideo(t),t.preventDefault()):i.closest("a").length||(n.find(".hero-story > h1 > a").get(0).click(),t.preventDefault())},openTile:function(t){var i=e(t.currentTarget).index();this.$(".slide:eq("+i+") .hero-story > h1 > a").click()},toggleFrontBack:function(){return this.mostPopularLoaded?(this.triggerAnimation(t.bind(function(){return"back"!==this.visibleFace?(s.trigger("uotrack","mostpopularopen"),this.goToBack()):(s.trigger("uotrack","mostpopularclose"),this.goToFront())},this)),!1):!1},goToFront:function(){return this.visibleFace="front",this.$el.uiPageTurn("goToPage",this.pageTurn.frontIndex)},goToBack:function(){return this.visibleFace="back",this.$el.uiPageTurn("goToPage",this.pageTurn.backIndex)},goToVideo:function(){return this.visibleFace="video",this.$el.uiPageTurn("goToPage",this.pageTurn.videoIndex).done(t.bind(function(){this.subviews.heroVideo.playVideo()},this))},onCardWidthChange:function(e){this.updateTrackingLabels(e)},updateTrackingLabels:function(i){this.$moduleWrap||(this.$moduleWrap=this.$el.closest(".hero-module")),!this.variant&&this.$moduleWrap.data("variant")&&(this.variant=this.$moduleWrap.data("variant")),"4uphp"===this.variant&&(this.trackPrefix||(this.trackPrefix=this.$moduleWrap.find(".hfwmm-list").data("track-prefix")),this.$flexListItems||(this.$flexListItems=this.$moduleWrap.find(".hfwmm-secondary-link,.hfwmm-tertiary-link")),1320===i.cardWidth?t.each(this.$flexListItems,function(t,i){var n=e(t),s=i>2?i-3+1:i+1;n.data("ht",this.trackPrefix+n.data("track-display-type")+s)},this):t.each(this.$flexListItems,function(t,i){var n=e(t);n.data("ht",this.trackPrefix+"stack"+(i+1))},this))},toggleFrontVideo:function(e){return this.subviews.heroVideo?(this.triggerAnimation(t.bind(function(){return"video"!==this.visibleFace?(s.trigger("uotrack","headlinevideoopen"),this.$(".hero-headline-video-close").show(),this.subviews.heroVideo.show(),this.goToVideo()):(this.subviews.heroVideo.onVideoStatusChange(e),this.subviews.heroVideo.hide(),s.trigger("uotrack","headlinevideoclose"),this.$(".hero-headline-video-close").hide(),this.goToFront())},this)),!1):!1}});return p}),define("third-party-apis/facebook/facebook",["jquery","underscore","third-party-apis/base-third-party-api"],function(e,t,i){"use strict";var n=i.extend({initialize:function(){this._config=this.getApiSiteConfig("FACEBOOK"),this._config&&(this._appid=this._config.APPID,this._channelUrl=window.location.protocol+"//"+window.location.host+window.site_static_url+"html/channel.html"),i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._facebookPromise||(this._facebookPromise=e.Deferred(t.bind(function(i){return this._config.ENABLED?void e.ajax("//connect.facebook.net/en_US/sdk.js",{cache:!0,data:{},dataType:"script"}).done(t.bind(function(){FB?(this._initializeFacebook(),i.resolve(FB)):i.reject()},this)).fail(function(){i.reject()}):void i.reject()},this)).promise()),this._facebookPromise},_initializeFacebook:function(){FB.init({appId:this._appid,version:"v2.3",channelUrl:this._channelUrl,status:!0,cookie:!0,xfbml:!1})},getUserPermissions:function(){return this._config.PERMISSIONS}});return new n}),define("modules/stories/share-facebook",["jquery","underscore","backbone","baseview","pubsub","utils","third-party-apis/facebook/facebook"],function(e,t,i,n,s,o,a){var r=n.extend({events:{"click .util-bar-share-submit-btn-facebook":"onClickPostBtn","click .util-bar-success-link-facebook":"onClickPostLink"},initialize:function(e){t.bindAll(this,"fbShareCallback"),n.prototype.initialize.call(this,e)},onClickPostBtn:function(){this.$loading=this.$$(".util-bar-share-loading-facebook"),this.$status=this.$$(".util-bar-share-status-text-facebook"),this.$message=this.$$(".util-bar-share-message-facebook"),this.$successPane=this.$$(".util-bar-flyout-pane-success-facebook"),this.$successLink=this.$$(".util-bar-success-link-facebook"),this.$successDescription=this.$$(".util-bar-success-description-facebook"),this.$flyoutSection=this.$$(".util-bar-flyout-section-facebook"),this.fbShare()},fbShare:function(){this.$loading.show();var e={method:"feed",link:this.$message.data("link"),picture:this.$message.data("image"),name:this.$message.data("title")};a.loadScript().done(t.bind(function(){FB.ui(e,this.fbShareCallback)},this))},fbShareCallback:function(t){if(t)if(t.error)this.$loading.hide(),this.$status.text("An error occurred, try again.");else{if(this.$successLink.remove(),t.post_id){var i=t.post_id.split("_");if(i.length>=2){var n="https://www.facebook.com/"+i[0]+"/posts/"+i[1],o=e('<a class="util-bar-success-link-facebook" href="'+n+'">View the post.</a>');this.$successDescription.append(o)}}this.$loading.hide(),this.$flyoutSection.hide(),this.$successPane.show(),s.trigger("uotrack","UtilityBarShareFacebook")}else this.$loading.hide()},onClickPostLink:function(t){t.preventDefault();var i=e(t.target).attr("href");o.openPopup(i,1e3,600)}});return r}),define("blog/blog-list",["jquery","underscore","backbone","state","modules/global/brightcove-video","baseview"],function(e,t,i,n,s,o){"use strict";var a=o.extend({el:".blog-list-module",events:{"click .button-add-content":"showMore"},initialize:function(){var t=this;this.subviews=this.subviews||{},this.subviews.video=[],this.readMoreBlogsNumber=this.$(".button-add-content").data("next"),e(".stag.hero .video, .blpm-video-container .video").each(function(){var i=new s({el:e(this).parent().get(0)});t.subviews.video.push(i)})},getMoreBlogs:function(e){n.fetchHtml(window.location.pathname+e+"/new").done(t.bind(function(e){this.applyBlogPosts(e)},this)).fail(t.bind(function(){this.$button.removeClass("loading").addClass("inactive").text("No more posts")},this))},showMore:function(t){return e(t.target).hasClass("inactive")?!1:(this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading")),this.getMoreBlogs(this.readMoreBlogsNumber),void t.preventDefault())},applyBlogPosts:function(t){{var i=this;t.find(".blpm-post").removeClass("active").addClass("inactive"),t.find(".button-add-content")}this.$(".blpm-all-articles").append(t),t.find(".video").each(function(){var t=new s({el:e(this).parent().get(0)});i.subviews.video.push(t)}),this.readMoreBlogsNumber++,this.$button.removeClass("loading").text(this.$button.attr("data-default"))}});return a}),define("modules/longform/longform-sponsorship",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({logoTemplate:'<div class="sponsored-by-text"><%= sponsoredByText %></div><div class="top-series-bucket-header-sponsor"><img src="<%= imageLogo %>" alt="<%= imageLogoAlt %>"></div>',initialize:function(t){t=e.extend({imageSkinLeft:null,imageSkinRight:null,clickThru:null,imageLogo:null,imageLogoAlt:null,sponsoredByText:"sponsored by:"},t),i.prototype.initialize.call(this,t),this.$adWrapper=this.$(".top-series-bucket-header-sponsor-wrapper"),this.$header=this.$(".top-series-bucket-header"),this.render()},destroy:function(e){this.$logo&&(this.$logo.remove(),this.$logo=null),i.prototype.destroy.call(this,e)},render:function(){this.setupLogo(),this.showBar()},setupLogo:function(){this.$header.height()>30&&this.$adWrapper.css("margin-top",this.$header.height()/2-this.$adWrapper.height()/2),this.$logo=e(t.template(this.logoTemplate,this.options)),this.$adWrapper.html(this.$logo)},showBar:function(){this.$adWrapper.removeClass("hidden"),this.$header.removeClass("hidden")}});return n}),define("modules/longform/longform-featured-series",["jquery","underscore","baseview","utils","sharedAdPosition","state","modules/longform/longform-sponsorship"],function(e,t,i,n,s,o,a){"use strict";var r=i.extend({el:".longform-top-series-bucket",events:{"click .top-series-bucket-prev":"doPrevTransition","click .top-series-bucket-next":"doNextTransition"},initialize:function(s){t.bindAll(this,"onAdReady"),this.$win=n.get("win"),s=e.extend({adPlacement:"poster",adSizes:["mediumrectangle"],adType:"sponsorship",defaultPosition:!0},s),this.$sponsorshipAd=this.$(".poster-ad"),this.$seriesBucketSet=this.$(".top-series-bucket-item-set"),this.$seriesBucketItem=this.$("div.top-series-bucket-item"),this.$seriesBucketNext=this.$(".top-series-bucket-next"),this.$seriesBucketPrev=this.$(".top-series-bucket-prev"),this.$currentSeriesArticleArrow=this.$(".arrow-down"),this.$seriesBucketPrev.addClass("inactive-item-prev"),this.$seriesBucketWrapper=this.$(".top-series-bucket-wrapper"),this.$seriesBucketArrow=this.$(".arrow-wrapper"),this.$seriesBucketItemTitle=this.$(".top-series-bucket-item-title"),this.$seriesBucketItemWrap=this.$(".top-series-bucket-item-wrapper"),this.$bucketItemPadding=40*this.$seriesBucketItem.length,this.$widthOfBucket=this._setSeriesSetWidth(),this._setSeriesHeight(),this._findCurrent(),i.prototype.initialize.call(this,s),this.$seriesBucketItem.length>3&&this._calcNavArrowSpacing(),this._buildAd()
},doNextTransition:function(){this.$seriesBucketNext.addClass("inactive-item-next"),this.$seriesBucketPrev.addClass("inactive-item-prev");var e=this,t=parseInt(this.$seriesBucketSet.css("left"),10)-300;this.$widthOfBucket-900===Math.abs(t)?this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketPrev.removeClass("inactive-item-prev")}):this.$widthOfBucket-600>Math.abs(t)&&this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketNext.removeClass("inactive-item-next"),e.$seriesBucketPrev.removeClass("inactive-item-prev")})},doPrevTransition:function(){this.$seriesBucketPrev.addClass("inactive-item-prev"),this.$seriesBucketNext.addClass("inactive-item-next");var e=this,t=parseInt(this.$seriesBucketSet.css("left"),10)+300;0===t?this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketNext.removeClass("inactive-item-next")}):300!==t&&this.animate(this.$seriesBucketSet,"left",t,300,"ease-out").done(function(){e.$seriesBucketPrev.removeClass("inactive-item-prev"),e.$seriesBucketNext.removeClass("inactive-item-next")})},_calcNavArrowSpacing:function(){this.$seriesBucketPrev.css("margin-left",(this.$win.width()-850)/2-100),this.$seriesBucketNext.css("margin-right",(this.$win.width()-850)/2-100),this.$seriesBucketPrev.removeClass("hidden"),this.$seriesBucketNext.removeClass("hidden")},_setSeriesSetWidth:function(){var e=this.$seriesBucketItem.width()*this.$seriesBucketItem.length+this.$bucketItemPadding,t=e;return this.$seriesBucketSet.css("width",t),this.$seriesBucketSet.removeClass("hidden"),e},_setSeriesHeight:function(){var t=this.$seriesBucketWrapper.height(),i=parseInt(this.$seriesBucketArrow.css("top")),n=this.$seriesBucketItem.length,s=0;this.$seriesBucketItemTitle.each(function(){var t=e(this).height();return t>195?!1:void(s+=1)}),s==n&&(t-=24,i-=24,this.$seriesBucketWrapper.css("height",t),this.$seriesBucketArrow.css("top",i))},_findCurrent:function(){var t=0,i=this.$seriesBucketItem.length,n=this;i>3&&this.$seriesBucketItemWrap.each(function(){return e(this).data("currentarticle")&&i-3>t?(n.$seriesBucketSet.css("left",-300*t),t>=1&&n.$seriesBucketPrev.removeClass("inactive-item-prev"),!1):e(this).data("currentarticle")&&3>=i-t?(n.$seriesBucketSet.css("left",-300*(i-3)),n.$seriesBucketNext.addClass("inactive-item-next"),n.$seriesBucketPrev.removeClass("inactive-item-prev"),!1):void(t+=1)})},_buildAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorAd&&(this.subviews.sponsorAd=new s({el:this.$sponsorshipAd,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:this.options.adType,defaultPosition:this.options.defaultPosition,onAdReady:this.onAdReady}))},onAdReady:function(t){this.subviews.sponsorshipAd&&this.subviews.sponsorshipAd.destroy(),this.subviews.sponsorshipAd=new a(e.extend({el:o.getActiveApp().$(".longform-top-series-bucket")},t))}});return r}),define("modules/fronts/countdown-clock",["jquery","underscore","baseview","state","directAdPosition"],function(e,t,i,n,s){"use strict";var o=i.extend({timer:0,seconds:0,classes:{sponsor:"countdown-clock-ad"},initialize:function(t){t=e.extend({adPlacement:"sponsor_logo_countdown",adSizes:[100,50],countdownContainer:".countdown-clock-container",digitBoxes:".countdown-timer-digit-container .digit",digitContainer:".countdown-timer-digit-container"},t),this.options=t,this.$sponsorshipAd=this.$("."+this.classes.sponsor),this.layoutType=this._getLayoutType();var n=e(t.countdownContainer).attr("data-type-event_date");i.prototype.initialize.call(this,t),this.seconds=Math.round(new Date(n).getTime()/1e3)-Math.round((new Date).getTime()/1e3),this.$digitBoxes=this.$(t.digitBoxes),this.$digitContainer=this.$(t.digitContainer),this.$primaryTimer=e(".card-primary-suspender.countdown-clock-module"),this.$sidebarTimer=e(".card-sidebar.countdown-clock-module"),this.counterStart(),this.positionTimer()},_getLayoutType:function(){var e=null;return this.options.layoutType&&(-1!==this.options.layoutType.indexOf("primary")?e="primary":"sidebar"===this.options.layoutType&&(e="sidebar")),e},positionTimer:function(){this.$sidebarTimer.length||this.$primaryTimer.css("display","block")},renderCardInfo:function(e){e.sidebarOpen||"primary"!==this.layoutType?e.sidebarOpen&&"sidebar"===this.layoutType&&this._buildSponsorshipAd():(this.$primaryTimer.show(),this._buildSponsorshipAd()),this.currentCardInfo=e},_buildSponsorshipAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorshipAd&&(this.subviews.sponsorshipAd=new s({el:this.$sponsorshipAd,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:"sponsor_logo",pageInfo:n.getActivePageInfo()}))},openSideBar:function(){this.currentCardInfo&&this._buildSponsorshipAd()},onCardWidthChange:function(e){e.sidebarOpen!==this.currentCardInfo.sidebarOpen&&(this.currentCardInfo=e,e.sidebarOpen&&this.$sidebarTimer.length?"primary"===this.layoutType?this.$primaryTimer.hide():"sidebar"===this.layoutType&&this._buildSponsorshipAd():"primary"===this.layoutType&&(this.$primaryTimer.show(),this._buildSponsorshipAd()))},pad:function(e){for(var t=[],i=e.length;i>0;i--){var n=e[e.length-i]>9?e[e.length-i]:"0"+e[e.length-i];t.push(n.toString())}return t},updateTime:function(t){var i=Math.floor(t/86400),n=Math.floor(t/3600),s=Math.floor(t/60),o=Math.floor(t),a=i,r=n-24*i,l=s-60*n,h=o-60*s,d=0,c="",u=this.$digitContainer,p=this.pad([a,r,l,h]);this.$digitBoxes.each(function(t,i){if(void 0!==p[d]){var n=p[d].split("");e(i).text(t%2===0?n[0]:n[1]),t++,t%2===0&&d++}}),c=u.clone().first(),t--,u.slice(1).html(c.html())},decrementCounter:function(){this.updateTime(this.seconds),(0===this.seconds||isNaN(this.seconds))&&this.counterStop(),this.seconds--},counterStart:function(){clearInterval(this.timer),this.timer=setInterval(this.decrementCounter.bind(this),1e3)},counterStop:function(){clearInterval(this.timer)},destroy:function(e){this.counterStop(),i.prototype.destroy.call(this,e)}});return o}),define("modules/topics/topics-share-tools",["jquery","underscore","baseview","third-party-apis/facebook/facebook"],function(e,t,i,n){var s=i.extend({events:{"click .tpa-social-icon-facebook":"onClickFB"},initialize:function(e){t.bindAll(this,"fbShareCallback"),i.prototype.initialize.call(this,e)},onClickFB:function(i){var s={method:"feed",caption:e(i.currentTarget).data("link"),link:e(i.currentTarget).data("link"),picture:e(i.currentTarget).data("image"),name:e(i.currentTarget).data("title"),description:e(i.currentTarget).data("description"),actions:[{name:e(i.currentTarget).data("link"),link:e(i.currentTarget).data("link")}]};n.loadScript().done(t.bind(function(){FB.ui(s,this.fbShareCallback)},this))},fbShareCallback:function(){}});return s}),define("form/input-field",["jquery","underscore","form/base-form-element"],function(e,t,i){"use strict";var n=i.extend({events:{focus:"onInputFocus",blur:"onInputBlur",keyup:"onKeyPress"},initialize:function(t){t=e.extend({onValueChange:null},t),i.prototype.initialize.call(this,t),this.isInputField="input"===(this.$el.prop("tagName")||"").toLowerCase()?!0:!1,this.hasPlaceHolderNativeSupport=Modernizr.input.placeholder?!0:!1,this.placeholder=this.$el.attr("placeholder"),this.setup()},setup:function(){this.placeholder&&this.showPlaceHolder(),this.$el.data("clearable")&&this.isInputField&&this._setupClearButton()},showPlaceHolder:function(){this.hasPlaceHolderNativeSupport||(this.setInputValue(this.placeholder),this.$el.addClass("ui-text-input-placeholder"))},clearPlaceHolder:function(){this.hasPlaceHolderNativeSupport||(this.clearInputValue(),this.$el.removeClass("ui-text-input-placeholder"))},getInputValue:function(){var e=this.$el.val();return e===this.placeholder&&(e=""),e},clearInputValue:function(){var e=this.getInputValue();this.$el.val(""),e&&this._triggerValueChange()},setInputValue:function(e){this.$el.val(e),this._triggerValueChange()},_setupClearButton:function(){this.clearButton=e('<div class="ui-text-input-clear-btn" style="display:none"></div>'),this.$el.parent().append(this.clearButton),this.clearButton.on("mousedown."+this.cid,t.bind(function(e){this.onClearButtonClick(e)},this))},onInputFocus:function(){var e=this.getInputValue();e?this.clearButton&&this.clearButton.show():this.clearPlaceHolder()},onInputBlur:function(){this.getInputValue()||this.reset(),this.clearButton&&this.clearButton.hide()},_triggerValueChange:function(){var e=this.getInputValue();this.clearButton&&(e?this.clearButton.show():this.clearButton.hide()),this.options.onValueChange&&this.options.onValueChange(e)},resetInput:function(){this.reset()},reset:function(){this.clearInputValue(),this.placeholder&&this.showPlaceHolder(),this.clearButton&&this.clearButton.hide()},onKeyPress:function(){clearTimeout(this.keyPressDelay),this.keyPressDelay=setTimeout(t.bind(function(){this._triggerValueChange()},this),1)},getType:function(){return"input"},onClearButtonClick:function(e){e.preventDefault(),this.clearInputValue(),this.clearButton.hide(),this.$el.focus()},destroy:function(e){this.clearButton&&(this.clearButton.off("."+this.cid),this.clearButton.remove()),i.prototype.destroy.call(this,e)}});return n}),define("form/autocomplete",["jquery","underscore","form/base-form-element","state","form/input-field"],function(e,t,i,n,s){"use strict";var o=i.extend({events:{"keydown .ui-text-input":"onKeyDown","paste .ui-text-input":"updateResults",focusout:"onInputBlur","mousedown .ui-autocomplete-result-item":"onMouseDownResultItem","mouseenter .ui-autocomplete-result-item":"onResultMouseEnterLeave","mousedown .ui-text-input-clear-btn":"onClearButtonClick"},initialize:function(n){n=e.extend({url:this.$el.data("autocomplete-url"),ajaxOptions:null,ajaxQueryKey:"query",resultDisplayTemplate:null,resultValueTemplate:null,onError:null,onSelect:null,maxResults:4,onShowResults:null,onParseResults:null,onValueChange:null},n),this.inputField=this.$el,this.setElement(this.$el.parent(),!1),this.autoCompleteResultsContainer=e('<ul class="ui-autocomplete-result-container"></ul>'),this.autoCompleteContent=e('<div class="ui-autocomplete-content"></div>'),this.autoCompleteContent.append(this.autoCompleteResultsContainer),this.$el.append(this.autoCompleteContent),t.bindAll(this,"updateResults","showResult","clearResults"),i.prototype.initialize.call(this,n),this.subviews.inputField=new s({el:this.inputField,onValueChange:this.options.onValueChange})},updateAjaxOptions:function(t){e.extend(!0,this.options.ajaxOptions,t)},updateResults:function(){clearTimeout(this.keyPressDelay),this.keyPressDelay=setTimeout(t.bind(function(){var e=this.inputField.val();this.fetcher&&this.fetcher.abort(),e.length?this.fetcher=this._fetchResults(e):this.clearResults()},this),1)},onResultMouseEnterLeave:function(t){var i=e(t.target);i.hasClass("hover")||(this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item").removeClass("hover"),i.addClass("hover"))},onInputBlur:function(){this.clearResults(),this.fetcher&&this.fetcher.abort()},onMouseDownResultItem:function(t){3!==t.which&&this._processSelectedItem(e(t.currentTarget))},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which,i=this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item"),n=i.filter(".ui-autocomplete-result-hover");9!==t&&(38===t||40===t?(e.preventDefault(),i.length&&this.onResultItemUpDownArrowKeyPress(t,n)):13===t?n.length?(e.preventDefault(),this._processSelectedItem(n)):this.clearResults():32===t&&n.length?this._processSelectedItem(n):this.updateResults())},onResultItemUpDownArrowKeyPress:function(e,t){var i=this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item");i.removeClass("ui-autocomplete-result-hover"),38===e?t.length&&this.inputField.val()!==this.currentInputFieldValue?t.prev().length?this.hoverResultItem(t.prev()):this.inputField.val(this.currentInputFieldValue):this.hoverResultItem(i.last()):t.length?t&&t.next().length?this.hoverResultItem(t.next()):this.inputField.val(this.currentInputFieldValue):this.hoverResultItem(i.first())},hoverResultItem:function(e){e.addClass("ui-autocomplete-result-hover"),this.inputField.val(e.text())},getUIElement:function(){return this.inputField},getFormElement:function(){return this.inputField},reset:function(){this.clearResults(),this.subviews.inputField.reset()},resetInput:function(){this.reset()},showResult:function(t,i,n){var s=e('<li class="ui-autocomplete-result-item"></li>');s.text(t),s.data("value",i),n&&s.data("result",n),this.autoCompleteResultsContainer.append(s)},clearResults:function(){this.autoCompleteResultsContainer.empty()},onClearButtonClick:function(){this.clearResults()},_processSelectedItem:function(e){var t=e.data("value")||e.text(),i=e.data("result");this.inputField.val(t),this.clearResults(),this.options.onSelect&&this.options.onSelect(t,i)},_getFetchAjaxOptions:function(i){var n=e.extend(!0,{},this.options.ajaxOptions),s={},o=n.url||this.options.url;return-1!==o.indexOf("<%=")?n.url=t.template(o,{query:i}):(s[this.options.ajaxQueryKey]=i,n=e.extend(!0,{url:o,data:s},n)),n},_fetchResults:function(i){var s=this._getFetchAjaxOptions(i);return n.fetchData(null,s).done(t.bind(function(t){var i=t;this.options.onParseResults&&(i=this.options.onParseResults(t)),this.autoCompleteResultsContainer.empty(),e.isArray(i)&&i.length>0&&(i=i.slice(0,this.options.maxResults),this._parseResults(i),this.options.onShowResults&&this.options.onShowResults(i),this.currentInputFieldValue=this.inputField.val())},this)).fail(t.bind(function(e){this.options.onError&&this.options.onError(e)},this))},_parseResults:function(i){e.map(i,t.bind(function(e){var i,n;this.options.resultDisplayTemplate&&(n=t.template(this.options.resultDisplayTemplate,e)),this.options.resultValueTemplate&&(i=t.template(this.options.resultValueTemplate,e)),this.showResult(n,i,e)},this))},getType:function(){return"autocomplete"},destroy:function(e){this.autoCompleteContent.remove(),i.prototype.destroy.call(this,e)}});return o}),define("modules/weather/weather-dropdown",["jquery","underscore","backbone","baseview","pubsub","utils","state","form/autocomplete","easing","animatecolors","cookie"],function(e,t,i,n,s,o,a,r){"use strict";var l=n.extend({el:".weather-nav-dropdown",events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .weather-nav-dropdown-settings-open-btn":"showSettingsPanel","click .weather-nav-dropdown-settings-close-btn":"hideSettingsPanel","click .weather-nav-location-cancel-btn":"hideSettingsPanel","click .weather-nav-location-set-btn":"onSetButtonClick","submit .weather-nav-location-form":"onSubmitLocationForm","keydown .weather-nav-location-input":"onKeyDown","focus .weather-nav-location-input":"onFocusLocationField","blur .weather-nav-location-input":"onBlurLocationField","click .weather-nav-full-forecast-btn":"onClickFullForecast"},initialize:function(e){t.bindAll(this,"refreshData","onAutoCompleteResultClick"),this.panels=this.$(".weather-nav-dropdown-panel-wrap"),this.frontPanel=this.panels.find(".weather-nav-conditions-panel"),this.frontWeatherLocation=this.frontPanel.find(".weather-nav-location-name"),this.settingsPanel=this.panels.find(".weather-nav-settings-panel"),this.locationField=this.settingsPanel.find(".weather-nav-location-input"),this.transitionDelay=80,this.body=o.get("body"),this.navBtn=this.$el.parent(".weather"),this.$navLink=this.$el.siblings("a").eq(0),this.$navTempSpan=this.$navLink.find(".site-nav-alt-span"),this.navBtnTemp=this.navBtn.find(".btn-temp"),this.navBtnClassName=this.navBtnTemp.attr("class"),this.pubSub={"weather:newLocation":this._parseData},this.weatherConfig=o.getNested(window.site_vars,"WEATHER")||{},n.prototype.initialize.call(this,e),this.locationErrorEl=this.$(".weather-nav-location-error"),this.setDefaultLocation(),this.refreshData(),this.weatherDataRefresh=setInterval(this.refreshData,3e5)},onSetButtonClick:function(e){e.preventDefault(),this.updateWeatherLocation(this.locationField.val())},onAutoCompleteResultClick:function(){this.updateWeatherLocation(this.locationField.val())},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&this.updateWeatherLocation(this.locationField.val()),this.clearLocationInputError()},onSubmitLocationForm:function(e){e.preventDefault()},onClickFullForecast:function(){this.isMouseOnDropdown=!1,this.closeDropdown()},onMouseEnter:function(){this.isMouseOnDropdown=!0},onMouseLeave:function(){this.locationField.is(":focus")||(this.isMouseOnDropdown=!1,this.closeDropdown())},closeDropdown:function(){this.isMouseOnDropdown||(this.isSettingsPanelActive&&this.hideSettingsPanel(),a.registerAnimation(this.$el.stop().fadeOut(this.transitionDelay,"swing").promise().done(t.bind(function(){this.$el.removeClass("dropdown-active"),this.navBtn.find(".nav-span").removeClass("dropdown-active")},this))),this.body.off("."+this.cid))},openDropdown:function(){a.registerAnimation(this.$el.stop().fadeIn(this.transitionDelay,"swing").promise().done(t.bind(function(){this.$el.addClass("dropdown-active"),this.navBtn.find(".nav-span").addClass("dropdown-active")},this)))},showSettingsPanel:function(){this.$el.hasClass("settings-active")||(this.$el.addClass("settings-active"),this.isSettingsPanelActive=!0),this.subviews.autocomplete||(this.subviews.autocomplete=new r({el:this.locationField,resultDisplayTemplate:"<%= City %>, <%= State %>",resultValueTemplate:"<%= City %>, <%= State %>",onSelect:this.onAutoCompleteResultClick}))},hideSettingsPanel:function(){this.subviews.autocomplete&&this.subviews.autocomplete.resetInput(),this.clearLocationInputError(),this.locationField.blur(),this.$el.hasClass("settings-active")&&(this.$el.removeClass("settings-active"),this.isSettingsPanelActive=!1)},onFocusLocationField:function(){this.locationField.val(""),this.body.on("click."+this.cid,t.bind(function(t){0===e(t.target).closest(this.el).length&&(this.isMouseOnDropdown=!1,this.closeDropdown())},this))},onBlurLocationField:function(){""===this.locationField.val()&&this.locationField.val(this.locationField.data("value"))},isDefaultLocation:function(e){return e.toLowerCase()===this.defaultLocation.toLowerCase()},setDefaultLocation:function(){this.defaultLocation="",this.weatherConfig&&(this.defaultLocation=this.weatherConfig.STATION_CITY+", "+this.weatherConfig.STATION_STATE)},setWeatherCookie:function(t){e.cookie("weatherLocation",t,{path:"/",expires:1825})},updateWeatherLocation:function(i){return i&&i!==e.cookie("weatherLocation")?this._fetchData(i).done(t.bind(function(e){this.hideSettingsPanel(),s.trigger("weather:newLocation",e)},this)).fail(t.bind(function(e){this.showLocationInputError(e)},this)):void 0},refreshData:function(){var t=e.cookie("weatherLocation")?e.cookie("weatherLocation"):this.defaultLocation;return this._fetchData(t)},_fetchData:function(i){if(this.isBusyGettingData||!i)return e.Deferred().reject();var n=i.split(", ");return i=1===n.length?"zip/"+n:"city/"+n[0]+"/state/"+n[1],this.isBusyGettingData=!0,e.Deferred(t.bind(function(e){a.fetchData("/weather/forecast/json/"+i).done(t.bind(function(t){t.WxCurrents?(this._parseData(t),e.resolveWith(this,[t])):e.rejectWith(this,["No data is available for this location."]),this.isBusyGettingData=!1},this)).fail(t.bind(function(){e.rejectWith(this,["There was an error finding this location. Please try again later."]),this.isBusyGettingData=!1},this))},this))},showLocationInputError:function(e){this.locationErrorEl.html()!==e&&(this.locationErrorEl.addClass("ui-input-field-error-active"),this.locationErrorEl.text(e),this.locationErrorEl.stop().slideDown(50,"easeInOutQuad"))},clearLocationInputError:function(){this.locationErrorEl.hasClass("ui-input-field-error-active")&&this.locationErrorEl.stop().slideUp(50,"easeInOutQuad").promise().done(t.bind(function(){this.locationErrorEl.removeClass("ui-input-field-error-active"),this.locationErrorEl.empty()},this))},_parseData:function(i){if(i.WxCurrents){var n=i.WxCurrents,s=n.City+", "+n.State,o=n.TempCurrent;if(e.cookie("weatherLocation")){var a="/weather/loc/"+n.City.replace(" ","_")+"-"+n.State;this.$(".weather-nav-full-forecast-btn").attr("href",a)}var r=new Date(1e3*i.WxCurrents.ObservationTimeUnix),l=r.getHours()%12;n["ObservationTime-Formatted"]=(l>0?l:12)+":"+r.getMinutes()+" "+(r.getHours()>=11?"PM":"AM");var h=this.$navTempSpan.find("[data-weather]").add(this.$("[data-weather]"));h.each(t.bind(function(t,i){var s=e(i),o=n[s.data("weather")]||"";"IMG"==s.prop("tagName")?(s.attr("src",window.site_static_url+"images/weather/"+o+".png"),s.attr("alt",o.replace("-"," ")),s.attr("title",n.Condition)):s.html(o+(s.data("weather-suffix")||""))},this)),s.length>20&&this.frontWeatherLocation.addClass("longname"),this.frontWeatherLocation.html(s),o>99&&this.frontWeatherTemp.addClass("three-digit"),this.$navTempSpan.addClass("site-nav-visible-alt-span"),this.isDefaultLocation(s)||e.cookie("weatherLocation")===s||this.setWeatherCookie(s),this.locationField.data("value",s).val(s)}},destroy:function(e){this.body.off("."+this.cid),clearInterval(this.weatherDataRefresh),n.prototype.destroy.call(this,e)}});return l}),define("modules/weather/site-nav-weather-module",["jquery","underscore","baseview","pubsub","utils","state","modules/weather/weather-dropdown"],function(e,t,i,n,s,o,a){"use strict";var r=i.extend({events:{mouseenter:"onHoverWeatherNav",mouseleave:"onHoverWeatherNav","click .site-nav-weather-link":"onClickWeatherNav"},initialize:function(){i.prototype.initialize.apply(this),this.subviews.weatherDropdown=new a},onHoverWeatherNav:function(e){var i=this.$(".site-nav-alt-span");clearTimeout(this.navBtnHoverDelay),i.hasClass("site-nav-visible-alt-span")&&("mouseenter"===e.type?(i.addClass("site-nav-active-alt-span"),this.navBtnHoverDelay=t.delay(t.bind(this.subviews.weatherDropdown.openDropdown,this.subviews.weatherDropdown),this.hoverDropdownDelay)):(i.removeClass("site-nav-active-alt-span"),this.navBtnHoverDelay=t.delay(t.bind(this.subviews.weatherDropdown.closeDropdown,this.subviews.weatherDropdown),this.hoverDropdownDelay)))},onClickWeatherNav:function(){this.subviews.weatherDropdown.closeDropdown()}});return r}),define("modules/live-newscasts/live-newscasts",["jquery","underscore","baseview","modules/global/livevideo"],function(e,t,i,n){var s=i.extend({events:{"click .newscast-item a":"onLiveNewscastsClick"},onLiveNewscastsClick:function(t){var i=e(t.currentTarget).attr("data-livevideoassetid");if(i){var s=new n({service:"/services/livenewscasts/"});return s.loadLiveVideo(i),!1}}});return s}),define("modules/videos/dynamic-video-playlist-module",["jquery","underscore","baseview","utils","managers/abtestmanager","modules/cxense-recommends/cxense-base"],function(e,t,i,n,s,o){var a=i.extend({initialize:function(e){if(i.prototype.initialize.call(this,e),!this.$el.hasClass("js-cx-links-added")){var a=s.getUserActiveTest();"article-right-rail"==n.getNested(a,"testTarget")?n.getNested(a,"activeVariant","control")?(this.subviews.cxense=new o({el:this.$el,getRecsOnInit:!1}),t.each(this.$(".dvp-item-link"),function(e,t){this.subviews.cxense.renderTestLink(e,t)},this),this.show(),this.$el.addClass("js-cx-links-added"),this.subviews.cxense.logTestImpression()):this.destroy(!0):this.show()}}});return a}),define("modules/interactives/overview",["jquery","underscore","backbone","utils","baseview","modules/interactives/interactive-templates","modules/global/brightcove-video"],function(e,t,i,n,s,o){var a=s.extend({initialize:function(e){s.prototype.initialize.call(this,e);var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),this.$el.length&&(this.subviews.template=new o({ads:t,el:this.$el,interactiveType:"chronology",isFramed:e.isFramed,standAlone:e.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex))}});return a}),define("modules/elections/election-front-results",["jquery","underscore","baseview","ui/generic-paginator"],function(e,t,i,n){"use strict";var s=i.extend({events:{"click .election-toggle .ui-button-toggle-item":"toggleLevel","click .election-results-tab":"toggleTabs"},initialize:function(e){t.bindAll(this,"goTo"),i.prototype.initialize.call(this,e),this.setupSlides(),this.slidesNumber>1&&(this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}))},goTo:function(e){{var t=this.slideWidth*e;this.slideHeight*e}this.animate(this.$slideContainer,"left",-1*t+"px",400,"ease-in-out",0),this.$slides.removeClass("active").eq(e).addClass("active"),this.currentSlideIndex=e},setupSlides:function(){this.$stage=this.$(".election-polls-stage"),this.$slideContainer=this.$(".election-polls"),this.$slides=this.$slideContainer.find(".election-poll"),this.$slides.css("width",this.$stage.width()+"px"),this.slideWidth=this.$slides.outerWidth(),this.slideHeight=this.$slides.outerHeight(),this.slidesNumber=this.$slides.length,this.$slideContainer.width(this.slidesNumber*this.slideWidth),this.currentSlideIndex=0}});return s}),define("modules/trending-map/trending-map",["jquery","underscore","baseview","utils"],function(e,t,i,n){"use strict";var s=i.extend({el:".tmfwm-wrapper",initialize:function(){t.bindAll(this,"processScroll"),this.$win=n.get("win"),this.$marketBubbles=this.$(".tmfwm-plot.tmfwm-market-bubble"),this.$trendingBubbles=this.$(".tmfwm-plot.tmfwm-trending-bubble"),this.isMapVisible()?this.showMarketBubbles():this.$win.on("scroll."+this.cid,t.throttle(this.processScroll,32))},showMarketBubbles:function(){var e=this;this.animate(this.$marketBubbles,"opacity",1,400,"ease-out").done(function(){e.showTrendingBubbles()}),this.animate(this.$marketBubbles,"transform","scale(1)",800,"ease-out")},showTrendingBubbles:function(){this.animate(this.$trendingBubbles,"opacity",1,600,"ease-out"),this.animate(this.$trendingBubbles,"transform","scale(1)",800,"ease-out")},isMapVisible:function(){return n.getScrollPosition()>=this.$el.offset().top-200},processScroll:function(){this.isMapVisible()&&(this.showMarketBubbles(),this.$win.off("."+this.cid))},destroy:function(){this.$win.off("."+this.cid),i.prototype.destroy.call(this,!0)}});return s}),define("modules/stories/oembed",["jquery","baseview","utils"],function(e,t,i){var n=t.extend({initialize:function(e){"rich"===this.$el.attr("data-oembed-type")&&"twitter"===this.$el.attr("data-oembed-provider")&&i.loadScript("http://platform.twitter.com/widgets.js","twttr",function(e){e.widgets.load()}),t.prototype.initialize.call(this,e)}});return n}),define("modules/fronts/live-feed",["jquery","underscore","baseview","state","utils"],function(e,t,i,n,s){"use strict";var o=i.extend({initialize:function(n){t.bindAll(this,"initMarkup","updateMarkup","fetchUpdate","hideImage");var o=this.$el.attr("data-livefeed")||s.getSectionPath(window.location.pathname),a=this.$el.attr("data-livefeed-site-id"),r=this.$el.attr("data-livefeed-site-prefix"),l=this.$el.attr("data-livefeed-itemfetchlimit")||40;n=e.extend({maxItems:60,itemFetchLimit:l,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",autoUpdate:!0,site_id:a,site_prefix:r,section:o,afterFetchResults:null,ajaxOptions:null},n);var h={count:n.itemFetchLimit};"undefined"!=typeof a&&""!==a&&(h.site_id=n.site_id),"undefined"!=typeof r&&""!==r&&(h.site_prefix=n.site_prefix);var d={url:"/feeds/live/"+o+"/",data:h};this.requestOptions=e.extend(!0,d,n.ajaxOptions),i.prototype.initialize.call(this,n)},onCardWidthChange:function(e){var t=e.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=e,t&&this.setLiveFeedWidth(e)},setLiveFeedWidth:function(e){e.sidebarWidth<340?this.$el.removeClass("live-feed-wide"):this.$el.addClass("live-feed-wide"),this.options.dataSrcAttr="data-src-"+e.sidebarWidth,this.loadLazyImages()},openSideBar:function(){this.setupLiveFeed()},closeSideBar:function(){this.stopUpdateCheck()},renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&this.setupLiveFeed()},setupLiveFeed:function(){this.stopUpdateCheck(),this.setLiveFeedWidth(this.currentCardInfo),this.$el.children("li").length?(this.$el.children(".newcontent").removeClass("newcontent"),this.fetchUpdate()):n.fetchHtml(null,this.requestOptions).done(t.bind(function(e){this.initMarkup(e),this.afterFetchResultsSuccess(e)},this))},afterFetchResultsSuccess:function(e){this.options.afterFetchResults&&this.options.afterFetchResults(e)},initMarkup:function(e){this.$el.removeClass("livefeed-loading"),this.$el.append(e),this.loadLazyImages(e.find("img")),this.refreshSidebar(),this.options.autoUpdate&&this.startUpdateCheck()},loadLazyImages:function(e){e=e||this.$("img"),s.lazyLoadImage(e,this.options.dataSrcAttr,!0,this.hideImage,this.refreshSidebar)},refreshSidebar:function(){n.getActiveApp().triggerEvent("refreshSidebarScroll")},hideImage:function(e){e.closest(".has-image").removeClass("has-image"),this.refreshSidebar()},fetchUpdate:function(){this.requestOptions.data.date=this.$("li:first").attr("data-timestamp"),n.fetchHtml(null,this.requestOptions).done(t.bind(function(e){this.updateMarkup(e),this.afterFetchResultsSuccess(e)},this))},updateMarkup:function(i){if(i&&0!==i.length){var n,s=this.$("li"),o={};s.removeClass("top"),i.each(function(){o[e(this).attr("data-content-id")]=!0}),s.each(function(){n=e(this),o[n.attr("data-content-id")]&&n.remove()}),i.eq(0).addClass("top").append('<div class="shadow"></div>'),this.$el.prepend(i),i.addClass("newcontent"),this.loadLazyImages(i.find("img")),s=this.$el.children("li"),s.length>60&&s.slice(60).remove(),this.afterNewContent=setTimeout(t.bind(function(){i.removeClass("newcontent")},this),1e3*this.options.removeNewHighlight),this.refreshSidebar()}},startUpdateCheck:function(){clearInterval(this.interval),this.interval=setInterval(this.fetchUpdate,1e3*this.options.updateDelay)},stopUpdateCheck:function(){clearInterval(this.interval)},destroy:function(e){e&&this.$el.empty(),this.stopUpdateCheck(),clearTimeout(this.afterNewContent),i.prototype.destroy.apply(this,arguments)}});return o}),define("partner/asset-sponsorship",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({backgroundTemplate:"<%= sponsorshipHtml %>",logoTemplate:'<div class="sponsor" style="display:table-cell;"><div class="sponsor-logo-box"><img src="<%= imageLogo %>" alt="<%= imageLogoAlt %>" class="sponsor-logo-img"><span class="sponsor-logo-byline">Sponsored by <br/><%= imageLogoAlt %></span></div></div>',initialize:function(t){t=e.extend({imageSkinLeft:null,imageSkinRight:null,clickThru:null,imageLogo:null,imageLogoAlt:null},t),i.prototype.initialize.call(this,t)},destroy:function(e){this.$background&&(this.$background.remove(),this.$background=null),this.$logo&&(this.$logo.remove(),this.$logo=null),i.prototype.destroy.call(this,e)},render:function(){this.setupBackground(),this.setupLogo()},setupBackground:function(){"Yes"!==this.options.hasSkin&&this.options.sponsorshipHtml||(this.$background=e(t.template(this.backgroundTemplate,this.options)),this.$el.parent().append(this.$background))},setupLogo:function(){var i=this.$(".content-bar-top .title").eq(0);i.length&&(this.$logo=e(t.template(this.logoTemplate,this.options)),i.after(this.$logo))}});return n}),define("modules/partner/poster-ad-asset",["jquery","underscore","baseview","state","sharedAdPosition","partner/asset-sponsorship","utils"],function(e,t,i,n,s,o,a){"use strict";var r=i.extend({initialize:function(e){t.bindAll(this,"onAdReady"),a.getNested(window.site_vars,"ADS","GALLERY","REFRESH")&&(this.pubSub={"carousel:refreshAd":this.refreshAdPosition}),i.prototype.initialize.call(this,e);var n=this.$el.data("sizes");n&&(n=n.split(",")),this.subviews.posterad=new s({el:this.$el,adSizes:n||["mediumrectangle","halfpage","portrait","filmstrip"],adPlacement:"poster",adType:"sponsorship",defaultPosition:!0,onAdReady:this.onAdReady})},refreshAdPosition:function(){window.amznads.getAdsCallback(window.site_vars.ADS.a9.account,function(){var e=e||{};e.cmd=e.cmd||[];try{window.amznads.setTargetingForGPTAsync("amznslots")}catch(t){}}),window.googletag.pubads().clearTargeting("amznslots"),this.subviews.posterad.refreshPosition()},onAdReady:function(t,i){this.subviews.posterad.show(),this.subviews.posterad.$("iframe").css("position","relative"),"sponsorship"===i&&(this.subviews.sponsorshipad&&this.subviews.sponsorshipad.destroy(),this.subviews.sponsorshipad=new o(e.extend({el:n.getActiveApp().$(".asset")},t)),this.subviews.sponsorshipad.render())
}});return r}),define("modules/weather/weather-seven-day",["jquery","underscore","baseview","state"],function(e,t,i){"use strict";var n=i.extend({initialize:function(e){i.prototype.initialize.call(this,e)}});return n}),define("modules/ggm-va-loan/ggm-va-loan",["jquery","underscore","baseview","form/dropdown","state","managers/routemanager"],function(e,t,i,n){"use strict";var s=i.extend({events:{"submit .ggmval-form":"onFormSubmit"},initialize:function(e){i.prototype.initialize.call(this,e),this._setupForm()},_setupForm:function(){this.subviews.dropdownProduct=new n({el:this.$(".ggmval-select")})},onFormSubmit:function(e){var t=this.$(".ggmval-input");return/^\d{5}$/.test(t.val())?void t.removeClass("ggmval-input-error"):(t.addClass("ggmval-input-error"),void e.preventDefault())}});return s}),define("modules/broadcast-most-popular/broadcast-most-popular",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({el:".most-popular-stories-container",initialize:function(e){i.prototype.initialize.call(this,e)}});return n}),define("modules/global/video-carousel",["jquery","underscore","baseview","pubsub","state","modules/global/brightcove-video"],function(e,t,i,n,s,o){"use strict";var a=i.extend({events:{"click .carousel-nav":"onCarouselNavClick","mouseleave .video-carousel-viewport":"carouselMouseOut","mouseenter .video-carousel-viewport":"carouselMouseIn"},initialize:function(n){this.$carouselContainer=this.$(".video-carousel-series"),this.moveMe=this.$carouselContainer,this.viewport=this.moveMe.parent(),this.$slides=this.$carouselContainer.find(".video-carousel-item"),this.totalSlides=this.$slides.length,this.index=this.$(".video-carousel-item-wrap.active").index(),this.subviews={},this.subviews.video=[],this.autoplay=!1,t.bindAll(this,"goToNextVideo"),this.totalSlides>1?this.slideChangeInterval=setInterval(this.goToNextVideo,5e3):this.$(".carousel-nav").hide();var s=this;t.bindAll(this,"bcPlayerLoaded"),e.each(this.$slides.find(".video"),function(){var e=new o({el:this,onVideoComplete:s.goToNextVideo,onVideoLoaded:s.bcPlayerLoaded,autostart:!1});s.subviews.video.push(e)}),this.$el.hasClass("autoplay")&&(this.subviews.video[0].$(".videoStillPlay").click(),clearInterval(this.slideChangeInterval)),i.prototype.initialize.call(this,n)},bcPlayerLoaded:function(){this.autoplay=!0},onCarouselNavClick:function(t){if(t.preventDefault(),this.totalSlides>1){var i=e(t.currentTarget),n=i.hasClass("prev"),s=this.$(".video-carousel-item-wrap.active").index();this.index=s,this.autoplay=!1,n?s--:s++,this.goTo(s)}},goTo:function(e){e>=this.totalSlides?e=0:0>e&&(e=this.totalSlides-1);var t=this.viewport.outerWidth(),i=t*e*-1;this.subviews.video[this.index].player&&this.subviews.video[this.index].resetVideoState(),this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),this.autoplay&&(n.trigger("uotrack","videocarousel|nextauto"),this.subviews.video[e].player||this.subviews.video[e].$(".videoStillPlay").click()),this.updateDom(e)},updateDom:function(e){this.updateNextPrevArrows(e),this.$(".video-carousel-item-wrap").eq(this.index).removeClass("active"),this.$(".video-carousel-item-wrap").eq(e).addClass("active"),this.index=e},goToNextVideo:function(){var e=this.$(".video-carousel-item-wrap.active").index()+1;this.subviews.video[this.index].modVP?this.subviews.video[this.index].modVP.getIsPlaying(t.bind(function(t){t||this.goTo(e)},this)):this.goTo(e)},carouselMouseIn:function(){this.slideChangeInterval&&(clearInterval(this.slideChangeInterval),this.slideChangeInterval=!1)},carouselMouseOut:function(){this.totalSlides>1&&(this.autoplay||this.slideChangeInterval||(this.slideChangeInterval=setInterval(this.goToNextVideo,5e3)))},updateNextPrevArrows:function(e){{var t=this.$(".carousel-prev");this.$(".carousel-next")}0===e?t.hide():t.show()},destroy:function(e){clearInterval(this.slideChangeInterval),i.prototype.destroy.call(this,e)}});return a}),define("modules/fronts/suspender-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var n=i.extend({initialize:function(t){t=e.extend({adPlacement:"sponsor_logo_front",adSizes:"sponsor_logo_medium"},t),this.visibleWithSidebarOpen="false"!==this.$el.attr("data-visible-with-sidebar-open"),i.prototype.initialize.call(this,t)},openSideBar:function(){this.visibleWithSidebarOpen||this._onHideSidebarAd()},closeSideBar:function(){this.visibleWithSidebarOpen||this._initAds()},_onHideSidebarAd:function(){this.subviews.simpleAd&&(this.subviews.simpleAd.destroy(),this.hide(),this.subviews.simpleAd=!1)},renderCardInfo:function(e){this.visibleWithSidebarOpen?this._initAds():e.sidebarOpen||this._initAds()}});return n}),define("modules/stories/google-survey",["jquery","underscore","utils","state","baseview","user-manager","managers/cachemanager","admanager","pubsub"],function(e,t,i,n,s,o,a,r,l){var h=s.extend({initialize:function(e){var a=o.getAccount("firefly"),h=i.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY")||{},d=this._getLocation(),c=n.getActivePageInfo();return window.gcsOnSurveyComplete=function(){var e={date:new Date,reliefPeriod:i.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY","relief_period")||864e5,isSet:function(){return localStorage.getItem("google-survey-complete-datetime")?!0:!1},isExpired:function(){return this.getSavedExpireTime()<this.date.getTime()?!0:!1},createNewExpireTime:function(){return parseInt(this.reliefPeriod,10)+this.date.getTime()},setExpirationTime:function(e){localStorage.setItem("google-survey-complete-datetime",e)},getSavedExpireTime:function(){return parseInt(localStorage.getItem("google-survey-complete-datetime"),10)}};if(e.isSet()&&!e.isExpired())l.trigger("fireflyout:open");else{var t=e.createNewExpireTime();e.setExpirationTime(t)}},window.gcsNoSurveyDelivered=function(){l.trigger("fireflyout:open")},s.prototype.initialize.call(this,e),this.setAlternativeActionResult(d),h.ENABLED&&this.surveyChecksPass(h)&&!c.sponsored_series?void r.getActiveSlotStatistics().done(t.bind(function(e){return t.findWhere(e.high_impact_info,{adType:"gravity"})||this.destroyed?!1:void(a?a.getUserInfo().done(t.bind(function(e){e.hasMarketAccess||this.loadGoogleConsumerSurvey(h,d)},this)).fail(t.bind(function(){this.loadGoogleConsumerSurvey(h,d)},this)):this.loadGoogleConsumerSurvey(h,d))},this)):(l.trigger("fireflyout:open"),!1)},surveyChecksPass:function(e){var t=parseInt(this.getAlternativeActionResult(),10),i=this.getEligibleArticleCount(),n=new Date;if(!e.show_on_article_number||i>=e.show_on_article_number){if(!t)return!0;if(n.getTime()>t+e.relief_period)return!0}else i++,a.setValue("gcs-eligible-page-count",i);return!1},loadGoogleConsumerSurvey:function(e,t){if(e.publisher_id&&t){var i="everything",s="//survey.g.doubleclick.net/survey";n.fetchData(s,{dataType:"script",data:{site:"_"+e.publisher_id,url:t,cid:i,after:"1"}})}},setAlternativeActionResult:function(e){if(e&&e.indexOf("#gcs-aau-success")>-1){var t=new Date;localStorage["gcs-aau-fulfilled"]=t.getTime(),window.location.hash=""}},getAlternativeActionResult:function(){return localStorage.getItem("gcs-aau-fulfilled")},getEligibleArticleCount:function(){return a.getValue("gcs-eligible-page-count",1)},_getLocation:function(){return window.location.href},destroy:function(){e(".t402-prompt-iframe-container").remove(),window.scrollTo(0,1),delete window.gcsOnSurveyComplete,delete window.gcsNoSurveyDelivered,s.prototype.destroy.call(this)}});return h}),define("modules/fronts/most-popular-primary",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,n,s){"use strict";var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(n){t.bindAll(this,"automate","goTo"),n=e.extend({transition:{interval:15e3}},n),this.subviews={},this.moveMe=this.$(".mppm-items-wrap"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new s({el:this.$(".paginator"),onGoTo:this.goTo}),n.transition&&(this.interval=n.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,n)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e*-1,s=i;this.animate(this.moveMe,"left",s+"px",450,"ease-in-out"),n.lazyLoadImage(this.moveMe.find("img"))},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return o}),define("modules/fronts/most-popular-sidebar",["jquery","underscore","baseview","utils","state"],function(e,t,i,n,s){"use strict";var o=i.extend({renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&this.loadLazyImages()},onCardWidthChange:function(e){var t=e.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=e,t&&this.loadLazyImages()},onOpenSidebar:function(){this.loadLazyImages()},loadLazyImages:function(){n.lazyLoadImage(this.$("img"),"data-src-"+this.currentCardInfo.sidebarWidth,!0,this.hideImage,this.showImage)},hideImage:function(e){e.parent().css("height",e.next().outerHeight()),s.getActiveApp().triggerEvent("refreshSidebarScroll")},showImage:function(e){e.css("visibility","visible"),s.getActiveApp().triggerEvent("refreshSidebarScroll")}});return o}),define("modules/fronts/most-popular",["jquery","underscore","baseview","modules/fronts/most-popular-primary","modules/fronts/most-popular-sidebar"],function(e,t,i,n,s){"use strict";var o=i.extend({initialize:function(e){this.subviews={},"sidebar"===e.layoutType?this.subviews.sidebar=new s(e):this.subviews.primary=new n(e),i.prototype.initialize.call(this,e)},renderCardInfo:function(e){this.triggerEvent("renderCardInfo",e)}});return o}),define("modules/rentalslite-classified",["jquery","baseview","state","directAdPosition","managers/routemanager"],function(e,t,i,n,s){var o=t.extend({adRendered:!1,events:{"click .js-rlc-search-btn":"aptsClassifieds"},renderAd:function(){var e=this.$(".js-rlc-google-ad")[0];!this.adRendered&&e&&(this.adRendered=!0,this.subviews.adPositionOne=this.createAdPosition(e))},createAdPosition:function(t){return new n({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag")})},initialize:function(){t.prototype.initialize.call(this),this.renderAd()},aptsClassifieds:function(){s.goTo(this.$("input:hidden.js-rlc-search-url").val())}});return o}),function(e){function t(e){function t(e,t,s){var a=null;if(i(t)&&(h(t),n(e),o(e),l(t),m>=2)){var r=d(t),v=0;v=u(r)?-1*p(g,r-1,Math.floor(m/2)-1):p(g,Math.floor(m/2),r-2),m%2===0&&(v+=c()),a=f(s,t,v),s.points=a}return a}function i(e){return null!=e.bars&&e.bars.show&&null!=e.bars.order}function n(e){var t=w?e.getPlaceholder().innerHeight():e.getPlaceholder().innerWidth(),i=w?s(e.getData(),1):s(e.getData(),0),n=i[1]-i[0];y=n/t}function s(e,t){for(var i=new Array,n=0;n<e.length;n++)i[0]=e[n].data[0][t],i[1]=e[n].data[e[n].data.length-1][t];return i}function o(e){g=a(e.getData()),m=g.length}function a(e){for(var t=new Array,i=0;i<e.length;i++)null!=e[i].bars.order&&e[i].bars.show&&t.push(e[i]);return t.sort(r)}function r(e,t){var i=e.bars.order,n=t.bars.order;return n>i?-1:i>n?1:0}function l(){v=3,b=v*y}function h(e){e.bars.horizontal&&(w=!0)}function d(e){for(var t=0,i=0;i<g.length;++i)if(e==g[i]){t=i;break}return t+1}function c(){return g[Math.ceil(m/2)].bars.barWidth/2}function u(e){return e<=Math.ceil(m/2)}function p(e,t,i){for(var n=0,s=t;i>=s;s++)n+=e[s].bars.barWidth+2*b;return n}function f(e,t,i){for(var n=e.pointsize,s=e.points,o=0,a=w?1:0;a<s.length;a+=n)s[a]+=i,t.data[o][3]=s[a],o++;return s}var g,m,v,b,y=1,w=!1;e.hooks.processDatapoints.push(t)}var i={series:{bars:{order:null}}};e.plot.plugins.push({init:t,options:i,name:"orderBars",version:"0.2"})}(jQuery),define("libs/flot/jquery.flot.orderBars",function(){}),function(e){function t(e){function t(e){var t=document.createElement("canvas");if(t.getContext&&t.getContext("2d")){e.getCanvas().getContext("2d"),e.width()+100,e.height()+50}}e.hooks.draw.push(t)}var i={};e.plot.plugins.push({init:t,options:i,name:"style ",version:"0.05"})}(jQuery),define("libs/flot/jquery.flot.usat.style",function(){}),define("modules/interactives/bar-chart",["jquery","underscore","baseview","utils","modules/interactives/interactive-base","libs/flot/jquery.flot.orderBars","libs/flot/jquery.flot.usat.style"],function(e,t,i,n,s){"use strict";var o=s.extend({initialize:function(e){this.orientation=this.$el.data("orientation"),s.prototype.initialize.call(this,e)},_isMultiBar:function(){return this.datasetItems.length>1},getChartColors:function(){return"horizontal"===this.orientation&&this._isMultiBar()?(this.$el.data("colors")||"").split("|").slice(0,this.datasetItems.length).reverse():(this.$el.data("colors")||"").split("|")},getFlotData:function(e){return t.map(e,function(e,i,n){var s=this.mainColor;return n.length>1&&(s=this.chartColors[i%this.chartColors.length]),{label:e.label||"",color:s,bars:{borderWidth:30,fillColor:s},data:t.map(e.value,function(e){return e.split(",")})}},this)},_getHoverBody:function(e){return[this.getHoverPrefix(),n.addCommas(n.addCommas(e.datapoint["horizontal"===this.orientation?0:1])),this.getHoverSuffix()].join(" ")},getFlotOptions:function(){var e=this.datasetItems.length+(this.datasetItems.length>1&&n.getNested(this.datasetItems,"0","value","length")>6?4:this.datasetItems.length>1?2:1),t=s.prototype.getFlotOptions.apply(this,arguments),i=1/e;return t.colors=this.chartColors,t.series={bars:{show:!0,barWidth:i,order:"integer"},stack:!1},t.series.bars.align="center",t.grid.borderWidth=1,t.grid.labelMargin=5,t.grid.axisMargin=0,t.grid.autoHighlight=!0,t.grid.borderColor="rgb(237,236,236)","horizontal"===this.orientation?(t.xaxis={position:"bottom",autoscaleMargin:.02,tickFormatter:this.numberWithCommas},t.yaxis={ticks:this._createTicks(this.chartData.datasetLabels||""),position:"left",tickLength:0,autoscaleMargin:.02},t.bars={horizontal:!0}):(t.xaxis={autoscaleMargin:.02,ticks:this._createTicks(this.chartData.datasetLabels||""),position:"bottom",tickLength:0},t.yaxis={position:"left",labelWidth:40,tickFormatter:this.numberWithCommas}),t},_getHoverLabel:function(e){return this._isMultiBar()?e.series.label:""}});return o}),define("modules/countdown-clock/countdown-clock",["jquery","underscore","baseview","state","directAdPosition","modules/fronts/countdown-clock"],function(e,t,i,n,s,o){"use strict";var a=o.extend({timer:0,seconds:0,classes:{sponsor:"countdown-clock-ad"},initialize:function(t){t=e.extend({adPlacement:"sponsor_logo_olympics",adSizes:[300,100],countdownContainer:".countdown-clock-container",digitBoxes:".countdown-timer-digit-container .digit",digitContainer:".countdown-timer-digit-container"},t),this.options=t,this.$sponsorshipAd=this.$("."+this.classes.sponsor),this.layoutType=this._getLayoutType();var n=e(t.countdownContainer).attr("data-type-event_date");i.prototype.initialize.call(this,t),this.options=t,this.seconds=Math.round(new Date(n).getTime()/1e3)-Math.round((new Date).getTime()/1e3),this.$digitBoxes=this.$(t.digitBoxes),this.$digitContainer=this.$(t.digitContainer),this.$primaryTimer=e(".card-primary-suspender.countdown-clock-broadcast-module"),this.$sidebarTimer=e(".card-sidebar.countdown-clock-broadcast-module"),this.counterStart(),this.positionTimer()},renderCardInfo:function(e){e.sidebarOpen||"primary"!==this.layoutType?e.sidebarOpen&&"sidebar"===this.layoutType&&this._buildSponsorshipAd():(this.$primaryTimer.show(),this._buildSponsorshipAd()),this.currentCardInfo=e},_buildSponsorshipAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorshipAd&&(this.subviews.sponsorshipAd=new s({el:this.$sponsorshipAd,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:"sponsor_logo",pageInfo:n.getActivePageInfo()}))},onCardWidthChange:function(e){e.sidebarOpen!==this.currentCardInfo.sidebarOpen&&(this.currentCardInfo=e,e.sidebarOpen&&this.$sidebarTimer.length?"primary"===this.layoutType?this.$primaryTimer.hide():"sidebar"===this.layoutType&&this._buildSponsorshipAd():"primary"===this.layoutType&&(this.$primaryTimer.show(),this._buildSponsorshipAd()))},decrementCounter:function(){this.updateTime(this.seconds),(0===this.seconds||isNaN(this.seconds)||this.seconds<0)&&(this.counterEnd(),this.counterStop()),this.seconds--},counterEnd:function(){this.$sidebarTimer.find(".countdown-timer").hide(),this.$primaryTimer.find(".countdown-timer").hide()}});return a}),define("modules/fronts/election-results-module",["jquery","underscore","backbone","baseview","pubsub","state"],function(e,t,i,n,s,o){"use strict";var a=n.extend({el:".elres-module-container",initialize:function(e){n.prototype.initialize.call(this,e),this.drawSenate(),this.drawHouse(),this.drawGov()},drawSenate:function(){var i=100,n="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/senate-bar-data.json";o.fetchData(n,{dataType:"json"}).done(t.bind(function(t){if(t){var n=t.senatedata[0],s=n.dem*i/100,o=n.repub*i/100,a=n.other*i/100,r=n.undecided*i/100;e(".elres-sen-democrat").width(s+"%"),e(".elres-sen-republican").width(o+"%"),e(".elres-sen-other").width(a+"%"),e(".elres-sen-undecided").width(r+"%"),e("#elres-sen-dem-num").html(n.dem),e("#elres-sen-rep-num").html(n.repub)}},this))},drawGov:function(){var i=100,n="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/gov-bar-data.json";o.fetchData(n,{dataType:"json"}).done(t.bind(function(t){if(t){var n=t.govdata[0],s=n.dem*i/50,o=n.repub*i/50,a=n.other*i/50,r=n.undecided*i/50;e(".elres-gov-democrat").width(s+"%"),e(".elres-gov-republican").width(o+"%"),e(".elres-gov-tossup").width(a+"%"),e(".elres-gov-undecided").width(r+"%"),e("#elres-gov-dem-num").html(n.dem),e("#elres-gov-rep-num").html(n.repub)}},this))},drawHouse:function(){var i=100,n="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/house-bar-data.json";o.fetchData(n,{dataType:"json"}).done(t.bind(function(t){if(t){var n=t.housedata[0],s=n.dem*i/435,o=n.repub*i/435,a=n.other*i/435,r=n.undecided*i/435;e(".elres-house-democrat").width(s+"%"),e(".elres-house-republican").width(o+"%"),e(".elres-house-tossup").width(a+"%"),e(".elres-house-undecided").width(r+"%"),e("#elres-house-dem-num").html(n.dem),e("#elres-house-rep-num").html(n.repub)}},this))}});return a}),define("modules/polldaddy-poll",["jquery","underscore","baseview","state"],function(e,t,i,n){"use strict";var s=i.extend({el:".polls-primary-wrapper",events:{"click .pmp-view-results":"toggleLink","click .pmp-answer-option":"submitVote"},initialize:function(e){i.prototype.initialize.call(this,e),this.$q_wrapper=this.$(".poll-question-wrapper"),this.$a_wrapper=this.$(".poll-answer-wrapper"),this.$question=this.$(".pmp-answer-option"),this.$toggle=this.$(".pmp-view-results"),this.$bars=this.$(".pmp-bar"),this.poll_id=this.$question.data("poll"),this.viewResults()},viewResults:function(){this.getVoteValue()===String(this.poll_id)&&(this.$a_wrapper.addClass("pmp-active"),this.$q_wrapper.remove(),this.$toggle.remove())},toggleLink:function(){this.$a_wrapper.hasClass("pmp-active")?(this.$a_wrapper.removeClass("pmp-active"),this.$q_wrapper.addClass("pmp-active")):(this.$q_wrapper.removeClass("pmp-active"),this.$a_wrapper.addClass("pmp-active"))},incBarWidths:function(i){var n=[],s=0;t.each(i.answers.answer,function(e){n.push(e.percent)}),e.each(this.$bars,function(){e(this).width(n[s]+"%"),s++})},submitVote:function(i){i.preventDefault();var s=e(i.target),o=s.data("vote"),a=s.data("poll"),r=this;this.getVoteValue()!==String(a)&&n.fetchData("/polls/post/"+a+"/"+o+"/").done(t.bind(function(e){this.setVoteValue(a),this.incBarWidths(e),r.viewResults()},this))},setVoteValue:function(e){localStorage.setItem("polldaddy_pollvote",e)},getVoteValue:function(){return localStorage.getItem("polldaddy_pollvote")}});return s}),define("modules/users/site-nav-user-module",["jquery","underscore","pubsub","utils","modules/header/site-nav-dropdown","user-manager"],function(e,t,i,n,s,o){"use strict";var a=s.extend({ALT_ACTIVE_CLASS:"site-nav-visible-alt-span",WRAP_ACTIVE_CLASS:"site-nav-user-dropdown-wrap-active",events:{"click .site-nav-user-login-btn":"onClickLogin","click .site-nav-user-logout-btn":"onClickLogout"},initialize:function(e){this.pubSub={"user:login":this.showLoggedInUser,"user:logout":this.showLoggedOutUser},t.bindAll(this,"_handleDropdownPanels","showLoggedInUser","showLoggedOutUser"),this.events=t.extend({},s.prototype.events,this.events),this.$loginWrap=this.$(".site-nav-user-logged-in-wrap"),this.$logoutWrap=this.$(".site-nav-user-logged-out-wrap"),this.$siteNavAltSpan=this.$(".site-nav-alt-span"),this.$avatarContainer=this.$(".site-nav-user-avatar-span"),this.$userDisplayName=this.$(".site-nav-user-display-name"),this.$avatar=this.$(".site-nav-user-avatar-image"),s.prototype.initialize.call(this,e),this._handleDropdownPanels()},_handleDropdownPanels:function(){this.isUserLoggedIn?(this.$loginWrap.addClass(this.WRAP_ACTIVE_CLASS),this.$logoutWrap.removeClass(this.WRAP_ACTIVE_CLASS)):(this.$loginWrap.removeClass(this.WRAP_ACTIVE_CLASS),this.$logoutWrap.addClass(this.WRAP_ACTIVE_CLASS))},showLoggedOutUser:function(){this.isUserLoggedIn=!1,this._teardownLoggedInMarkup(),this._handleDropdownPanels()},showLoggedInUser:function(){this._setupLoggedInMarkup(o.getAccount()),this.isUserLoggedIn=!0,this._handleDropdownPanels()},_setupLoggedInMarkup:function(e){var t=e.getUserFirstName()+" "+e.getUserLastName();this.$avatar.attr("src",e.getUserAvatar()),this.$avatar.attr("alt",t),this.$siteNavAltSpan.addClass(this.ALT_ACTIVE_CLASS),this.$userDisplayName.html(t)},_teardownLoggedInMarkup:function(){this.$avatar.attr("src",""),this.$avatar.attr("alt",""),this.$siteNavAltSpan.removeClass(this.ALT_ACTIVE_CLASS),this.$userDisplayName.html("")},onClickLogout:function(){this.showLoggedOutUser(),o.logoutUser().done(function(){i.trigger("uotrack","headerprofilelogout")})},onClickLogin:function(t){var n=e(t.target).data("user-account");o.loginUser(n).done(function(){i.trigger("uotrack","headerprofilelogin")})},destroy:function(e){this._teardownLoggedInMarkup(),s.prototype.destroy.call(this,e)}});return a}),define("modules/rentals-listing-row",["jquery","baseview","state","directAdPosition"],function(e,t,i,n){var s=t.extend({events:{"click .js-rlpm-more-apts":"scrollDownToMoreApartments"},initialize:function(){t.prototype.initialize.call(this);var e=this.$(".js-rlpm-ad-pos")[0],i=this.$(".js-rlpm-ad-pos")[1];e&&(this.subviews.adPositionOne=this.createAdPosition(e)),i&&(this.subviews.adPositionTwo=this.createAdPosition(i))},scrollDownToMoreApartments:function(){e("html, body").animate({scrollTop:this.$el.offset().top+this.$el.outerHeight(!0)+300},500)},handleCardSizeChange:function(e){e.sidebarOpen===!0?this.$(".js-rlpm-more-apts").addClass("rlpm-more-apts-hide"):this.$(".js-rlpm-more-apts").removeClass("rlpm-more-apts-hide")},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)},createAdPosition:function(t){return new n({el:e(t),adSizes:[330,330],adPlacement:e(t).data("adtag"),pageInfo:i.getActivePageInfo()})}});return s}),define("modules/fronts/elections-module",["jquery","underscore","backbone","baseview","pubsub","state"],function(e,t,i,n,s,o){"use strict";var a=n.extend({el:".elections-module-container",events:{"click .epm-selector":"displayChanger","click .epm-counter-div":"changeSlide","click .epm-module-link":"trackFull"},initialize:function(e){n.prototype.initialize.call(this,e),this.loadData("senate")},loadData:function(e){var i=this,n="/services/webproxy/?url=http://www.gannett-cdn.com/GDContent/2014/elections/api-scrapers/data/key-race-index.json";o.fetchData(n).done(t.bind(function(t){"key"==e?i.keyRaces(e,t):i.fillBars(e,t)},this))},fillBars:function(e,t){s.trigger("uotrack","elections2014"+e+".m");var i=0,n=0,o=100,a=[];"governor"==e?(n=25,i=50,a=t.govdata[0]):"house"==e?(n=100,i=435,a=t.housedata[0]):(n=100,i=100,a=t.senatedata[0]);var r=a.dem*o/i,l=a.leandem*o/i,h=a.repub*o/i,d=a.leanrepub*o/i,c=a.other*o/i;"house"!=e&&(n+=50),setTimeout(function(){this.$(".epm-democrat ").animate({width:r+"%"},50),this.$(".epm-lean-democrat ").animate({width:l+"%"},50),this.$(".epm-republican").animate({width:h+"%"},50),this.$(".epm-lean-republican").animate({width:d+"%"},50),this.$(".epm-tossup").animate({width:c+"%"},50)},100),this.$("#democrat ").html(a.dem),this.$("#lean-democrat ").html(a.leandem),this.$("#republican").html(a.repub),this.$("#lean-republican").html(a.leanrepub),this.$("#tossup").html(a.other)},keyRaces:function(e,t){s.trigger("uotrack","elections2014"+e+".m");var i=0;if(0===this.$(".epm-carousel-li").length){for(var n=t.races,o="",a="",r="",l="",h="",d=1;d<n.length;d++){{var c=n[d],u=c.stp,p=u.toLowerCase(),f=0;n.length-1}"RL"==c.lean?(a="r-lean",r="Lean Republican"):"DL"==c.lean?(a="d-lean",r="Lean Democrat"):"T"==c.lean?(a="t-lean",r="Tossup"):(a="t-lean",r="No Lean"),l="";for(var g=0;g<c.cand.length;g++){var m=c.cand[g];2>f&&(l+="<p class='epm-candidate "+m.pty+" "+m.inc+"'>"+m.lname+"</p>"),f++}var v="/pages/interactives/elections-forecast-2014/#/race/",b="<a class='epm-candidate-box' target='_blank' href='"+v+c.id+"'>";b+="<div class='epm-candidate-state "+a+"'>"+c.st+"<span class='epm-state-holder state-icon state-lg-"+p+"'></span></div>",b+="<div class='epm-candidate-candidates'>",b+="<div class='epm-lean-container "+a+"'>"+r+"</div>",b+="<span class='epm-candidate-container'>"+l+"</span></div>",b+="</a>",d%3===0?(h+=b,o+="<li class='epm-carousel-li'>"+h+"</li>",h="",i++):h+=b}""!==h&&(o+="<li class='epm-carousel-li'>"+h+"</li>",i++),this.$(".epm-key-races-container").append(o),this.slideCalc(i)}},displayChanger:function(t){var i=e(t.target).attr("id");this.$(".epm-races-holder, .epm-key-races, .epm-governor-numbers, .epm-house-numbers, .epm-senate-numbers").hide(),"key"==i?(this.loadData("key"),this.$(".epm-map").hide(),this.$(".epm-key-races").show()):(this.loadData(i),this.$(".epm-map").show(),this.$(".epm-races-holder").show(),this.$(".epm-"+i+"-numbers").show()),this.$(".epm-selector").removeClass("selected"),this.$("#"+i).addClass("selected")},slideCalc:function(e){var t=522*e+"px";if(this.$(".epm-key-races-container").width(t),0===this.$(".epm-counter-div").length){for(var i="<div class='selected epm-counter-div' id='slide-0'></div>",n=e-1,s=0;n>s;s++){var o=s+1;i+="<div class='epm-counter-div' id='slide-"+o+"'></div>"}this.$(".epm-module-navigation").append(i)}var a=this.$(".elections-module-navigation").width(),r=510-a,l=r/2+"px";this.$(".epm-module-navigation").css("margin-left",l)},changeSlide:function(t){this.$(".epm-counter-div").removeClass("selected"),e(t.target).addClass("selected");var i=e(t.target).attr("id"),n=i.split("-"),s=n[1],o=522*s+"px";this.$(".epm-key-races-container").animate({marginLeft:"-"+o},500)},trackFull:function(){s.trigger("uotrack","elections2014full")}});return a}),define("modules/stories/utility-bar-module-share",["jquery","underscore","backbone","utils","state","pubsub","managers/resourcemanager","modules/stories/utility-bar-flyout"],function(e,t,i,n,s,o,a,r){"use strict";var l=r.extend({events:{"click .util-bar-flyout-nav-btn":"onClickFlyoutNavBtn"},initialize:function(e){t.bindAll(this,"onClickFlyoutNavBtn");var i=this.$(".util-bar-share-summary-image");n.lazyLoadImage(i,"data-src",!0),this.events=t.extend({},r.prototype.events,this.events),r.prototype.initialize.call(this,e),this._loadUtilityBarModules()},_loadUtilityBarModules:function(){var e=n.getNested(window.site_vars,"utility_bar_modules");if(e){var i=t.find(e,function(e){return"utility-bar-module-share"===e.name});i&&i.options&&i.options.submodules&&a.fetchPageModules(i.options.submodules).done(t.bind(function(e){this.destroyed||t.each(e,function(e){this.subviews[e.name]=new e.ModuleClass(t.extend({el:e.selector},e.options))},this)},this))}},onClickFlyoutNavBtn:function(t){var i=e(t.currentTarget),n=e(t.currentTarget).data("share-method"),a="utilitybarshare"+n;o.trigger("uotrack",a),"A"!==i.prop("tagName")&&(t.preventDefault(),n&&s.getActiveApp().$(".util-bar-btn-"+n).trigger("click"))},showSection:function(t){this.activeSection=t,this.$(".util-bar-flyout-section, .util-bar-flyout-pane").hide(),this.$(".util-bar-flyout-pane-share, .util-bar-flyout-section-"+t).show(),this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$(".util-bar-flyout-nav-btn-"+t).addClass("active"),e(".js-share-email-form-success-pane").hide(),"email"===this.activeSection?e(".js-share-email-form-container").show():e(".js-share-email-form-container").hide()}});return l}),define("modules/elections/election-all-results",["jquery","underscore","baseview","form/autocomplete","ui/dropdown","state"],function(e,t,i,n,s){"use strict";var o=i.extend({events:{"click .election-toggle .ui-button-toggle-item":"toggleLevel","click .election-results-tab":"toggleTabs"},initialize:function(o){this.$nationalTab=this.$(".election-national-tab"),this.$nationalResultsTab=this.$(".election-results-national .election-results-tab"),this.$nationalResults=this.$(".election-results-national.election-results-content"),this.$nationalContainer=this.$(".election-results-national .election-results-container"),this.$stateTab=this.$(".election-state-tab"),this.$stateResultsTab=this.$(".election-results-state .election-results-tab"),this.$stateResults=this.$(".election-results-state.election-results-content"),this.$stateContainer=this.$(".election-results-state .election-results-container"),this.$stateStateContainers=this.$stateResults.find(".state-container"),this.$electionStatePicker=this.$(".election-state-picker-dropdown .ui-dropdown-item"),this.$bars=this.$(".hor-bar"),this.stateCode="placeholder",this.$nationalTab.hasClass("active")?this.$stateResults.hide().removeClass("hidden"):this.$nationalResults.hide().removeClass("hidden"),i.prototype.initialize.call(this,o),this.barsAnimate(),this.$(".election-state-picker-dropdown").length>0&&(this.selectDropdown=new s({el:".election-state-picker-dropdown",allResults:this,onSelect:this.selectState})),this.$electionSearch=this.$(".elections-autocomplete"),this.$electionSearch.each(t.bind(function(t,i){i=e(i);var s=i.attr("class").split("election-autocomplete-")[1].split(" ")[0];this.subviews["autocomplete-"+s]=new n({el:i,ajaxQueryKey:"term",resultDisplayTemplate:"<%= value %>",resultValueTemplate:"<%= value %>",maxResults:5,onParseResults:function(){}})},this))},barsAnimate:function(){var i=null;this.$bars.each(t.bind(function(n,s){s=e(s),s.is(":visible")?s.width()<=1&&(s.find(".percentage").hide(),i=this.animate(s,"width",s.data("percentage")+"%",800,"easeOutExpo"),i.done(t.bind(function(){s.find(".percentage").fadeIn()},s))):s.width(1)},this))},barsReset:function(){this.$bars.width(1)},selectState:function(t){this.allResults.$stateStateContainers.each(function(){var t=e(this);t.hasClass("hidden")||t.addClass("hidden")}),this.allResults.barsReset();var i=e(".specific-state-"+t);i.removeClass("hidden"),e(i.find(".election-results-container")[0]).addClass("selected"),e(i.find(".election-results-tab")[0]).addClass("selected"),this.allResults.barsAnimate()},toggleLevel:function(t){var i=e(t.currentTarget),n=i.hasClass("active");!n&&i.hasClass("election-national-tab")?(this.$stateTab.removeClass("active"),this.$nationalTab.addClass("active"),this.toggleResults(this.$nationalResults,this.$stateResults)):!n&&i.hasClass("election-state-tab")&&(this.$nationalTab.removeClass("active"),this.$stateTab.addClass("active"),this.toggleResults(this.$stateResults,this.$nationalResults))},toggleResults:function(t,i){var n=this;i.each(function(){e(this).fadeOut()}),i.promise().done(function(){t.fadeIn(),n.barsAnimate()})},toggleTabs:function(t){var i=this;this.$electionStatePicker.each(function(){"selected"==e(this).attr("data-selected")&&(i.stateCode=e(this).attr("data-value"))
});var n,s,o,a=e(t.currentTarget);a.parents(".election-results-national").length>0?(n=this.$nationalResultsTab.filter(".selected"),s=this.$nationalContainer.filter(".selected"),o=this.$nationalContainer.eq(a.index())):a.parents(".election-results-state").length>0&&(n=this.$stateResultsTab.filter(".selected"),s=this.$stateContainer.filter(".selected"),o=this.$stateContainer.eq(a.index())),n.removeClass("selected"),s.removeClass("selected"),a.addClass("selected"),o.addClass("selected"),e(".specific-state-"+this.stateCode).find(".election-results-container").eq(a.index()).addClass("selected"),this.barsAnimate()}});return o}),define("modules/home-finder/home-search",["jquery","underscore","baseview","utils"],function(e,t,i){"use strict";var n=i.extend({events:{"focus .mpa-hf-form-price-input":"inputFocus","click .mpa-hf-form-label":"generalDropdown","click .mpa-hf-form-price-options .mpa-hf-form-option":"priceClick","change .mpa-hf-form-price-input":"inputChange","click .mpa-hf-filter-option":"criteriaClick","click .mpa-hf-btn":"searchHomeFinder"},initialize:function(){this.actionHomeFinder=["",""],this.$priceFilterPane=this.$(".mpa-hf-price-filter-pane"),this.$priceOptions=this.$(".mpa-hf-form-price-options"),this.$priceLabel=this.$(".mpa-hf-form-price-label"),this.$container=this.$(".mpa-hf-filter-pane"),e("body").on("mouseup."+this.cid,t.bind(function(t){var i=this.$(".mpa-hf-form-label"),n=this.$(".mpa-hf-form-option"),s=this.$(".mpa-hf-form-price-input"),o=this.$(".mpa-hf-input-area");i.is(t.target)||n.is(t.target)||s.is(t.target)||o.is(t.target)||!this.$container.is(":visible")||i.is(e(t.target).parent())||this.$container.toggleClass("mpa-closed",this.$container.is(":visible"))},this))},searchHomeFinder:function(){var e=this.$(".mpa-hf-input-area").val().toLowerCase();if(e.match(/(\d{5}(?:-\d{4})?)/))this.actionHomeFinder[0]="zip-code/",this.actionHomeFinder[1]=e.match(/(\d{5}(?:-\d{4})?)/)[1]+"/";else if(e.trim().match(/^([^,]+),\s*(\w{2})$/)){var i=e.trim().match(/^([^,]+),\s*(\w{2})$/);this.actionHomeFinder[0]=i[2].toUpperCase()+"/",this.actionHomeFinder[1]=(i[1].charAt(0).toUpperCase()+i[1].slice(1)).replace(/\s/,"-")+"/"}else this.isInt(e)?(this.actionHomeFinder[0]="zip-code/",this.actionHomeFinder[1]=e+"/"):0===e.length?(this.actionHomeFinder[0]="search/",this.actionHomeFinder[1]=""):(this.actionHomeFinder[0]="search/?area=",this.actionHomeFinder[1]=e);var n=t.reduce(this.actionHomeFinder,function(e,t){return e+t});this.$(".seach-form").attr("action","//www.homefinder.com/"+n)},changeSearchAttribut:function(e,t){if(!isNaN(e))switch(t){case"bed":this.actionHomeFinder[2]="min-bed-"+e+"/";break;case"bath":this.actionHomeFinder[3]="min-bath-"+e+"/";break;case"min_price":this.actionHomeFinder[4]="min-price-"+e+"/";break;case"max_price":this.actionHomeFinder[5]="max-price-"+e+"/"}},generalDropdown:function(t){this.$container.not(".mpa-closed").is(t.currentTarget.nextElementSibling)||this.$container.not(".mpa-closed").addClass("mpa-closed"),e(t.currentTarget.nextElementSibling).toggleClass("mpa-closed"),e(t.currentTarget).hasClass("mpa-hf-form-price-label")&&(this.$(".mpa-hf-form-dropdown-menu[data-price='max']").hasClass("mpa-closed")||this.$(".mpa-hf-form-payment-min").focus())},inputFocus:function(t){var i=e(t.currentTarget),n=i.attr("placeholder").toLowerCase();this.$(".mpa-hf-form-dropdown-menu[data-price='"+n+"']").parent().is(":visible")||this.$priceOptions.toggleClass("mpa-closed")},priceClick:function(t){var i=e(t.currentTarget),n=i.parent(),s=n.parent(),o=s.data("price"),a=n.data("value").replace(/,/g,"");this.priceLabelDisplay(o,a),this.changeSearchAttribut(a,o+"_price"),this.$(".mpa-hf-form-payment-"+o).val(n.data("value")),e(".mpa-hf-form-payment-min").val().length>0&&e(".mpa-hf-form-payment-max").val().length>0&&this.$container.toggleClass("mpa-closed",this.$container.is(":visible"))},criteriaClick:function(t){var i=e(t.currentTarget),n=i.parent(),s=n.parent(),o=s.data("criteria");e(".mpa-hf-"+o+"-select").html(n.text()),this.$container.toggleClass("mpa-closed",this.$container.is(":visible")),this.changeSearchAttribut(n.data("value"),o)},inputChange:function(t){var i=e(t.currentTarget),n=i.val().replace(/,/g,""),s=i.attr("placeholder").toLowerCase();this.priceLabelDisplay(s,n),this.changeSearchAttribut(n,s+"_price")},priceLabelDisplay:function(t,i){var n="";this.$(".mpa-hf-form-price").data(t,i),0!==this.$(".mpa-hf-form-price").data("min")&&0!==this.$(".mpa-hf-form-price").data("max")?(this.$(".mpa-hf-form-price-prepend, .mpa-hf-form-price-append").hide(),n=this.priceConvert(e(".mpa-hf-form-price").data("min"))+" - "+this.priceConvert(e(".mpa-hf-form-price").data("max"))):(n=this.priceConvert(e(".mpa-hf-form-price").data(t)),0===e(".mpa-hf-form-price").data("min")?e(".mpa-hf-form-price-prepend").html("Up to "):e(".mpa-hf-form-price-append").html(" +")),e(".mpa-hf-form-price").html(n)},priceConvert:function(e){var t="$";return t+=e>=1e3?e.match(/^(\d.*)\d{3}$/)[1]+"K":e},isInt:function(e){if(isNaN(e))return!1;var t=parseFloat(e);return(0|t)===t},destroy:function(t){e("body").off("."+this.cid),i.prototype.destroy.call(this,t)}});return n}),define("modules/stories/utility-bar-module-comments",["jquery","underscore","backbone","pubsub","utils","modules/stories/utility-bar-flyout","modules/scroller/vertical-scroll","third-party-apis/facebook/facebook"],function(e,t,i,n,s,o,a,r){var l=o.extend({initialize:function(i){this.pubSub={"breakingbar:after:open":this.scalePanel},i=e.extend({noFlyoutScroll:!0},i),this.events=t.extend({},o.prototype.events,this.events),o.prototype.initialize.call(this,i)},attachCommentListener:function(){r.loadScript().done(function(){FB.getLoginStatus(function(e){"connected"===e.status&&(FB.Event.subscribe("comment.create",function(){n.trigger("comment:created")}),FB.Event.subscribe("comment.remove",function(){n.trigger("comment:removed")}))})})},unattachCommentListener:function(){r.loadScript().done(function(){FB.getLoginStatus(function(e){"connected"===e.status&&(FB.Event.unsubscribe("comment.create"),FB.Event.unsubscribe("comment.remove"))})})},loadComments:function(){return r.loadScript().done(t.bind(function(){FB.XFBML.parse(this.$scrollable[0]),this.scrollableHeight=this.$scrollable.height(),this.heightPoll=setInterval(t.bind(function(){this.scrollableHeight!==this.$scrollable.height()&&(this.scrollableHeight=this.$scrollable.height(),this.scalePanel())},this),200);var e=!1;-1===navigator.userAgent.indexOf("Chrome")?e=!0:Modernizr.touch&&(this.$scrollWrap.css({"-webkit-overflow-scrolling":"touch"}),"touch"===this.$scrollWrap.css("-webkit-overflow-scrolling")&&(e=!0)),e?this.$scrollWrap.css("overflow","auto"):this.subviews.vscroll=new a({el:this.$scrollWrap,draggerPaddingTop:0,color:"lighter"})},this))},onWindowResize:function(){this.scalePanel(),o.prototype.onWindowResize.call(this)},scalePanel:function(){this.$scrollWrap.css("height",this.$win.height()-s.get("headerHeight")-115),this.subviews.vscroll&&this.subviews.vscroll.refresh()},open:function(){this.$scrollWrap=this.$(".util-bar-scroll-wrap"),this.$scrollable=this.$(".scrollable-content"),this.$fbPluginWrap=this.$(".facebook-comments-plugin-wrap"),this.$win=s.get("win"),this.loadComments().done(t.bind(function(){this.attachCommentListener(),n.trigger("uotrack","UtilityBarCommentsOpen"),o.prototype.open.call(this)},this))},close:function(){n.trigger("uotrack","UtilityBarCommentsClose"),this.destroy()},destroy:function(e){clearInterval(this.heightPoll),this.unattachCommentListener(),o.prototype.destroy.call(this,e)}});return l}),define("videos/jwplayer_splice",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({el:".js-jwloader",initialize:function(e){i.prototype.initialize.call(this,e)}});return n}),define("modules/topics/topics-timeline",["jquery","underscore","state","baseview","utils","pubsub"],function(e,t,i,n,s,o){var a=n.extend({initialize:function(i){t.bindAll(this,"onScroll"),i=e.extend({enableInfiniteScroll:!0},i),i.enableInfiniteScroll&&(this.$win=s.get("win"),this.$win.on("scroll."+this.cid,t.throttle(this.onScroll,200)),this.$storyWrapper=this.$(".tpatm-wrap"),this.fetchingStories=!1,this.loaderClass="tpatm-loading-icon",this.loader='<div class="'+this.loaderClass+'">Loading...</div>'),n.prototype.initialize.call(this,i)},getMoreStories:function(){var e=this.$(".tpatm-item:last"),n=e.attr("data-more-stories-path");if(n){this.fetchingStories=!0,this.$storyWrapper.append(this.loader),o.trigger("topicarticles:fetching");var s=this.$storyWrapper.find("."+this.loaderClass),a="/topic/ajax/stories/?counter="+this.getStoriesCount()+"&path="+encodeURIComponent(n);e.removeAttr("data-more-stories-path"),i.fetchHtml(a).done(t.bind(function(e){s.remove(),e.hide().appendTo(this.$storyWrapper).fadeIn(1e3),this.fetchingStories=!1,o.trigger("topicarticles:fetched")},this)).fail(t.bind(function(){s.remove()},this))}},getStoriesCount:function(){return this.$(".tpatm-item").length},onScroll:function(){if(!this.fetchingStories){var e=this.$(".tpatm-item").last().position().top,t=this.$storyWrapper.offset().top;s.getScrollPosition()>=e-t&&this.getMoreStories()}return!1},destroy:function(e){this.$win.off("."+this.cid),n.prototype.destroy.call(this,e)}});return a}),define("modules/newsletter-signup/newsletter-signup",["jquery","underscore","baseview","state","user-manager","pubsub","managers/cachemanager"],function(e,t,i,n,s,o,a){"use strict";var r=i.extend({validEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},el:".newsletter-signup-container",events:{submit:"onFormSubmit"},initialize:function(){this.$nlTitle=this.$(".newsletter-signup-title"),this.$nlForm=this.$(".newsletter-signup-form"),this.$nlFormAction=this.$nlForm.attr("action"),this.$emailField=this.$(".newsletter-signup-email"),this.$emailConfirmField=this.$(".newsletter-signup-email-confirm"),this.$emailFormMsg=this.$(".newsletter-signup-msg"),this.$emailFormMsgTxt=this.$(".newsletter-signup-message-text"),this.$customSuccessMessage=this.$emailFormMsg.data("success-message"),this.$nlCheckboxes=this.$(".newsletter-signup-form .newsletters input"),this.$businessUnitCode=this.$nlForm.data("business-unit"),this.$nlSubmit=this.$(".newsletter-signup-submit"),this.$nlTagline=this.$(".newsletter-signup-tagline"),this.userAccount=s.getAccount("firefly"),this.userAccount&&this.userAccount.getUserInfo().done(t.bind(function(t){t.email&&(this.$currentUserEmail=t.email,this.$emailField.val(this.$currentUserEmail),this.$emailConfirmField.val(this.$currentUserEmail),this.$emailField.prop("type","hidden"),this.$emailConfirmField.prop("type","hidden"),this.$nlSubmit.prop("value","Update"),this.$nlTagline.html("Hello, <strong>"+t.welcomeName+"</strong>. Please select any new newsletters you would like to receive."),this.newsletterLocal=a.getValue(this.$currentUserEmail+"_newsletter",null,1),this.newsletterLocal?e.each(this.newsletterLocal.subscriptions,function(t,i){e("#newsletter-"+i)&&e("#newsletter-"+i).prop("checked",!0)}):(a.clearValue(this.$currentUserEmail+"_newsletter"),n.fetchData(null,{url:"/services/gemsapi/getuser/"+t.email+"/"+this.$businessUnitCode}).done(function(t){t.success===!0&&t.subscriptions&&e.each(t.subscriptions,function(t,i){e("#newsletter-"+i)&&e("#newsletter-"+i).prop("checked",!0)})})))},this))},setSubscriptionsLocal:function(e,t){var i={subscriptions:t};a.setValue(e+"_newsletter",i,10)},onFormSubmit:function(i){if(i.preventDefault(),this.$emailField.val()==this.$emailConfirmField.val()&&this.$emailField.val()&&this.validEmail(this.$emailField.val())){this.$emailFormMsg.hide();var s=[];this.$nlCheckboxes.each(function(t,i){s.push({id:e(i).data("newsletter-id"),signup:e(i).is(":checked")})});var a=JSON.stringify(s);this.$emailFormMsg.removeClass("fail").removeClass("success").addClass("updating"),this.$emailFormMsgTxt.html("Updating subscriptions."),this.$emailFormMsg.show();var r=0;this.userAccount&&this.userAccount.getUserInfo().always(t.bind(function(e){e.email&&(r=1)},this)),n.fetchData(null,{type:"POST",url:this.$nlFormAction+this.$emailField.val()+"/"+this.$businessUnitCode+"/",data:{logged_in:r,newsletter_choices:a}}).done(t.bind(function(t){if(this.$emailFormMsg.removeClass("updating"),t.success===!0){this.$emailFormMsg.removeClass("fail").addClass("success");var i=this.$el.hasClass("newsletter-signup-sidebar");i&&(this.$nlForm.addClass("hidden"),this.$nlTitle.addClass("hidden"));var n="newsletter-signup|front|"+this.$nlSubmit.data("frontname")+"|choices|",s=[];this.$nlCheckboxes.each(function(t,i){e(i).is(":checked")&&s.push(e(i).data("newsletter-id"))}),this.setSubscriptionsLocal(this.$currentUserEmail,s);var a=s.join("|");n+=a,o.trigger("uotrack",n)}else this.$emailFormMsg.removeClass("success").addClass("fail");t.success&&this.$customSuccessMessage&&(this.$customSuccessMessage=this.$customSuccessMessage.split("||").map(function(e){return'<span class="newsletter-signup-custom-success">'+e+"</span>"}).join(""),t.message=this.$customSuccessMessage),this.$emailFormMsgTxt.html(t.message)},this))}else this.$emailFormMsg.removeClass("updating").removeClass("success").addClass("fail"),this.$emailField.val()!=this.$emailConfirmField.val()&&this.$emailFormMsgTxt.html("Email addresses do not match."),this.$emailField.val()&&this.validEmail(this.$emailField.val())||this.$emailFormMsgTxt.html("Please enter a valid email address."),this.$emailFormMsg.show()}});return r}),define("modules/broadcast-live-newscasts/broadcast-live-newscasts",["jquery","underscore","baseview"],function(e,t,i){"use strict";var n=i.extend({el:".broadcast_live_newscasts",initialize:function(e){i.prototype.initialize.call(this,e)}});return n}),define("modules/partner/slider-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var n=i.extend({initialize:function(t){t=e.extend({adType:"slider",adPlacement:"slider",adSizes:[160,600]},t),i.prototype.initialize.call(this,t),this._initAds()}});return n}),define("modules/stories/share-email",["jquery","underscore","backbone","pubsub","baseview","state","utils","form/input-field"],function(e,t,i,n,s,o,a,r){var l=s.extend({events:{"click .recaptcha_option":"onRecaptcha","click .js-share-email-cancel-btn":"onClickCancelBtn","click .js-share-email-send-btn":"onSubmitEmailForm"},initialize:function(i){i=e.extend({uotrackName:"UtilityBarShareEmail",message:""},i),t.bindAll(this,"initInputs"),this.subviews={},this.initInputs(),this.$emailForm=this.$(".js-share-email-form"),this.$emailFormContainer=this.$(".js-share-email-form-container"),this.$successPane=this.$(".js-share-email-form-success-pane"),this.$shareTextarea=this.$(".js-share-email-form-textarea"),this.$shareTextareaOldVal=this.$shareTextarea.val(),this.setRecaptcha(),this.$emailForm.length&&a.requireSingleUseScript("http://www.google.com/recaptcha/api/challenge?k=6Lf7fuESAAAAAJ3_KMIDbkQySsEE0vMkLXUkq4eY").done(t.delay(this.initInputs,300)),s.prototype.initialize.call(this,i)},initInputs:function(){this.$inputs=this.$(".ui-text-input"),t.each(this.$inputs,function(e,t){this.subviews["input"+t]&&this.subviews["input"+t].destroy(),this.subviews["input"+t]=new r({el:e})},this)},setRecaptcha:function(){e(".recaptcha_widget").remove();var t=e("#recaptcha_widget").html();this.$(".js-email-form-recaptcha-widget").html(t),"modalEmailForm"===this.$el.attr("id")&&e("#recaptcha_response_field").addClass("ui-light")},onSubmitEmailForm:function(i){i.preventDefault();var n=this.$("#recaptcha_response_field");this.isValid(this.$emailForm)&&e.ajax({type:"POST",url:this.$emailForm.attr("action"),data:this.$emailForm.serialize()}).done(t.bind(function(){this.onSuccessfulSubmission()},this)).fail(t.bind(function(){n.addClass("error"),window.Recaptcha.reload()},this))},onSuccessfulSubmission:function(){this.showSuccessPane(),this.triggerEvent("clearInputValue"),this.reloadRecaptcha(),n.trigger("uotrack",this.options.uotrackName)},showSuccessPane:function(){this.hideEmailForm(),this.$successPane.show()},showEmailForm:function(){this.hideConfirmationPane(),this.setupShareText(),this.$el.show(),this.$emailFormContainer.show()},setupShareText:function(){this.$shareTextarea.val(this.options.message+"\n"+this.options.postLink+"\n\n"+this.$shareTextareaOldVal),this.$shareTextarea.height(40)},hideEmailForm:function(){this.$emailFormContainer.hide()},hideConfirmationPane:function(){this.$successPane.hide()},isValid:function(t){var i=!0;return t.children("input,textarea").removeClass("error").each(function(t,n){var s=e(n);s.hasClass("required")&&""===s.val()&&(s.addClass("error"),i=!1)}),i},onClickCancelBtn:function(){"modalEmailForm"===this.$el.attr("id")?o.getActiveApp().$(".social-share-modal-close-btn").trigger("click"):o.getActiveApp().$(".js-share-email-btn").trigger("click")},onRecaptcha:function(t){var i=e(t.currentTarget).data("option");"audio"===i||"image"===i?this.switchRecaptchaType(i):"help"===i?this.showRecaptchaHelp():this.reloadRecaptcha()},switchRecaptchaType:function(e){window.Recaptcha.switch_type(e)},showRecaptchaHelp:function(){window.Recaptcha.showhelp()},reloadRecaptcha:function(){window.Recaptcha.reload()}});return l}),define("modules/interactives/sequencer",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","modules/global/brightcove-video"],function(e,t,i,n,s,o){var a=s.extend({events:function(){var e=Modernizr.touch?"touchstart":"click",t={"click .navigation li":"navInteraction"};return t[e+" .nav-hide"]="showHidePanel",t},initialize:function(e){s.prototype.initialize.call(this,e);var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),this.subviews.template=new o({ads:t,el:this.$el,ignoreFirstNav:!0,interactiveType:"sequencer",isFramed:e.isFramed,standAlone:e.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex),this.subviews.video=[],this.$slideContainer=this.subviews.template.$slideContainer,this.$slides=this.subviews.template.$slides,this.$nav=this.subviews.template.$navigation,this.$navButton=this.$nav.find(".nav-hide-button"),this.$viewport=this.subviews.template.$viewport,this.setupSlides()},setupSlides:function(){if(this.$viewport.hasClass("slide-transition")){var e=this.$slides.eq(0).width()*this.$slides.length;this.$slideContainer.width(e)}else if(this.$viewport.hasClass("vslide-transition")){var t=this.$slides.eq(0).height()*this.$slides.length;this.$slideContainer.height(t)}},showHidePanel:function(){if(this.$navButton.length<1)return!1;var e=this.$nav.hasClass("show"),t=e?"showpanel":"hidepanel";this.animatePanel(e),this.options.isFramed!==!0&&this.subviews.template.trackClick("sequencer"+document.location.pathname+t)},navInteraction:function(){this.$(arguments[0].currentTarget).hasClass("nav-hide")||this.options.isFramed!==!0&&this.subviews.template.trackPageView()},animatePanel:function(e){e?(this.$nav.animate({width:"180px"},350),this.$nav.find(".sq-navigation-text-wrap").fadeIn()):(this.$nav.find(".sq-navigation-text-wrap").fadeOut(),this.$nav.animate({width:"48px"},350)),this.$nav.toggleClass("show")}});return a}),define("modules/live-video-sidebar/live-video-sidebar",["jquery","underscore","baseview","state","modules/global/livevideo"],function(e,t,i,n,s){"use strict";var o=i.extend({events:{"click .lvsm-link":"onClickLiveVideoLink"},initialize:function(e){this.liveVideosRailPoll=n.recurringFetchHtml("/videos/services/live-video-sidebar/",null,91e3,t.bind(function(e){this.$el.html(e)},this)),i.prototype.initialize.call(this,e)},destroy:function(){clearInterval(this.liveVideosRailPoll),i.prototype.destroy.apply(this,arguments)},onClickLiveVideoLink:function(t){var i=e(t.currentTarget).data("video-id");i&&(this.subviews.live&&this.subviews.live.destroy(!0),this.subviews.live=new s,this.subviews.live.loadLiveVideo(i),t.preventDefault())}});return o}),define("modules/topics/topics-photo-gallery",["jquery","underscore","baseview","utils","pubsub","modules/scroller/horizontal-scroll","modules/scroller/vertical-scroll","site-manager","state","meteredAdPosition"],function(e,t,i,n,s,o,a,r,l,h){var d=i.extend({events:{"click .tpapgm-gallery-nav-next":"_onClickNext","click .tpapgm-gallery-nav-previous":"_onClickPrev","click .tpapgm-collage-link":"_onClickMosaic","click .tpapgm-gallery-slide-link":"_onClickSlide","click .tpapgm-gallery-nav-close":"_onClickClose","click .tpapgm-gallery-nav-fullscreen":"_onClickFullScreen","click .tpapgm-gallery-thumbs-item-link":"_onClickThumb"},selectors:{slides:".tpapgm-gallery-slide:not(.tpapgm-gallery-slide-partner-ad)",slideImage:".tpapgm-gallery-slide-image",thumb:".tpapgm-gallery-thumbs-item"},initialize:function(s){t.bindAll(this,"_handleKeyPress","_onClickThumb","refreshScrollbar"),s=e.extend({enableGalleryAds:!0,debounceSpeed:0,captionsEnabled:!0,thumbsLocation:"top",thumbWidth:80,thumbHeight:45},s),this.$doc=n.get("document"),this.$body=n.get("body"),this.$win=n.get("win"),this.$moduleWrap=this.$(".tpapgm-module-wrap"),this.$gallery=this.$(".tpapgm-gallery-wrap"),this.$collageWrap=this.$(".tpapgm-collage-wrap"),this.$slidesWrap=this.$(".tpapgm-gallery-slides-wrap"),this.$slidesItemsWrap=this.$(".tpapgm-gallery-slides-items-wrap"),this.$arrowNext=this.$(".tpapgm-gallery-nav-next"),this.$arrowPrev=this.$(".tpapgm-gallery-nav-previous"),this.$closeBtn=this.$(".tpapgm-gallery-nav-close"),this.$caption=this.$(".tpapgm-gallery-caption"),this.totalPhotos=this.$gallery.data("total-photos"),this.activeClass="tpapgm-gallery-slide-active",this.loadingClass="tpapgm-gallery-slide-loading",this.fullscreenClass="tpapgm-gallery-wrap-fullscreen",this.fetchingImages=!1,this.$thumbsWrap=this.$(".tpapgm-gallery-thumbs-wrap"),this.$thumbsList=this.$(".tpapgm-gallery-thumbs-list"),this.thumbTemplate=this.$(".tpapgm-thumb-template").html(),this.thumbActiveClass="tpapgm-gallery-thumbs-item-active",this.slidesCount=this.$(this.selectors.slides).length,this.activeIndex=1,this.adActiveClass="slide-partner-active",this.arrowDebounce=t.debounce(function(e){this.goToSlide(e)},s.debounceSpeed,!0),i.prototype.initialize.call(this,s),this._bindKeys(),s.enableGalleryAds&&this._initializeAds()},_initializeAds:function(){var e=l.getActivePageInfo();this.$adSlide=this.$(".tpapgm-gallery-slide-partner-ad"),this.$adContents=this.$(".tpapgm-gallery-slide-partner-ad .partner-placement"),this.showingAd=!1,this.subviews.ad=new h({el:this.$adContents,adPlacement:"transition_gallery",adSizes:["elastic"],meterThreshold:"transition_gallery",rateMeterId:"topic_"+e.topic})},shouldShowAd:function(){return!this.showingAd&&this.subviews.ad&&this.subviews.ad.shouldShowAd()},setAdDimensions:function(){this.subviews.ad.resizeAd(this.$adSlide.width(),this.$adSlide.height())},_updateSlidesCount:function(){return this.slidesCount=this.$(this.selectors.slides).length,this.slidesCount},_getActiveSlide:function(){return this.$(this.selectors.slides).eq(this.activeIndex)},_setActiveSlide:function(e){this.activeIndex=e;var t=this._getActiveSlide();return t.addClass(this.activeClass),t},openGallery:function(e){this._setActiveSlide(e),this._updateSlide(),this.lazyLoadPhotos(),this.$collageWrap.hide(),this.$gallery.show(),this._bindKeys(),this.loadThumbs(),this._trackSlideChange(),this.subviews.ad&&this.subviews.ad.setInitialDimensions(this.$adSlide.width(),this.$adSlide.height())},openFullScreen:function(){s.trigger("topicgallery:open"),this.$gallery.addClass(this.fullscreenClass),this.$body.css("overflow","hidden"),this.lazyLoadPhotos(),r.getHeader().setClosedFixed(!0),this.refreshScrollbar(),this.fetchImages(),this.$win.on("resize."+this.cid,t.throttle(this.refreshScrollbar,2e3,{leading:!1,trailing:!1})),this.subviews.ad&&this.setAdDimensions()},refreshScrollbar:function(){this.subviews.scrollbar.refresh()},lazyLoadPhotos:function(){var t=this._getActiveSlide(),i=t.find("img"),s=t.prevAll("*:lt(2)").find("img"),o=t.nextAll("*:lt(2)").find("img"),a=this._isFullScreen()?"data-src-large":"data-src",r=this.loadingClass;this.$(this.selectors.slides+"."+r).removeClass(r),i=i.add(s).add(o);var l=function(t){e(t).closest(".tpapgm-gallery-slide").removeClass(r)};n.lazyLoadImage(i,a,!0,null,l)&&i.each(function(t,i){e(i).closest(".tpapgm-gallery-slide").addClass(r)})},loadThumbs:function(){for(var e=this.$(this.selectors.slides),i=t.template(this.thumbTemplate),n=this.$thumbsWrap.data("pos"),s=this.$thumbsList.find(this.selectors.thumb).length,r=s;r<this.slidesCount;r++){var l=e.eq(r).find(this.selectors.slideImage),h=i({active:r==this.activeIndex?this.thumbActiveClass:"",thumbSrc:l.data("thumb-src"),alt:l.data("caption"),current:r+1,total:this.totalPhotos});this.$thumbsList.append(h)}this.subviews.scrollbar?this.refreshScrollbar():this.subviews.scrollbar="top"==n||"bottom"==n?new o({el:this.$thumbsWrap,color:"light",draggerPaddingLeft:4,draggerPaddingRight:4}):new a({el:this.$thumbsWrap,color:"light",draggerPaddingTop:10,draggerPaddingBottom:0}),this.subviews.scrollbar.scrollToElement(this.$("."+this.thumbActiveClass),!0,0,"linear")},closeGallery:function(){s.trigger("topicgallery:close"),this._isFullScreen()&&(this.$body.css("overflow","auto"),this.$gallery.removeClass(this.fullscreenClass),this.lazyLoadPhotos(),r.getHeader().restoreLastState(),this.refreshScrollbar(),this.$win.off("."+this.cid),this.subviews.ad&&this.setAdDimensions())},nextSlide:function(){this.activeIndex+1<this.slidesCount&&this.arrowDebounce(this.activeIndex+1)},previousSlide:function(){0!==this.activeIndex&&this.arrowDebounce(this.activeIndex-1)},goToSlide:function(e){var t=this.$(this.selectors.slides),i=this._getActiveSlide(),n=t.eq(e),s=this.shouldShowAd();this.showingAd?(this.subviews.ad.stopAd(),this.subviews.ad.refreshPosition(),this.showingAd=!1,this.$adSlide.hide(),this.$gallery.removeClass(this.adActiveClass)):(i.removeClass(this.activeClass),i.hide()),s?(this.showingAd=!0,this.subviews.ad.show(),this.subviews.ad.playAd(),this.$gallery.addClass(this.adActiveClass),this.$adSlide.show()):(n.show(),this._setActiveSlide(e),this._updateSlide(),this._selectThumb(this.activeIndex),this.lazyLoadPhotos(),this._trackSlideChange()),e>=t.length-10&&!this.fetchingImages&&this.fetchImages()},_selectThumb:function(e){var t=this.$thumbsList.find(this.selectors.thumb).eq(e);t.addClass(this.thumbActiveClass).siblings().removeClass(this.thumbActiveClass),this.subviews.scrollbar.scrollToElement(t,!0,400,"ease-out")},_updateArrows:function(){0===this.activeIndex?this.$arrowPrev.hide():this.$arrowPrev.show(),this.activeIndex<this.slidesCount-1?this.$arrowNext.show():this.$arrowNext.hide()},_updateCaption:function(){var e=this._getActiveSlide().find(this.selectors.slideImage),t=e.data("caption")+' <span class="tpapgm-gallery-captions-credit">'+e.data("credit")+"</span>";this.$caption.html(t)},_updateSlide:function(){this._updateArrows(),this.options.captionsEnabled&&this._updateCaption()},_trackSlideChange:function(){var e={gallery_id:l.getActivePageInfo().topic,gallery_title:this.$gallery.attr("data-title"),gallery_index:this.activeIndex,slide_id:this._getActiveSlide().find("img").attr("data-id"),ssts:this.$gallery.attr("data-ssts"),cst:this.$gallery.attr("data-cst"),contenttype:l.getActivePageInfo().contenttype+"-gallery",pathName:this.$gallery.attr("data-gallery-path")};s.trigger("slide:change",e),l.fetchData(window.site_static_path+"html/comscorepvcandidate.xml",{cache:!0},!1,!0,!1)},fetchImages:function(){this.fetchingImages=!0;var e=this.$(this.selectors.slides).last();if(e.attr("data-more-photos-path")){var i="/topic/ajax/photos/?path="+encodeURIComponent(e.data("more-photos-path"));l.fetchHtml(i).done(t.bind(function(t){t.appendTo(this.$slidesWrap),this._updateSlidesCount(),this._updateSlide(),this.loadThumbs(),e.removeAttr("data-more-photos-path"),this.fetchingImages=!1},this))}},_isFullScreen:function(){return this.$gallery.hasClass(this.fullscreenClass)},_onClickNext:function(){this.nextSlide()},_onClickPrev:function(){this.previousSlide()},_onClickSlide:function(t){return e(t.currentTarget).closest(".tpapgm-gallery-slide-partner-ad").length?!1:void this.nextSlide()},_onClickMosaic:function(t){this.openGallery(e(t.currentTarget).index())},_onClickClose:function(){this.closeGallery()},_onClickFullScreen:function(){this.openFullScreen()},_onClickThumb:function(t){this.arrowDebounce(e(t.currentTarget).closest(this.selectors.thumb).index())},_bindKeys:function(){this.$gallery.is(":visible")&&this.$doc.on("keydown."+this.cid,this._handleKeyPress)},_handleKeyPress:function(e){return 37===e.keyCode&&this.$arrowPrev.is(":visible")?(this.$arrowPrev.trigger("click"),!1):39===e.keyCode&&this.$arrowNext.is(":visible")?(this.$arrowNext.trigger("click"),!1):27===e.keyCode&&this._isFullScreen()?(this.$closeBtn.trigger("click"),!1):!0},destroy:function(){this.$doc.off("."+this.cid),this.$win.off("."+this.cid),i.prototype.destroy.apply(this,arguments)}});return d}),function(e,t){var i,n;typeof exports!=t+""?i=exports:(n=e.L,i={},i.noConflict=function(){return e.L=n,this},e.L=i),i.version="0.4.4",i.Util={extend:function(e){for(var t,i=Array.prototype.slice.call(arguments,1),n=0,s=i.length;s>n;n++){t=i[n]||{};for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}return e},bind:function(e,t){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return e.apply(t,i||arguments)}},stamp:function(){var e=0,t="_leaflet_id";return function(i){return i[t]=i[t]||++e,i[t]}}(),limitExecByInterval:function(e,t,i){var n,s;return function o(){var a=arguments;return n?void(s=!0):(n=!0,setTimeout(function(){n=!1,s&&(o.apply(i,a),s=!1)},t),void e.apply(i,a))}},falseFn:function(){return!1},formatNum:function(e,t){var i=Math.pow(10,t||5);return Math.round(e*i)/i},splitWords:function(e){return e.replace(/^\s+|\s+$/g,"").split(/\s+/)},setOptions:function(e,t){return e.options=i.Util.extend({},e.options,t),e.options},getParamString:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+"="+e[i]);return"?"+t.join("&")},template:function(e,t){return e.replace(/\{ *([\w_]+) *\}/g,function(e,i){var n=t[i];if(!t.hasOwnProperty(i))throw new Error("No value provided for variable "+e);return n})},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var i,n,s=["webkit","moz","o","ms"];for(i=0;i<s.length&&!n;i++)n=e[s[i]+t];return n}function n(t){return e.setTimeout(t,1e3/60)}var s=e.requestAnimationFrame||t("RequestAnimationFrame")||n,o=e.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};i.Util.requestAnimFrame=function(t,o,a,r){return t=i.Util.bind(t,o),a&&s===n?void t():s.call(e,t,r)},i.Util.cancelAnimFrame=function(t){t&&o.call(e,t)}}(),i.Class=function(){},i.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments)},n=function(){};n.prototype=this.prototype;var s=new n;s.constructor=t,t.prototype=s;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(t[o]=this[o]);return e.statics&&(i.Util.extend(t,e.statics),delete e.statics),e.includes&&(i.Util.extend.apply(null,[s].concat(e.includes)),delete e.includes),e.options&&s.options&&(e.options=i.Util.extend({},s.options,e.options)),i.Util.extend(s,e),t},i.Class.include=function(e){i.Util.extend(this.prototype,e)},i.Class.mergeOptions=function(e){i.Util.extend(this.prototype.options,e)};var s="_leaflet_events";i.Mixin={},i.Mixin.Events={addEventListener:function(e,t,n){var o,a,r,l=this[s]=this[s]||{};if("object"==typeof e){for(o in e)e.hasOwnProperty(o)&&this.addEventListener(o,e[o],t);return this}for(e=i.Util.splitWords(e),a=0,r=e.length;r>a;a++)l[e[a]]=l[e[a]]||[],l[e[a]].push({action:t,context:n||this});return this},hasEventListeners:function(e){return s in this&&e in this[s]&&this[s][e].length>0},removeEventListener:function(e,t,n){var o,a,r,l,h,d=this[s];if("object"==typeof e){for(o in e)e.hasOwnProperty(o)&&this.removeEventListener(o,e[o],t);
return this}for(e=i.Util.splitWords(e),a=0,r=e.length;r>a;a++)if(this.hasEventListeners(e[a]))for(l=d[e[a]],h=l.length-1;h>=0;h--)t&&l[h].action!==t||n&&l[h].context!==n||l.splice(h,1);return this},fireEvent:function(e,t){if(!this.hasEventListeners(e))return this;for(var n=i.Util.extend({type:e,target:this},t),o=this[s][e].slice(),a=0,r=o.length;r>a;a++)o[a].action.call(o[a].context||this,n);return this}},i.Mixin.Events.on=i.Mixin.Events.addEventListener,i.Mixin.Events.off=i.Mixin.Events.removeEventListener,i.Mixin.Events.fire=i.Mixin.Events.fireEvent,function(){var n=navigator.userAgent.toLowerCase(),s=!!e.ActiveXObject,o=s&&!e.XMLHttpRequest,a=-1!==n.indexOf("webkit"),r=-1!==n.indexOf("gecko"),l=-1!==n.indexOf("chrome"),h=e.opera,d=-1!==n.indexOf("android"),c=-1!==n.search("android [23]"),u=typeof orientation!=t+""?!0:!1,p=document.documentElement,f=s&&"transition"in p.style,g=a&&"WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix,m=r&&"MozPerspective"in p.style,v=h&&"OTransition"in p.style,b=!e.L_NO_TOUCH&&function(){var e="ontouchstart";if(e in p)return!0;var t=document.createElement("div"),i=!1;return t.setAttribute?(t.setAttribute(e,"return;"),"function"==typeof t[e]&&(i=!0),t.removeAttribute(e),t=null,i):!1}(),y="devicePixelRatio"in e&&e.devicePixelRatio>1||"matchMedia"in e&&e.matchMedia("(min-resolution:144dpi)").matches;i.Browser={ua:n,ie:s,ie6:o,webkit:a,gecko:r,opera:h,android:d,android23:c,chrome:l,ie3d:f,webkit3d:g,gecko3d:m,opera3d:v,any3d:!e.L_DISABLE_3D&&(f||g||m||v),mobile:u,mobileWebkit:u&&a,mobileWebkit3d:u&&g,mobileOpera:u&&h,touch:b,retina:y}}(),i.Point=function(e,t,i){this.x=i?Math.round(e):e,this.y=i?Math.round(t):t},i.Point.prototype={add:function(e){return this.clone()._add(i.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(i.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e,t){return new i.Point(this.x/e,this.y/e,t)},multiplyBy:function(e,t){return new i.Point(this.x*e,this.y*e,t)},distanceTo:function(e){e=i.point(e);var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},clone:function(){return new i.Point(this.x,this.y)},toString:function(){return"Point("+i.Util.formatNum(this.x)+", "+i.Util.formatNum(this.y)+")"}},i.point=function(e,t,n){return e instanceof i.Point?e:e instanceof Array?new i.Point(e[0],e[1]):isNaN(e)?e:new i.Point(e,t,n)},i.Bounds=i.Class.extend({initialize:function(e,t){if(e)for(var i=t?[e,t]:e,n=0,s=i.length;s>n;n++)this.extend(i[n])},extend:function(e){return e=i.point(e),this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=e.clone(),this.max=e.clone()),this},getCenter:function(e){return new i.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new i.Point(this.min.x,this.max.y)},getTopRight:function(){return new i.Point(this.max.x,this.min.y)},contains:function(e){var t,n;return e="number"==typeof e[0]||e instanceof i.Point?i.point(e):i.bounds(e),e instanceof i.Bounds?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=i.bounds(e);var t=this.min,n=this.max,s=e.min,o=e.max,a=o.x>=t.x&&s.x<=n.x,r=o.y>=t.y&&s.y<=n.y;return a&&r}}),i.bounds=function(e,t){return!e||e instanceof i.Bounds?e:new i.Bounds(e,t)},i.Transformation=i.Class.extend({initialize:function(e,t,i,n){this._a=e,this._b=t,this._c=i,this._d=n},transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new i.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}}),i.DomUtil={get:function(e){return"string"==typeof e?document.getElementById(e):e},getStyle:function(e,t){var i=e.style[t];if(!i&&e.currentStyle&&(i=e.currentStyle[t]),!i||"auto"===i){var n=document.defaultView.getComputedStyle(e,null);i=n?n[t]:null}return"auto"===i?null:i},getViewportOffset:function(e){var t=0,n=0,s=e,o=document.body;do{if(t+=s.offsetTop||0,n+=s.offsetLeft||0,s.offsetParent===o&&"absolute"===i.DomUtil.getStyle(s,"position"))break;if("fixed"===i.DomUtil.getStyle(s,"position")){t+=o.scrollTop||0,n+=o.scrollLeft||0;break}s=s.offsetParent}while(s);s=e;do{if(s===o)break;t-=s.scrollTop||0,n-=s.scrollLeft||0,s=s.parentNode}while(s);return new i.Point(n,t)},create:function(e,t,i){var n=document.createElement(e);return n.className=t,i&&i.appendChild(n),n},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=i.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(e,t){return e.className.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){i.DomUtil.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:function(e,t){function i(e,i){return i===t?"":e}e.className=e.className.replace(/(\S+)\s*/g,i).replace(/(^\s+|\s+$)/,"")},setOpacity:function(e,t){"opacity"in e.style?e.style.opacity=t:i.Browser.ie&&(t=Math.round(100*t),e.style.filter="alpha(opacity="+t+")")},testProp:function(e){for(var t=document.documentElement.style,i=0;i<e.length;i++)if(e[i]in t)return e[i];return!1},getTranslateString:function(e){var t=i.Browser.webkit3d,n="translate"+(t?"3d":"")+"(",s=(t?",0":"")+")";return n+e.x+"px,"+e.y+"px"+s},getScaleString:function(e,t){var n=i.DomUtil.getTranslateString(t),s=" scale("+e+") ",o=i.DomUtil.getTranslateString(t.multiplyBy(-1));return n+s+o},setPosition:function(e,t,n){e._leaflet_pos=t,!n&&i.Browser.any3d?(e.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(t),i.Browser.mobileWebkit3d&&(e.style.WebkitBackfaceVisibility="hidden")):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getPosition:function(e){return e._leaflet_pos}},i.Util.extend(i.DomUtil,{TRANSITION:i.DomUtil.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:i.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])}),i.LatLng=function(e,t,i){var n=parseFloat(e),s=parseFloat(t);if(isNaN(n)||isNaN(s))throw new Error("Invalid LatLng object: ("+e+", "+t+")");i!==!0&&(n=Math.max(Math.min(n,90),-90),s=(s+180)%360+(-180>s||180===s?180:-180)),this.lat=n,this.lng=s},i.Util.extend(i.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),i.LatLng.prototype={equals:function(e){if(!e)return!1;e=i.latLng(e);var t=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return t<=i.LatLng.MAX_MARGIN},toString:function(){return"LatLng("+i.Util.formatNum(this.lat)+", "+i.Util.formatNum(this.lng)+")"},distanceTo:function(e){e=i.latLng(e);var t=6378137,n=i.LatLng.DEG_TO_RAD,s=(e.lat-this.lat)*n,o=(e.lng-this.lng)*n,a=this.lat*n,r=e.lat*n,l=Math.sin(s/2),h=Math.sin(o/2),d=l*l+h*h*Math.cos(a)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))}},i.latLng=function(e,t,n){return e instanceof i.LatLng?e:e instanceof Array?new i.LatLng(e[0],e[1]):isNaN(e)?e:new i.LatLng(e,t,n)},i.LatLngBounds=i.Class.extend({initialize:function(e,t){if(e)for(var i=t?[e,t]:e,n=0,s=i.length;s>n;n++)this.extend(i[n])},extend:function(e){return e="number"==typeof e[0]||e instanceof i.LatLng?i.latLng(e):i.latLngBounds(e),e instanceof i.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(e.lat,this._southWest.lat),this._southWest.lng=Math.min(e.lng,this._southWest.lng),this._northEast.lat=Math.max(e.lat,this._northEast.lat),this._northEast.lng=Math.max(e.lng,this._northEast.lng)):(this._southWest=new i.LatLng(e.lat,e.lng,!0),this._northEast=new i.LatLng(e.lat,e.lng,!0)):e instanceof i.LatLngBounds&&(this.extend(e._southWest),this.extend(e._northEast)),this},pad:function(e){var t=this._southWest,n=this._northEast,s=Math.abs(t.lat-n.lat)*e,o=Math.abs(t.lng-n.lng)*e;return new i.LatLngBounds(new i.LatLng(t.lat-s,t.lng-o),new i.LatLng(n.lat+s,n.lng+o))},getCenter:function(){return new i.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new i.LatLng(this._northEast.lat,this._southWest.lng,!0)},getSouthEast:function(){return new i.LatLng(this._southWest.lat,this._northEast.lng,!0)},contains:function(e){e="number"==typeof e[0]||e instanceof i.LatLng?i.latLng(e):i.latLngBounds(e);var t,n,s=this._southWest,o=this._northEast;return e instanceof i.LatLngBounds?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=s.lat&&n.lat<=o.lat&&t.lng>=s.lng&&n.lng<=o.lng},intersects:function(e){e=i.latLngBounds(e);var t=this._southWest,n=this._northEast,s=e.getSouthWest(),o=e.getNorthEast(),a=o.lat>=t.lat&&s.lat<=n.lat,r=o.lng>=t.lng&&s.lng<=n.lng;return a&&r},toBBoxString:function(){var e=this._southWest,t=this._northEast;return[e.lng,e.lat,t.lng,t.lat].join(",")},equals:function(e){return e?(e=i.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast())):!1}}),i.latLngBounds=function(e,t){return!e||e instanceof i.LatLngBounds?e:new i.LatLngBounds(e,t)},i.Projection={},i.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(e){var t=i.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,s=Math.max(Math.min(n,e.lat),-n),o=e.lng*t,a=s*t;return a=Math.log(Math.tan(Math.PI/4+a/2)),new i.Point(o,a)},unproject:function(e){var t=i.LatLng.RAD_TO_DEG,n=e.x*t,s=(2*Math.atan(Math.exp(e.y))-Math.PI/2)*t;return new i.LatLng(s,n,!0)}},i.Projection.LonLat={project:function(e){return new i.Point(e.lng,e.lat)},unproject:function(e){return new i.LatLng(e.y,e.x,!0)}},i.CRS={latLngToPoint:function(e,t){var i=this.projection.project(e),n=this.scale(t);return this.transformation._transform(i,n)},pointToLatLng:function(e,t){var i=this.scale(t),n=this.transformation.untransform(e,i);return this.projection.unproject(n)},project:function(e){return this.projection.project(e)},scale:function(e){return 256*Math.pow(2,e)}},i.CRS.EPSG3857=i.Util.extend({},i.CRS,{code:"EPSG:3857",projection:i.Projection.SphericalMercator,transformation:new i.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(e){var t=this.projection.project(e),i=6378137;return t.multiplyBy(i)}}),i.CRS.EPSG900913=i.Util.extend({},i.CRS.EPSG3857,{code:"EPSG:900913"}),i.CRS.EPSG4326=i.Util.extend({},i.CRS,{code:"EPSG:4326",projection:i.Projection.LonLat,transformation:new i.Transformation(1/360,.5,-1/360,.5)}),i.Map=i.Class.extend({includes:i.Mixin.Events,options:{crs:i.CRS.EPSG3857,fadeAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23,trackResize:!0,markerZoomAnimation:i.DomUtil.TRANSITION&&i.Browser.any3d},initialize:function(e,n){n=i.Util.setOptions(this,n),this._initContainer(e),this._initLayout(),this._initHooks(),this._initEvents(),n.maxBounds&&this.setMaxBounds(n.maxBounds),n.center&&n.zoom!==t&&this.setView(i.latLng(n.center),n.zoom,!0),this._initLayers(n.layers)},setView:function(e,t){return this._resetView(i.latLng(e),this._limitZoom(t)),this},setZoom:function(e){return this.setView(this.getCenter(),e)},zoomIn:function(){return this.setZoom(this._zoom+1)},zoomOut:function(){return this.setZoom(this._zoom-1)},fitBounds:function(e){var t=this.getBoundsZoom(e);return this.setView(i.latLngBounds(e).getCenter(),t)},fitWorld:function(){var e=new i.LatLng(-60,-170),t=new i.LatLng(85,179);return this.fitBounds(new i.LatLngBounds(e,t))},panTo:function(e){return this.setView(e,this._zoom)},panBy:function(e){return this.fire("movestart"),this._rawPanBy(i.point(e)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(e){if(e=i.latLngBounds(e),this.options.maxBounds=e,!e)return this._boundsMinZoom=null,this;var t=this.getBoundsZoom(e,!0);return this._boundsMinZoom=t,this._loaded&&(this._zoom<t?this.setView(e.getCenter(),t):this.panInsideBounds(e)),this},panInsideBounds:function(e){e=i.latLngBounds(e);var t=this.getBounds(),n=this.project(t.getSouthWest()),s=this.project(t.getNorthEast()),o=this.project(e.getSouthWest()),a=this.project(e.getNorthEast()),r=0,l=0;return s.y<a.y&&(l=a.y-s.y),s.x>a.x&&(r=a.x-s.x),n.y>o.y&&(l=o.y-n.y),n.x<o.x&&(r=o.x-n.x),this.panBy(new i.Point(r,l,!0))},addLayer:function(e){var t=i.Util.stamp(e);if(this._layers[t])return this;this._layers[t]=e,e.options&&!isNaN(e.options.maxZoom)&&(this._layersMaxZoom=Math.max(this._layersMaxZoom||0,e.options.maxZoom)),e.options&&!isNaN(e.options.minZoom)&&(this._layersMinZoom=Math.min(this._layersMinZoom||1/0,e.options.minZoom)),this.options.zoomAnimation&&i.TileLayer&&e instanceof i.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,e.on("load",this._onTileLayerLoad,this));var n=function(){e.onAdd(this),this.fire("layeradd",{layer:e})};return this._loaded?n.call(this):this.on("load",n,this),this},removeLayer:function(e){var t=i.Util.stamp(e);if(this._layers[t])return e.onRemove(this),delete this._layers[t],this.options.zoomAnimation&&i.TileLayer&&e instanceof i.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,e.off("load",this._onTileLayerLoad,this)),this.fire("layerremove",{layer:e})},hasLayer:function(e){var t=i.Util.stamp(e);return this._layers.hasOwnProperty(t)},invalidateSize:function(e){var t=this.getSize();if(this._sizeChanged=!0,this.options.maxBounds&&this.setMaxBounds(this.options.maxBounds),!this._loaded)return this;var n=t.subtract(this.getSize()).divideBy(2,!0);return e===!0?this.panBy(n):(this._rawPanBy(n),this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i.Util.bind(this.fire,this,"moveend"),200)),this},addHandler:function(e,t){return t?(this[e]=new t(this),this.options[e]&&this[e].enable(),this):void 0},getCenter:function(){return this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(e.getBottomLeft()),n=this.unproject(e.getTopRight());return new i.LatLngBounds(t,n)},getMinZoom:function(){var e=this.options.minZoom||0,t=this._layersMinZoom||0,i=this._boundsMinZoom||0;return Math.max(e,t,i)},getMaxZoom:function(){var e=this.options.maxZoom===t?1/0:this.options.maxZoom,i=this._layersMaxZoom===t?1/0:this._layersMaxZoom;return Math.min(e,i)},getBoundsZoom:function(e,t){e=i.latLngBounds(e);var n,s,o,a=this.getSize(),r=this.options.minZoom||0,l=this.getMaxZoom(),h=e.getNorthEast(),d=e.getSouthWest(),c=!0;t&&r--;do r++,s=this.project(h,r),o=this.project(d,r),n=new i.Point(Math.abs(s.x-o.x),Math.abs(o.y-s.y)),c=t?n.x<a.x||n.y<a.y:n.x<=a.x&&n.y<=a.y;while(c&&l>=r);return c&&t?null:t?r:r-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new i.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size},getPixelBounds:function(){var e=this._getTopLeftPoint();return new i.Bounds(e,e.add(this.getSize()))},getPixelOrigin:function(){return this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e){var t=this.options.crs;return t.scale(e)/t.scale(this._zoom)},getScaleZoom:function(e){return this._zoom+Math.log(e)/Math.LN2},project:function(e,n){return n=n===t?this._zoom:n,this.options.crs.latLngToPoint(i.latLng(e),n)},unproject:function(e,n){return n=n===t?this._zoom:n,this.options.crs.pointToLatLng(i.point(e),n)},layerPointToLatLng:function(e){var t=i.point(e).add(this._initialTopLeftPoint);return this.unproject(t)},latLngToLayerPoint:function(e){var t=this.project(i.latLng(e))._round();return t._subtract(this._initialTopLeftPoint)},containerPointToLayerPoint:function(e){return i.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return i.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(i.point(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(i.latLng(e)))},mouseEventToContainerPoint:function(e){return i.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=i.DomUtil.get(e);if(t._leaflet)throw new Error("Map container is already initialized.");t._leaflet=!0},_initLayout:function(){var e=this._container;e.innerHTML="",i.DomUtil.addClass(e,"leaflet-container"),i.Browser.touch&&i.DomUtil.addClass(e,"leaflet-touch"),this.options.fadeAnimation&&i.DomUtil.addClass(e,"leaflet-fade-anim");var t=i.DomUtil.getStyle(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._mapPane=e.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=e.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),this._objectsPane=e.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),e.shadowPane=this._createPane("leaflet-shadow-pane"),e.overlayPane=this._createPane("leaflet-overlay-pane"),e.markerPane=this._createPane("leaflet-marker-pane"),e.popupPane=this._createPane("leaflet-popup-pane");var t=" leaflet-zoom-hide";this.options.markerZoomAnimation||(i.DomUtil.addClass(e.markerPane,t),i.DomUtil.addClass(e.shadowPane,t),i.DomUtil.addClass(e.popupPane,t))},_createPane:function(e,t){return i.DomUtil.create("div",e,t||this._objectsPane)},_initializers:[],_initHooks:function(){var e,t;for(e=0,t=this._initializers.length;t>e;e++)this._initializers[e].call(this)},_initLayers:function(e){e=e?e instanceof Array?e:[e]:[],this._layers={},this._tileLayersNum=0;var t,i;for(t=0,i=e.length;i>t;t++)this.addLayer(e[t])},_resetView:function(e,t,n,s){var o=this._zoom!==t;s||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(e),n?this._initialTopLeftPoint._add(this._getMapPanePos()):i.DomUtil.setPosition(this._mapPane,new i.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum,this.fire("viewreset",{hard:!n}),this.fire("move"),(o||s)&&this.fire("zoomend"),this.fire("moveend",{hard:!n}),this._loaded||(this._loaded=!0,this.fire("load"))},_rawPanBy:function(e){i.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_initEvents:function(){if(i.DomEvent){i.DomEvent.on(this._container,"click",this._onMouseClick,this);var t,n,s=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(t=0,n=s.length;n>t;t++)i.DomEvent.on(this._container,s[t],this._fireMouseEvent,this);this.options.trackResize&&i.DomEvent.on(e,"resize",this._onResize,this)}},_onResize:function(){i.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=i.Util.requestAnimFrame(this.invalidateSize,this,!1,this._container)},_onMouseClick:function(e){!this._loaded||this.dragging&&this.dragging.moved()||(this.fire("preclick"),this._fireMouseEvent(e))},_fireMouseEvent:function(e){if(this._loaded){var t=e.type;if(t="mouseenter"===t?"mouseover":"mouseleave"===t?"mouseout":t,this.hasEventListeners(t)){"contextmenu"===t&&i.DomEvent.preventDefault(e);var n=this.mouseEventToContainerPoint(e),s=this.containerPointToLayerPoint(n),o=this.layerPointToLatLng(s);this.fire(t,{latlng:o,layerPoint:s,containerPoint:n,originalEvent:e})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this._tileBg&&(clearTimeout(this._clearTileBgTimer),this._clearTileBgTimer=setTimeout(i.Util.bind(this._clearTileBg,this),500))},_getMapPanePos:function(){return i.DomUtil.getPosition(this._mapPane)},_getTopLeftPoint:function(){if(!this._loaded)throw new Error("Set map center and zoom first.");return this._initialTopLeftPoint.subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(e,t){var i=this.getSize().divideBy(2);return this.project(e,t)._subtract(i)._round()},_latLngToNewLayerPoint:function(e,t,i){var n=this._getNewTopLeftPoint(i,t).add(this._getMapPanePos());return this.project(e,t)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize().divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitZoom:function(e){var t=this.getMinZoom(),i=this.getMaxZoom();return Math.max(t,Math.min(i,e))}}),i.Map.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),i="function"==typeof e?e:function(){this[e].apply(this,t)};this.prototype._initializers.push(i)},i.map=function(e,t){return new i.Map(e,t)},i.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(e){var t=i.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,s=Math.max(Math.min(n,e.lat),-n),o=this.R_MAJOR,a=this.R_MINOR,r=e.lng*t*o,l=s*t,h=a/o,d=Math.sqrt(1-h*h),c=d*Math.sin(l);c=Math.pow((1-c)/(1+c),.5*d);var u=Math.tan(.5*(.5*Math.PI-l))/c;return l=-a*Math.log(u),new i.Point(r,l)},unproject:function(e){for(var t,n=i.LatLng.RAD_TO_DEG,s=this.R_MAJOR,o=this.R_MINOR,a=e.x*n/s,r=o/s,l=Math.sqrt(1-r*r),h=Math.exp(-e.y/o),d=Math.PI/2-2*Math.atan(h),c=15,u=1e-7,p=c,f=.1;Math.abs(f)>u&&--p>0;)t=l*Math.sin(d),f=Math.PI/2-2*Math.atan(h*Math.pow((1-t)/(1+t),.5*l))-d,d+=f;return new i.LatLng(d*n,a,!0)}},i.CRS.EPSG3395=i.Util.extend({},i.CRS,{code:"EPSG:3395",projection:i.Projection.Mercator,transformation:function(){var e=i.Projection.Mercator,t=e.R_MAJOR,n=e.R_MINOR;return new i.Transformation(.5/(Math.PI*t),.5,-.5/(Math.PI*n),.5)}()}),i.TileLayer=i.Class.extend({includes:i.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:i.Browser.mobile,updateWhenIdle:i.Browser.mobile},initialize:function(e,t){t=i.Util.setOptions(this,t),t.detectRetina&&i.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomOffset++,t.minZoom>0&&t.minZoom--,this.options.maxZoom--),this._url=e;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(e){this._map=e,this._initContainer(),this._createTileProto(),e.on({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||(this._limitedUpdate=i.Util.limitExecByInterval(this._update,150,this),e.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._panes.tilePane.removeChild(this._container),e.off({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||e.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var e=this._map._panes.tilePane;return this._container&&(e.appendChild(this._container),this._setAutoZIndex(e,Math.max)),this},bringToBack:function(){var e=this._map._panes.tilePane;return this._container&&(e.insertBefore(this._container,e.firstChild),this._setAutoZIndex(e,Math.min)),this},getAttribution:function(){return this.options.attribution},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},setUrl:function(e,t){return this._url=e,t||this.redraw(),this},redraw:function(){return this._map&&(this._map._panes.tilePane.empty=!1,this._reset(!0),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==t&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e,t){for(var i,n=e.getElementsByClassName("leaflet-layer"),s=-t(1/0,-1/0),o=0,a=n.length;a>o;o++)n[o]!==this._container&&(i=parseInt(n[o].style.zIndex,10),isNaN(i)||(s=t(s,i)));this._container.style.zIndex=isFinite(s)?s+t(1,-1):""},_updateOpacity:function(){i.DomUtil.setOpacity(this._container,this.options.opacity);var e,t=this._tiles;if(i.Browser.webkit)for(e in t)t.hasOwnProperty(e)&&(t[e].style.webkitTransform+=" translate(0,0)")},_initContainer:function(){var e=this._map._panes.tilePane;(!this._container||e.empty)&&(this._container=i.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),e.appendChild(this._container),this.options.opacity<1&&this._updateOpacity())},_resetCallback:function(e){this._reset(e.hard)},_reset:function(e){var t,i=this._tiles;for(t in i)i.hasOwnProperty(t)&&this.fire("tileunload",{tile:i[t]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),e&&this._container&&(this._container.innerHTML=""),this._initContainer()},_update:function(){if(!this._map._panTransition||!this._map._panTransition._inProgress){var e=this._map.getPixelBounds(),t=this._map.getZoom(),n=this.options.tileSize;if(!(t>this.options.maxZoom||t<this.options.minZoom)){var s=new i.Point(Math.floor(e.min.x/n),Math.floor(e.min.y/n)),o=new i.Point(Math.floor(e.max.x/n),Math.floor(e.max.y/n)),a=new i.Bounds(s,o);this._addTilesFromCenterOut(a),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(a)}}},_addTilesFromCenterOut:function(e){var t,n,s,o=[],a=e.getCenter();for(t=e.min.y;t<=e.max.y;t++)for(n=e.min.x;n<=e.max.x;n++)s=new i.Point(n,t),this._tileShouldBeLoaded(s)&&o.push(s);var r=o.length;if(0!==r){o.sort(function(e,t){return e.distanceTo(a)-t.distanceTo(a)});var l=document.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=r,n=0;r>n;n++)this._addTile(o[n],l);this._container.appendChild(l)}},_tileShouldBeLoaded:function(e){if(e.x+":"+e.y in this._tiles)return!1;if(!this.options.continuousWorld){var t=this._getWrapTileNum();if(this.options.noWrap&&(e.x<0||e.x>=t)||e.y<0||e.y>=t)return!1}return!0},_removeOtherTiles:function(e){var t,i,n,s;for(s in this._tiles)this._tiles.hasOwnProperty(s)&&(t=s.split(":"),i=parseInt(t[0],10),n=parseInt(t[1],10),(i<e.min.x||i>e.max.x||n<e.min.y||n>e.max.y)&&this._removeTile(s))},_removeTile:function(e){var t=this._tiles[e];this.fire("tileunload",{tile:t,url:t.src}),this.options.reuseTiles?(i.DomUtil.removeClass(t,"leaflet-tile-loaded"),this._unusedTiles.push(t)):t.parentNode===this._container&&this._container.removeChild(t),i.Browser.android||(t.src=i.Util.emptyImageUrl),delete this._tiles[e]},_addTile:function(e,t){var n=this._getTilePos(e),s=this._getTile();i.DomUtil.setPosition(s,n,i.Browser.chrome||i.Browser.android23),this._tiles[e.x+":"+e.y]=s,this._loadTile(s,e),s.parentNode!==this._container&&t.appendChild(s)},_getZoomForUrl:function(){var e=this.options,t=this._map.getZoom();return e.zoomReverse&&(t=e.maxZoom-t),t+e.zoomOffset},_getTilePos:function(e){var t=this._map.getPixelOrigin(),i=this.options.tileSize;return e.multiplyBy(i).subtract(t)},getTileUrl:function(e){return this._adjustTilePoint(e),i.Util.template(this._url,i.Util.extend({s:this._getSubdomain(e),z:this._getZoomForUrl(),x:e.x,y:e.y},this.options))},_getWrapTileNum:function(){return Math.pow(2,this._getZoomForUrl())},_adjustTilePoint:function(e){var t=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(e.x=(e.x%t+t)%t),this.options.tms&&(e.y=t-e.y-1)},_getSubdomain:function(e){var t=(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_createTileProto:function(){var e=this._tileImg=i.DomUtil.create("img","leaflet-tile");e.galleryimg="no";var t=this.options.tileSize;e.style.width=t+"px",e.style.height=t+"px"},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var e=this._unusedTiles.pop();return this._resetTile(e),e}return this._createTile()},_resetTile:function(){},_createTile:function(){var e=this._tileImg.cloneNode(!1);return e.onselectstart=e.onmousemove=i.Util.falseFn,e},_loadTile:function(e,t){e._layer=this,e.onload=this._tileOnLoad,e.onerror=this._tileOnError,e.src=this.getTileUrl(t)},_tileLoaded:function(){this._tilesToLoad--,this._tilesToLoad||this.fire("load")},_tileOnLoad:function(){var e=this._layer;this.src!==i.Util.emptyImageUrl&&(i.DomUtil.addClass(this,"leaflet-tile-loaded"),e.fire("tileload",{tile:this,url:this.src})),e._tileLoaded()},_tileOnError:function(){var e=this._layer;e.fire("tileerror",{tile:this,url:this.src});var t=e.options.errorTileUrl;t&&(this.src=t),e._tileLoaded()}}),i.tileLayer=function(e,t){return new i.TileLayer(e,t)},i.TileLayer.WMS=i.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(e,t){this._url=e;var n=i.Util.extend({},this.defaultWmsParams);n.width=n.height=t.detectRetina&&i.Browser.retina?2*this.options.tileSize:this.options.tileSize;for(var s in t)this.options.hasOwnProperty(s)||(n[s]=t[s]);this.wmsParams=n,i.Util.setOptions(this,t)},onAdd:function(e){var t=parseFloat(this.wmsParams.version)>=1.3?"crs":"srs";this.wmsParams[t]=e.options.crs.code,i.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e,t){var n=this._map,s=n.options.crs,o=this.options.tileSize,a=e.multiplyBy(o),r=a.add(new i.Point(o,o)),l=s.project(n.unproject(a,t)),h=s.project(n.unproject(r,t)),d=[l.x,h.y,h.x,l.y].join(","),c=i.Util.template(this._url,{s:this._getSubdomain(e)});return c+i.Util.getParamString(this.wmsParams)+"&bbox="+d},setParams:function(e,t){return i.Util.extend(this.wmsParams,e),t||this.redraw(),this}}),i.tileLayer.wms=function(e,t){return new i.TileLayer.WMS(e,t)},i.TileLayer.Canvas=i.TileLayer.extend({options:{async:!1},initialize:function(e){i.Util.setOptions(this,e)},redraw:function(){var e,t=this._tiles;for(e in t)t.hasOwnProperty(e)&&this._redrawTile(t[e])},_redrawTile:function(e){this.drawTile(e,e._tilePoint,e._zoom)},_createTileProto:function(){var e=this._canvasProto=i.DomUtil.create("canvas","leaflet-tile"),t=this.options.tileSize;e.width=t,e.height=t},_createTile:function(){var e=this._canvasProto.cloneNode(!1);return e.onselectstart=e.onmousemove=i.Util.falseFn,e},_loadTile:function(e,t,i){e._layer=this,e._tilePoint=t,e._zoom=i,this.drawTile(e,t,i),this.options.async||this.tileDrawn(e)},drawTile:function(){},tileDrawn:function(e){this._tileOnLoad.call(e)}}),i.tileLayer.canvas=function(e){return new i.TileLayer.Canvas(e)},i.ImageOverlay=i.Class.extend({includes:i.Mixin.Events,options:{opacity:1},initialize:function(e,t,n){this._url=e,this._bounds=i.latLngBounds(t),i.Util.setOptions(this,n)},onAdd:function(e){this._map=e,this._image||this._initImage(),e._panes.overlayPane.appendChild(this._image),e.on("viewreset",this._reset,this),e.options.zoomAnimation&&i.Browser.any3d&&e.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(e){e.getPanes().overlayPane.removeChild(this._image),e.off("viewreset",this._reset,this),e.options.zoomAnimation&&e.off("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var e=this._map._panes.overlayPane;return this._image&&e.insertBefore(this._image,e.firstChild),this},_initImage:function(){this._image=i.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&i.Browser.any3d?i.DomUtil.addClass(this._image,"leaflet-zoom-animated"):i.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),i.Util.extend(this._image,{galleryimg:"no",onselectstart:i.Util.falseFn,onmousemove:i.Util.falseFn,onload:i.Util.bind(this._onImageLoad,this),src:this._url})
},_animateZoom:function(e){var t=this._map,n=this._image,s=t.getZoomScale(e.zoom),o=this._bounds.getNorthWest(),a=this._bounds.getSouthEast(),r=t._latLngToNewLayerPoint(o,e.zoom,e.center),l=t._latLngToNewLayerPoint(a,e.zoom,e.center).subtract(r),h=t.latLngToLayerPoint(a).subtract(t.latLngToLayerPoint(o)),d=r.add(l.subtract(h).divideBy(2));n.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(d)+" scale("+s+") "},_reset:function(){var e=this._image,t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast()).subtract(t);i.DomUtil.setPosition(e,t),e.style.width=n.x+"px",e.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){i.DomUtil.setOpacity(this._image,this.options.opacity)}}),i.imageOverlay=function(e,t,n){return new i.ImageOverlay(e,t,n)},i.Icon=i.Class.extend({options:{className:""},initialize:function(e){i.Util.setOptions(this,e)},createIcon:function(){return this._createIcon("icon")},createShadow:function(){return this._createIcon("shadow")},_createIcon:function(e){var t=this._getIconUrl(e);if(!t){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(t);return this._setIconStyles(i,e),i},_setIconStyles:function(e,t){var n,s=this.options,o=i.point(s[t+"Size"]);n=i.point("shadow"===t?s.shadowAnchor||s.iconAnchor:s.iconAnchor),!n&&o&&(n=o.divideBy(2,!0)),e.className="leaflet-marker-"+t+" "+s.className,n&&(e.style.marginLeft=-n.x+"px",e.style.marginTop=-n.y+"px"),o&&(e.style.width=o.x+"px",e.style.height=o.y+"px")},_createImg:function(e){var t;return i.Browser.ie6?t=document.createElement("div"):(t=document.createElement("img"),t.src=e),t},_getIconUrl:function(e){return this.options[e+"Url"]}}),i.icon=function(e){return new i.Icon(e)},i.Icon.Default=i.Icon.extend({options:{iconSize:new i.Point(25,41),iconAnchor:new i.Point(13,41),popupAnchor:new i.Point(1,-34),shadowSize:new i.Point(41,41)},_getIconUrl:function(e){var t=e+"Url";if(this.options[t])return this.options[t];var n=i.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+e+".png"}}),i.Icon.Default.imagePath=function(){var e,t,i,n,s=document.getElementsByTagName("script"),o=/\/?leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(e=0,t=s.length;t>e;e++)if(i=s[e].src,n=i.match(o))return i.split(o)[0]+"/images"}(),i.Marker=i.Class.extend({includes:i.Mixin.Events,options:{icon:new i.Icon.Default,title:"",clickable:!0,draggable:!1,zIndexOffset:0,opacity:1},initialize:function(e,t){i.Util.setOptions(this,t),this._latlng=i.latLng(e)},onAdd:function(e){this._map=e,e.on("viewreset",this.update,this),this._initIcon(),this.update(),e.options.zoomAnimation&&e.options.markerZoomAnimation&&e.on("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this._removeIcon(),this.closePopup&&this.closePopup(),e.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(e){this._latlng=i.latLng(e),this.update(),this._popup&&this._popup.setLatLng(e)},setZIndexOffset:function(e){this.options.zIndexOffset=e,this.update()},setIcon:function(e){this._map&&this._removeIcon(),this.options.icon=e,this._map&&(this._initIcon(),this.update())},update:function(){if(this._icon){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}},_initIcon:function(){var e=this.options,t=this._map,n=t.options.zoomAnimation&&t.options.markerZoomAnimation,s=n?"leaflet-zoom-animated":"leaflet-zoom-hide",o=!1;this._icon||(this._icon=e.icon.createIcon(),e.title&&(this._icon.title=e.title),this._initInteraction(),o=this.options.opacity<1,i.DomUtil.addClass(this._icon,s)),this._shadow||(this._shadow=e.icon.createShadow(),this._shadow&&(i.DomUtil.addClass(this._shadow,s),o=this.options.opacity<1)),o&&this._updateOpacity();var a=this._map._panes;a.markerPane.appendChild(this._icon),this._shadow&&a.shadowPane.appendChild(this._shadow)},_removeIcon:function(){var e=this._map._panes;e.markerPane.removeChild(this._icon),this._shadow&&e.shadowPane.removeChild(this._shadow),this._icon=this._shadow=null},_setPos:function(e){i.DomUtil.setPosition(this._icon,e),this._shadow&&i.DomUtil.setPosition(this._shadow,e),this._icon.style.zIndex=e.y+this.options.zIndexOffset},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPos(t)},_initInteraction:function(){if(this.options.clickable){var e=this._icon,t=["dblclick","mousedown","mouseover","mouseout"];i.DomUtil.addClass(e,"leaflet-clickable"),i.DomEvent.on(e,"click",this._onMouseClick,this);for(var n=0;n<t.length;n++)i.DomEvent.on(e,t[n],this._fireMouseEvent,this);i.Handler.MarkerDrag&&(this.dragging=new i.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(e){i.DomEvent.stopPropagation(e),this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()||this.fire(e.type,{originalEvent:e})},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e}),"mousedown"!==e.type&&i.DomEvent.stopPropagation(e)},setOpacity:function(e){this.options.opacity=e,this._map&&this._updateOpacity()},_updateOpacity:function(){i.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&i.DomUtil.setOpacity(this._shadow,this.options.opacity)}}),i.marker=function(e,t){return new i.Marker(e,t)},i.DivIcon=i.Icon.extend({options:{iconSize:new i.Point(12,12),className:"leaflet-div-icon"},createIcon:function(){var e=document.createElement("div"),t=this.options;return t.html&&(e.innerHTML=t.html),t.bgPos&&(e.style.backgroundPosition=-t.bgPos.x+"px "+-t.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),i.divIcon=function(e){return new i.DivIcon(e)},i.Map.mergeOptions({closePopupOnClick:!0}),i.Popup=i.Class.extend({includes:i.Mixin.Events,options:{minWidth:50,maxWidth:300,maxHeight:null,autoPan:!0,closeButton:!0,offset:new i.Point(0,6),autoPanPadding:new i.Point(5,5),className:""},initialize:function(e,t){i.Util.setOptions(this,e),this._source=t},onAdd:function(e){this._map=e,this._container||this._initLayout(),this._updateContent();var t=e.options.fadeAnimation;t&&i.DomUtil.setOpacity(this._container,0),e._panes.popupPane.appendChild(this._container),e.on("viewreset",this._updatePosition,this),i.Browser.any3d&&e.on("zoomanim",this._zoomAnimation,this),e.options.closePopupOnClick&&e.on("preclick",this._close,this),this._update(),t&&i.DomUtil.setOpacity(this._container,1)},addTo:function(e){return e.addLayer(this),this},openOn:function(e){return e.openPopup(this),this},onRemove:function(e){e._panes.popupPane.removeChild(this._container),i.Util.falseFn(this._container.offsetWidth),e.off({viewreset:this._updatePosition,preclick:this._close,zoomanim:this._zoomAnimation},this),e.options.fadeAnimation&&i.DomUtil.setOpacity(this._container,0),this._map=null},setLatLng:function(e){return this._latlng=i.latLng(e),this._update(),this},setContent:function(e){return this._content=e,this._update(),this},_close:function(){var e=this._map;e&&(e._popup=null,e.removeLayer(this).fire("popupclose",{popup:this}))},_initLayout:function(){var e,t="leaflet-popup",n=this._container=i.DomUtil.create("div",t+" "+this.options.className+" leaflet-zoom-animated");this.options.closeButton&&(e=this._closeButton=i.DomUtil.create("a",t+"-close-button",n),e.href="#close",e.innerHTML="&#215;",i.DomEvent.on(e,"click",this._onCloseButtonClick,this));var s=this._wrapper=i.DomUtil.create("div",t+"-content-wrapper",n);i.DomEvent.disableClickPropagation(s),this._contentNode=i.DomUtil.create("div",t+"-content",s),i.DomEvent.on(this._contentNode,"mousewheel",i.DomEvent.stopPropagation),this._tipContainer=i.DomUtil.create("div",t+"-tip-container",n),this._tip=i.DomUtil.create("div",t+"-tip",this._tipContainer)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var s=e.offsetHeight,o=this.options.maxHeight,a="leaflet-popup-scrolled";o&&s>o?(t.height=o+"px",i.DomUtil.addClass(e,a)):i.DomUtil.removeClass(e,a),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng),t=i.Browser.any3d,n=this.options.offset;t&&i.DomUtil.setPosition(this._container,e),this._containerBottom=-n.y-(t?0:e.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);i.DomUtil.setPosition(this._container,t)},_adjustPan:function(){if(this.options.autoPan){var e=this._map,t=this._container.offsetHeight,n=this._containerWidth,s=new i.Point(this._containerLeft,-t-this._containerBottom);i.Browser.any3d&&s._add(i.DomUtil.getPosition(this._container));var o=e.layerPointToContainerPoint(s),a=this.options.autoPanPadding,r=e.getSize(),l=0,h=0;o.x<0&&(l=o.x-a.x),o.x+n>r.x&&(l=o.x+n-r.x+a.x),o.y<0&&(h=o.y-a.y),o.y+t>r.y&&(h=o.y+t-r.y+a.y),(l||h)&&e.panBy(new i.Point(l,h))}},_onCloseButtonClick:function(e){this._close(),i.DomEvent.stop(e)}}),i.popup=function(e,t){return new i.Popup(e,t)},i.Marker.include({openPopup:function(){return this._popup&&this._map&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},bindPopup:function(e,t){var n=i.point(this.options.icon.options.popupAnchor)||new i.Point(0,0);return n=n.add(i.Popup.prototype.options.offset),t&&t.offset&&(n=n.add(t.offset)),t=i.Util.extend({offset:n},t),this._popup||this.on("click",this.openPopup,this),this._popup=new i.Popup(t,this).setContent(e),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.openPopup)),this}}),i.Map.include({openPopup:function(e){return this.closePopup(),this._popup=e,this.addLayer(e).fire("popupopen",{popup:this._popup})},closePopup:function(){return this._popup&&this._popup._close(),this}}),i.LayerGroup=i.Class.extend({initialize:function(e){this._layers={};var t,i;if(e)for(t=0,i=e.length;i>t;t++)this.addLayer(e[t])},addLayer:function(e){var t=i.Util.stamp(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=i.Util.stamp(e);return delete this._layers[t],this._map&&this._map.removeLayer(e),this},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(e){var t,i,n=Array.prototype.slice.call(arguments,1);for(t in this._layers)this._layers.hasOwnProperty(t)&&(i=this._layers[t],i[e]&&i[e].apply(i,n));return this},onAdd:function(e){this._map=e,this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e),this._map=null},addTo:function(e){return e.addLayer(this),this},eachLayer:function(e,t){for(var i in this._layers)this._layers.hasOwnProperty(i)&&e.call(t,this._layers[i])}}),i.layerGroup=function(e){return new i.LayerGroup(e)},i.FeatureGroup=i.LayerGroup.extend({includes:i.Mixin.Events,addLayer:function(e){return this._layers[i.Util.stamp(e)]?this:(e.on("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),i.LayerGroup.prototype.addLayer.call(this,e),this._popupContent&&e.bindPopup&&e.bindPopup(this._popupContent),this)},removeLayer:function(e){return e.off("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),i.LayerGroup.prototype.removeLayer.call(this,e),this._popupContent?this.invoke("unbindPopup"):this},bindPopup:function(e){return this._popupContent=e,this.invoke("bindPopup",e)},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new i.LatLngBounds;return this.eachLayer(function(t){e.extend(t instanceof i.Marker?t.getLatLng():t.getBounds())},this),e},_propagateEvent:function(e){e.layer=e.target,e.target=this,this.fire(e.type,e)}}),i.featureGroup=function(e){return new i.FeatureGroup(e)},i.Path=i.Class.extend({includes:[i.Mixin.Events],statics:{CLIP_PADDING:i.Browser.mobile?Math.max(0,Math.min(.5,(1280/Math.max(e.innerWidth,e.innerHeight)-1)/2)):.5},options:{stroke:!0,color:"#0033ff",dashArray:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(e){i.Util.setOptions(this,e)},onAdd:function(e){this._map=e,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),e.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._pathRoot.removeChild(this._container),this._map=null,i.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),e.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(e){return i.Util.setOptions(this,e),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),i.Map.include({_updatePathViewport:function(){var e=i.Path.CLIP_PADDING,t=this.getSize(),n=i.DomUtil.getPosition(this._mapPane),s=n.multiplyBy(-1)._subtract(t.multiplyBy(e)),o=s.add(t.multiplyBy(1+2*e));this._pathViewport=new i.Bounds(s,o)}}),i.Path.SVG_NS="http://www.w3.org/2000/svg",i.Browser.svg=!(!document.createElementNS||!document.createElementNS(i.Path.SVG_NS,"svg").createSVGRect),i.Path=i.Path.extend({statics:{SVG:i.Browser.svg},bringToFront:function(){return this._container&&this._map._pathRoot.appendChild(this._container),this},bringToBack:function(){if(this._container){var e=this._map._pathRoot;e.insertBefore(this._container,e.firstChild)}return this},getPathString:function(){},_createElement:function(e){return document.createElementNS(i.Path.SVG_NS,e)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray")):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var e=this.getPathString();e||(e="M0 0"),this._path.setAttribute("d",e)},_initEvents:function(){if(this.options.clickable){(i.Browser.svg||!i.Browser.vml)&&this._path.setAttribute("class","leaflet-clickable"),i.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var e=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],t=0;t<e.length;t++)i.DomEvent.on(this._container,e[t],this._fireMouseEvent,this)}},_onMouseClick:function(e){this._map.dragging&&this._map.dragging.moved()||(this._fireMouseEvent(e),i.DomEvent.stopPropagation(e))},_fireMouseEvent:function(e){if(this.hasEventListeners(e.type)){"contextmenu"===e.type&&i.DomEvent.preventDefault(e);var t=this._map,n=t.mouseEventToContainerPoint(e),s=t.containerPointToLayerPoint(n),o=t.layerPointToLatLng(s);this.fire(e.type,{latlng:o,layerPoint:s,containerPoint:n,originalEvent:e})}}}),i.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=i.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&i.Browser.any3d?(this._pathRoot.setAttribute("class"," leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):this._pathRoot.setAttribute("class"," leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(e){var t=this.getZoomScale(e.zoom),n=this._getCenterOffset(e.center).divideBy(1-1/t),s=this.containerPointToLayerPoint(this.getSize().multiplyBy(-i.Path.CLIP_PADDING)),o=s.add(n).round();this._pathRoot.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(o.multiplyBy(-1).add(i.DomUtil.getPosition(this._pathRoot)).multiplyBy(t).add(o))+" scale("+t+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,n=e.max,s=n.x-t.x,o=n.y-t.y,a=this._pathRoot,r=this._panes.overlayPane;i.Browser.mobileWebkit&&r.removeChild(a),i.DomUtil.setPosition(a,t),a.setAttribute("width",s),a.setAttribute("height",o),a.setAttribute("viewBox",[t.x,t.y,s,o].join(" ")),i.Browser.mobileWebkit&&r.appendChild(a)}}}),i.Path.include({bindPopup:function(e,t){return this._popup&&this._popup.options===t||(this._popup=new i.Popup(t,this)),this._popup.setContent(e),this._openPopupAdded||(this.on("click",this._openPopup,this),this._openPopupAdded=!0),this},openPopup:function(e){return this._popup&&(e=e||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:e})),this},_openPopup:function(e){this._popup.setLatLng(e.latlng),this._map.openPopup(this._popup)}}),i.Browser.vml=function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"==typeof t.adj}catch(i){return!1}}(),i.Path=i.Browser.svg||!i.Browser.vml?i.Path:i.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var e=this._container=this._createElement("shape");i.DomUtil.addClass(e,"leaflet-vml-shape"),this.options.clickable&&i.DomUtil.addClass(e,"leaflet-clickable"),e.coordsize="1 1",this._path=this._createElement("path"),e.appendChild(this._path),this._map._pathRoot.appendChild(e)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var e=this._stroke,t=this._fill,i=this.options,n=this._container;n.stroked=i.stroke,n.filled=i.fill,i.stroke?(e||(e=this._stroke=this._createElement("stroke"),e.endcap="round",n.appendChild(e)),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,e.dashStyle=i.dashArray?i.dashArray.replace(/ *, */g," "):""):e&&(n.removeChild(e),this._stroke=null),i.fill?(t||(t=this._fill=this._createElement("fill"),n.appendChild(t)),t.color=i.fillColor||i.color,t.opacity=i.fillOpacity):t&&(n.removeChild(t),this._fill=null)},_updatePath:function(){var e=this._container.style;e.display="none",this._path.v=this.getPathString()+" ",e.display=""}}),i.Map.include(i.Browser.svg||!i.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var e=this._pathRoot=document.createElement("div");e.className="leaflet-vml-container",this._panes.overlayPane.appendChild(e),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),i.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),i.Path=i.Path.SVG&&!e.L_PREFER_CANVAS||!i.Browser.canvas?i.Path:i.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(e){return i.Util.setOptions(this,e),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(e){e.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this._requestUpdate(),this._map=null},_requestUpdate:function(){this._map&&(i.Util.cancelAnimFrame(this._fireMapMoveEnd),this._updateRequest=i.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var e=this.options;e.stroke&&(this._ctx.lineWidth=e.weight,this._ctx.strokeStyle=e.color),e.fill&&(this._ctx.fillStyle=e.fillColor||e.color)},_drawPath:function(){var e,t,n,s,o,a;for(this._ctx.beginPath(),e=0,n=this._parts.length;n>e;e++){for(t=0,s=this._parts[e].length;s>t;t++)o=this._parts[e][t],a=(0===t?"move":"line")+"To",this._ctx[a](o.x,o.y);this instanceof i.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var e=this._ctx,t=this.options;this._drawPath(),e.save(),this._updateStyle(),t.fill&&(t.fillOpacity<1&&(e.globalAlpha=t.fillOpacity),e.fill()),t.stroke&&(t.opacity<1&&(e.globalAlpha=t.opacity),e.stroke()),e.restore()}},_initEvents:function(){this.options.clickable&&this._map.on("click",this._onClick,this)},_onClick:function(e){this._containsPoint(e.layerPoint)&&this.fire("click",e)}}),i.Map.include(i.Path.SVG&&!e.L_PREFER_CANVAS||!i.Browser.canvas?{}:{_initPathRoot:function(){var e,t=this._pathRoot;t||(t=this._pathRoot=document.createElement("canvas"),t.style.position="absolute",e=this._canvasCtx=t.getContext("2d"),e.lineCap="round",e.lineJoin="round",this._panes.overlayPane.appendChild(t),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,n=e.max.subtract(t),s=this._pathRoot;i.DomUtil.setPosition(s,t),s.width=n.x,s.height=n.y,s.getContext("2d").translate(-t.x,-t.y)}}}),i.LineUtil={simplify:function(e,t){if(!t||!e.length)return e.slice();var i=t*t;return e=this._reducePoints(e,i),e=this._simplifyDP(e,i)},pointToSegmentDistance:function(e,t,i){return Math.sqrt(this._sqClosestPointOnSegment(e,t,i,!0))},closestPointOnSegment:function(e,t,i){return this._sqClosestPointOnSegment(e,t,i)},_simplifyDP:function(e,i){var n=e.length,s=typeof Uint8Array!=t+""?Uint8Array:Array,o=new s(n);o[0]=o[n-1]=1,this._simplifyDPStep(e,o,i,0,n-1);var a,r=[];for(a=0;n>a;a++)o[a]&&r.push(e[a]);return r},_simplifyDPStep:function(e,t,i,n,s){var o,a,r,l=0;for(a=n+1;s-1>=a;a++)r=this._sqClosestPointOnSegment(e[a],e[n],e[s],!0),r>l&&(o=a,l=r);l>i&&(t[o]=1,this._simplifyDPStep(e,t,i,n,o),this._simplifyDPStep(e,t,i,o,s))},_reducePoints:function(e,t){for(var i=[e[0]],n=1,s=0,o=e.length;o>n;n++)this._sqDist(e[n],e[s])>t&&(i.push(e[n]),s=n);return o-1>s&&i.push(e[o-1]),i},clipSegment:function(e,t,i,n){var s=(i.min,i.max,n?this._lastCode:this._getBitCode(e,i)),o=this._getBitCode(t,i);for(this._lastCode=o;;){if(!(s|o))return[e,t];if(s&o)return!1;var a=s||o,r=this._getEdgeIntersection(e,t,a,i),l=this._getBitCode(r,i);a===s?(e=r,s=l):(t=r,o=l)}},_getEdgeIntersection:function(e,t,n,s){var o=t.x-e.x,a=t.y-e.y,r=s.min,l=s.max;return 8&n?new i.Point(e.x+o*(l.y-e.y)/a,l.y):4&n?new i.Point(e.x+o*(r.y-e.y)/a,r.y):2&n?new i.Point(l.x,e.y+a*(l.x-e.x)/o):1&n?new i.Point(r.x,e.y+a*(r.x-e.x)/o):void 0},_getBitCode:function(e,t){var i=0;return e.x<t.min.x?i|=1:e.x>t.max.x&&(i|=2),e.y<t.min.y?i|=4:e.y>t.max.y&&(i|=8),i},_sqDist:function(e,t){var i=t.x-e.x,n=t.y-e.y;return i*i+n*n},_sqClosestPointOnSegment:function(e,t,n,s){var o,a=t.x,r=t.y,l=n.x-a,h=n.y-r,d=l*l+h*h;return d>0&&(o=((e.x-a)*l+(e.y-r)*h)/d,o>1?(a=n.x,r=n.y):o>0&&(a+=l*o,r+=h*o)),l=e.x-a,h=e.y-r,s?l*l+h*h:new i.Point(a,r)}},i.Polyline=i.Path.extend({initialize:function(e,t){i.Path.prototype.initialize.call(this,t),this._latlngs=this._convertLatLngs(e),i.Handler.PolyEdit&&(this.editing=new i.Handler.PolyEdit(this),this.options.editable&&this.editing.enable())},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var e=0,t=this._latlngs.length;t>e;e++)this._originalPoints[e]=this._map.latLngToLayerPoint(this._latlngs[e])},getPathString:function(){for(var e=0,t=this._parts.length,i="";t>e;e++)i+=this._getPathPartStr(this._parts[e]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._latlngs=this._convertLatLngs(e),this.redraw()},addLatLng:function(e){return this._latlngs.push(i.latLng(e)),this.redraw()},spliceLatLngs:function(){var e=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs),this.redraw(),e},closestLayerPoint:function(e){for(var t,n,s=1/0,o=this._parts,a=null,r=0,l=o.length;l>r;r++)for(var h=o[r],d=1,c=h.length;c>d;d++){t=h[d-1],n=h[d];var u=i.LineUtil._sqClosestPointOnSegment(e,t,n,!0);s>u&&(s=u,a=i.LineUtil._sqClosestPointOnSegment(e,t,n))}return a&&(a.distance=Math.sqrt(s)),a},getBounds:function(){for(var e=new i.LatLngBounds,t=this.getLatLngs(),n=0,s=t.length;s>n;n++)e.extend(t[n]);return e},onAdd:function(e){i.Path.prototype.onAdd.call(this,e),this.editing&&this.editing.enabled()&&this.editing.addHooks()},onRemove:function(e){this.editing&&this.editing.enabled()&&this.editing.removeHooks(),i.Path.prototype.onRemove.call(this,e)},_convertLatLngs:function(e){var t,n;for(t=0,n=e.length;n>t;t++){if(e[t]instanceof Array&&"number"!=typeof e[t][0])return;e[t]=i.latLng(e[t])}return e},_initEvents:function(){i.Path.prototype._initEvents.call(this)},_getPathPartStr:function(e){for(var t,n=i.Path.VML,s=0,o=e.length,a="";o>s;s++)t=e[s],n&&t._round(),a+=(s?"L":"M")+t.x+" "+t.y;return a},_clipPoints:function(){var e,t,n,s=this._originalPoints,o=s.length;if(this.options.noClip)return void(this._parts=[s]);this._parts=[];var a=this._parts,r=this._map._pathViewport,l=i.LineUtil;for(e=0,t=0;o-1>e;e++)n=l.clipSegment(s[e],s[e+1],r,e),n&&(a[t]=a[t]||[],a[t].push(n[0]),(n[1]!==s[e+1]||e===o-2)&&(a[t].push(n[1]),t++))},_simplifyPoints:function(){for(var e=this._parts,t=i.LineUtil,n=0,s=e.length;s>n;n++)e[n]=t.simplify(e[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),i.Path.prototype._updatePath.call(this))}}),i.polyline=function(e,t){return new i.Polyline(e,t)},i.PolyUtil={},i.PolyUtil.clipPolygon=function(e,t){var n,s,o,a,r,l,h,d,c,u=(t.min,t.max,[1,4,2,8]),p=i.LineUtil;for(s=0,h=e.length;h>s;s++)e[s]._code=p._getBitCode(e[s],t);for(a=0;4>a;a++){for(d=u[a],n=[],s=0,h=e.length,o=h-1;h>s;o=s++)r=e[s],l=e[o],r._code&d?l._code&d||(c=p._getEdgeIntersection(l,r,d,t),c._code=p._getBitCode(c,t),n.push(c)):(l._code&d&&(c=p._getEdgeIntersection(l,r,d,t),c._code=p._getBitCode(c,t),n.push(c)),n.push(r));e=n}return e},i.Polygon=i.Polyline.extend({options:{fill:!0},initialize:function(e,t){i.Polyline.prototype.initialize.call(this,e,t),e&&e[0]instanceof Array&&"number"!=typeof e[0][0]&&(this._latlngs=this._convertLatLngs(e[0]),this._holes=e.slice(1))},projectLatlngs:function(){if(i.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(var e=0,t=this._holes.length;t>e;e++){this._holePoints[e]=[];for(var n=0,s=this._holes[e].length;s>n;n++)this._holePoints[e][n]=this._map.latLngToLayerPoint(this._holes[e][n])}},_clipPoints:function(){var e=this._originalPoints,t=[];if(this._parts=[e].concat(this._holePoints),!this.options.noClip){for(var n=0,s=this._parts.length;s>n;n++){var o=i.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);o.length&&t.push(o)}this._parts=t}},_getPathPartStr:function(e){var t=i.Polyline.prototype._getPathPartStr.call(this,e);return t+(i.Browser.svg?"z":"x")}}),i.polygon=function(e,t){return new i.Polygon(e,t)},function(){function e(e){return i.FeatureGroup.extend({initialize:function(e,t){this._layers={},this._options=t,this.setLatLngs(e)},setLatLngs:function(t){var i=0,n=t.length;for(this.eachLayer(function(e){n>i?e.setLatLngs(t[i++]):this.removeLayer(e)},this);n>i;)this.addLayer(new e(t[i++],this._options));return this}})}i.MultiPolyline=e(i.Polyline),i.MultiPolygon=e(i.Polygon),i.multiPolyline=function(e,t){return new i.MultiPolyline(e,t)},i.multiPolygon=function(e,t){return new i.MultiPolygon(e,t)}}(),i.Rectangle=i.Polygon.extend({initialize:function(e,t){i.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=i.latLngBounds(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast(),e.getSouthWest()]}}),i.rectangle=function(e,t){return new i.Rectangle(e,t)},i.Circle=i.Path.extend({initialize:function(e,t,n){i.Path.prototype.initialize.call(this,n),this._latlng=i.latLng(e),this._mRadius=t},options:{fill:!0},setLatLng:function(e){return this._latlng=i.latLng(e),this.redraw()},setRadius:function(e){return this._mRadius=e,this.redraw()},projectLatlngs:function(){var e=this._getLngRadius(),t=new i.LatLng(this._latlng.lat,this._latlng.lng-e,!0),n=this._map.latLngToLayerPoint(t);this._point=this._map.latLngToLayerPoint(this._latlng),this._radius=Math.max(Math.round(this._point.x-n.x),1)},getBounds:function(){var e=this._map,t=this._radius*Math.cos(Math.PI/4),n=e.project(this._latlng),s=new i.Point(n.x-t,n.y+t),o=new i.Point(n.x+t,n.y-t),a=e.unproject(s),r=e.unproject(o);return new i.LatLngBounds(a,r)},getLatLng:function(){return this._latlng},getPathString:function(){var e=this._point,t=this._radius;return this._checkIfEmpty()?"":i.Browser.svg?"M"+e.x+","+(e.y-t)+"A"+t+","+t+",0,1,1,"+(e.x-.1)+","+(e.y-t)+" z":(e._round(),t=Math.round(t),"AL "+e.x+","+e.y+" "+t+","+t+" 0,23592600")},getRadius:function(){return this._mRadius},_getLngRadius:function(){var e=40075017,t=e*Math.cos(i.LatLng.DEG_TO_RAD*this._latlng.lat);return this._mRadius/t*360},_checkIfEmpty:function(){if(!this._map)return!1;var e=this._map._pathViewport,t=this._radius,i=this._point;return i.x-t>e.max.x||i.y-t>e.max.y||i.x+t<e.min.x||i.y+t<e.min.y}}),i.circle=function(e,t,n){return new i.Circle(e,t,n)},i.CircleMarker=i.Circle.extend({options:{radius:10,weight:2},initialize:function(e,t){i.Circle.prototype.initialize.call(this,e,null,t),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setRadius:function(e){return this._radius=e,this.redraw()}}),i.circleMarker=function(e,t){return new i.CircleMarker(e,t)},i.Polyline.include(i.Path.CANVAS?{_containsPoint:function(e,t){var n,s,o,a,r,l,h,d=this.options.weight/2;for(i.Browser.touch&&(d+=10),n=0,a=this._parts.length;a>n;n++)for(h=this._parts[n],s=0,r=h.length,o=r-1;r>s;o=s++)if((t||0!==s)&&(l=i.LineUtil.pointToSegmentDistance(e,h[o],h[s]),d>=l))return!0;return!1}}:{}),i.Polygon.include(i.Path.CANVAS?{_containsPoint:function(e){var t,n,s,o,a,r,l,h,d=!1;if(i.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(o=0,l=this._parts.length;l>o;o++)for(t=this._parts[o],a=0,h=t.length,r=h-1;h>a;r=a++)n=t[a],s=t[r],n.y>e.y!=s.y>e.y&&e.x<(s.x-n.x)*(e.y-n.y)/(s.y-n.y)+n.x&&(d=!d);return d}}:{}),i.Circle.include(i.Path.CANVAS?{_drawPath:function(){var e=this._point;
this._ctx.beginPath(),this._ctx.arc(e.x,e.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(e){var t=this._point,i=this.options.stroke?this.options.weight/2:0;return e.distanceTo(t)<=this._radius+i}}:{}),i.GeoJSON=i.FeatureGroup.extend({initialize:function(e,t){i.Util.setOptions(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,n,s=e instanceof Array?e:e.features;if(s){for(t=0,n=s.length;n>t;t++)this.addData(s[t]);return this}var o=this.options;if(!o.filter||o.filter(e)){var a=i.GeoJSON.geometryToLayer(e,o.pointToLayer);return a.feature=e,this.resetStyle(a),o.onEachFeature&&o.onEachFeature(e,a),this.addLayer(a)}},resetStyle:function(e){var t=this.options.style;t&&this._setLayerStyle(e,t)},setStyle:function(e){this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){"function"==typeof t&&(t=t(e.feature)),e.setStyle&&e.setStyle(t)}}),i.Util.extend(i.GeoJSON,{geometryToLayer:function(e,t){var n,s,o,a,r,l="Feature"===e.type?e.geometry:e,h=l.coordinates,d=[];switch(l.type){case"Point":return n=this.coordsToLatLng(h),t?t(e,n):new i.Marker(n);case"MultiPoint":for(o=0,a=h.length;a>o;o++)n=this.coordsToLatLng(h[o]),r=t?t(e,n):new i.Marker(n),d.push(r);return new i.FeatureGroup(d);case"LineString":return s=this.coordsToLatLngs(h),new i.Polyline(s);case"Polygon":return s=this.coordsToLatLngs(h,1),new i.Polygon(s);case"MultiLineString":return s=this.coordsToLatLngs(h,1),new i.MultiPolyline(s);case"MultiPolygon":return s=this.coordsToLatLngs(h,2),new i.MultiPolygon(s);case"GeometryCollection":for(o=0,a=l.geometries.length;a>o;o++)r=this.geometryToLayer(l.geometries[o],t),d.push(r);return new i.FeatureGroup(d);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e,t){var n=parseFloat(e[t?0:1]),s=parseFloat(e[t?1:0]);return new i.LatLng(n,s,!0)},coordsToLatLngs:function(e,t,i){var n,s,o,a=[];for(s=0,o=e.length;o>s;s++)n=t?this.coordsToLatLngs(e[s],t-1,i):this.coordsToLatLng(e[s],i),a.push(n);return a}}),i.geoJson=function(e,t){return new i.GeoJSON(e,t)},i.DomEvent={addListener:function(e,t,n,s){var o,a,r,l=i.Util.stamp(n),h="_leaflet_"+t+l;return e[h]?this:(o=function(t){return n.call(s||e,t||i.DomEvent._getEvent())},i.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener?this.addDoubleTapListener(e,o,l):("addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",o,!1),e.addEventListener(t,o,!1)):"mouseenter"===t||"mouseleave"===t?(a=o,r="mouseenter"===t?"mouseover":"mouseout",o=function(t){return i.DomEvent._checkMouse(e,t)?a(t):void 0},e.addEventListener(r,o,!1)):e.addEventListener(t,o,!1):"attachEvent"in e&&e.attachEvent("on"+t,o),e[h]=o,this))},removeListener:function(e,t,n){var s=i.Util.stamp(n),o="_leaflet_"+t+s,a=e[o];if(a)return i.Browser.touch&&"dblclick"===t&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,s):"removeEventListener"in e?"mousewheel"===t?(e.removeEventListener("DOMMouseScroll",a,!1),e.removeEventListener(t,a,!1)):"mouseenter"===t||"mouseleave"===t?e.removeEventListener("mouseenter"===t?"mouseover":"mouseout",a,!1):e.removeEventListener(t,a,!1):"detachEvent"in e&&e.detachEvent("on"+t,a),e[o]=null,this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this},disableClickPropagation:function(e){var t=i.DomEvent.stopPropagation;return i.DomEvent.addListener(e,i.Draggable.START,t).addListener(e,"click",t).addListener(e,"dblclick",t)},preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stop:function(e){return i.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,t){var n=document.body,s=document.documentElement,o=e.pageX?e.pageX:e.clientX+n.scrollLeft+s.scrollLeft,a=e.pageY?e.pageY:e.clientY+n.scrollTop+s.scrollTop,r=new i.Point(o,a);return t?r._subtract(i.DomUtil.getViewportOffset(t)):r},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_checkMouse:function(e,t){var i=t.relatedTarget;if(!i)return!0;try{for(;i&&i!==e;)i=i.parentNode}catch(n){return!1}return i!==e},_getEvent:function(){var t=e.event;if(!t)for(var i=arguments.callee.caller;i&&(t=i.arguments[0],!t||e.Event!==t.constructor);)i=i.caller;return t}},i.DomEvent.on=i.DomEvent.addListener,i.DomEvent.off=i.DomEvent.removeListener,i.Draggable=i.Class.extend({includes:i.Mixin.Events,statics:{START:i.Browser.touch?"touchstart":"mousedown",END:i.Browser.touch?"touchend":"mouseup",MOVE:i.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(e,t){this._element=e,this._dragStartTarget=t||e},enable:function(){this._enabled||(i.DomEvent.on(this._dragStartTarget,i.Draggable.START,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(i.DomEvent.off(this._dragStartTarget,i.Draggable.START,this._onDown),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(!(!i.Browser.touch&&e.shiftKey||1!==e.which&&1!==e.button&&!e.touches)){if(this._simulateClick=!0,e.touches&&e.touches.length>1)return void(this._simulateClick=!1);var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=t.target;i.DomEvent.preventDefault(e),i.Browser.touch&&"a"===n.tagName.toLowerCase()&&i.DomUtil.addClass(n,"leaflet-active"),this._moved=!1,this._moving||(this._startPos=this._newPos=i.DomUtil.getPosition(this._element),this._startPoint=new i.Point(t.clientX,t.clientY),i.DomEvent.on(document,i.Draggable.MOVE,this._onMove,this),i.DomEvent.on(document,i.Draggable.END,this._onUp,this))}},_onMove:function(e){if(!(e.touches&&e.touches.length>1)){var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=new i.Point(t.clientX,t.clientY),s=n.subtract(this._startPoint);(s.x||s.y)&&(i.DomEvent.preventDefault(e),this._moved||(this.fire("dragstart"),this._moved=!0,i.Browser.touch||(i.DomUtil.disableTextSelection(),this._setMovingCursor())),this._newPos=this._startPos.add(s),this._moving=!0,i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget))}},_updatePosition:function(){this.fire("predrag"),i.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(e){if(this._simulateClick&&e.changedTouches){var t=e.changedTouches[0],n=t.target,s=this._newPos&&this._newPos.distanceTo(this._startPos)||0;"a"===n.tagName.toLowerCase()&&i.DomUtil.removeClass(n,"leaflet-active"),s<i.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",t)}i.Browser.touch||(i.DomUtil.enableTextSelection(),this._restoreCursor()),i.DomEvent.off(document,i.Draggable.MOVE,this._onMove),i.DomEvent.off(document,i.Draggable.END,this._onUp),this._moved&&(i.Util.cancelAnimFrame(this._animRequest),this.fire("dragend")),this._moving=!1},_setMovingCursor:function(){i.DomUtil.addClass(document.body,"leaflet-dragging")},_restoreCursor:function(){i.DomUtil.removeClass(document.body,"leaflet-dragging")},_simulateEvent:function(t,i){var n=document.createEvent("MouseEvents");n.initMouseEvent(t,!0,!0,e,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(n)}}),i.Handler=i.Class.extend({initialize:function(e){this._map=e},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),i.Map.mergeOptions({dragging:!0,inertia:!i.Browser.android23,inertiaDeceleration:3e3,inertiaMaxSpeed:1500,inertiaThreshold:i.Browser.touch?32:14,worldCopyJump:!0}),i.Map.Drag=i.Handler.extend({addHooks:function(){if(!this._draggable){this._draggable=new i.Draggable(this._map._mapPane,this._map._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);var e=this._map.options;e.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),this._map.on("viewreset",this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var e=this._map;e.fire("movestart").fire("dragstart"),e._panTransition&&e._panTransition._onTransitionEnd(!0),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var e=this._lastTime=+new Date,t=this._lastPos=this._draggable._newPos;this._positions.push(t),this._times.push(e),e-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint(new i.LatLng(0,0));this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.project(new i.LatLng(0,180)).x},_onPreDrag:function(){var e=(this._map,this._worldWidth),t=Math.round(e/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,s=(n-t+i)%e+t-i,o=(n+t+i)%e-t-i,a=Math.abs(s+i)<Math.abs(o+i)?s:o;this._draggable._newPos.x=a},_onDragEnd:function(){var e=this._map,n=e.options,s=+new Date-this._lastTime,o=!n.inertia||s>n.inertiaThreshold||this._positions[0]===t;if(o)e.fire("moveend");else{var a=this._lastPos.subtract(this._positions[0]),r=(this._lastTime+s-this._times[0])/1e3,l=a.multiplyBy(.58/r),h=l.distanceTo(new i.Point(0,0)),d=Math.min(n.inertiaMaxSpeed,h),c=l.multiplyBy(d/h),u=d/n.inertiaDeceleration,p=c.multiplyBy(-u/2).round(),f={duration:u,easing:"ease-out"};i.Util.requestAnimFrame(i.Util.bind(function(){this._map.panBy(p,f)},this))}e.fire("dragend"),n.maxBounds&&i.Util.requestAnimFrame(this._panInsideMaxBounds,e,!0,e._container)},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)}}),i.Map.addInitHook("addHandler","dragging",i.Map.Drag),i.Map.mergeOptions({doubleClickZoom:!0}),i.Map.DoubleClickZoom=i.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick)},_onDoubleClick:function(e){this.setView(e.latlng,this._zoom+1)}}),i.Map.addInitHook("addHandler","doubleClickZoom",i.Map.DoubleClickZoom),i.Map.mergeOptions({scrollWheelZoom:!i.Browser.touch}),i.Map.ScrollWheelZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){i.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll)},_onWheelScroll:function(e){var t=i.DomEvent.getWheelDelta(e);this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),clearTimeout(this._timer),this._timer=setTimeout(i.Util.bind(this._performZoom,this),40),i.DomEvent.preventDefault(e)},_performZoom:function(){var e=this._map,t=Math.round(this._delta),i=e.getZoom();if(t=Math.max(Math.min(t,4),-4),t=e._limitZoom(i+t)-i,this._delta=0,t){var n=i+t,s=this._getCenterForScrollWheelZoom(this._lastMousePos,n);e.setView(s,n)}},_getCenterForScrollWheelZoom:function(e,t){var i=this._map,n=i.getZoomScale(t),s=i.getSize().divideBy(2),o=e.subtract(s).multiplyBy(1-1/n),a=i._getTopLeftPoint().add(s).add(o);return i.unproject(a)}}),i.Map.addInitHook("addHandler","scrollWheelZoom",i.Map.ScrollWheelZoom),i.Util.extend(i.DomEvent,{addDoubleTapListener:function(e,t,i){function n(e){if(1===e.touches.length){var t=Date.now(),i=t-(o||t);a=e.touches[0],r=i>0&&l>=i,o=t}}function s(){r&&(a.type="dblclick",t(a),o=null)}var o,a,r=!1,l=250,h="_leaflet_",d="touchstart",c="touchend";return e[h+d+i]=n,e[h+c+i]=s,e.addEventListener(d,n,!1),e.addEventListener(c,s,!1),this},removeDoubleTapListener:function(e,t){var i="_leaflet_";return e.removeEventListener(e,e[i+"touchstart"+t],!1),e.removeEventListener(e,e[i+"touchend"+t],!1),this}}),i.Map.mergeOptions({touchZoom:i.Browser.touch&&!i.Browser.android23}),i.Map.TouchZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){i.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var n=t.mouseEventToLayerPoint(e.touches[0]),s=t.mouseEventToLayerPoint(e.touches[1]),o=t._getCenterLayerPoint();this._startCenter=n.add(s).divideBy(2,!0),this._startDist=n.distanceTo(s),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),i.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),i.DomEvent.preventDefault(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length){var t=this._map,n=t.mouseEventToLayerPoint(e.touches[0]),s=t.mouseEventToLayerPoint(e.touches[1]);this._scale=n.distanceTo(s)/this._startDist,this._delta=n.add(s).divideBy(2,!0).subtract(this._startCenter),1!==this._scale&&(this._moved||(i.DomUtil.addClass(t._mapPane,"leaflet-zoom-anim leaflet-touching"),t.fire("movestart").fire("zoomstart")._prepareTileBg(),this._moved=!0),i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),i.DomEvent.preventDefault(e))}},_updateOnMove:function(){var e=this._map,t=this._getScaleOrigin(),n=e.layerPointToLatLng(t);e.fire("zoomanim",{center:n,zoom:e.getScaleZoom(this._scale)}),e._tileBg.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(this._delta)+" "+i.DomUtil.getScaleString(this._scale,this._startCenter)},_onTouchEnd:function(){if(this._moved&&this._zooming){var e=this._map;this._zooming=!1,i.DomUtil.removeClass(e._mapPane,"leaflet-touching"),i.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var t=this._getScaleOrigin(),n=e.layerPointToLatLng(t),s=e.getZoom(),o=e.getScaleZoom(this._scale)-s,a=o>0?Math.ceil(o):Math.floor(o),r=e._limitZoom(s+a);e.fire("zoomanim",{center:n,zoom:r}),e._runAnimation(n,r,e.getZoomScale(r)/this._scale,t,!0)}},_getScaleOrigin:function(){var e=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(e)}}),i.Map.addInitHook("addHandler","touchZoom",i.Map.TouchZoom),i.Map.mergeOptions({boxZoom:!0}),i.Map.BoxZoom=i.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){i.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){i.DomEvent.off(this._container,"mousedown",this._onMouseDown)},_onMouseDown:function(e){return!e.shiftKey||1!==e.which&&1!==e.button?!1:(i.DomUtil.disableTextSelection(),this._startLayerPoint=this._map.mouseEventToLayerPoint(e),this._box=i.DomUtil.create("div","leaflet-zoom-box",this._pane),i.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",i.DomEvent.on(document,"mousemove",this._onMouseMove,this).on(document,"mouseup",this._onMouseUp,this).preventDefault(e),void this._map.fire("boxzoomstart"))},_onMouseMove:function(e){var t=this._startLayerPoint,n=this._box,s=this._map.mouseEventToLayerPoint(e),o=s.subtract(t),a=new i.Point(Math.min(s.x,t.x),Math.min(s.y,t.y));i.DomUtil.setPosition(n,a),n.style.width=Math.abs(o.x)-4+"px",n.style.height=Math.abs(o.y)-4+"px"},_onMouseUp:function(e){this._pane.removeChild(this._box),this._container.style.cursor="",i.DomUtil.enableTextSelection(),i.DomEvent.off(document,"mousemove",this._onMouseMove).off(document,"mouseup",this._onMouseUp);var t=this._map,n=t.mouseEventToLayerPoint(e),s=new i.LatLngBounds(t.layerPointToLatLng(this._startLayerPoint),t.layerPointToLatLng(n));t.fitBounds(s),t.fire("boxzoomend",{boxZoomBounds:s})}}),i.Map.addInitHook("addHandler","boxZoom",i.Map.BoxZoom),i.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),i.Map.Keyboard=i.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61],zoomOut:[189,109]},initialize:function(e){this._map=e,this._setPanOffset(e.options.keyboardPanOffset),this._setZoomOffset(e.options.keyboardZoomOffset)},addHooks:function(){var e=this._map._container;-1===e.tabIndex&&(e.tabIndex="0"),i.DomEvent.addListener(e,"focus",this._onFocus,this).addListener(e,"blur",this._onBlur,this).addListener(e,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var e=this._map._container;i.DomEvent.removeListener(e,"focus",this._onFocus,this).removeListener(e,"blur",this._onBlur,this).removeListener(e,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){this._focused||this._map._container.focus()},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(e){var t,i,n=this._panKeys={},s=this.keyCodes;for(t=0,i=s.left.length;i>t;t++)n[s.left[t]]=[-1*e,0];for(t=0,i=s.right.length;i>t;t++)n[s.right[t]]=[e,0];for(t=0,i=s.down.length;i>t;t++)n[s.down[t]]=[0,e];for(t=0,i=s.up.length;i>t;t++)n[s.up[t]]=[0,-1*e]},_setZoomOffset:function(e){var t,i,n=this._zoomKeys={},s=this.keyCodes;for(t=0,i=s.zoomIn.length;i>t;t++)n[s.zoomIn[t]]=e;for(t=0,i=s.zoomOut.length;i>t;t++)n[s.zoomOut[t]]=-e},_addHooks:function(){i.DomEvent.addListener(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){i.DomEvent.removeListener(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){var t=e.keyCode;if(this._panKeys.hasOwnProperty(t))this._map.panBy(this._panKeys[t]);else{if(!this._zoomKeys.hasOwnProperty(t))return;this._map.setZoom(this._map.getZoom()+this._zoomKeys[t])}i.DomEvent.stop(e)}}),i.Map.addInitHook("addHandler","keyboard",i.Map.Keyboard),i.Handler.MarkerDrag=i.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new i.Draggable(e,e).on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this)),this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var e=i.DomUtil.getPosition(this._marker._icon);this._marker._shadow&&i.DomUtil.setPosition(this._marker._shadow,e),this._marker._latlng=this._marker._map.layerPointToLatLng(e),this._marker.fire("move").fire("drag")},_onDragEnd:function(){this._marker.fire("moveend").fire("dragend")}}),i.Handler.PolyEdit=i.Handler.extend({options:{icon:new i.DivIcon({iconSize:new i.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(e,t){this._poly=e,i.Util.setOptions(this,t)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new i.LayerGroup),this._markers=[];var e,t,n,s,o=this._poly._latlngs;for(e=0,n=o.length;n>e;e++)s=this._createMarker(o[e],e),s.on("click",this._onMarkerClick,this),this._markers.push(s);var a,r;for(e=0,t=n-1;n>e;t=e++)(0!==e||i.Polygon&&this._poly instanceof i.Polygon)&&(a=this._markers[t],r=this._markers[e],this._createMiddleMarker(a,r),this._updatePrevNext(a,r))},_createMarker:function(e,t){var n=new i.Marker(e,{draggable:!0,icon:this.options.icon});return n._origLatLng=e,n._index=t,n.on("drag",this._onMarkerDrag,this),n.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(n),n},_fireEdit:function(){this._poly.fire("edit")},_onMarkerDrag:function(e){var t=e.target;i.Util.extend(t._origLatLng,t._latlng),t._middleLeft&&t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev,t)),t._middleRight&&t._middleRight.setLatLng(this._getMiddleLatLng(t,t._next)),this._poly.redraw()},_onMarkerClick:function(e){if(!(this._poly._latlngs.length<3)){var t=e.target,i=t._index;t._prev&&t._next&&(this._createMiddleMarker(t._prev,t._next),this._updatePrevNext(t._prev,t._next)),this._markerGroup.removeLayer(t),t._middleLeft&&this._markerGroup.removeLayer(t._middleLeft),t._middleRight&&this._markerGroup.removeLayer(t._middleRight),this._markers.splice(i,1),this._poly.spliceLatLngs(i,1),this._updateIndexes(i,-1),this._poly.fire("edit")}},_updateIndexes:function(e,t){this._markerGroup.eachLayer(function(i){i._index>e&&(i._index+=t)})},_createMiddleMarker:function(e,t){var i,n,s,o=this._getMiddleLatLng(e,t),a=this._createMarker(o);a.setOpacity(.6),e._middleRight=t._middleLeft=a,n=function(){var n=t._index;a._index=n,a.off("click",i).on("click",this._onMarkerClick,this),o.lat=a.getLatLng().lat,o.lng=a.getLatLng().lng,this._poly.spliceLatLngs(n,0,o),this._markers.splice(n,0,a),a.setOpacity(1),this._updateIndexes(n,1),t._index++,this._updatePrevNext(e,a),this._updatePrevNext(a,t)},s=function(){a.off("dragstart",n,this),a.off("dragend",s,this),this._createMiddleMarker(e,a),this._createMiddleMarker(a,t)},i=function(){n.call(this),s.call(this),this._poly.fire("edit")},a.on("click",i,this).on("dragstart",n,this).on("dragend",s,this),this._markerGroup.addLayer(a)},_updatePrevNext:function(e,t){e._next=t,t._prev=e},_getMiddleLatLng:function(e,t){var i=this._poly._map,n=i.latLngToLayerPoint(e.getLatLng()),s=i.latLngToLayerPoint(t.getLatLng());return i.layerPointToLatLng(n._add(s).divideBy(2))}}),i.Control=i.Class.extend({options:{position:"topright"},initialize:function(e){i.Util.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),s=e._controlCorners[n];return i.DomUtil.addClass(t,"leaflet-control"),-1!==n.indexOf("bottom")?s.insertBefore(t,s.firstChild):s.appendChild(t),this},removeFrom:function(e){var t=this.getPosition(),i=e._controlCorners[t];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(e),this}}),i.control=function(e){return new i.Control(e)},i.Map.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.removeFrom(this),this},_initControlPos:function(){function e(e,o){var a=n+e+" "+n+o;t[e+o]=i.DomUtil.create("div",a,s)}var t=this._controlCorners={},n="leaflet-",s=this._controlContainer=i.DomUtil.create("div",n+"control-container",this._container);e("top","left"),e("top","right"),e("bottom","left"),e("bottom","right")}}),i.Control.Zoom=i.Control.extend({options:{position:"topleft"},onAdd:function(e){var t="leaflet-control-zoom",n=i.DomUtil.create("div",t);return this._createButton("Zoom in",t+"-in",n,e.zoomIn,e),this._createButton("Zoom out",t+"-out",n,e.zoomOut,e),n},_createButton:function(e,t,n,s,o){var a=i.DomUtil.create("a",t,n);return a.href="#",a.title=e,i.DomEvent.on(a,"click",i.DomEvent.stopPropagation).on(a,"click",i.DomEvent.preventDefault).on(a,"click",s,o).on(a,"dblclick",i.DomEvent.stopPropagation),a}}),i.Map.mergeOptions({zoomControl:!0}),i.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new i.Control.Zoom,this.addControl(this.zoomControl))}),i.control.zoom=function(e){return new i.Control.Zoom(e)},i.Control.Attribution=i.Control.extend({options:{position:"bottomright",prefix:'Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>'},initialize:function(e){i.Util.setOptions(this,e),this._attributions={}},onAdd:function(e){return this._container=i.DomUtil.create("div","leaflet-control-attribution"),i.DomEvent.disableClickPropagation(this._container),e.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(e){e.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):void 0},removeAttribution:function(e){return e?(this._attributions[e]--,this._update(),this):void 0},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions.hasOwnProperty(t)&&this._attributions[t]&&e.push(t);var i=[];this.options.prefix&&i.push(this.options.prefix),e.length&&i.push(e.join(", ")),this._container.innerHTML=i.join(" &#8212; ")}},_onLayerAdd:function(e){e.layer.getAttribution&&this.addAttribution(e.layer.getAttribution())},_onLayerRemove:function(e){e.layer.getAttribution&&this.removeAttribution(e.layer.getAttribution())}}),i.Map.mergeOptions({attributionControl:!0}),i.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new i.Control.Attribution).addTo(this))}),i.control.attribution=function(e){return new i.Control.Attribution(e)},i.Control.Scale=i.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(e){this._map=e;var t="leaflet-control-scale",n=i.DomUtil.create("div",t),s=this.options;return this._addScales(s,t,n),e.on(s.updateWhenIdle?"moveend":"move",this._update,this),this._update(),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=i.DomUtil.create("div",t+"-line",n)),e.imperial&&(this._iScale=i.DomUtil.create("div",t+"-line",n))},_update:function(){var e=this._map.getBounds(),t=e.getCenter().lat,i=6378137*Math.PI*Math.cos(t*Math.PI/180),n=i*(e.getNorthEast().lng-e.getSouthWest().lng)/180,s=this._map.getSize(),o=this.options,a=0;s.x>0&&(a=n*(o.maxWidth/s.x)),this._updateScales(o,a)},_updateScales:function(e,t){e.metric&&t&&this._updateMetric(t),e.imperial&&t&&this._updateImperial(t)},_updateMetric:function(e){var t=this._getRoundNum(e);this._mScale.style.width=this._getScaleWidth(t/e)+"px",this._mScale.innerHTML=1e3>t?t+" m":t/1e3+" km"},_updateImperial:function(e){var t,i,n,s=3.2808399*e,o=this._iScale;s>5280?(t=s/5280,i=this._getRoundNum(t),o.style.width=this._getScaleWidth(i/t)+"px",o.innerHTML=i+" mi"):(n=this._getRoundNum(s),o.style.width=this._getScaleWidth(n/s)+"px",o.innerHTML=n+" ft")},_getScaleWidth:function(e){return Math.round(this.options.maxWidth*e)-10},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,t*i}}),i.control.scale=function(e){return new i.Control.Scale(e)},i.Control.Layers=i.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(e,t,n){i.Util.setOptions(this,n),this._layers={},this._lastZIndex=0;for(var s in e)e.hasOwnProperty(s)&&this._addLayer(e[s],s);for(s in t)t.hasOwnProperty(s)&&this._addLayer(t[s],s,!0)},onAdd:function(){return this._initLayout(),this._update(),this._container},addBaseLayer:function(e,t){return this._addLayer(e,t),this._update(),this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._update(),this},removeLayer:function(e){var t=i.Util.stamp(e);return delete this._layers[t],this._update(),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=i.DomUtil.create("div",e);i.Browser.touch?i.DomEvent.on(t,"click",i.DomEvent.stopPropagation):i.DomEvent.disableClickPropagation(t);var n=this._form=i.DomUtil.create("form",e+"-list");if(this.options.collapsed){i.DomEvent.on(t,"mouseover",this._expand,this).on(t,"mouseout",this._collapse,this);var s=this._layersLink=i.DomUtil.create("a",e+"-toggle",t);s.href="#",s.title="Layers",i.Browser.touch?i.DomEvent.on(s,"click",i.DomEvent.stopPropagation).on(s,"click",i.DomEvent.preventDefault).on(s,"click",this._expand,this):i.DomEvent.on(s,"focus",this._expand,this),this._map.on("movestart",this._collapse,this)}else this._expand();this._baseLayersList=i.DomUtil.create("div",e+"-base",n),this._separator=i.DomUtil.create("div",e+"-separator",n),this._overlaysList=i.DomUtil.create("div",e+"-overlays",n),t.appendChild(n)},_addLayer:function(e,t,n){var s=i.Util.stamp(e);this._layers[s]={layer:e,name:t,overlay:n},this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var e=!1,t=!1;for(var i in this._layers)if(this._layers.hasOwnProperty(i)){var n=this._layers[i];this._addItem(n),t=t||n.overlay,e=e||!n.overlay}this._separator.style.display=t&&e?"":"none"}},_createRadioElement:function(e,t){var i='<input type="radio" name="'+e+'"';t&&(i+=' checked="checked"'),i+="/>";var n=document.createElement("div");return n.innerHTML=i,n.firstChild},_addItem:function(e){var t,n=document.createElement("label"),s=this._map.hasLayer(e.layer);e.overlay?(t=document.createElement("input"),t.type="checkbox",t.defaultChecked=s):t=this._createRadioElement("leaflet-base-layers",s),t.layerId=i.Util.stamp(e.layer),i.DomEvent.on(t,"click",this._onInputClick,this);var o=document.createTextNode(" "+e.name);n.appendChild(t),n.appendChild(o);var a=e.overlay?this._overlaysList:this._baseLayersList;a.appendChild(n)},_onInputClick:function(){var e,t,i,n=this._form.getElementsByTagName("input"),s=n.length;for(e=0;s>e;e++)t=n[e],i=this._layers[t.layerId],t.checked?this._map.addLayer(i.layer,!i.overlay):this._map.removeLayer(i.layer)},_expand:function(){i.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),i.control.layers=function(e,t,n){return new i.Control.Layers(e,t,n)},i.Transition=i.Class.extend({includes:i.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:i.DomUtil.setPosition},implemented:function(){return i.Transition.NATIVE||i.Transition.TIMER}},options:{easing:"ease",duration:.5},_setProperty:function(e,t){var n=i.Transition.CUSTOM_PROPS_SETTERS;e in n?n[e](this._el,t):this._el.style[e]=t}}),i.Transition=i.Transition.extend({statics:function(){var e=i.DomUtil.TRANSITION,t="webkitTransition"===e||"OTransition"===e?e+"End":"transitionend";return{NATIVE:!!e,TRANSITION:e,PROPERTY:e+"Property",DURATION:e+"Duration",EASING:e+"TimingFunction",END:t,CUSTOM_PROPS_PROPERTIES:{position:i.Browser.any3d?i.DomUtil.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(e,t){this._el=e,i.Util.setOptions(this,t),i.DomEvent.on(e,i.Transition.END,this._onTransitionEnd,this),this._onFakeStep=i.Util.bind(this._onFakeStep,this)},run:function(e){var t,n=[],s=i.Transition.CUSTOM_PROPS_PROPERTIES;for(t in e)e.hasOwnProperty(t)&&(t=s[t]?s[t]:t,t=this._dasherize(t),n.push(t));this._el.style[i.Transition.DURATION]=this.options.duration+"s",this._el.style[i.Transition.EASING]=this.options.easing,this._el.style[i.Transition.PROPERTY]="all";for(t in e)e.hasOwnProperty(t)&&this._setProperty(t,e[t]);i.Util.falseFn(this._el.offsetWidth),this._inProgress=!0,i.Browser.mobileWebkit&&(this.backupEventFire=setTimeout(i.Util.bind(this._onBackupFireEnd,this),1.2*this.options.duration*1e3)),i.Transition.NATIVE?(clearInterval(this._timer),this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval)):this._onTransitionEnd()},_dasherize:function(){function e(e){return"-"+e.toLowerCase()}var t=/([A-Z])/g;return function(i){return i.replace(t,e)}}(),_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(e){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[i.Transition.TRANSITION]="",clearTimeout(this.backupEventFire),delete this.backupEventFire,this.fire("step"),e&&e.type&&this.fire("end"))},_onBackupFireEnd:function(){var e=document.createEvent("Event");e.initEvent(i.Transition.END,!0,!1),this._el.dispatchEvent(e)}}),i.Transition=i.Transition.NATIVE?i.Transition:i.Transition.extend({statics:{getTime:Date.now||function(){return+new Date},TIMER:!0,EASINGS:{linear:function(e){return e},"ease-out":function(e){return e*(2-e)
}},CUSTOM_PROPS_GETTERS:{position:i.DomUtil.getPosition},UNIT_RE:/^[\d\.]+(\D*)$/},options:{fps:50},initialize:function(e,t){this._el=e,i.Util.extend(this.options,t),this._easing=i.Transition.EASINGS[this.options.easing]||i.Transition.EASINGS["ease-out"],this._step=i.Util.bind(this._step,this),this._interval=Math.round(1e3/this.options.fps)},run:function(e){this._props={};var t=i.Transition.CUSTOM_PROPS_GETTERS,n=i.Transition.UNIT_RE;this.fire("start");for(var s in e)if(e.hasOwnProperty(s)){var o={};if(s in t)o.from=t[s](this._el);else{var a=this._el.style[s].match(n);o.from=parseFloat(a[0]),o.unit=a[1]}o.to=e[s],this._props[s]=o}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=i.Transition.getTime()},_step:function(){var e=i.Transition.getTime(),t=e-this._startTime,n=1e3*this.options.duration;n>t?this._runFrame(this._easing(t/n)):(this._runFrame(1),this._complete())},_runFrame:function(e){var t,n,s,o=i.Transition.CUSTOM_PROPS_SETTERS;for(t in this._props)this._props.hasOwnProperty(t)&&(n=this._props[t],t in o?(s=n.to.subtract(n.from).multiplyBy(e).add(n.from),o[t](this._el,s)):this._el.style[t]=(n.to-n.from)*e+n.from+n.unit);this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")}}),i.Map.include(i.Transition&&i.Transition.implemented()?{setView:function(e,t,i){t=this._limitZoom(t);var n=this._zoom!==t;if(this._loaded&&!i&&this._layers){var s=n?this._zoomToIfClose&&this._zoomToIfClose(e,t):this._panByIfClose(e);if(s)return clearTimeout(this._sizeTimer),this}return this._resetView(e,t),this},panBy:function(e,t){return e=i.point(e),e.x||e.y?(this._panTransition||(this._panTransition=new i.Transition(this._mapPane),this._panTransition.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.Util.setOptions(this._panTransition,i.Util.extend({duration:.25},t)),this.fire("movestart"),i.DomUtil.addClass(this._mapPane,"leaflet-pan-anim"),this._panTransition.run({position:i.DomUtil.getPosition(this._mapPane).subtract(e)}),this):this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){i.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_panByIfClose:function(e){var t=this._getCenterOffset(e)._floor();return this._offsetIsWithinView(t)?(this.panBy(t),!0):!1},_offsetIsWithinView:function(e,t){var i=t||1,n=this.getSize();return Math.abs(e.x)<=n.x*i&&Math.abs(e.y)<=n.y*i}}:{}),i.Map.mergeOptions({zoomAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23&&!i.Browser.mobileOpera}),i.DomUtil.TRANSITION&&i.Map.addInitHook(function(){i.DomEvent.on(this._mapPane,i.Transition.END,this._catchTransitionEnd,this)}),i.Map.include(i.DomUtil.TRANSITION?{_zoomToIfClose:function(e,t){if(this._animatingZoom)return!0;if(!this.options.zoomAnimation)return!1;var n=this.getZoomScale(t),s=this._getCenterOffset(e).divideBy(1-1/n);if(!this._offsetIsWithinView(s,1))return!1;i.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this.fire("movestart").fire("zoomstart"),this.fire("zoomanim",{center:e,zoom:t});var o=this._getCenterLayerPoint().add(s);return this._prepareTileBg(),this._runAnimation(e,t,n,o),!0},_catchTransitionEnd:function(){this._animatingZoom&&this._onZoomTransitionEnd()},_runAnimation:function(t,n,s,o,a){this._animateToCenter=t,this._animateToZoom=n,this._animatingZoom=!0;var r=i.DomUtil.TRANSFORM,l=this._tileBg;clearTimeout(this._clearTileBgTimer),(i.Browser.gecko||e.opera)&&(l.style[r]+=" translate(0,0)"),i.Util.falseFn(l.offsetWidth);var h=i.DomUtil.getScaleString(s,o),d=l.style[r];l.style[r]=a?d+" "+h:h+" "+d},_prepareTileBg:function(){var e=this._tilePane,t=this._tileBg;if(t&&this._getLoadedTilesPercentage(t)>.5&&this._getLoadedTilesPercentage(e)<.5)return e.style.visibility="hidden",e.empty=!0,void this._stopLoadingImages(e);t||(t=this._tileBg=this._createPane("leaflet-tile-pane",this._mapPane),t.style.zIndex=1),t.style[i.DomUtil.TRANSFORM]="",t.style.visibility="hidden",t.empty=!0,e.empty=!1,this._tilePane=this._panes.tilePane=t;var n=this._tileBg=e;i.DomUtil.addClass(n,"leaflet-zoom-animated"),this._stopLoadingImages(n)},_getLoadedTilesPercentage:function(e){var t,i,n=e.getElementsByTagName("img"),s=0;for(t=0,i=n.length;i>t;t++)n[t].complete&&s++;return s/i},_stopLoadingImages:function(e){var t,n,s,o=Array.prototype.slice.call(e.getElementsByTagName("img"));for(t=0,n=o.length;n>t;t++)s=o[t],s.complete||(s.onload=i.Util.falseFn,s.onerror=i.Util.falseFn,s.src=i.Util.emptyImageUrl,s.parentNode.removeChild(s))},_onZoomTransitionEnd:function(){this._restoreTileFront(),i.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),i.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1},_restoreTileFront:function(){this._tilePane.innerHTML="",this._tilePane.style.visibility="",this._tilePane.style.zIndex=2,this._tileBg.style.zIndex=1},_clearTileBg:function(){this._animatingZoom||this.touchZoom._zooming||(this._tileBg.innerHTML="")}}:{}),i.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(e){if(e=this._locationOptions=i.Util.extend(this._defaultLocateOptions,e),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=i.Util.bind(this._handleGeolocationResponse,this),n=i.Util.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,n,e):navigator.geolocation.getCurrentPosition(t,n,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this},_handleGeolocationError:function(e){var t=e.code,i=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locationOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(e){var t=180*e.coords.accuracy/4e7,n=2*t,s=e.coords.latitude,o=e.coords.longitude,a=new i.LatLng(s,o),r=new i.LatLng(s-t,o-n),l=new i.LatLng(s+t,o+n),h=new i.LatLngBounds(r,l),d=this._locationOptions;if(d.setView){var c=Math.min(this.getBoundsZoom(h),d.maxZoom);this.setView(a,c)}this.fire("locationfound",{latlng:a,bounds:h,accuracy:e.coords.accuracy})}})}(this),define("leaflet",function(){}),define("modules/map/map",["jquery","underscore","state","baseview","leaflet"],function(e,t,i,n){"use strict";var s=n.extend({initialize:function(i){i=e.extend(!0,{latitude:0,longitude:0,currentLocationMarker:!0,addMapLabel:!1,mapLabelClass:null,defaultZoom:null,mapUrl:null,mapOptions:{trackResize:!1,scrollWheelZoom:!1,zoomControl:!1,attributionControl:!1}},i),n.prototype.initialize.call(this,i),t.bindAll(this,"_onGetMapTilesSuccess"),this.createMap(i.latitude,i.longitude)},createMap:function(e,t){var i,n=this.$el.data()||{},s=n.attrMapurl||this.options.mapUrl,o=parseFloat(n.latitude)||e,a=parseFloat(n.longitude)||t;s&&(i=parseInt(n.attrZoom,10)||this.options.defaultZoom,"L"===n.attrSize&&(this.options.mapOptions.zoomControl=!0),this.map=this.buildMap(),this.setLocation(o,a,i),this.getMapTiles(s))},buildMap:function(){return this.$mapEl=e('<div class="standard-app-map"></div>'),this.$el.html(this.$mapEl),this.options.addMapLabel&&(this.$mapLabel=this.buildMapLabel(),this.$el.append(this.$mapLabel)),new L.Map(this.$mapEl[0],this.options.mapOptions)},buildMapLabel:function(){var t=e('<span class="standard-app-map-location-label">');return this.options.mapLabelClass&&t.addClass(this.options.mapLabelClass),t},setCurrentLocationMarker:function(e,t){if(this.options.currentLocationMarker){var i=new L.LatLng(e,t);if(this.currentLocationMarker)this.currentLocationMarker.setLatLng(i);else{var n=window.site_static_url,s=L.Icon.extend({options:{iconUrl:n+"/images/modules/maps/marker.png",shadowUrl:n+"/images/modules/maps/marker-shadow.png",iconSize:[25,41],shadowSize:[41,41],iconAnchor:[11,41],shadowAnchor:[11,41]}}),o=new s;this.currentLocationMarker=new L.Marker(i,{icon:o,zIndexOffset:1e3}),this.map.addLayer(this.currentLocationMarker)}}},removeCurrentLocationMarker:function(){this.currentLocationMarker&&(this.map.removeLayer(this.currentLocationMarker),this.currentLocationMarker=null)},setLocation:function(e,t,i){var n=new L.LatLng(e,t);i=i||this.map.getZoom(),this.map.setView(n,i,!0),this.setCurrentLocationMarker(e,t)},getMapTiles:function(e){i.fetchData(e,{dataType:"jsonp"}).done(this._onGetMapTilesSuccess)},_onGetMapTilesSuccess:function(e){var t=L.TileLayer.extend({initialize:function(e){e=e||{},e.minZoom=e.minzoom||0,e.maxZoom=e.maxzoom||22,L.TileLayer.prototype.initialize.call(this,e.tiles[0],e)}});this.tiles=new t(e),this.map.addLayer(this.tiles)},setMapLabel:function(e){this.$mapLabel&&this.$mapLabel.text(e)},destroy:function(e){this.tiles&&(this.map.removeLayer(this.tiles),this.tiles=null),this.$mapLabel&&this.$mapLabel.remove(),this.$mapEl&&this.$mapEl.remove(),this.map=null,n.prototype.destroy.call(this,e)}});return s}),define("modules/interactives/line-chart",["jquery","underscore","baseview","utils","modules/interactives/interactive-base"],function(e,t,i,n,s){"use strict";var o=s.extend({getFlotData:function(e){return void 0===e?null:(t.isArray(e)||(e=[e]),t.map(e,function(e,i,n){var s=this.mainColor;return n.length>1&&(s=this.chartColors[i%this.chartColors.length]),{label:e.label||"",color:s,data:t.map(e.value,function(e,t){return[t,e]}),points:{fillColor:s}}},this))},_getMinValue:function(e){var i=Number.MAX_VALUE,n=Number.MIN_VALUE;if(t.each(e,function(e){t.each(e.data,function(e){e=parseFloat(e[1]),i>e&&(i=e),e>n&&(n=e)})}),i===Number.MAX_VALUE)i=n=0;else{i>0&&(i=0);var s=.1*(n-i);n+=s,0>i&&(i-=s)}return[i,n]},getFlotOptions:function(){var e=n.getNested(this.flotData,0,"data","length")||0,t=this._getMinValue(this.flotData),i=s.prototype.getFlotOptions.apply(this,arguments);return i.legend={show:!1,noColumns:1},i.xaxis={ticks:this._createTicks(this.chartData.xaxisvalues||""),autoscaleMargin:.03,position:"bottom",borderColor:"rgb(237,236,236)"},i.yaxis={position:"left",labelHeight:25,borderColor:"rgb(237,236,236)",min:t[0],max:t[1],tickFormatter:this.numberWithCommas},i.series={lines:{show:!0}},i.grid={borderWidth:1,borderColor:"rgb(237,236,236)",labelMargin:5,axisMargin:0,clickable:!0,hoverable:!0,autoHighlight:!0},i.colors=this.colors,13>e?i.series.points={show:!0,radius:5,fill:!0}:e>13&&(i.series.points={show:!1}),i},_getHoverBody:function(e){return[this.getHoverPrefix(),n.addCommas(n.getNested(e,"datapoint","1"))||"",this.getHoverSuffix()].join(" ")}});return o}),define("modules/stories/cxense-top-stories",["jquery","underscore","utils","modules/cxense-recommends/cxense-base","managers/abtestmanager"],function(e,t,i,n,s){var o=n.extend({initialize:function(o){if(o=e.extend({cxenseMinRecs:2,getRecsOnInit:!1},o),n.prototype.initialize.call(this,o),!this.$el.hasClass("js-cx-recs-rendered")){var a=s.getUserActiveTestOptions(this.userActiveTest),r=i.getNested(a,"cxenseWidgets",0,"id");r&&"article-right-rail"==i.getNested(this.userActiveTest,"testTarget")?(this.options.cxenseMaxRecs=a.maxNumItems||5,a.displayName&&this.$(".story-ribbon-title").html(a.displayName),a.cssClasses&&this.$el.addClass(a.cssClasses),this.renderRecs(r).then(this.show,t.bind(function(){this.destroy(!0)},this))):this.destroy(!0)}},afterRenderRecs:function(e){var i={},n=t.countBy(e,"recType");t.isEmpty(e)||(i.num_recs=e.length),t.each(n,function(e,t){i["type_"+t]=e}),this.$el.addClass("js-cx-recs-rendered"),this.logTestImpression(i)},additionalFormatItemForTemplate:function(e,t){var n=i.getNested(e,"dominantthumbnail"),s=i.getNested(e,"recs-image")||n,o=84,a=84,r=null,l=!1;if(n||s){var h=i.getNested(e,"dominantthumbnaildimensions");1===t.position&&n?r=n:s&&(r=s),h&&(h=h.split("x"),o=parseInt(h[0]),a=parseInt(h[1]))}return{imgSrc:r,imgW:o,imgH:a,imgFromCxense:r===n,shiftThumb:l}}});return o}),define("modules/interactives/timeline",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","libs/jqueryui/draggable","modules/global/brightcove-video","touchswipe"],function(e,t,i,n,s,o){var a=s.extend({events:{"click .interactive-timeline-marker":"goToMarker","click .slide-nav.prev, .slide-nav.next":"renderArrowClick"},initialize:function(e){s.prototype.initialize.call(this,e),t.bindAll(this,"snapToMarker"),this.subviews.template=new o({el:this.$el,interactiveType:"timeline",isFramed:e.isFramed,standAlone:e.standAlone}),this.$leftArrow=this.subviews.template.$leftArrow,this.$rightArrow=this.subviews.template.$rightArrow,this.$slideContainer=this.subviews.template.$slideContainer,this.$slides=this.subviews.template.$slides,this.$viewport=this.subviews.template.$viewport,this.$timeslider=this.$(".interactive-timeline-timeslider"),this.$timesliderBelt=this.$timeslider.find(".interactive-timeline-belt"),this.$timesliderBuckle=this.$timeslider.find(".interactive-timeline-buckle"),this.$timesliderLabelContainer=this.$timeslider.find(".interactive-timeline-labels"),this.$timesliderLabels=this.$timesliderLabelContainer.find(".interactive-timeline-label"),this.$contentBox=this.$slideContainer.find(".timeline-slide-content"),this.$gridLines=this.$viewport.find(".grid-line"),this.arrEventPositions=[],this.maxSlides=this.subviews.template.maxSlides,this.arrayPanelMax=850,this.numPanelMinLefts=6,this.numMarkerWidth=9,this.strDateBegin="",this.strDateEnd="",this.currentSlideIndex=this.subviews.template.currentSlideIndex;var i={containment:".buckle-box",cursor:"move",axis:"x",stop:this.snapToMarker};if(Modernizr.touch){i.delay=200,this.$(".stage").swipe({self:this,swipe:function(e,t,i,n,s,o){"right"===t||"down"===t?o.self.previousSlide():o.self.nextSlide()}});var n=this;require(["touchpunch"],function(){n.destroyed||n.setup(i)})}else this.setup(i)},destroy:function(){this.$timesliderBuckle.draggable("destroy"),s.prototype.destroy.apply(this,arguments)},setup:function(t){var i="",n=this.$viewport.data()||{},s=this;this.strDateBegin=n.graphstart,this.strDateEnd=n.graphend,this.$slides.each(function(t){var n=e(this).find(".timeline-slide-content").data().tlpercent,o=parseInt(s.arrayPanelMax,10),a=Math.round(n*o+27);s.arrEventPositions[t]=a,i+='<div class="interactive-timeline-marker" style="left:'+a+'px;"></div>'}),this.$timesliderBelt.append(i),this.maxEvents=this.arrEventPositions.length,this.setUpLabels(),this.goTo(0),this.$timesliderBuckle.draggable(t)},setUpLabels:function(){var t=this.strDateBegin,i=this.strDateEnd,n=i-t,s=this,o=s.arrayPanelMax;this.$timesliderLabels.each(function(){var i=e(this).data().labelms,s=Math.round((i-t)/n*o);e(this).css("left",s)}),this.$gridLines.each(function(t){var i=s.$timesliderLabels.eq(t).position().left+33+"px";e(this).css("left",i)}),this.$timesliderLabels.find(".interactive-timeline-time").fadeIn("slow")},goToMarker:function(e){var t=this.$timesliderBelt.children(".interactive-timeline-marker").index(e.currentTarget);this.goTo(t),this.options.isFramed!==!0&&this.subviews.template.trackPageView()},renderArrowClick:function(t){e(t.currentTarget).is(this.$leftArrow)?this.previousSlide():this.nextSlide(),this.options.isFramed!==!0&&this.subviews.template.trackPageView()},goTo:function(e){var t;this.currentSlideIndex=e;var i=parseInt(this.$contentBox.eq(e).width(),10),n=this.arrayPanelMax-i;this.$timesliderBuckle.css("left",(this.arrEventPositions[e]-19).toString()+"px"),t=Math.round(this.arrEventPositions[e]+this.numMarkerWidth/2-i/2),t>n?t=n:t<this.numPanelMinLefts&&(t=this.numPanelMinLefts),this.$slides.eq(e).find(".indicator").css("left",this.arrEventPositions[e]-8-t.toString()+"px"),this.$slides.removeClass("active").eq(e).css("left",t.toString()+"px").addClass("active"),this.$contentBox.find(".text a").attr("target","_blank"),this.subviews.template.goTo(e),this.currentSlideIndex=e},previousSlide:function(){this.goTo(Math.max(this.currentSlideIndex-1,0))},nextSlide:function(){this.goTo(Math.min(this.currentSlideIndex+1,this.maxSlides-1))},snapToMarker:function(t){var i,n,s=850,o=e(t.target),a=parseInt(o.css("left"),10);for(n=0;n<this.arrEventPositions.length;n++)Math.abs(a+19-this.arrEventPositions[n])<s&&(i=n,s=Math.abs(a+19-this.arrEventPositions[n]));this.options.isFramed!==!0&&this.subviews.template.trackPageView(),this.goTo(i)}});return a}),define("modules/rentalslite-ads",["jquery","baseview","state","directAdPosition","managers/routemanager"],function(e,t,i,n){var s=t.extend({layoutType:"",adRendered:!1,renderAd:function(){var e=this.$(".js-rlad-google-ad")[0];!this.adRendered&&e&&(this.adRendered=!0,this.subviews.adPositionOne=this.createAdPosition(e))},destroyAd:function(){this.adRendered&&(this.subviews.adPositionOne.destroy(),this.adRendered=!1)},isSidebarModule:function(){return"sidebar"===this.layoutType},isPrimaryWellModule:function(){return"primary"===this.layoutType},createAdPosition:function(t){return new n({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag")})},initialize:function(e){t.prototype.initialize.call(this),this.layoutType=e.layoutType},handleCardSizeChange:function(e){this.isSidebarModule()?e.sidebarAds===!0?(this.$(".js-rlad-sidebar-ad").removeClass("rlad-hide-ad"),this.renderAd()):(this.$(".js-rlad-sidebar-ad").addClass("rlad-hide-ad"),this.destroyAd()):this.isPrimaryWellModule()&&(e.sidebarOpen===!0?this.destroyAd():this.renderAd()),e.sidebarOpen===!0?(this.$(".js-rlad-wrap").addClass("rlad-wrap-margin").removeClass("rlad-dynamic-margin"),this.$(".js-rlad-google-ad").removeClass("rlad-dynamic-margin"),this.isPrimaryWellModule()&&(this.$(".js-rlad-wrap").addClass("rlad-dynamic-height"),this.$(".js-rlad-local").addClass("rlad-sidebar-local"))):(this.$(".js-rlad-wrap").removeClass("rlad-wrap-margin"),this.isPrimaryWellModule()&&(this.$(".js-rlad-wrap").removeClass("rlad-dynamic-height"),this.$(".js-rlad-local").addClass("rlad-primary-local").removeClass("rlad-sidebar-local")),this.$(".js-rlad-wrap").addClass("rlad-dynamic-margin"),this.$(".js-rlad-google-ad").addClass("rlad-dynamic-margin"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)}});return s}),define("modules/stories/utility-bar-module-print",["jquery","underscore","backbone","pubsub","baseview"],function(e,t,i,n,s){var o=s.extend({open:function(){n.trigger("uotrack","UtilityBarPrint"),window.print(),this.destroy()},close:function(){this.destroy()},destroy:function(e){s.prototype.destroy.call(this,e),this.options.onDestroy&&this.options.onDestroy(this)}});return o}),define("modules/cxense-recommends/cxense-section-highlights",["jquery","underscore","state","utils","pubsub","managers/abtestmanager","modules/cxense-recommends/cxense-base"],function(e,t,i,n,s,o,a){var r=a.extend({initialize:function(t){t=e.extend({recsTimeout:1e4,sectionSelector:".shpm-section",cxenseMinRecs:2,cxenseMaxRecs:5,appendTrackingParams:!1},t),this.mmPrimaryImgBase="http://www.gannett-cdn.com/-mm-/472b5bfb1477a51f0eb96a3e26b2dce432610914/c=0-9-4440-2513&r=x189&c=330x186/local/-/",this.mmSecondaryImgBase="http://www.gannett-cdn.com/-mm-/783bd39503829b6d0587ace1f2b521ebfcce9930/c=726-0-4519-3793&r=x71&c=90x68/local/-/",this.mmRx=new RegExp(".*local\\/-\\/"),a.prototype.initialize.call(this,t)},renderHighlights:function(t){return e.when.apply(e,e.map(t,this.renderRecs))},renderRecs:function(e){return this.getProcessedRecs(e.id).then(t.bind(function(i){var n,s=this.$(".js-section-"+e.secHiSection),o=s.find(".js-link");t.each(i,function(t,i){n=o.eq(i),i<o.length&&(0===i?n.find(".js-primary-image").attr({src:t.primaryImgSrc,alt:t.headline}).removeAttr("data-src"):1===i&&(n.find(".js-secondary-image").attr({src:t.secondaryImgSrc,alt:t.headline}).removeAttr("data-src"),n.find(".js-meta").html(t.time+" | "+t.sectionDisplay).css("textTransform","capitalize")),n.find(".js-headline").html(t.headline)),t.trackingPrefix+="-"+e.secHiSection,this.renderTestLink(n,i,null,t)},this),this.$el.addClass("js-cx-url-params-added"),s.addClass("js-cx-section"),o.not(".js-cx-item-link").remove()},this))},additionalFormatItemForTemplate:function(e){return this.getImages(e)},getImages:function(e){var t=null,i=null,s=n.getNested(e,"dominantimage")||"",o=n.getNested(e,"dominantthumbnail")||null;return-1!==s.indexOf("-mm-")?(s=s.replace(this.mmRx,""),t=this.mmPrimaryImgBase+s,i=this.mmSecondaryImgBase+s):o&&(t=i=o),{primaryImgSrc:t,secondaryImgSrc:i}}});return r}),define("modules/section-highlights/section-highlights",["jquery","underscore","backbone","utils","baseview","managers/abtestmanager","modules/cxense-recommends/cxense-section-highlights"],function(e,t,i,n,s,o,a){"use strict";var r=s.extend({initialize:function(e){t.bindAll(this,"reveal"),s.prototype.initialize.call(this,e),this.render()},render:function(){var i=e.Deferred().resolve();if(!this.subviews.cxense){var n=o.getUserActiveTest(),s=this._getTestSections(n);if(s.length){if(this.subviews.cxense=new a({el:this.$el,getRecsOnInit:!1}),!this.$el.hasClass("js-cx-url-params-added")){var r=this._getCxenseWidgets(n);r.length?i=this.subviews.cxense.renderHighlights(r).then(t.bind(function(){this.subviews.cxense.logTestImpression()},this)):(this._renderControlLinks(s,n),this.subviews.cxense.logTestImpression())}}else this.$el.removeClass("js-cx-url-params-added"),this._refreshSports()}i.always(this.reveal)},_refreshSports:function(){t.each(this.$(".shpm-score-box"),function(t){if("True"==e(t).data("live")){var i="/services/live_sports_scores/"+e(t).data("league")+"/"+e(t).data("team")+"/"+Math.floor(Date.now()/6e4);e.get(i,function(i){e(t).replaceWith(i)})}})},reveal:function(){t.each(this.$("img"),function(t){n.lazyLoadImage(e(t),"data-src",!1)},this),this.$(".placeholder").removeClass("placeholder")},_getTestSections:function(e){return n.getNested(e,"defaultOptions","secHiSections")||[]},_getCxenseWidgets:function(e){return n.getNested(e,"activeVariant","options","cxenseWidgets")||[]},_renderControlLinks:function(e,i){this.subviews.cxense&&e&&(t.each(e,function(e){var s=n.getNested(i,"trackingPrefix")+"-"+e;t.each(this.$(".js-section-"+e+" .js-link"),function(e,t){this.subviews.cxense.renderTestLink(e,t,s)},this)},this),this.$el.addClass("js-cx-url-params-added"))}});return r}),define("modules/fronts/blogs",["jquery","underscore","backbone","baseview","pubsub"],function(e,t,i,n){var s=n.extend({events:{"click .scroller":"scroll"},initialize:function(t){this.$moveMe=this.$(".stage ul"),this.totalItems=e("li",this.$moveMe).length,this.$scrollerLeft=this.$(".scroller.left"),this.$scrollerRight=this.$(".scroller.right"),n.prototype.initialize.call(this,t)},scroll:function(t){t&&t.preventDefault();var i=e(t.target);if(i.hasClass("disabled"))return!1;var n=i.hasClass("right"),s=this.$moveMe.data("item-offset"),o=4;Modernizr.mq("screen and (min-width: 1250px)")?o=6:Modernizr.mq("screen and (min-width: 1150px)")&&(o=5),n&&(o=-1*o);var a=o+s;a>0&&(a=0);var r=183*s-1,l=183*o,h=l+r;h=183*a-1,0===a?this.$scrollerLeft.addClass("disabled"):this.$scrollerLeft.removeClass("disabled");var d=Math.abs(a)+Math.abs(o);d>=this.totalItems?(this.$scrollerRight.addClass("disabled"),o+=d-this.totalItems,a=o+s,l=183*o,h=l+r,h=183*a-1):this.$scrollerRight.removeClass("disabled"),this.$moveMe.data("item-offset",a),this.animate(this.$moveMe,"left",h+"px",200,"ease-in")}});return s}),define("modules/live-vpc-suspender/live-vpc-suspender",["jquery","underscore","baseview","state","utils","modules/global/livevideo"],function(e,t,i,n,s,o){var a=i.extend({el:".live-vpc-suspender",events:{"click .live-vpc-item a":"onVpcSuspenderClick"},initialize:function(e){i.prototype.initialize.call(this,e)},onVpcSuspenderClick:function(t){var i=e(t.currentTarget).attr("href");if(i.indexOf("livevideoassetid")>0){var n=new o;return n.loadLiveVideo(i.split("#")[1].split("=")[1]),!1}}});return a}),define("modules/fronts/super-hero",["jquery","underscore","baseview","state","managers/routemanager"],function(e,t,i,n,s){var o=i.extend({el:".super-hero-module-wrapper",events:{"click .super-hero":"open"},open:function(t){if("a"!=e(t.target).prop("tagName").toLowerCase()){var i=e(t.currentTarget);s.goTo(i.find(".hero-story > h1 > a").attr("href"))}}});return o}),define("buildfiles/common",function(){}),define("framework-config",[],function(){return window.use_minified_css&&require.config({baseUrl:window.site_static_url+"jsb"}),{paths:{jquery:"libs/jquery/jquery.require",jquery_modern:"libs/jquery/jquery-2.1.4",jquery_legacy:"libs/jquery/jquery-1.11.3",underscore:"libs/underscore/underscore",backbone:"libs/backbone/backbone-dev",utils:"global/utils",baseview:"global/base-view","base-app":"apps/base-app",pubsub:"global/pubsub","site-manager":"managers/sitemanager",state:"managers/statemanager","user-manager":"managers/usermanager",cookie:"libs/jquery/plugins/jquery.cookie",easing:"libs/jquery/plugins/jquery.easing.1.3",animatecolors:"libs/jquery/plugins/jquery.animate-colors-min",mousewheel:"libs/jquery/plugins/jquery.mousewheel",uiPageTurn:"libs/jquery/plugins/jquery.ui-page-turn",uiFlip:"libs/jquery/plugins/jquery.ui-flip",transformSupport:"libs/jquery/plugins/jquery.transformSupport",touchpunch:"libs/jquery/plugins/jquery-ui.touch-punch.min",admanager:"managers/admanager",sharedAdPosition:"partner/shared-ad-position",meteredAdPosition:"partner/metered-ad-position",directAdPosition:"partner/direct-ad-position",leaflet:"libs/leaflet/leaflet-0.4.4",base64:"libs/base64/base64",mergedSiteConfig:"/services/config/site-config",adLogger:"partner/ad-logger","file-upload":"libs/jquery/plugins/file-upload/jquery.fileupload"},shim:{jquery_modern:["console.setup"],jquery_legacy:["console.setup"],easing:["jquery"],animatecolors:["jquery"],mousewheel:["jquery"],touchpunch:["libs/jqueryui/mouse"],backbone:["underscore","jquery"],"file-upload":["libs/jquery/plugins/file-upload/jquery.iframe-transport"]}}}),require(["framework-config"],function(e){require.config(e),require(["site-manager","state","modules/global/header","third-party-apis/facebook/facebook","third-party-apis/google/google","user-accounts/facebook-user-account","user-accounts/googleplus-user-account","analytics/settealium"],function(e,t,i){e.start(!window.chromeless&&i,t)})}),define("main",function(){});
//# sourceMappingURL=main.min.js
//# sourceMappingURL=main.min.js.map