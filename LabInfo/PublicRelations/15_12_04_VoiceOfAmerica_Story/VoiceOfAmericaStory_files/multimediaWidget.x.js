Type.registerNamespace("RFERL.js.custom");RFERL.js.custom.MultimediaWidget=function(n){RFERL.js.custom.MultimediaWidget.initializeBase(this);this._LTRorRTL=n.LTRorRTL;this.scrollTimer;this.scrollStep;this.photogalH=n.photogalH;this.photogalW=n.photogalW;this.soundslideW=n.soundslideW;this.soundslideH=n.soundslideH;this.soundslideSize2W=n.soundslideSize2W;this.soundslideSize2H=n.soundslideSize2H;this.oneColW=n.oneColW;this.oneColH=n.oneColH;this.ContentType=n.ContentType;this.flashXmlUrlTemplate=n.flashXmlUrlTemplate;this.emailToFriendTemplate=n.emailToFriendTemplate;this.OSSModal;this.SSPopupHtml};RFERL.js.custom.MultimediaWidget.prototype={loadItem:function(n,t,i,r){var c=$(n),u=$(n).parents(".multimedia_widget"),h=null,l=$(".mmw_video",u),a,v,e,o,s,f;$(".mmw_content_container > *",u).addClass("item_hide");$(".mmw_description",u).addClass("item_hide").filter(":eq("+c.index()+")").removeClass("item_hide");l.length>0&&(h=$find($("[id*=upFirstOrDefaultVideoPlayer]",u).attr("id")),h.stop());switch(i){case this.ContentType.Video.value:l.removeClass("item_hide");r.contentId=t;r.flashXmlUrl=this.flashXmlUrlTemplate.replace("%id%",t);r.shareUrl=this.emailToFriendTemplate.replace("%id%",t);r.platform=4;r.playMode="user";r.poster=$("img",n).css("background-image").replace(/^url\("?([^\)"]+)"?\)$/gi,"$1").replace(/\??&?(w|h)=[0-9]*/gi,"");r.intro=$(".mmw_description:visible .mmw_intro",u).html();h.setAndPlay(r);break;case this.ContentType.Photogallery.value:$(".mmw_htmlPhotogallery",u).removeClass("item_hide");t>0&&(a=this,v=u.hasClass("mmw_one_column")?this.oneColW:this.photogalW,www.rferl.org.Services.MediaWidgetService.GetMediaDescription(t,u.hasClass("mmw_one_column")?this.oneColW:this.photogalW,u.hasClass("mmw_one_column")?this.oneColH:this.photogalH,function(n){var t=eval("("+n+")");t.PhotogalleryJs&&($(".htmlPhgFullScreen").remove(),$(".mmw_htmlPhotogallery",u).show().empty().append(t.PhotogalleryJs))},function(){}));break;case this.ContentType.SoundSlide.value:e=$(".mmw_ssph",u);e.removeClass("item_hide");r!==""&&e.data("flashurl",r);f=$("img.mmw_ssph_i",e);f.attr("src",$("img",n).css("background-image").replace(/^url\("?([^\)"]+)"?\)$/gi,"$1").replace(/w=[0-9]*/gi,"w="+f.width()).replace(/h=[0-9]*/gi,"h="+f.height()).replace(/w[0-9]*/gi,"w_"+f.width()).replace("_r1","h="+f.height()));break;case this.ContentType.Placeholder.value:o=$(".mmw_youtube_placeholder",u);o.removeClass("item_hide");s=$(".mmw_youtube_placeholder iframe",u);r.indexOf("youtube.com/embed")!==-1&&s.attr("src")!==r?s.attr("src",r):s.length==0&&o.attr("href",r);f=$("img.mmw_youtube_placeholder_i",o);f.attr("src",$("img",n).css("background-image").replace(/^url\("?([^\)"]+)"?\)$/gi,"$1").replace(/w=[0-9]*/gi,"w="+f.width()).replace(/w[0-9]*/gi,"w"+f.width()))}$(".mmw_th_selected",u).removeClass("mmw_th_selected");c.addClass("mmw_th_selected")},scroll:function(n,t){var f=this,e=this.selectOwidgetOnly(n),i=$(".mmw_thumbnails",e),r=i.width(),u=$(".mmw_thumbnails_container",e).width();this.setScrollStep(5);r>u&&(this.scrollTimer=window.setInterval(function(){t=="back"?f.scrollB(i,r,u):f.scrollF(i,r,u)},10))},scrollF:function(n,t,i){this.doScroll(n,Math.max(parseInt(n.css(this._LTRorRTL=="rtl"?"margin-right":"margin-left"))-this.scrollStep,-t+i))},scrollB:function(n){this.doScroll(n,Math.min(parseInt(n.css(this._LTRorRTL=="rtl"?"margin-right":"margin-left"))+this.scrollStep,0))},doScroll:function(n,t){n.css(this._LTRorRTL=="rtl"?"margin-right":"margin-left",t+"px")},stopScroll:function(){window.clearInterval(this.scrollTimer)},selectOwidget:function(n){return n?$(n).parents(".multimedia_widget"):$(String.format("#mmw_{0}",WidgetInstanceId))},selectOwidgetOnly:function(n){return $(n).parents(".multimedia_widget")},showSoundSlide:function(n,t){var f=this.selectOwidget(n),r="SFlash_soundslide_modal",e={id:r,name:"SoundSlide"},i=null,u;i=t==null?$(n).data("flashurl")?$(n).data("flashurl"):$(".mmw_thumbnails > :eq(0)",f).attr("onclick").match("'(.*)'")[1]:t;u=i.match("size=1");i&&(this.OSSModal||(this.OSSModal=$(".mmw_soundslide_fulscreen",f),$(document.body).append(this.OSSModal),$(".mmw_soundslide_fl",this.OSSModal).attr("id",r),this.SSPopupHtml=$(".mmw_soundslide_popup",this.OSSModal).html()),this.OSSModal.show(),isIE6&&($(".mmw_soundslide_popup_cont",this.OSSModal).css("top",$(window).scrollTop()+25+"px"),$(".mmw_soundslide_bg",this.OSSModal).css("height",$(document).height()+"px")),swfobject.embedSWF(i,r,u?this.soundslideW:this.soundslideSize2W,u?this.soundslideH:this.soundslideSize2H,"10.0.0","/flash/expressInstall.swf",null,{bgcolor:"#000000"},e))},hideSoundSlide:function(){this.OSSModal.hide();$(".mmw_soundslide_popup",this.OSSModal).html(this.SSPopupHtml)},setScrollStep:function(n){this.scrollStep=n}};RFERL.js.custom.MultimediaWidget.registerClass("RFERL.js.custom.MultimediaWidget",null,Sys.IDisposable);;