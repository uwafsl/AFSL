"number"!==typeof TNCMS_DotConnect_Tile&&(TNCMS_DotConnect_Tile=1);"undefined"==typeof TNCMS_Used_Ad&&(TNCMS_Used_Ad={});Object.create||(Object.create=function(H){var d=function(){};d.prototype=H;return new d});
if("boolean"!==typeof TNCMS_PAGE_LOADED){TNCMS_PAGE_LOADED=!1;var pageLoaded=function(){TNCMS_PAGE_LOADED=!0};window.addEventListener?window.addEventListener("load",pageLoaded,!1):window.attachEvent?window.attachEvent("onload",pageLoaded):(priorOnLoad=window.onload,window.onload="function"!=typeof window.onload?pageLoaded:function(){priorOnLoad&&priorOnLoad();pageLoaded()})}window.TNCMS||(window.TNCMS={});
window.TNCMS.AdManager||(window.TNCMS.AdManager=function(){function H(a){a=a||{};a.debug&&(p=a.debug,0<p&&("undefined"==typeof console?alert("Please turn on the debugging console!"):(d("Debug level set to: "+p),A=!0)));U(a)&&(a.slot||(y?m("Changing the default domain from "+y+" to "+a.domain+"."):d("Setting the default domain to "+a.domain+"."),y=a.domain,Q=a.secureDomain),window.TNCMS.Tracking||n?window.TNCMS.Tracking&&!n&&(n=!0):(d("Start loading tracking script"),n="loading",D(a,"/shared-content/art/tncms/tracking.js",
function(){n=!0;d("Finished loading tracker script");if(!0!==n)d("Rendering deferred: Tracker script has not been loaded");else{for(sDomain in s)I(sDomain);for(;oAd=R.shift();)E(oAd)}})));if(a.virtualregion)for(regionType in w)a.virtualregion&&a.virtualregion[regionType]&&(w[regionType]=a.virtualregion[regionType]);if(a.callback)for(adType in F)"dotconnect"!=adType&&"html"!=adType&&a.callback&&a.callback[adType]&&(F[adType]=a.callback[adType])}function d(a){p&1&&A&&console.info(a)}function m(a){p&
2&&A&&console.warn(a)}function S(a){p&4&&A&&console.error(a)}function D(a,b,d){a=a||{};if(!a.domain||!a.secureDomain)throw Error("Failed to load script ("+b+"): valid domain data not detected");domain="https:"==location.protocol?a.secureDomain:a.domain;var c=document.createElement("script");c.src=location.protocol+"//"+domain+b;c.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(c);"function"==typeof d&&("undefined"!=typeof c.addEventListener?c.addEventListener("load",d,
!1):c.attachEvent("onreadystatechange",function(){"loaded"==c.readyState&&d()}));return c}function U(a){if(!a.domain||!a.secureDomain)return!1;if(t[a.domain])return!0;if(q[a.domain]&&u[a.domain]&&h[a.domain])return d("Using existing configs for "+a.domain),s[a.domain]=s[a.domain]||[],t[a.domain]=!0;q[a.domain]?d("Using existing impression data for "+a.domain):(d("Start loading impression data for "+a.domain),D(a,"/content/tncms/ads/impressions.js",function(){d("Finished loading impression data for "+
a.domain);u[a.domain]&&h[a.domain]&&(t[a.domain]=!0,I(a.domain))}));u[a.domain]?d("Using existing traffic data for "+a.domain):(d("Start loading traffic data for "+a.domain),D(a,"/content/tncms/ads/traffic.js",function(){d("Finished loading traffic data for "+a.domain);q[a.domain]&&h[a.domain]&&(t[a.domain]=!0,I(a.domain))}));h[a.domain]?d("Using existing settings for "+a.domain):(d("Start loading settings for "+a.domain),D(a,"/content/tncms/ads/settings.js",function(){d("Finished loading settings for "+
a.domain);q[a.domain]&&u[a.domain]&&(t[a.domain]=!0,I(a.domain))}));s[a.domain]=[];t[a.domain]="loading";return!0}function I(a){if(!0!==n)return d("Rendering deferred for "+a+": Tracker script has not been loaded"),!1;if(!0!==t[a])return d("Rendering deferred for "+a+": Config scripts have not been loaded"),!1;if(0==s[a].length)return d("No positions for "+a+" currently need rendering"),!1;for(;oConfig=s[a].shift();)J(oConfig)}function K(a){a=a||{};if(a.all){for(sDomain in f)K({domain:sDomain});return!0}if(a.region&&
a.slot){sDomain=a.domain||y;if(f[sDomain]&&f[sDomain][a.region]&&f[sDomain][a.region][a.slot]){if(!h[a.domain][a.region]||!h[a.domain][a.region].refreshable)return d("Ads for "+sDomain+" in "+a.region+" are not refreshable."),!1;d("Refreshing ads for "+sDomain+" in "+a.region+a.slot);J(f[sDomain][a.region][a.slot])}return!0}if(a.region){sDomain=a.domain||y;if(!h[sDomain][a.region]||!h[sDomain][a.region].refreshable)return d("Ads for "+sDomain+" in "+a.region+" are not refreshable."),!1;for(sSlot in f[sDomain][a.region])a.slot=
sSlot,K({domain:sDomain,region:a.region,slot:sSlot});return!0}sDomain=a.domain||y;if(!f[sDomain])return d("No ads to refresh for "+sDomain),!1;for(sRegion in f[sDomain])K({domain:sDomain,region:sRegion});return!0}function J(a){a=a||{};if(!0!==t[a.domain]||!0!==n)return s[a.domain]=s[a.domain]||[],s[a.domain].push(a),!0;if(sPositionCookie=L("tncms_position_"+a.region+"_"+a.slot))if(aData=sPositionCookie.split("&"),iFrequency=parseInt(aData[0],10),nMinutes=(new Date(unescape(aData[1]))-new Date)/6E4,
0<nMinutes){iMinutes=parseInt(nMinutes,10);sMessage="The position "+a.region+a.slot+" has met its frequency cap, which is set to "+iFrequency+" minutes. This position will be available again in ";sMessage=0==iMinutes?sMessage+"under a minute.":1==iMinutes?sMessage+"around a minute.":sMessage+("around "+iMinutes+" minutes.");m(sMessage);try{document.getElementById("blox-ad-position-"+a.region+a.slot).innerHTML=sMessage}catch(b){}return!1}a.position=a.region+a.slot;a.cdn=h[a.domain].cdn||null;a.section=
a.section?a.section:V;k[a.domain]=k[a.domain]||{};k[a.domain][a.region]=k[a.domain][a.region]||{};k[a.domain][a.region][a.slot]=k[a.domain][a.region][a.slot]||!1;if(!a.adList&&!k[a.domain][a.region][a.slot]&&!a.finalRender)return d("Attempting to load ads for "+a.domain+" in "+a.region+a.slot),D(a,"/content/tncms/ads/"+escape(a.region)+"/"+a.slot+".js",function(){d("Finished loading ads for "+a.domain+" in "+a.region+a.slot);a.finalRender=!0;return J(a)}),!1;f[a.domain]&&f[a.domain][a.region]&&f[a.domain][a.region][a.slot]||
(f[a.domain]=f[a.domain]||{},f[a.domain][a.region]=f[a.domain][a.region]||{},f[a.domain][a.region][a.slot]=a);for(iAd in TNCMS_Used_Ad)if(TNCMS_Used_Ad[iAd]==a.position){d("Removing ad #"+iAd+" from used ad list.");delete TNCMS_Used_Ad[iAd];break}try{return d("Generating ad for "+a.domain+" in "+a.position),oAd=W(a),w[oAd.regionType]?w[oAd.regionType](oAd):E(oAd)}catch(e){if("Warning"==e.name?m(e.message):S(e.message),oPositionDiv=document.getElementById("blox-ad-position-"+a.position))oPositionDiv.innerHTML=
"\x3c!-- "+e.message+" --\x3e"}return!1}function E(a){if(!a.type)throw Error("No ad type was found.");if(!F[a.type])throw Error('No callback for type "'+a.type+" was found.");if(!0!==t[a.domain]||!0!==n)return R.push(a),!0;if(p&1&&A){var b={};for(x in a)b[x]=a[x];d(b)}F[a.type](a);TNCMS.Tracking.addEvent({domain:TNCMS.AdManager.isSecure?a.secureDomain:a.domain,app:"bannerad",metric:"impressions",id:a.section+"/"+a.position+"/"+a.uuid});"dotconnect"!=a.type&&(TNCMS_Used_Ad[a.adid]=a.position);h[a.domain][a.region][a.slot]&&
h[a.domain][a.region][a.slot][a.section]&&h[a.domain][a.region][a.slot][a.section].frequency&&(iFrequency=parseInt(h[a.domain][a.region][a.slot][a.section].frequency,10),0<iFrequency&&!L("tncms_position_"+a.region+"_"+a.slot)&&(b=new Date,b.setTime(b.getTime()+6E4*iFrequency),d("Creating frequency cookie for "+a.region+a.slot+". It will expire in "+iFrequency+" minutes."),document.cookie="tncms_position_"+a.region+"_"+a.slot+"="+iFrequency+"&"+escape(b.toUTCString())+"; expires="+b.toUTCString()+
"; path=/"));if(a.frequency_limit)if(sCookieName="tncms_ad_"+a.adid,sCookieValue=L(sCookieName))aData=sCookieValue.split("&"),nAdCount=parseInt(aData[0],10)+1,d("Incrementing frequency limit cookie for "+a.adid),document.cookie=sCookieName+"="+nAdCount+"&"+aData[1]+"; expires="+unescape(aData[1])+"; path=/";else if(a.frequency_number&&a.frequency_type){b=new Date;switch(a.frequency_type){case "minutes":b.setTime(b.getTime()+6E4*a.frequency_number);break;case "hours":b.setTime(b.getTime()+36E5*a.frequency_number);
break;case "days":b.setTime(b.getTime()+864E5*a.frequency_number)}var e="; expires="+b.toUTCString();d("Creating frequency limit cookie for "+a.adid);document.cookie=sCookieName+"=1&"+escape(b.toUTCString())+e+"; path=/"}return!0}function T(a,b,d,c){k[a]=k[a]||{};k[a][b]=k[a][b]||{};k[a][b][d]=c}function W(a){if(a.adList)d("Caching passed ads for "+a.domain+" in "+a.region+a.slot),T(a.domain,a.region,a.slot,a.adList),oAdList=a.adList;else if(k[a.domain][a.region][a.slot])d("Using cached ads for "+
a.domain+" in "+a.region+a.slot),oAdList=k[a.domain][a.region][a.slot];else throw{name:"Warning",message:"No ads found in cache for "+a.domain+" in "+a.region+a.slot};for(iAd in oAdList)if("_popunder"!=a.region||"expandable"!=oAdList[iAd].type&&"flashexpandable"!=oAdList[iAd].type&&"pagecurl"!=oAdList[iAd].type&&"flashpagecurl"!=oAdList[iAd].type)if(TNCMS_Used_Ad[iAd])d("Removing ad #"+oAdList[iAd].adid+" because it is already being displayed."),delete oAdList[iAd];else{if("flash"==oAdList[iAd].type&&
(oAdList[iAd].flashVersion||(oAdList[iAd].flashVersion=11>oAdList[iAd].version?oAdList[iAd].version:13>oAdList[iAd].version?10+(parseInt(oAdList[iAd].version)-9)/10:24>oAdList[iAd].version?11+(parseInt(oAdList[iAd].version)-13)/10:13+(parseInt(oAdList[iAd].version)-24)/10,oAdList[iAd].flashVersion.toString().match(/\./i)||(oAdList[iAd].flashVersion+=".0")),!z.willPlay(oAdList[iAd].flashVersion))){var b=z.major?"Flash is not installed":"the installed Flash version is only "+z.major+"."+z.minor;if(oAdList[iAd].imageurl)d("Falling back to image from "+
oAdList[iAd].type+" for ad #"+oAdList[iAd].adid+" because Flash version "+oAdList[iAd].flashVersion+" is required but "+b+"."),oAdList[iAd].type="image",oAdList[iAd].file=oAdList[iAd].image,oAdList[iAd].file_modified=oAdList[iAd].image_modified,oAdList[iAd].uri=oAdList[iAd].imageuri,oAdList[iAd].asseturl=oAdList[iAd].imageurl,oAdList[iAd].height=oAdList[iAd].imageheight,oAdList[iAd].width=oAdList[iAd].imagewidth,b=oAdList[iAd].clickuri.split(","),oAdList[iAd].clickuri="",b[0]&&(oAdList[iAd].clickuri=
b[0]);else{d("Removing "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid+" because Flash version "+oAdList[iAd].flashVersion+" is required but "+b+".");delete oAdList[iAd];continue}}if(oAdList[iAd].uri||"image"!=oAdList[iAd].type&&"flash"!=oAdList[iAd].type&&"video"!=oAdList[iAd].type)if("flashexpandable"!=oAdList[iAd].type&&"flashpagecurl"!=oAdList[iAd].type||z.willPlay(7)){if("video"==oAdList[iAd].type){var e=!1;(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))e=!0})(navigator.userAgent||navigator.vendor||window.opera);switch(e){case !0:d("Mobile browser detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);switch(oAdList[iAd].asseturl.split(".").pop()){case "mp4":d("Mp4 file detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);break;case "flv":switch(z.willPlay(7)){case !0:d("Flash detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);break;case !1:d("Flash not found "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid),delete oAdList[iAd]}}break;
case !1:switch(d("Non-Mobile browser detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid),oAdList[iAd].asseturl.split(".").pop()){case "mp4":d("Mp4 file detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);break;case "flv":switch(z.willPlay(7)){case !0:d("Flash detected "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid);break;case !1:d("Flash not found "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid),delete oAdList[iAd]}}}}if("html"!=oAdList[iAd].type||"https:"!=location.protocol||oAdList[iAd].secure)if(F[oAdList[iAd].type])if("dotconnect"==
oAdList[iAd].type&&16<TNCMS_DotConnect_Tile)d("Removing ad #"+oAdList[iAd].adid+" because it is a DotConnect ad and there are already 16 DoctConnect ads on this page."),delete oAdList[iAd];else{if(oAdList[iAd].keywords&&0!==Object.keys(oAdList[iAd].keywords).length){bKeep=0;for(var c in oAdList[iAd].keywords)if(b=RegExp(" "+oAdList[iAd].keywords[c].toLowerCase()+" ",""),X.match(b)){bKeep=1;break}if(!bKeep){d("Removing ad #"+oAdList[iAd].adid+" because it does not match any keywords on this page.");
delete oAdList[iAd];continue}}var b=new Date,v=new Date,f=new Date,g=oAdList[iAd].startdate.split("-");v.setFullYear(g[0],g[1]-1,g[2]);g=oAdList[iAd].enddate.split("-");f.setFullYear(g[0],g[1]-1,g[2]);if(v>b)d("Removing ad #"+oAdList[iAd].adid+" because it has not yet started."),delete oAdList[iAd];else if(f<b)d("Removing ad #"+oAdList[iAd].adid+" because it has already ended."),delete oAdList[iAd];else if(a.width&&oAdList[iAd].width&&oAdList[iAd].width>a.width)d("Removing ad #"+oAdList[iAd].adid+
" because it is too wide for this region."),delete oAdList[iAd];else if(q[a.domain].daily[iAd]&&oAdList[iAd].dailyLimit&&oAdList[iAd].dailyLimit<=q[a.domain].daily[iAd])d("Removing ad #"+oAdList[iAd].adid+" because it has already met its daily impression limit."),delete oAdList[iAd];else if(q[a.domain].total[iAd]&&oAdList[iAd].totalLimit&&oAdList[iAd].totalLimit<=q[a.domain].total[iAd])d("Removing ad #"+oAdList[iAd].adid+" because it has already met its total impression limit."),delete oAdList[iAd];
else{if(oAdList[iAd].daypart_enabled&&""!=oAdList[iAd].daypart_enabled){if(!oAdList[iAd].daypart_schedule){d("Removing ad #"+oAdList[iAd].adid+" because day parting is enabled but there is not schedule.");delete oAdList[iAd];continue}b=eval("("+oAdList[iAd].daypart_schedule+")");if(!b[C.day]){d("Removing ad #"+oAdList[iAd].adid+" because day parting is enabled and this day is not in the schedule.");delete oAdList[iAd];continue}if(!(b[C.day].allday||b[C.day][C.startBound]&&b[C.day][C.endBound])){d("Removing ad #"+
oAdList[iAd].adid+" because day parting is enabled and it is not in the the start or end bound.");delete oAdList[iAd];continue}}if(oAdList[iAd].frequency_limit&&(sValue=L("tncms_ad_"+iAd))&&(aData=sValue.split("&"),nAdCount=parseInt(aData[0],10),nAdCount>=oAdList[iAd].frequency_limit)){d("Removing ad #"+oAdList[iAd].adid+" because it has met its frequency limit.");delete oAdList[iAd];continue}oAdList[iAd].lat&&oAdList[iAd]["long"]&&oAdList[iAd].proximity&&G&&(b=Math.sin((G.lat*Math.PI/180-oAdList[iAd].lat)/
2),v=Math.sin((G["long"]*Math.PI/180-oAdList[iAd]["long"])/2),b=Math.pow(b,2)+Math.pow(v,2)*Math.cos(oAdList[iAd].lat)*Math.cos(G.lat*Math.PI/180),7974*Math.atan2(Math.sqrt(b),Math.sqrt(1-b))>oAdList[iAd].proximity&&(d("Removing ad #"+oAdList[iAd].adid+" because the reader was not detected within the configured porximity."),delete oAdList[iAd]))}}else d("Removing ad #"+oAdList[iAd].adid+" because it is of type ("+oAdList[iAd].type+") and there is no callback registerd for that."),delete oAdList[iAd];
else d("Removing ad #"+oAdList[iAd].adid+" because is not a secure HTML ad."),delete oAdList[iAd]}else d("Removing "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid+" because there is no flash player to play it."),delete oAdList[iAd];else d("Removing "+oAdList[iAd].type+" ad #"+oAdList[iAd].adid+" because it is missing the mandatory asset uri."),delete oAdList[iAd]}else d("Removing ad #"+oAdList[iAd].adid+" because "+oAdList[iAd].type+" ads are not allowed in a popunder."),delete oAdList[iAd];if(0==oAdList.length)throw{name:"Warning",
message:"All ads have been eliminated from the ad list for this position ("+a.region+a.slot+")."};oSectionAds=N(a.section,oAdList);sCurrentSection=oSectionAds.section;aAd=oSectionAds.ads;if("ros"==sCurrentSection&&h[a.domain].sectionExclusions)for(c=0;c<h[a.domain].sectionExclusions.length;c++)if(h[a.domain].sectionExclusions[c]==a.section||-1<window.location.href.indexOf("/"+h[a.domain].sectionExclusions[c]+"/"))throw{name:"Warning",message:"ROS ads are excluded from this section ("+a.section+") so no ads will be displayed for this position ("+
a.region+a.slot+")."};if(!aAd||0==aAd.length)throw{name:"Warning",message:"There are no ads available in this section ("+a.section+") for this position ("+a.region+a.slot+")."};var m=g=f=v=b=0,n=0;for(c=0;c<aAd.length;c++)aAd[c].weight=Y(aAd[c],sCurrentSection,a.domain),1==aAd[c].weight.locked?(v+=parseFloat(aAd[c].weight.percent),aAd[c].minRange=b,aAd[c].maxRange=b+1E4*parseFloat(aAd[c].weight.percent),d("Weight range for ad #"+aAd[c].adid+": "+aAd[c].minRange+" to "+aAd[c].maxRange),b=aAd[c].maxRange):
2==aAd[c].weight.locked?f+=parseFloat(aAd[c].weight.percent):(g+=parseFloat(aAd[c].weight.percent),m++);if(f+g>100-v)for(nMultiplier=(100-v)/100,c=0;c<aAd.length;c++)1!=aAd[c].weight.locked&&(aAd[c].minRange=b,aAd[c].maxRange=b+1E4*parseFloat(aAd[c].weight.percent)*nMultiplier,d("Weight range for ad #"+aAd[c].adid+": "+aAd[c].minRange+" to "+aAd[c].maxRange),b=aAd[c].maxRange);else if(f+g<=100-v)if(0==g)for(n=100-v-f,c=0;c<aAd.length;c++)1!=aAd[c].weight.locked&&(aAd[c].minRange=b,aAd[c].maxRange=
b+1E4*parseFloat(aAd[c].weight.percent),d("Weight range for ad #"+aAd[c].adid+": "+aAd[c].minRange+" to "+aAd[c].maxRange),b=aAd[c].maxRange);else for(nNewPercent=(100-v-f)/m,c=0;c<aAd.length;c++)1!=aAd[c].weight.locked&&(nPercent=1>aAd[c].weight.locked?nNewPercent:aAd[c].weight.percent,aAd[c].minRange=b,aAd[c].maxRange=b+1E4*parseFloat(nPercent),d("Weight range for ad #"+aAd[c].adid+": "+aAd[c].minRange+" to "+aAd[c].maxRange),b=aAd[c].maxRange);b+=n;b=Math.floor(Math.random()*b);for(c=0;c<aAd.length;c++)if(aAd[c].minRange<=
b&&aAd[c].maxRange>b){d("Ad #"+aAd[c].adid+"(type: "+aAd[c].type+") chosen from "+a.domain+" to display in "+a.region+a.slot);oAd=Object.create(aAd[c]);for(sFieldName in a)"finalRender"==sFieldName||oAd[sFieldName]||(oAd[sFieldName]=a[sFieldName]);oAd.originalSection=a.section;oAd.section=sCurrentSection;oAd.position=a.region+a.slot;oAd.cdn&&(oAd.asseturl=location.protocol+"//"+oAd.cdn+oAd.uri);"https:"==location.protocol&&(oAd.smallImage&&(oAd.smallImage=oAd.smallImage.replace(/^http:/i,"https:")),
oAd.largeImage&&(oAd.largeImage=oAd.largeImage.replace(/^http:/i,"https:")),oAd.smallFlash&&(oAd.smallFlash=oAd.smallFlash.replace(/^http:/i,"https:")),oAd.largeFlash&&(oAd.largeFlash=oAd.largeFlash.replace(/^http:/i,"https:")));oAd.window=window;p&1&&"function"!=typeof w[oAd.regionType]?((debugHeaderDiv=document.getElementById("blox-ad-position-debug-header-"+oAd.position))?oAd.positionDiv=document.getElementById("blox-ad-position-"+oAd.position):(debugDiv=document.getElementById("blox-ad-position-"+
oAd.position),debugDiv.setAttribute("id","blox-ad-position-debug-"+oAd.position),debugHeaderDiv=document.createElement("div"),debugHeaderDiv.style.border="1px solid black",debugHeaderDiv.style.width="100%",debugHeaderDiv.setAttribute("id","blox-ad-position-debug-header-"+oAd.position),debugDiv.appendChild(debugHeaderDiv),oAd.positionDiv=document.createElement("div"),oAd.positionDiv.setAttribute("id","blox-ad-position-"+oAd.position),debugDiv.appendChild(oAd.positionDiv)),debugHeaderDiv.innerHTML=
" Ad Position: "+oAd.section+" : "+oAd.region+" : "+oAd.slot+" Ad ID: "+oAd.adid+" ("+oAd.type+":API 2)"):oAd.positionDiv=document.getElementById("blox-ad-position-"+oAd.position);if(oAd.clickuri)if("flash"==oAd.type){b=oAd.clickuri.split(",");for(a=0;a<b.length;a++)b[a]=b[a].replace(/^\s*/,"").replace(/\s*$/,""),b[a]=b[a].match(/^https?:\/\//i)?b[a]:"http://"+b[a],b[a]=TNCMS.Tracking.getRedirectURL({domain:TNCMS.AdManager.isSecure?oAd.secureDomain:oAd.domain,app:"bannerad",metric:"clicks",id:oAd.section+
"/"+oAd.position+"/"+oAd.uuid,url:unescape(b[a])});oAd.clickuri=b}else clickuri=oAd.clickuri.match(/^https?:\/\//i)?oAd.clickuri:"http://"+oAd.clickuri,oAd.clickuri=TNCMS.Tracking.getRedirectURL({domain:TNCMS.AdManager.isSecure?oAd.secureDomain:oAd.domain,app:"bannerad",metric:"clicks",id:oAd.section+"/"+oAd.position+"/"+oAd.uuid,url:clickuri});else"html"==oAd.type&&oAd.html&&(trackerURL=location.protocol+TNCMS.Tracking.getRedirectURL({domain:TNCMS.AdManager.isSecure?oAd.secureDomain:oAd.domain,app:"bannerad",
metric:"clicks",id:oAd.section+"/"+oAd.position+"/"+oAd.uuid,url:"TNCMS_AD_TRACKER"}),trackerURL=trackerURL.replace(/TNCMS_AD_TRACKER/,""),html=eval(oAd.html),oAd.html=html.replace(/__TRACKER_URL__/g,trackerURL));"video"==oAd.type&&(oAd.rolltype="pre",oAd.autoplay=0,oAd.embed=0,oAd.volume=50,h[oAd.domain][oAd.region][oAd.slot]&&h[oAd.domain][oAd.region][oAd.slot][oAd.section]&&(a=h[oAd.domain][oAd.region][oAd.slot][oAd.section],oAd.rolltype=a.video_rolltype||oAd.rolltype,oAd.autoplay=a.video_autoplay?
parseInt(a.video_autoplay,10):oAd.autoplay,oAd.embed=a.video_embed?parseInt(a.video_embed,10):oAd.embed,oAd.volume=a.video_volume?parseInt(a.video_volume,10):oAd.volume));return oAd}throw{name:"Warning",message:"No ad was selected from the list"};}function Y(a,b,e){for(adSection in a.weights)if(adSection==b){if(!h[e].trafficSmoothing||"asap"==a.ad_balancing)return d("On "+e+" using default weights (ASAP) for ad#"+a.adid),a.weights[adSection];if(!u[e].estimate||!u[e].ratio)return m("No traffic data found for "+
e+": using default weights for ad#"+a.adid),a.weights[adSection];iHour=(new Date).getHours();nTrafficEstimate=u[e].estimate[iHour]||0;nTrafficRatio=u[e].ratio[iHour]||0;if(a.dailyLimit&&q[e].daily[a.adid]&&nTrafficRatio&&nTrafficEstimate){nWantedImpressions=(a.dailyLimit-q[e].daily[a.adid])*nTrafficRatio;if(nWantedImpressions>=nTrafficEstimate)return d("Wanted impressions for "+a.adid+" is greater than the current traffic estimate: using default weights for ad#"+a.adid),a.weights[adSection];nWeight=
nWantedImpressions/nTrafficEstimate;d("Overriding default weight: using traffic curve for ad#"+a.adid);return{section:b,percent:100*nWeight,locked:2}}d("Using default weight in favor of traffic curve for ad#"+a.adid);return a.weights[adSection]}m("No weight data found for ad#"+a.adid+" found: using 0");return 0}function N(a,b){oValidAds=[];for(nAdId in b)for(var e=b[nAdId].sections,c=0;c<e.length;c++)e[c]==a&&oValidAds.push(b[nAdId]);return 0<oValidAds.length||"ros"==a?(d("Returning ads for section: "+
a),{section:a,ads:oValidAds}):(sMatch=a.match(/(\/[\w\-]+)$/g))?N(a.replace(sMatch,""),b):N("ros",b)}function L(a){a+="=";for(var b=document.cookie.split(";"),d=0;d<b.length;d++){for(var c=b[d];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(a))return c.substring(a.length,c.length)}return null}function r(a){var b=a.style?' style="'+a.style+'"':"";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){b='<embed type="application/x-shockwave-flash" src="'+a.src+'" width="'+
a.width+'" height="'+a.height+'"'+b+' id="'+a.id+'" name="'+a.id+'" ';for(key in a.flashParams)b+=key+'="'+a.flashParams[key]+'" ';0<a.flashVars.length&&(b+='flashvars="'+a.flashVars.join("&")+'"');return b+"/>"}b='<object id="'+a.id+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+a.width+'" height="'+a.height+'" '+b+'><param name="movie" value="'+a.src+'" />';for(key in a.flashParams)b+='<param name="'+key+'" value="'+a.flashParams[key]+'" />';0<a.flashVars.length&&(b+='<param name="flashvars" value="'+
a.flashVars.join("&")+'" />');return b+"</object>"}var t={},s={},f={},y=null,O={},Q=null,Z="https:"==location.protocol?!0:!1,k={},R=[],p=location.search.match(/(\?|\&)adman_debug_mode=(\d+)/)?RegExp.$2:0,A=!1,G=!1,n=!1,q={},u={},h={},z=function(){var a=[],b=!1;if(navigator.plugins&&navigator.mimeTypes.length)(b=navigator.plugins["Shockwave Flash"])&&b.description&&(a=b.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."));else{try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(d){try{b=
new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{b.AllowScriptAccess="always"}catch(c){a=[6,0,21],b=!1}}catch(f){}if(!a)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(h){}}b&&(a=b.GetVariable("$version").split(" ")[1].split(","))}var g=a[0]?parseInt(a[0]):0,k=a[1]?parseInt(a[1]):0,m=a[2]?parseInt(a[2]):0;delete a;return{major:g,minor:k,rev:m,willPlay:function(a){if(0==g&&0==k&&0==m)return!1;aFlashFileVersion=a.toString().split(".");a=aFlashFileVersion[0]?parseInt(aFlashFileVersion[0]):
0;var b=aFlashFileVersion[1]?parseInt(aFlashFileVersion[1]):0,c=aFlashFileVersion[2]?parseInt(aFlashFileVersion[2]):0;return g<a?!1:g>a?!0:k<b?!1:k>b?!0:m<c?!1:!0}}}(),F={dotconnect:function(a){var b=window.location.pathname.split("/"),d="frontpage",c=a.domain.replace("www.","");1<b.length&&-1==b[1].indexOf(".")&&(d=b[1]);var f="";a.fold&&("above"==a.fold?f="atf":"below"==a.fold?f="btf":"span"==a.fold&&(f="stf"));if(!window.googletag&&(window.googletag={},null===document.getElementById("dotconnect-gpt-load"))){b=
document.createElement("script");b.id="dotconnect-gpt-load";b.async=!0;b.type="text/javascript";b.src=("https:"==document.location.protocol?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var h=document.getElementsByTagName("head")[0];h.appendChild(b,h)}var g=window.googletag||{};g.cmd=g.cmd||[];O[a.adid]?g.pubads().refresh([O[a.adid]]):(g.cmd.push(function(){O[a.adid]=g.defineSlot("/132916964/"+c,[parseInt(a.width),parseInt(a.height)],a.positionDiv.id).addService(g.pubads()).setTargeting("pos",
f);g.pubads().setTargeting("sec",d);g.enableServices();g.display(a.positionDiv.id)}),a.positionDiv.className="tncms-iq-ad",TNCMS_DotConnect_Tile++)},expandable:function(a){var b='<img src="'+a.smallImage+'" alt="'+(a.title?a.title:"*")+'" border="0" id="expandable_'+a.adid+'" onmouseover="document.getElementById(\'expandable_'+a.adid+"').src = '"+a.largeImage+"'\" onmouseout=\"document.getElementById('expandable_"+a.adid+"').src = '"+a.smallImage+"'\"/>";a.clickuri&&(b='<a rel="nofollow" href="http:'+
a.clickuri+'" target="'+(a.target?a.target:"_blank")+'">'+b+"</a>");a.positionDiv.innerHTML=b},flash:function(a){oFlashConfig={id:"blox-flash-ad-"+a.adid,src:a.asseturl,width:a.width,height:a.height,flashParams:{bgcolor:"#000",quality:"high",wmode:a.transparent?"transparent":"opaque"},flashVars:[]};if(0<a.clickuri.length)for(var b=0;b<a.clickuri.length;b++)sCount=0==b?"":b+1,oFlashConfig.flashVars.push("clickTAG"+sCount+"=http:"+escape(a.clickuri[b]));a.positionDiv.innerHTML=r(oFlashConfig)},flashexpandable:function(a){window.TNCMS_FlashExpandable||
(window.TNCMS_FlashExpandable={autohidetimer:10,timerrunning:!1,timerlen:5,slideAniLen:400});window.slidedown||(window.slidedown=function(a){TNCMS_FlashExpandable.moving||"none"!=document.getElementById("expanded1container").style.display||(TNCMS_FlashExpandable.moving=!0,TNCMS_FlashExpandable.dir="down",startslide(a))});window.slideup||(window.slideup=function(a){TNCMS_FlashExpandable.moving||"none"==document.getElementById("expanded1container").style.display||(TNCMS_FlashExpandable.moving=!0,TNCMS_FlashExpandable.dir=
"up",startslide(a))});window.startslide||(window.startslide=function(a){TNCMS_FlashExpandable.obj=document.getElementById("expanded1container");TNCMS_FlashExpandable.endHeight=parseInt(TNCMS_FlashExpandable.obj.style.height);TNCMS_FlashExpandable.startTime=(new Date).getTime();"down"==TNCMS_FlashExpandable.dir&&(TNCMS_FlashExpandable.obj.style.height="1px");TNCMS_FlashExpandable.obj.style.display="block";TNCMS_FlashExpandable.timerID=setInterval("slidetick('"+a+"');",TNCMS_FlashExpandable.timerlen)});
window.slidetick||(window.slidetick=function(a){var d=(new Date).getTime()-TNCMS_FlashExpandable.startTime;d>TNCMS_FlashExpandable.slideAniLen?endSlide(a):(a=Math.round(d/TNCMS_FlashExpandable.slideAniLen*TNCMS_FlashExpandable.endHeight),"up"==TNCMS_FlashExpandable.dir&&(a=TNCMS_FlashExpandable.endHeight-a),TNCMS_FlashExpandable.obj.style.height=a+"px")});window.endSlide||(window.endSlide=function(a){clearInterval(TNCMS_FlashExpandable.timerID);"up"==TNCMS_FlashExpandable.dir&&(TNCMS_FlashExpandable.obj.style.display=
"none");TNCMS_FlashExpandable.obj.style.height=TNCMS_FlashExpandable.endHeight+"px";delete TNCMS_FlashExpandable.moving;delete TNCMS_FlashExpandable.timerID;delete TNCMS_FlashExpandable.startTime;delete TNCMS_FlashExpandable.endHeight;delete TNCMS_FlashExpandable.obj;delete TNCMS_FlashExpandable.dir});window.expand||(window.expand=function(a){"none"==document.getElementById("expanded1container").style.display&&(slidedown(a),collapsedstoptimer(a))});window.collapse||(window.collapse=function(a){"block"==
document.getElementById("expanded1container").style.display&&(slideup(a),collapsedstoptimer(a))});window.toggleSlide||(window.toggleSlide=function(a){"none"==document.getElementById("expanded1container").style.display?slidedown(a):(slideup(a),collapsedstoptimer(a))});window.collapsedstoptimer||(window.collapsedstoptimer=function(a){TNCMS_FlashExpandable.timerrunning&&clearTimeout(TNCMS_FlashExpandable.timer)});window.collapsedinit||(window.collapsedinit=function(a){toggleSlide(a);0<TNCMS_FlashExpandable.autohidetimer&&
(TNCMS_FlashExpandable.timer=setTimeout("toggleSlide('"+a+"')",1E3*TNCMS_FlashExpandable.autohidetimer));TNCMS_FlashExpandable.timerrunning=!0});sHTML='<div id="adholder" style="position:relative;z-index:1;">';sHTML+='  <div id="collapsed1container" style="position:relative;width:'+a.width+"px;height:"+a.height+'px;z-index:1;">';sHTML+=r({id:"collapsed1SmallObject",src:a.smallFlash,width:a.width,height:a.height,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high",swliveconnect:"true"},
flashVars:["small=&ad_url=http:"+escape(a.clickuri)]});sHTML+="  </div>";sHTML+='  <div id="expanded1container" style="position:relative;display:none;width:'+a.largewidth+"px;height:"+a.largeheight+'px;overflow:hidden;z-index:1;">';sHTML+=r({id:"expanded1SmallObject",src:a.largeFlash,width:a.largewidth,height:a.largeheight,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high",swliveconnect:"true"},flashVars:["big=&ad_url=http:"+escape(a.clickuri)]});sHTML+="  </div>";sHTML+="</div>";
sHTML+='<script type="text/javascript">collapsedinit('+a.adid+");\x3c/script>";a.positionDiv.innerHTML=sHTML},flashpagecurl:function(a){window.sizeup987||(window.sizeup987=function(){document.getElementById("bigCorner").style.top="0px";document.getElementById("smallCorner").style.top="-1000px"});window.sizedown987||(window.sizedown987=function(){document.getElementById("smallCorner").style.top="0px";document.getElementById("bigCorner").style.top="-1000px"});sSmallSize=100>=a.width?100:250;sLargeSize=
650>=a.largewidth?650:800;domain="";document.domain!=a.domain&&document.domain!=a.secureDomain&&(domain=location.protocol+"//"+("https:"==location.protocol?a.secureDomain:a.domain));sHTML='<div id="smallCorner" style="position:absolute; width:'+sSmallSize+"px; height:"+sSmallSize+'px; z-index:999999; right:0px; top:0px;">';sHTML+=r({id:"smallCornerObject",src:domain+"/shared-content/tncms-ad-manager/pagecurl_small.swf?ico="+escape(a.smallFlash),width:sSmallSize,height:sSmallSize,flashParams:{allowScriptAccess:"always",
wmode:"transparent",quality:"high"},flashVars:["ico="+escape(a.smallFlash)]});sHTML+="</div>";sHTML+='<div id="bigCorner" style="position:absolute; width:'+sLargeSize+"px; height:"+sLargeSize+'px; z-index:9999; right:0px; top:0px;">';sHTML+=r({id:"bigCornerObject",src:domain+"/shared-content/tncms-ad-manager/pagecurl_large.swf?big="+escape(a.largeFlash)+"&ad_url=http:"+escape(a.clickuri),width:sLargeSize,height:sLargeSize,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high"},
flashVars:["big="+escape(a.largeFlash)+"&ad_url=http:"+escape(a.clickuri)]});sHTML+="</div>";setTimeout('document.getElementById("bigCorner").style.top = "-1000px";',1E3);a.positionDiv.innerHTML=sHTML},html5:function(a){if(a.positionDiv.hasChildNodes())for(d("Position "+a.position+" has child nodes. Removing child nodes for refresh.");a.positionDiv.firstChild;)a.positionDiv.removeChild(a.positionDiv.firstChild);var b=document.createElement("iframe");b.setAttribute("id","html5-ad-frame-"+a.adid);b.setAttribute("width",
a.width);b.setAttribute("height",a.height);b.setAttribute("marginwidth",0);b.setAttribute("marginheight",0);b.setAttribute("hspace",0);b.setAttribute("vspace",0);b.setAttribute("frameborder",0);b.setAttribute("scrolling","no");var e="//"+a.cdn+"/content/tncms/ads/__html5/"+a.uuid+"/"+a.html5_id+"/"+a.htmlfile;a.clickuri&&(e+="?clickTag="+encodeURIComponent(a.clickuri));b.src=e;a.positionDiv.appendChild(b)},html:function(a){if(null!=a.height&&""!=a.height){if(a.positionDiv.hasChildNodes())for(d("Position "+
a.position+" has child nodes. Removing child nodes for refresh.");a.positionDiv.firstChild;)a.positionDiv.removeChild(a.positionDiv.firstChild);var b=document.createElement("iframe");b.setAttribute("id","html-ad-frame-"+a.adid);b.setAttribute("width",a.width);b.setAttribute("height",a.height);b.setAttribute("marginwidth",0);b.setAttribute("marginheight",0);b.setAttribute("hspace",0);b.setAttribute("vspace",0);b.setAttribute("frameborder",0);b.setAttribute("scrolling","no");var e;e='<script type="text/javascript">var inDapIF = true;\x3c/script>'+
a.html;e=e.replace(/[-[\]\/{}()*+?.\\^$|'"]/g,"\\$&");b.src="javascript:'"+e+"'";a.positionDiv.appendChild(b)}else for(a.positionDiv.innerHTML=a.html,aChildNode=a.positionDiv.childNodes,b=0;aChildNode[b];b++)if(aChildNode[b].nodeName&&"script"===aChildNode[b].nodeName.toLowerCase()&&(!aChildNode[b].type||"text/javascript"===aChildNode[b].type.toLowerCase())){oNode=aChildNode[b].parentNode?aChildNode[b].parentNode.removeChild(aChildNode[b]):aChildNode[b];if(oNode.src)d("Ad #"+a.adid+": Loading script: "+
oNode.src+" on "+a.position),$.loadScript(oNode.src,"blox-ad-position-"+a.position);else{d("Ad #"+a.adid+": Running inline script: on "+a.position);sData=oNode.text||oNode.textContent||oNode.innerHTML||"";e=document.getElementsByTagName("head")[0]||document.documentElement;var c=document.createElement("script");c.type="text/javascript";c.appendChild(document.createTextNode(sData));oldDocumentWrite=document.write;document.write=function(b){a.positionDiv.innerHTML+=b};e.insertBefore(c,e.firstChild);
e.removeChild(c);document.write=oldDocumentWrite}oNode.parentNode&&oNode.parentNode.removeChild(oNode)}},image:function(a){alt=a.title?a.title:"*";sHeight=a.height?' height="'+a.height+'"':"";sWidth=a.width?' width="'+a.width+'"':"";sOnClick="";a.clickuri&&(sTarget=a.target?a.target:"_blank",sOnClick=" onclick=\"window.open('http:"+a.clickuri+"','"+sTarget+'\');" style="cursor: pointer;"');a.positionDiv.innerHTML='<img src="'+a.asseturl+'" alt="'+alt+'" border="0"'+sHeight+sWidth+sOnClick+"/>"},pagecurl:function(a){window.sizeup987||
(window.sizeup987=function(){document.getElementById("bigCorner").style.top="0px";document.getElementById("smallCorner").style.top="-1000px"});window.sizedown987||(window.sizedown987=function(){document.getElementById("smallCorner").style.top="0px";document.getElementById("bigCorner").style.top="-1000px"});document.domain==a.domain||document.domain==a.secureDomain?path="/shared-content/tncms-ad-manager/":(domain="https:"==location.protocol?a.secureDomain:a.domain,path=location.protocol+"//"+domain+
"/shared-content/tncms-ad-manager/");sSmallSize="100";sBigSize="650";sHTML='<div id="smallCorner" style="position:absolute; width:'+sSmallSize+"px; height:"+sSmallSize+'px; z-index:9999; right:0px; top:0px;">';sHTML+=r({id:"smallCornerObject",src:path+"pagecurl_small.swf?ico="+escape(a.smallImage),width:sSmallSize,height:sSmallSize,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high",swliveconnect:"true"},flashVars:["ico="+escape(a.smallImage)]});sHTML+="</div>";sHTML+='<div id="bigCorner" style="position:absolute; width:'+
sBigSize+"px; height:"+sBigSize+'px; z-index:9999; right:0px; top:0px;">';sHTML+=r({id:"bigCornerObject",src:path+"pagecurl_large.swf?big="+escape(a.largeImage)+"&ad_url=http:"+escape(a.clickuri),width:sBigSize,height:sBigSize,flashParams:{allowScriptAccess:"always",wmode:"transparent",quality:"high",swliveconnect:"true"},flashVars:["big="+escape(a.largeImage)+"&ad_url=http:"+escape(a.clickuri)]});sHTML+="</div>";setTimeout("document.getElementById('bigCorner').style.top = '-1000px';",1E3);a.positionDiv.innerHTML=
sHTML},text:function(a){sTarget=a.target?a.target:"_blank";a.positionDiv.innerHTML='<a rel="nofollow" href="http:'+a.clickuri+'" target="'+sTarget+'">'+a.title+"</a><br />"+a.text},video:function(a){oFlashConfig={id:"blox-flash-ad-"+a.adid,src:"/shared-content/art/tncms-ad-manager/flowplayer/FlowPlayer.swf",width:a.width,height:a.height,flashParams:{wmode:"transparent",allowfullscreen:!0,allowscriptaccess:"always",quality:"high",bgcolor:"#ffffff"},flashVars:["config={&quot;autoPlay&quot;:"+(1==a.autoplay?
"true":"false")+",&quot;initialVolumePercentage&quot;:"+a.volume+",&quot;autoBuffering&quot;:false,&quot;loop&quot;:false,&quot;playList&quot;:[{&quot;url&quot;:&quot;"+a.asseturl+"&quot;,&quot;type&quot;:&quot;flv&quot;,&quot;linkUrl&quot;:&quot;"+escape(a.clickuri)+"&quot;}]}"]};document.domain!=a.domain&&document.domain!=a.secureDomain&&(domain="https:"==location.protocol?a.secureDomain:a.domain,oFlashConfig.src=location.protocol+"//"+domain+oFlashConfig.src);a.positionDiv.innerHTML=r(oFlashConfig)}},
w={popunder:function(a){if("expandable"==a.type||"flashexpandable"==a.type||"pagecurl"==a.type||"flashpagecurl"==a.type)throw Error("Ad type "+a.type+"is not allowed in a popunder.");iWidth=a.width?parseInt(a.width,10)+30:300;iHeight=a.height?parseInt(a.height,10)+100:300;iLeft=(screen.width-iWidth)/2;iTop=(screen.height-iHeight)/2;a.window=window.open("","tncms_adman_popunder","top="+iTop+", left="+iLeft+",width="+iWidth+",height="+iHeight+",scrollbars=0,resizable=0,toolbar=0,location=0,menubar=0,status=0,directories=0");
a.positionDiv=a.window.document.body;a.positionDiv.setAttribute("id","blox-ad-position-"+a.position);a.positionDiv.innerHTML="";a.window.blur();window.focus();a.window.document.title=a.title;a.window.resizeTo(iWidth,iHeight);a.window.moveTo(iLeft,iTop);E(a)},popup:function(a){function b(){document.getElementsByTagName("body")[0].removeChild(document.getElementById("blox-ad-position-_popup1"));document.getElementsByTagName("body")[0].removeChild(document.getElementById("BlackOutDiv"))}var d=document.createElement("div");
d.setAttribute("id","BlackOutDiv");d.style.position="fixed";d.style.top=0;d.style.left=0;d.style.width="100%";d.style.height="100%";d.style.zIndex=99999;d.style.backgroundColor="black";d.style.opacity=0.9;d.style.filter="alpha(opacity=90)";if("number"==typeof window.innerWidth)iWinWidth=window.innerWidth,iWinHeight=window.innerHeight;else if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight))iWinWidth=document.documentElement.clientWidth,iWinHeight=
document.documentElement.clientHeight;else if(document.body&&(document.body.clientWidth||document.body.clientHeight))iWinWidth=document.body.clientWidth,iWinHeight=document.body.clientHeight;else throw Error("No valid hight or width for the current window could be found");iWidth=a.width||400;iHeight=a.height||400;iAdLeft=parseInt((iWinWidth-iWidth)/2);iAdLeft=0<iAdLeft?iAdLeft:0;iAdTop=parseInt((iWinHeight-iHeight)/2);iAdTop=0<iAdTop?iAdTop:0;var c=document.createElement("div");c.style.position="absolute";
c.style.top=iAdTop+"px";c.style.left=iAdLeft+"px";c.style.zIndex=parseInt(d.style.zIndex)+1;c.setAttribute("id","blox-ad-position-_popup1");"undefined"!=typeof d.addEventListener?d.addEventListener("click",b,!1):("BackCompat"==document.compatMode&&(d.style.width="110%",d.style.height="110%",d.style.position="absolute"),d.attachEvent("onclick",b));document.getElementsByTagName("body")[0].appendChild(d);document.getElementsByTagName("body")[0].appendChild(c);a.positionDiv=document.getElementById("blox-ad-position-_popup1");
E(a)}};0<p&&("undefined"==typeof console?alert("Please turn on the debugging console!"):(d("Debug level set to: "+p),A=!0));window.XMLHttpRequest?oReq=new XMLHttpRequest:window.ActiveXObject&&(oReq=new ActiveXObject("MSXML2.XMLHTTP.3.0"));if(oReq){oReq.onreadystatechange=function(){if(4==oReq.readyState&&200==oReq.status){var a=eval("("+oReq.responseText+")");""!==a.lat&&""!==a["long"]&&(G={lat:a.lat,"long":a["long"]})}};try{oReq.open("GET","/_services/v1/client_ip_info/",!1),oReq.send()}catch(ba){}}oCurrent=
(aTime=location.search.match(/(\?|\&)adman_debug_time=(\d\d)\/(\d\d)\/(\d\d\d\d)_(\d\d)-(\d\d)/))?new Date(aTime[4],aTime[2]-1,aTime[3],aTime[5],aTime[6]):new Date;sBound=4*oCurrent.getHours()+Math.floor(oCurrent.getMinutes()/15);var C={day:oCurrent.getDay(),startBound:sBound,endBound:sBound+1};delete aTime;delete oCurrent;delete sBound;aTag=document.getElementsByTagName("meta");oKeyword={};aKeyword=[];for(var M=0;M<aTag.length;M++)if("keywords"==aTag[M].name.toLowerCase()){aTemp=aTag[M].content.split(",");
for(var P=0;P<aTemp.length;P++)(sTemp=aTemp[P].replace(/^\s+|\s+$/g,""))&&(oKeyword[" "+sTemp+" "]=1)}for(var aa in oKeyword)aKeyword.push(aa);var X=aKeyword.join(",").toLowerCase();delete aTag;delete oKeyword;delete aKeyword;docPath=document.location.href.replace(/\?.*/,"").replace(/#\w+/,"");sPath="";docPath.match(/^https:\/\/.+\/\-(\/[^#?\s]+)/)?sPath=RegExp.$1:docPath.match(/^((http|ftp|https):\/)?\/?([^:\/\s]+)((\/[\w\-\.]+)*\/)([\w\-\.]+\.[^#?\s]+)(#[\w\-]+)?$/)?sPath=RegExp.$4:docPath.match(/^((http|ftp|https):\/)?\/?([^:\/\s]+)((\/[\w\-\.]+)*\/)?$/)&&
(sPath=RegExp.$4);var V="/"==sPath?"frontpage":sPath.replace(/^\//,"").replace(/\/$/,"");delete docPath;delete sPath;for(regionType in w)"function"==typeof window["tncms_virtual_region_"+regionType]&&(w[regionType]=window["tncms_virtual_region_"+regionType]);var $=function(){function a(){q.length?f(q.shift()):0===t&&(d("jsLoader: Auto-releasing"),B.release())}function b(d){var c=s[d.domId];if(c&&c.length)if(c=c.shift(),0===c.toLowerCase().indexOf("<script")){var l=document.createElement("div");l.innerHTML=
"dummy<div>"+c+"</div>";l=l.children[0].children[0];c=l.getAttribute("language")||"javascript";if(l.src)d.src=l.src,d.charset=l.charset,d.language=c,d.type=l.type,f(d);else{if(l=l.text?l.text.replace(/^\s*|\s*$/gi,""):l.text)h(d,l,c),A(l,c);e(d)}}else{l=u[d.domId]||(u[d.domId]=document.getElementById(d.domId));if(!l)throw Error('jsLoader: Unable to inject html. Element with id "'+d.domId+'" does not exist');if(c=c?c.replace(/^\s*|\s*$/gi,""):c)l.innerHTML+=c;b(d)}else{for(;0<r.length;)if(d=r.pop(),
c=d.id,l=B.originalGetElementById.call?B.originalGetElementById.call(document,c):B.originalGetElementById(c)){var g=l.parentNode;l.id=c+"__tmp";g.insertBefore(d,l);g.removeChild(l)}a()}}function e(a){var d=a.domId,c;c=p.join("").replace(/<noscript>[\s\S]*?<\/noscript>/ig,"");p=[];var e=y,f,g=0,h,k=[];if(z)h=c.split(e);else{for(h=[];f=e.exec(c);)f.index>g&&k.push(c.slice(g,f.index)),1<f.length&&f.index<c.length&&Array.prototype.push.apply(h,f.slice(1)),g=e.lastIndex;g<c.length&&h.push(c.slice(g))}c=
0;for(e=h.length;c<e;c+=1)""!==h[c]&&k.push(h[c]);s[d]?Array.prototype.unshift.apply(s[d],k):s[d]=k;b(a)}function c(a){function b(a,c){var d=c.children,e,f,g;if(d&&d.length)for(e=0,f=d.length;e<f;e++)if(g=d[e],g.id&&g.id===a||g.children&&g.children.length&&(g=b(a,g)))return g}function d(a){var b,c,e;b=0;for(c=r.length;b<c;b++)if(e=r[b],e.id===a)return e}var c=B.originalGetElementById.call?B.originalGetElementById.call(document,a):B.originalGetElementById(a),e,f;if(c||r.length&&(c=d(a)))return c;if(p.length)return c=
p.join(""),e=document.createDocumentFragment(),f=document.createElement("div"),f.innerHTML=c,e.appendChild(f),(c=b(a,f))&&r.push(c),c}function f(a){t++;var b=document.createElement("script");a.type&&(b.type=a.type);a.charset&&(b.charset=a.charset);a.language&&(b.language=a.language);h(a);var c=!1;b.onload=b.onreadystatechange=function(){t--;b.loaded=!0;c||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(c=!0,b.onload=b.onreadystatechange=null,d("jsLoader: #"+a.domId+": onload "+
a.src),e(a))};b.loaded=!1;b.src=a.src;w.insertBefore(b,w.firstChild);setTimeout(function(){if(!b.loaded)throw Error("jsLoader: SCRIPT NOT LOADED: "+b.src);},3E3)}function h(a,b,c){d("jsLoader: #"+a.domId+(b?": Inline "+c+": "+b.replace("\n"," ").substr(0,30)+"...":": Inject "+a.src))}function g(a){p.push(a);d("jsLoader: write: "+a)}function k(){return document}function m(){}var n=!1,q=[],p=[],s={},t=0,u={},r=[],y=/(<script[\s\S]*?<\/script>)/gim,B=null,w=document.getElementsByTagName("head")[0]||
document.documentElement,z="b"==="abc".split(/(b)/)[1],A=function(){return window.execScript?function(a,b){window.execScript(a,b||"JavaScript")}:function(a,b){b&&!/^javascript/i.test(b)||window.eval.call(window,a)}}();return B={activate:function(){n||(document.write=document.writeln=g,document.open=k,document.close=m,document.getElementById=c,n=!0)},release:function(){n&&(document.write=this.originalWrite,document.writeln=this.originalWriteLn,document.open=this.originalOpen,document.close=this.originalClose,
document.getElementById=this.originalGetElementById,u={},n=!1)},loadScript:function(b,c){if("string"!==typeof c)throw Error("jsLoader: No valid DOM ID found for "+b);n||(d("jsLoader: Auto-activating"),this.activate());q.push({src:b,domId:c});setTimeout(function(){0===t&&a()},1)},originalGetElementById:document.getElementById,originalWrite:document.write,originalWriteLn:document.writeln,originalOpen:document.open,originalClose:document.close}}();return{info:d,warn:m,error:S,init:H,setImpressions:function(a,
b){q[a]=b},setTraffic:function(a,b){u[a]=b},setSettings:function(a,b){h[a]=b;h[a].trafficSmoothing&&d("Traffic smoothing active on "+a)},setAds:T,render:function(a){a=a||{};H(a);a.domain=a.domain||y;a.secureDomain=a.secureDomain||Q;if(!a.region||!a.slot)return m("No valid position"),m(a),!1;aRegionType=a.region.match(/^\_(.*)$/);a.regionType=aRegionType&&aRegionType[1]?aRegionType[1]:"inline";if(!document.getElementById("blox-ad-position-"+a.region+a.slot)&&"inline"==a.regionType){if(TNCMS_PAGE_LOADED)return m("The div for position ("+
a.region+a.slot+") does not exist!"),!1;document.write('\n<div id="blox-ad-position-'+a.region+a.slot+'"></div>\n')}return J(a)},renderAd:E,refresh:K,isSecure:Z}}());
